{
    "GenomicsDB": {
        "name_process": "GenomicsDB",
        "string_process": "\nprocess GenomicsDB {\n   input:\n   file(genome)\n   file(genome_index)\n   file(genome_dict)\n   set region_no, region_list, file(gvcfs) from region_and_gvcf_ch\n\n   output: \n                                \n   set region_no, file(\"ws-reg-${region_no}\") into genomicsdb_ch\n\n   script:\n                                               \n   bed_str = region_list.join(\"\\t\").replace(\",\", \"\\t\").replace(\"-\", \"\\t\")\n   \"\"\"\n   echo \"${bed_str}\" > reg-${region_no}.bed;\n   # printf to avoid newline at end, which GenomicsDBImport is allergic to\n   # printf '%s'\n   echo \"${sample_name_map_str}\" > sample_map.csv\n   ls -l\n   gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \" \\\n       GenomicsDBImport --sample-name-map sample_map.csv --genomicsdb-workspace-path ws-reg-${region_no} --intervals reg-${region_no}.bed\n   \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "   bed_str = region_list.join(\"\\t\").replace(\",\", \"\\t\").replace(\"-\", \"\\t\")\n   \"\"\"\n   echo \"${bed_str}\" > reg-${region_no}.bed;\n   # printf to avoid newline at end, which GenomicsDBImport is allergic to\n   # printf '%s'\n   echo \"${sample_name_map_str}\" > sample_map.csv\n   ls -l\n   gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \" \\\n       GenomicsDBImport --sample-name-map sample_map.csv --genomicsdb-workspace-path ws-reg-${region_no} --intervals reg-${region_no}.bed\n   \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genome",
            "genome_index",
            "genome_dict",
            "region_and_gvcf_ch"
        ],
        "nb_inputs": 4,
        "outputs": [
            "genomicsdb_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "GenotypeGVF": {
        "name_process": "GenotypeGVF",
        "string_process": "\nprocess GenotypeGVF {\n    tag \"Running GenotypeGVF on region_no $region_no\"\n\n    input:\n    set region_no, file(\"ws-reg-${region_no}\") from genomicsdb_ch\n    file(genome)\n    file(genome_index)\n    file(genome_dict)\n\n    output:\n    set region_no, file(\"reg-${region_no}.vcf.gz\"), file(\"reg-${region_no}.vcf.gz.tbi\") into region_gtvcf_ch\n\n    script:\n    \"\"\"\n    gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \" \\\n        GenotypeGVCFs -R ${genome} -V gendb://ws-reg-${region_no} -G StandardAnnotation -O reg-${region_no}.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \" \\\n        GenotypeGVCFs -R ${genome} -V gendb://ws-reg-${region_no} -G StandardAnnotation -O reg-${region_no}.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genomicsdb_ch",
            "genome",
            "genome_index",
            "genome_dict"
        ],
        "nb_inputs": 4,
        "outputs": [
            "region_gtvcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running GenotypeGVF on region_no $region_no\""
        ],
        "when": "",
        "stub": ""
    },
    "gtvcf_merge": {
        "name_process": "gtvcf_merge",
        "string_process": "\nprocess gtvcf_merge {\n    tag \"Running gtvcf_merge\"\n    publishDir \"${params.publishdir}\", mode: 'copy'\n\n    input:\n                                                                                    \n    file '*' from region_gtvcf_ch.collect()\n\n    output:\n    set sample_key, file(\"${sample_key}.raw.vcf.gz\"), file(\"${sample_key}.raw.vcf.gz.tbi\") into gtvcf_merge_ch1\n\n    script:\n    \"\"\"\n    bcftools concat -a -o ${sample_key}.tmp.raw.vcf.gz -O z --threads ${task.cpus} reg*.vcf.gz;\n    bcftools index -t ${sample_key}.tmp.raw.vcf.gz;\n    picard -Dsamjdk.compression_level=2 -Xms4000m -Xmx${task.memory.toGiga()}G \\\n        -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \\\n        SortVcf \\\n        TMP_DIR=\\$(dirname ${sample_key})/tmp \\\n        I=${sample_key}.tmp.raw.vcf.gz \\\n        O=${sample_key}.raw.vcf.gz;\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    bcftools concat -a -o ${sample_key}.tmp.raw.vcf.gz -O z --threads ${task.cpus} reg*.vcf.gz;\n    bcftools index -t ${sample_key}.tmp.raw.vcf.gz;\n    picard -Dsamjdk.compression_level=2 -Xms4000m -Xmx${task.memory.toGiga()}G \\\n        -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \\\n        SortVcf \\\n        TMP_DIR=\\$(dirname ${sample_key})/tmp \\\n        I=${sample_key}.tmp.raw.vcf.gz \\\n        O=${sample_key}.raw.vcf.gz;\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "region_gtvcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "gtvcf_merge_ch1"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running gtvcf_merge\"",
            "publishDir \"${params.publishdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "HardFilterAndMakeSitesOnlyVcf": {
        "name_process": "HardFilterAndMakeSitesOnlyVcf",
        "string_process": "\nprocess HardFilterAndMakeSitesOnlyVcf {\n    tag \"Running HardFilterAndMakeSitesOnlyVcf\"\n    input:\n        set sample_key, file(\"${sample_key}.raw.vcf.gz\"), file(\"${sample_key}.raw.vcf.gz.tbi\") from gtvcf_merge_ch1\n    output:\n                                                                                                                                                                                                        \n        set sample_key, file(\"${sample_key}.variant_filtered.vcf.gz\"), file(\"${sample_key}.variant_filtered.vcf.gz.tbi\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz.tbi\") into sites_only_vcf_ch1, sites_only_vcf_ch2, sites_only_vcf_ch3\n    script:\n    \"\"\"\n    gatk VariantFiltration \\\n        --filter-expression \"ExcessHet > 54.69\" \\\n        --filter-name ExcessHet \\\n        -O ${sample_key}.variant_filtered.vcf.gz \\\n        -V ${sample_key}.raw.vcf.gz;\n\n    gatk  MakeSitesOnlyVcf \\\n        --INPUT ${sample_key}.variant_filtered.vcf.gz \\\n        --OUTPUT ${sample_key}.sites_only_vcf_filename.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    gatk VariantFiltration \\\n        --filter-expression \"ExcessHet > 54.69\" \\\n        --filter-name ExcessHet \\\n        -O ${sample_key}.variant_filtered.vcf.gz \\\n        -V ${sample_key}.raw.vcf.gz;\n\n    gatk  MakeSitesOnlyVcf \\\n        --INPUT ${sample_key}.variant_filtered.vcf.gz \\\n        --OUTPUT ${sample_key}.sites_only_vcf_filename.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gtvcf_merge_ch1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sites_only_vcf_ch1",
            "sites_only_vcf_ch2",
            "sites_only_vcf_ch3"
        ],
        "nb_outputs": 3,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running HardFilterAndMakeSitesOnlyVcf\""
        ],
        "when": "",
        "stub": ""
    },
    "VariantRecalibrator_SNPs": {
        "name_process": "VariantRecalibrator_SNPs",
        "string_process": "\nprocess VariantRecalibrator_SNPs {\n    tag \"sample $sample_key\"\n    input:\n                                                                                                                                                                \n        set sample_key, file(\"${sample_key}.variant_filtered.vcf.gz\"), file(\"${sample_key}.variant_filtered.vcf.gz.tbi\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz.tbi\") from sites_only_vcf_ch1\n        file(genome)\n        file(genome_index)\n        file(genome_dict)\n        file(hapmap)\n        file(hapmap_idx)\n        file(omni)\n        file(omni_idx)\n        file(phase1_snps)\n        file(phase1_snps_idx)\n        file(dbsnp)\n        file(dbsnp_index)\n    output:\n        set sample_key, file(\"${sample_key}.recalibrate_SNP.recal\"), file(\"${sample_key}.recalibrate_SNP.recal.idx\"), file(\"${sample_key}.recalibrate_SNP.tranches\") into variantrecalibrator_SNP_ch\n    script:\n    \"\"\"\n    gatk VariantRecalibrator \\\n        -V ${sample_key}.sites_only_vcf_filename.vcf.gz \\\n        -R $genome \\\n        --trust-all-polymorphic \\\n        -resource hapmap,known=false,training=true,truth=true,prior=15.0:./$hapmap \\\n        -resource omni,known=false,training=true,truth=true,prior=12.0:./$omni \\\n        -resource 1000G,known=false,training=true,truth=false,prior=10.0:./$phase1_snps \\\n        -resource dbsnp,known=true,training=false,truth=false,prior=7.0:./$dbsnp \\\n        -an DP \\\n        -an QD \\\n        -an FS \\\n        -an SOR \\\n        -an MQ \\\n        -an MQRankSum \\\n        -an ReadPosRankSum \\\n        -mode SNP \\\n        -an InbreedingCoeff \\\n        --minimum-bad-variants 1000 \\\n        -tranche 100.0 -tranche 99.9 -tranche 99.0 -tranche 90.0 \\\n        --max-gaussians 4 \\\n        --output-model ${sample_key}..snps.model.report \\\n        -O ${sample_key}.recalibrate_SNP.recal \\\n        --tranches-file ${sample_key}.recalibrate_SNP.tranches \n    \"\"\"   \n}",
        "nb_lignes_process": 44,
        "string_script": "    \"\"\"\n    gatk VariantRecalibrator \\\n        -V ${sample_key}.sites_only_vcf_filename.vcf.gz \\\n        -R $genome \\\n        --trust-all-polymorphic \\\n        -resource hapmap,known=false,training=true,truth=true,prior=15.0:./$hapmap \\\n        -resource omni,known=false,training=true,truth=true,prior=12.0:./$omni \\\n        -resource 1000G,known=false,training=true,truth=false,prior=10.0:./$phase1_snps \\\n        -resource dbsnp,known=true,training=false,truth=false,prior=7.0:./$dbsnp \\\n        -an DP \\\n        -an QD \\\n        -an FS \\\n        -an SOR \\\n        -an MQ \\\n        -an MQRankSum \\\n        -an ReadPosRankSum \\\n        -mode SNP \\\n        -an InbreedingCoeff \\\n        --minimum-bad-variants 1000 \\\n        -tranche 100.0 -tranche 99.9 -tranche 99.0 -tranche 90.0 \\\n        --max-gaussians 4 \\\n        --output-model ${sample_key}..snps.model.report \\\n        -O ${sample_key}.recalibrate_SNP.recal \\\n        --tranches-file ${sample_key}.recalibrate_SNP.tranches \n    \"\"\"",
        "nb_lignes_script": 24,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "sites_only_vcf_ch1",
            "genome",
            "genome_index",
            "genome_dict",
            "hapmap",
            "hapmap_idx",
            "omni",
            "omni_idx",
            "phase1_snps",
            "phase1_snps_idx",
            "dbsnp",
            "dbsnp_index"
        ],
        "nb_inputs": 12,
        "outputs": [
            "variantrecalibrator_SNP_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "VariantRecalibrator_INDELs": {
        "name_process": "VariantRecalibrator_INDELs",
        "string_process": "\nprocess VariantRecalibrator_INDELs {\n    tag \"sample $sample_key\"\n    input:\n                                                                                                                                                                \n        set sample_key, file(\"${sample_key}.variant_filtered.vcf.gz\"), file(\"${sample_key}.variant_filtered.vcf.gz.tbi\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz.tbi\") from sites_only_vcf_ch2\n        file(genome)\n        file(genome_index)\n        file(genome_dict)\n        file(dbsnp)\n        file(dbsnp_index)\n        file(golden_indel)\n        file(golden_indel_idx)\n    output:\n        set sample_key, file(\"${sample_key}.recalibrate_INDEL.recal\"), file(\"${sample_key}.recalibrate_INDEL.recal.idx\"), file(\"${sample_key}.recalibrate_INDEL.tranches\") into variantrecalibrator_INDEL_ch\n    script:\n    \"\"\"\n    gatk VariantRecalibrator \\\n        -V ${sample_key}.sites_only_vcf_filename.vcf.gz \\\n        -R $genome \\\n        --trust-all-polymorphic \\\n        --resource mills,known=false,training=true,truth=true,prior=12.0:./$golden_indel \\\n        --resource dbsnp,known=true,training=false,truth=false,prior=2.0:./$dbsnp \\\n        -an QD \\\n        -an DP \\\n        -an FS \\\n        -an SOR \\\n        -an MQRankSum \\\n        -an ReadPosRankSum \\\n        -mode INDEL \\\n        -an InbreedingCoeff \\\n        -tranche 100.0 -tranche 99.9 -tranche 99.0 -tranche 90.0 \\\n        --max-gaussians 4 \\\n        -O ${sample_key}.recalibrate_INDEL.recal \\\n        --tranches-file ${sample_key}.recalibrate_INDEL.tranches \\\n    \"\"\"   \n}",
        "nb_lignes_process": 35,
        "string_script": "    \"\"\"\n    gatk VariantRecalibrator \\\n        -V ${sample_key}.sites_only_vcf_filename.vcf.gz \\\n        -R $genome \\\n        --trust-all-polymorphic \\\n        --resource mills,known=false,training=true,truth=true,prior=12.0:./$golden_indel \\\n        --resource dbsnp,known=true,training=false,truth=false,prior=2.0:./$dbsnp \\\n        -an QD \\\n        -an DP \\\n        -an FS \\\n        -an SOR \\\n        -an MQRankSum \\\n        -an ReadPosRankSum \\\n        -mode INDEL \\\n        -an InbreedingCoeff \\\n        -tranche 100.0 -tranche 99.9 -tranche 99.0 -tranche 90.0 \\\n        --max-gaussians 4 \\\n        -O ${sample_key}.recalibrate_INDEL.recal \\\n        --tranches-file ${sample_key}.recalibrate_INDEL.tranches \\\n    \"\"\"",
        "nb_lignes_script": 19,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "sites_only_vcf_ch2",
            "genome",
            "genome_index",
            "genome_dict",
            "dbsnp",
            "dbsnp_index",
            "golden_indel",
            "golden_indel_idx"
        ],
        "nb_inputs": 8,
        "outputs": [
            "variantrecalibrator_INDEL_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "ApplyVQSR": {
        "name_process": "ApplyVQSR",
        "string_process": "\nprocess ApplyVQSR {\n    tag \"sample $sample_key\"\n    publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'\n    input:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \n       set sample_key, file(\"${sample_key}.variant_filtered.vcf.gz\"), file(\"${sample_key}.variant_filtered.vcf.gz.tbi\"), \\\n            file(\"${sample_key}.sites_only_vcf_filename.vcf.gz\"), file(\"${sample_key}.sites_only_vcf_filename.vcf.gz.tbi\"), \\\n            file(\"${sample_key}.recalibrate_INDEL.recal\"),  file(\"${sample_key}.recalibrate_INDEL.recal.idx\"), \\\n            file(\"${sample_key}.recalibrate_INDEL.tranches\"), file(\"${sample_key}.recalibrate_SNP.recal\"), \\\n            file(\"${sample_key}.recalibrate_SNP.recal.idx\"), file(\"${sample_key}.recalibrate_SNP.tranches\") \\\n            from sites_only_vcf_ch3.join(variantrecalibrator_INDEL_ch).join(variantrecalibrator_SNP_ch)\n\n                                                                                                                                                                                                              \n                                                                                                                                                                                                      \n    output:\n         set sample_key, file(\"${sample_key}.recalibrated.vcf.gz\"), file(\"${sample_key}.recalibrated.vcf.gz.tbi\") into results_ch\n    script:\n    \"\"\"\n    gatk ApplyVQSR \\\n      -O ${sample_key}.tmp.indel.recalibrated.vcf.gz \\\n      -V ${sample_key}.variant_filtered.vcf.gz \\\n      --recal-file ${sample_key}.recalibrate_INDEL.recal \\\n      --tranches-file ${sample_key}.recalibrate_INDEL.tranches \\\n      --truth-sensitivity-filter-level 99.7 \\\n      --create-output-variant-index true \\\n      -mode INDEL;\n\n    gatk  ApplyVQSR \\\n      -O ${sample_key}.recalibrated.vcf.gz \\\n      -V ${sample_key}.tmp.indel.recalibrated.vcf.gz \\\n      --recal-file ${sample_key}.recalibrate_SNP.recal \\\n      --tranches-file ${sample_key}.recalibrate_SNP.tranches \\\n      --truth-sensitivity-filter-level 99.7 \\\n      --create-output-variant-index true \\\n      -mode SNP\n    \"\"\"\n}",
        "nb_lignes_process": 37,
        "string_script": "    \"\"\"\n    gatk ApplyVQSR \\\n      -O ${sample_key}.tmp.indel.recalibrated.vcf.gz \\\n      -V ${sample_key}.variant_filtered.vcf.gz \\\n      --recal-file ${sample_key}.recalibrate_INDEL.recal \\\n      --tranches-file ${sample_key}.recalibrate_INDEL.tranches \\\n      --truth-sensitivity-filter-level 99.7 \\\n      --create-output-variant-index true \\\n      -mode INDEL;\n\n    gatk  ApplyVQSR \\\n      -O ${sample_key}.recalibrated.vcf.gz \\\n      -V ${sample_key}.tmp.indel.recalibrated.vcf.gz \\\n      --recal-file ${sample_key}.recalibrate_SNP.recal \\\n      --tranches-file ${sample_key}.recalibrate_SNP.tranches \\\n      --truth-sensitivity-filter-level 99.7 \\\n      --create-output-variant-index true \\\n      -mode SNP\n    \"\"\"",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "sample_key",
            "sites_only_vcf_ch3",
            "variantrecalibrator_INDEL_ch",
            "variantrecalibrator_SNP_ch"
        ],
        "nb_inputs": 4,
        "outputs": [
            "results_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"sample $sample_key\"",
            "publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "trimadap_map": {
        "name_process": "trimadap_map",
        "string_process": "\nprocess trimadap_map {\n    tag { \"Aligning readdunit $ru_key of sample $sample_key\" }\n    input:\n        set sample_key, ru_key, file(fq1), file(fq2) from readunits_ch\n        file(ref)\n        file(ref_amb)\n        file(ref_ann)\n        file(ref_bwt)\n        file(ref_pac)\n        file(ref_sa)\n    output:\n                                                                                \n        set sample_key, file(\"${ru_key}.bam\"), file(\"${ru_key}.bam.bai\") into ru_bam_ch\n    script:\n                                                    \n        st_threads = (int) Math.ceil(task.cpus/2)\n        sort_mem='250M'\n        readgroup = \"@RG\\\\tID:$ru_key\\\\tPU:$ru_key\\\\tSM:$sample_key\\\\tLB:$sample_key\\\\tPL:ILLUMINA\"\n        \"\"\"\n        seqtk mergepe ${fq1} ${fq2} | \\\n         trimadap-mt -p ${task.cpus} - | \\\n            bwa mem -R \\\"${readgroup}\\\" -t ${task.cpus} -p ${ref} - | \\\n            samtools fixmate -@ ${task.cpus} - - | \\\n            samtools sort -@ ${st_threads} -m ${sort_mem} -T ${ru_key}.tmp -o ${ru_key}.bam;\n        samtools index -@ ${task.cpus} ${ru_key}.bam\n        \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "        st_threads = (int) Math.ceil(task.cpus/2)\n        sort_mem='250M'\n        readgroup = \"@RG\\\\tID:$ru_key\\\\tPU:$ru_key\\\\tSM:$sample_key\\\\tLB:$sample_key\\\\tPL:ILLUMINA\"\n        \"\"\"\n        seqtk mergepe ${fq1} ${fq2} | \\\n         trimadap-mt -p ${task.cpus} - | \\\n            bwa mem -R \\\"${readgroup}\\\" -t ${task.cpus} -p ${ref} - | \\\n            samtools fixmate -@ ${task.cpus} - - | \\\n            samtools sort -@ ${st_threads} -m ${sort_mem} -T ${ru_key}.tmp -o ${ru_key}.bam;\n        samtools index -@ ${task.cpus} ${ru_key}.bam\n        \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "seqtk",
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/seqtk",
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "seqtk",
                "uri": "https://bio.tools/seqtk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool for processing sequences in the FASTA or FASTQ format. It parses both FASTA and FASTQ files which can also be optionally compressed by gzip.",
                "homepage": "https://github.com/lh3/seqtk"
            },
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "readunits_ch",
            "ref",
            "ref_amb",
            "ref_ann",
            "ref_bwt",
            "ref_pac",
            "ref_sa"
        ],
        "nb_inputs": 7,
        "outputs": [
            "ru_bam_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag { \"Aligning readdunit $ru_key of sample $sample_key\" }"
        ],
        "when": "",
        "stub": ""
    },
    "merge_bams": {
        "name_process": "merge_bams",
        "string_process": "\nprocess merge_bams {\n    tag \"Merging readunit BAMs for sample $sample_key\"\n    input:\n        set sample_key, file(bam), file(bai) from ru_bam_ch.groupTuple()\n    output:\n        set sample_key, file(\"${sample_key}.merged.bam\") into merged_bam_ch\n    script:\n        \"\"\"\n        samtools merge -@ ${task.cpus} ${sample_key}.merged.bam ${bam.join(' ')}\n        \"\"\"\n}",
        "nb_lignes_process": 10,
        "string_script": "        \"\"\"\n        samtools merge -@ ${task.cpus} ${sample_key}.merged.bam ${bam.join(' ')}\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ru_bam_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "merged_bam_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Merging readunit BAMs for sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "mark_duplicates": {
        "name_process": "mark_duplicates",
        "string_process": "\nprocess mark_duplicates {\n    tag \"Marking duplicates for sample $sample_key\"\n    input:\n        set sample_key, file(\"${sample_key}.merged.bam\") from merged_bam_ch\n    output:\n        set sample_key, file(\"${sample_key}.dedup.bam\"),file(\"${sample_key}.dedup.bam.bai\") \\\n            into dedup_bam1_ch, dedup_bam2_ch\n    script:\n                                                                                     \n                                                                                   \n                                                                                                                                               \n                                                       \n        \"\"\"\n        #java -Dsamjdk.compression_level=2 -Xms4000m -jar \\${PICARD_JAR}\n        picard -Dsamjdk.compression_level=2 -Xms4000m -Xmx${task.memory.toGiga()}G \\\n            -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \\\n            MarkDuplicates \\\n            INPUT=${sample_key}.merged.bam \\\n            OUTPUT=${sample_key}.dedup.bam \\\n            METRICS_FILE=${sample_key}.metrics.txt \\\n            VALIDATION_STRINGENCY=SILENT \\\n            OPTICAL_DUPLICATE_PIXEL_DISTANCE=2500 \\\n            ASSUME_SORTED=\"true\" \\\n            CLEAR_DT=\"false\" \\\n            ADD_PG_TAG_TO_READS=false \\\n            TMP_DIR=\\$(dirname ${sample_key})/tmp;\n        samtools index ${sample_key}.dedup.bam\n        \"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "        \"\"\"\n        #java -Dsamjdk.compression_level=2 -Xms4000m -jar \\${PICARD_JAR}\n        picard -Dsamjdk.compression_level=2 -Xms4000m -Xmx${task.memory.toGiga()}G \\\n            -XX:ConcGCThreads=${task.cpus} -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} \\\n            MarkDuplicates \\\n            INPUT=${sample_key}.merged.bam \\\n            OUTPUT=${sample_key}.dedup.bam \\\n            METRICS_FILE=${sample_key}.metrics.txt \\\n            VALIDATION_STRINGENCY=SILENT \\\n            OPTICAL_DUPLICATE_PIXEL_DISTANCE=2500 \\\n            ASSUME_SORTED=\"true\" \\\n            CLEAR_DT=\"false\" \\\n            ADD_PG_TAG_TO_READS=false \\\n            TMP_DIR=\\$(dirname ${sample_key})/tmp;\n        samtools index ${sample_key}.dedup.bam\n        \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "Picard",
            "MarkDuplicates (IP)",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools",
            "https://bio.tools/markduplicates_ip",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            },
            {
                "name": "MarkDuplicates (IP)",
                "uri": "https://bio.tools/markduplicates_ip",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0253",
                                    "term": "Sequence feature detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0253",
                                    "term": "Sequence feature recognition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0253",
                                    "term": "Sequence feature prediction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Marks all duplicate reads in a provided SAM or BAM file and either removes them or flags them.",
                "homepage": "https://galaxy.pasteur.fr/tool_runner?tool_id=toolshed.pasteur.fr/repos/fmareuil/picard_pasteur_wrapper/rgPicardMarkDups/1.56.0"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "merged_bam_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "dedup_bam1_ch",
            "dedup_bam2_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Marking duplicates for sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "gatk_recalibrate_info": {
        "name_process": "gatk_recalibrate_info",
        "string_process": "\nprocess gatk_recalibrate_info {\n    tag \"Running BaseRecalibrator for sample $sample_key\"\n    input:\n        set sample_key, file(\"${sample_key}.dedup.bam\"), file(\"${sample_key}.dedup.bam.bai\") from dedup_bam1_ch\n        file(ref)\n        file(ref_fai)\n        file(ref_dict)\n        file(dbsnp)\n        file(dbsnp_index)\n        file(mills)\n        file(mills_index)\n    output:\n        set sample_key, file(\"${sample_key}.bqsr.grp\") into bqsr_ch\n                                                                \n    script:\n        \"\"\"\n        gatk --java-options \"-Xmx${task.memory.toGiga()}G -Xms4000m -XX:ConcGCThreads=${task.cpus} \\\n            -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus}\" \\\n            BaseRecalibrator -R ${ref} -I ${sample_key}.dedup.bam \\\n            --known-sites ${dbsnp} --known-sites ${mills} -O ${sample_key}.bqsr.grp\n        \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "        \"\"\"\n        gatk --java-options \"-Xmx${task.memory.toGiga()}G -Xms4000m -XX:ConcGCThreads=${task.cpus} \\\n            -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus}\" \\\n            BaseRecalibrator -R ${ref} -I ${sample_key}.dedup.bam \\\n            --known-sites ${dbsnp} --known-sites ${mills} -O ${sample_key}.bqsr.grp\n        \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "dedup_bam1_ch",
            "ref",
            "ref_fai",
            "ref_dict",
            "dbsnp",
            "dbsnp_index",
            "mills",
            "mills_index"
        ],
        "nb_inputs": 8,
        "outputs": [
            "bqsr_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running BaseRecalibrator for sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "gatk_recalibrate_bam": {
        "name_process": "gatk_recalibrate_bam",
        "string_process": "\nprocess gatk_recalibrate_bam {\n    tag \"Running ApplyBQSR for sample $sample_key\"\n    input:\n        set sample_key, file(\"${sample_key}.dedup.bam\"), file(\"${sample_key}.dedup.bam.bai\"), file(\"${sample_key}.bqsr.grp\")\\\n            from dedup_bam2_ch.join(bqsr_ch)\n        file(ref)\n        file(ref_fai)\n        file(ref_dict)\n    output:\n        set sample_key, file(\"${sample_key}.bqsr.bam\"), file(\"${sample_key}.bqsr.bam.bai\") into \\\n            bqsr_bam_ch1, bqsr_bam_ch2, bqsr_bam_ch3, bqsr_bam_ch4, bqsr_bam_ch5\n        file(\"${sample_key}.bqsr.bam\") into bqsr_bam_only_ch\n        file(\"${sample_key}.bqsr.bam.bai\") into  bqsr_bai_only_ch\n    script:\n        \"\"\"\n        # keeping original qualities, so that we can always go back\n        gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus} \\\n            -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} -Dsamjdk.compression_level=2\" \\\n            ApplyBQSR -R ${ref} -I ${sample_key}.dedup.bam --emit-original-quals \\\n            -bqsr ${sample_key}.bqsr.grp -O ${sample_key}.bqsr.bam;\n        samtools index -@ ${task.cpus} ${sample_key}.bqsr.bam\n        \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "        \"\"\"\n        # keeping original qualities, so that we can always go back\n        gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus} \\\n            -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus} -Dsamjdk.compression_level=2\" \\\n            ApplyBQSR -R ${ref} -I ${sample_key}.dedup.bam --emit-original-quals \\\n            -bqsr ${sample_key}.bqsr.grp -O ${sample_key}.bqsr.bam;\n        samtools index -@ ${task.cpus} ${sample_key}.bqsr.bam\n        \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "dedup_bam2_ch",
            "bqsr_ch",
            "ref",
            "ref_fai",
            "ref_dict"
        ],
        "nb_inputs": 5,
        "outputs": [
            "bqsr_bam_ch1",
            "bqsr_bam_ch2",
            "bqsr_bam_ch3",
            "bqsr_bam_ch4",
            "bqsr_bam_ch5",
            "bqsr_bam_only_ch",
            "bqsr_bai_only_ch"
        ],
        "nb_outputs": 7,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running ApplyBQSR for sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "indexcov": {
        "name_process": "indexcov",
        "string_process": "\nprocess indexcov {\n    tag \"Running indexcov for all samples\"\n    publishDir \"${params.publishdir}\", mode: 'copy'\n    input:\n        file bams from bqsr_bam_only_ch.collect()\n        file bais from bqsr_bai_only_ch.collect()\n    output:\n        file(\"indexcov/all*\") into indexcov_ch\n    script:\n        \"\"\"\n        goleft indexcov --sex chrX,chrY -d indexcov/all ${bams}\n        \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "        \"\"\"\n        goleft indexcov --sex chrX,chrY -d indexcov/all ${bams}\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bqsr_bam_only_ch",
            "bqsr_bai_only_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "indexcov_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running indexcov for all samples\"",
            "publishDir \"${params.publishdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "sample_qc": {
        "name_process": "sample_qc",
        "string_process": "\nprocess sample_qc {\n    tag \"Running Stats/QC for sample $sample_key\"\n    publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'\n    input:\n        set sample_key, file(\"${sample_key}.bqsr.bam\"), file(\"${sample_key}.bqsr.bam.bai\") from bqsr_bam_ch1\n    output:\n        set sample_key, file(\"${sample_key}.cov-062017.txt\"), file(\"stats/*\") into sample_qc_ch\n    script:\n        \"\"\"\n        sg10k-cov-062017.sh ${sample_key}.bqsr.bam > ${sample_key}.cov-062017.txt;\n        mkdir stats;\n        samtools stats ${sample_key}.bqsr.bam > stats/${sample_key}.stats;\n        plot-bamstats -p stats/${sample_key} stats/${sample_key}.stats\n        \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "        \"\"\"\n        sg10k-cov-062017.sh ${sample_key}.bqsr.bam > ${sample_key}.cov-062017.txt;\n        mkdir stats;\n        samtools stats ${sample_key}.bqsr.bam > stats/${sample_key}.stats;\n        plot-bamstats -p stats/${sample_key} stats/${sample_key}.stats\n        \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bqsr_bam_ch1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sample_qc_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running Stats/QC for sample $sample_key\"",
            "publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "verifybamid": {
        "name_process": "verifybamid",
        "string_process": "\nprocess verifybamid {\n    tag \"Running contamination checks for sample $sample_key on $cont_key\"\n    publishDir \"${params.publishdir}/${sample_key}/verifybamid/\", mode: 'copy'\n    input:\n        set sample_key, file(\"${sample_key}.bqsr.bam\"), file(\"${sample_key}.bqsr.bam.bai\"), cont_key, file(cont_vcf) from bqsr_bam_ch2.combine(cont_vcfs)\n                              \n    output:\n        set sample_key, file(\"*\") into verifybamid_ch\n    script:\n        out_base = cont_vcf.toString().replace(\".sites.vcf.GRCh38.liftover.gz\", \" \")\n    \"\"\"\n    verifyBamID --vcf ${cont_vcf} --bam ${sample_key}.bqsr.bam --out ${sample_key}.${out_base} \\\n        --noPhoneHome --precise --maxDepth 100 --minMapQ 20 \\\n        --minQ 20 --maxQ 100\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "        out_base = cont_vcf.toString().replace(\".sites.vcf.GRCh38.liftover.gz\", \" \")\n    \"\"\"\n    verifyBamID --vcf ${cont_vcf} --bam ${sample_key}.bqsr.bam --out ${sample_key}.${out_base} \\\n        --noPhoneHome --precise --maxDepth 100 --minMapQ 20 \\\n        --minQ 20 --maxQ 100\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "verifyBamID"
        ],
        "tools_url": [
            "https://bio.tools/verifybamid"
        ],
        "tools_dico": [
            {
                "name": "verifyBamID",
                "uri": "https://bio.tools/verifybamid",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_1383",
                                "term": "Nucleic acid sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Software that verifies whether the reads in particular file match previously known genotypes for an individual (or group of individuals), and checks whether the reads are contaminated as a mixture of two samples. It can detect sample contamination and swaps when external genotypes are available. When external genotypes are not available, it still robustly detects sample swaps.",
                "homepage": "http://genome.sph.umich.edu/wiki/VerifyBamID"
            }
        ],
        "inputs": [
            "bqsr_bam_ch2",
            "cont_vcfs"
        ],
        "nb_inputs": 2,
        "outputs": [
            "verifybamid_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running contamination checks for sample $sample_key on $cont_key\"",
            "publishDir \"${params.publishdir}/${sample_key}/verifybamid/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "bam2cram": {
        "name_process": "bam2cram",
        "string_process": "\nprocess bam2cram {\n    tag \"Converting BAM to CRAM for sample $sample_key\"\n    publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'\n    input:\n        set sample_key, file(\"${sample_key}.bqsr.bam\"), file(\"${sample_key}.bqsr.bam.bai\") from bqsr_bam_ch4\n        file(ref)\n    output:\n        set sample_key, file(\"${sample_key}.bqsr.cram\"), file(\"${sample_key}.bqsr.cram.crai\")\n    script:\n        \"\"\"\n        samtools view -@ ${task.cpus} -C ${sample_key}.bqsr.bam -o ${sample_key}.bqsr.cram -O CRAM -T ${ref};\n        # reheader to fix reference to fasta in workdir\n        samtools view -H ${sample_key}.bqsr.cram| sed -e \"s,UR:[^[:space:]]*,UR:${params.references.genome},\" > ${sample_key}.bqsr.header\n        samtools reheader -i ${sample_key}.bqsr.header ${sample_key}.bqsr.cram;\n        samtools index ${sample_key}.bqsr.cram\n        \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "        \"\"\"\n        samtools view -@ ${task.cpus} -C ${sample_key}.bqsr.bam -o ${sample_key}.bqsr.cram -O CRAM -T ${ref};\n        # reheader to fix reference to fasta in workdir\n        samtools view -H ${sample_key}.bqsr.cram| sed -e \"s,UR:[^[:space:]]*,UR:${params.references.genome},\" > ${sample_key}.bqsr.header\n        samtools reheader -i ${sample_key}.bqsr.header ${sample_key}.bqsr.cram;\n        samtools index ${sample_key}.bqsr.cram\n        \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bqsr_bam_ch4",
            "ref"
        ],
        "nb_inputs": 2,
        "outputs": [
            "sample_key"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Converting BAM to CRAM for sample $sample_key\"",
            "publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "freebayes": {
        "name_process": "freebayes",
        "string_process": "\nprocess freebayes {\n    tag \"Calling variants with Freebayes for sample $sample_key\"\n    publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'\n    input:\n        set sample_key, file(\"${sample_key}.bqsr.bam\"), file(\"${sample_key}.bqsr.bam.bai\") from bqsr_bam_ch5\n        file(ref)\n        file(ref_fai)\n        file(calling_interval_list)\n    output:\n        set sample_key, file(\"${sample_key}.fb.vcf.gz\"), file(\"${sample_key}.fb.vcf.gz.tbi\")\n    when:\n        ! params.gvcf_only\n    script:\n        \"\"\"\n        awk '/^[^@]/ {printf \"%s:%d-%d\\\\n\", \\$1, \\$2, \\$3}' ${calling_interval_list} > calling.regions;\n        export TMPDIR=\\$PWD;\n        freebayes-parallel calling.regions ${task.cpus} -f ${ref} ${sample_key}.bqsr.bam | bgzip > ${sample_key}.fb-raw.vcf.gz;\n\n        # freebayes-parallel can fail silently with a non-truncated file if TMPDIR is full, so check\n\t# however don't report if this is due to low coverage\n\ttabix ${sample_key}.fb-raw.vcf.gz\n        nchrom=\\$(tabix -l ${sample_key}.fb-raw.vcf.gz | wc -l);\n        nreads=\\$(samtools idxstats ${sample_key}.bqsr.bam | awk '{s+=\\$3} END {print s}');\n        if [ \\$nchrom -lt 22 ] && [ \\$nreads -gt 10000000 ]; then echo \"ERROR: fewer than expected chroms\" 1>&2; exit 1; fi\n\n        bcftools view -e 'Q<20' -O z -o ${sample_key}.fb.vcf.gz ${sample_key}.fb-raw.vcf.gz;\n        bcftools index --threads ${task.cpus} -t ${sample_key}.fb.vcf.gz\n        \"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "        \"\"\"\n        awk '/^[^@]/ {printf \"%s:%d-%d\\\\n\", \\$1, \\$2, \\$3}' ${calling_interval_list} > calling.regions;\n        export TMPDIR=\\$PWD;\n        freebayes-parallel calling.regions ${task.cpus} -f ${ref} ${sample_key}.bqsr.bam | bgzip > ${sample_key}.fb-raw.vcf.gz;\n\n        # freebayes-parallel can fail silently with a non-truncated file if TMPDIR is full, so check\n\t# however don't report if this is due to low coverage\n\ttabix ${sample_key}.fb-raw.vcf.gz\n        nchrom=\\$(tabix -l ${sample_key}.fb-raw.vcf.gz | wc -l);\n        nreads=\\$(samtools idxstats ${sample_key}.bqsr.bam | awk '{s+=\\$3} END {print s}');\n        if [ \\$nchrom -lt 22 ] && [ \\$nreads -gt 10000000 ]; then echo \"ERROR: fewer than expected chroms\" 1>&2; exit 1; fi\n\n        bcftools view -e 'Q<20' -O z -o ${sample_key}.fb.vcf.gz ${sample_key}.fb-raw.vcf.gz;\n        bcftools index --threads ${task.cpus} -t ${sample_key}.fb.vcf.gz\n        \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bqsr_bam_ch5",
            "ref",
            "ref_fai",
            "calling_interval_list"
        ],
        "nb_inputs": 4,
        "outputs": [
            "sample_key"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Calling variants with Freebayes for sample $sample_key\"",
            "publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'"
        ],
        "when": "! params.gvcf_only",
        "stub": ""
    },
    "gatk_hc": {
        "name_process": "gatk_hc",
        "string_process": "\nprocess gatk_hc {\n    tag \"Running HaplotypeCaller on region $region_name for sample $sample_key\"\n                                                                                                        \n                                                                                                                                                     \n    input:\n        set sample_key, file(\"${sample_key}.bqsr.bam\"), file(\"${sample_key}.bqsr.bam.bai\"), region_name, region_list from bqsr_bam_ch3.combine(region_list_ch)\n                                                                                                 \n                                               \n        file(ref)\n        file(ref_fai)\n        file(ref_dict)\n        file(dbsnp)\n        file(dbsnp_index)\n    output:\n        set sample_key, file(\"${region_name}.g.vcf.gz\"), file(\"${region_name}.g.vcf.gz.tbi\") into region_gvcf_ch1\n    script:\n\t                               \n                                       \n        \"\"\"\n        echo \"${region_list}\" > ${region_name}.bed;\n        gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus}  \\\n            -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus}\" HaplotypeCaller \\\n            -contamination 0 --max-alternate-alleles 6 -R ${ref} --dbsnp ${dbsnp} \\\n            -I ${sample_key}.bqsr.bam -L ${region_name}.bed --emit-ref-confidence GVCF \\\n            -O ${region_name}.g.vcf.gz\n        \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "        \"\"\"\n        echo \"${region_list}\" > ${region_name}.bed;\n        gatk --java-options \"-Xmx${task.memory.toGiga()}G -XX:ConcGCThreads=${task.cpus}  \\\n            -XX:+UseConcMarkSweepGC -XX:ParallelGCThreads=${task.cpus}\" HaplotypeCaller \\\n            -contamination 0 --max-alternate-alleles 6 -R ${ref} --dbsnp ${dbsnp} \\\n            -I ${sample_key}.bqsr.bam -L ${region_name}.bed --emit-ref-confidence GVCF \\\n            -O ${region_name}.g.vcf.gz\n        \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "bqsr_bam_ch3",
            "region_list_ch",
            "ref",
            "ref_fai",
            "ref_dict",
            "dbsnp",
            "dbsnp_index"
        ],
        "nb_inputs": 7,
        "outputs": [
            "region_gvcf_ch1"
        ],
        "nb_outputs": 1,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Running HaplotypeCaller on region $region_name for sample $sample_key\""
        ],
        "when": "",
        "stub": ""
    },
    "gvcf_merge": {
        "name_process": "gvcf_merge",
        "string_process": "\nprocess gvcf_merge {\n    tag \"Merging gVCFs for sample $sample_key\"\n    publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'\n    input:\n        set sample_key, file(reggvcfs), file(reggvcfs_index) from region_gvcf_ch1.groupTuple()\n    output:\n        file(\"${sample_key}.g.vcf.gz\")\n        file(\"${sample_key}.g.vcf.gz.tbi\")\n    script:\n       \"\"\"\n       bcftools concat -o ${sample_key}.g.vcf.gz -O z --threads ${task.cpus} \\$(ls ${reggvcfs.join(' ')} | sort -k 2 -t r -n);\n       bcftools index --threads ${task.cpus} -t ${sample_key}.g.vcf.gz\n       nchrom=\\$(tabix -l ${sample_key}.g.vcf.gz | wc -l);\n       if [ \\$nchrom -lt 22 ]; then echo \"ERROR: fewer than expected chroms\" 1>&2; exit 1; fi\n       \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "       \"\"\"\n       bcftools concat -o ${sample_key}.g.vcf.gz -O z --threads ${task.cpus} \\$(ls ${reggvcfs.join(' ')} | sort -k 2 -t r -n);\n       bcftools index --threads ${task.cpus} -t ${sample_key}.g.vcf.gz\n       nchrom=\\$(tabix -l ${sample_key}.g.vcf.gz | wc -l);\n       if [ \\$nchrom -lt 22 ]; then echo \"ERROR: fewer than expected chroms\" 1>&2; exit 1; fi\n       \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "region_gvcf_ch1"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "gis-rpd__rpd-sg10k-grch38-gatk4-gvcf-freebayes-vcf",
        "directive": [
            "tag \"Merging gVCFs for sample $sample_key\"",
            "publishDir \"${params.publishdir}/${sample_key}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}