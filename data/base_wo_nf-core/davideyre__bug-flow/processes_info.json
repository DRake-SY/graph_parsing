{
    "indexReference": {
        "name_process": "indexReference",
        "string_process": "\nprocess indexReference {\n  \n    input:\n        file refFasta\n\t\n\toutput:\n\t\tfile \"*\" into ref_index\n\t\n\ttag {refFasta}\n\tpublishDir \"$outputPath/reference/${refFasta.baseName}\", mode: 'copy'\n\n    \"\"\"\n    #bwa index\n    bwa index $refFasta\n    \n    #samtools index\n    samtools faidx $refFasta\n    \n    #blast indexes for self-self blast\n\tmakeblastdb -dbtype nucl -in $refFasta\n    \n    #reference mask\n    genRefMask.py -r $refFasta -m 200 -p 95\n    bgzip -c ${refFasta}.rpt.regions > ${refFasta.baseName}.rpt_mask.gz\n\techo '##INFO=<ID=RPT,Number=1,Type=Integer,Description=\"Flag for variant in repetitive region\">' > ${refFasta.baseName}.rpt_mask.hdr\n\ttabix -s1 -b2 -e3 ${refFasta.baseName}.rpt_mask.gz\n\t\n\t#gatk reference dictionary\n\tgatk CreateSequenceDictionary -R $refFasta -O ${refFasta.baseName}.dict\n    \"\"\"\n}",
        "nb_lignes_process": 30,
        "string_script": "\"\"\"\n    #bwa index\n    bwa index $refFasta\n    \n    #samtools index\n    samtools faidx $refFasta\n    \n    #blast indexes for self-self blast\n\tmakeblastdb -dbtype nucl -in $refFasta\n    \n    #reference mask\n    genRefMask.py -r $refFasta -m 200 -p 95\n    bgzip -c ${refFasta}.rpt.regions > ${refFasta.baseName}.rpt_mask.gz\n\techo '##INFO=<ID=RPT,Number=1,Type=Integer,Description=\"Flag for variant in repetitive region\">' > ${refFasta.baseName}.rpt_mask.hdr\n\ttabix -s1 -b2 -e3 ${refFasta.baseName}.rpt_mask.gz\n\t\n\t#gatk reference dictionary\n\tgatk CreateSequenceDictionary -R $refFasta -O ${refFasta.baseName}.dict\n    \"\"\"",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools",
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools",
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "refFasta"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ref_index"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "rawFastQC": {
        "name_process": "rawFastQC",
        "string_process": "\nprocess rawFastQC {\n\t\n\tinput:\n        set uuid, file(fq1), file(fq2) from samples_ch1\n\t\n\toutput:\n\t\tfile \"*\"\n\t\n\ttag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/raw_fastqc\", mode: 'copy', pattern: \"${uuid}*\"\n\t\n\t\"\"\"\n\tcat $fq1 $fq2 > ${uuid}_raw.fq.gz\n\tfastqc --threads ${task.cpus} ${uuid}_raw.fq.gz > ${uuid}_raw_fastqc_log.txt\n\trm ${uuid}_raw.fq.gz\n\t\"\"\"\n\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n\tcat $fq1 $fq2 > ${uuid}_raw.fq.gz\n\tfastqc --threads ${task.cpus} ${uuid}_raw.fq.gz > ${uuid}_raw_fastqc_log.txt\n\trm ${uuid}_raw.fq.gz\n\t\"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "samples_ch1"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "bbDuk": {
        "name_process": "bbDuk",
        "string_process": "\nprocess bbDuk {\n\t\n\tinput:\n\t\tset uuid, file(fq1), file(fq2) from samples_ch2\n\t\n\toutput:\n\t\tset uuid, file(\"${uuid}_clean.1.fq.gz\"), file(\"${uuid}_clean.2.fq.gz\") into bbduk_out_ch\n\t\n\ttag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/clean_fastq\", mode: 'copy'\n\t\n\t\"\"\"\n\tbbduk.sh in1=$fq1 in2=$fq2 out1=${uuid}_clean.1.fq out2=${uuid}_clean.2.fq \\\n\t\t\t\tref=$bbduk_adapaters ktrim=r k=23 mink=11 hdist=1 \\\n\t\t\t\ttpe tbo -Xmx${task.memory.toGiga()}g threads=${task.cpus}\n\tgzip ${uuid}_clean.1.fq ${uuid}_clean.2.fq\n\t\"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n\tbbduk.sh in1=$fq1 in2=$fq2 out1=${uuid}_clean.1.fq out2=${uuid}_clean.2.fq \\\n\t\t\t\tref=$bbduk_adapaters ktrim=r k=23 mink=11 hdist=1 \\\n\t\t\t\ttpe tbo -Xmx${task.memory.toGiga()}g threads=${task.cpus}\n\tgzip ${uuid}_clean.1.fq ${uuid}_clean.2.fq\n\t\"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "TPES"
        ],
        "tools_url": [
            "https://bio.tools/TPES"
        ],
        "tools_dico": [
            {
                "name": "TPES",
                "uri": "https://bio.tools/TPES",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Tumor Purity Estimation from SNVs.",
                "homepage": "https://bitbucket.org/l0ka/tpes.git"
            }
        ],
        "inputs": [
            "samples_ch2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bbduk_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "cleanFastQC": {
        "name_process": "cleanFastQC",
        "string_process": "\nprocess cleanFastQC {\n\t\n\tinput:\n    \tset uuid, file(\"${uuid}_clean.1.fq.gz\"), file(\"${uuid}_clean.2.fq.gz\") from bbduk_out_ch1\n\t\n\toutput:\n\t\tfile \"*\"\n\t\n\ttag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/clean_fastqc\", mode: 'copy', pattern: \"${uuid}*\"\n\t\n\t\"\"\"\n\tcat ${uuid}_clean.1.fq.gz ${uuid}_clean.2.fq.gz > ${uuid}_clean.fq.gz\n\tfastqc --threads ${task.cpus} ${uuid}_clean.fq.gz > ${uuid}_clean_fastqc_log.txt\n\trm ${uuid}_clean.fq.gz\n\t\"\"\"\n\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n\tcat ${uuid}_clean.1.fq.gz ${uuid}_clean.2.fq.gz > ${uuid}_clean.fq.gz\n\tfastqc --threads ${task.cpus} ${uuid}_clean.fq.gz > ${uuid}_clean_fastqc_log.txt\n\trm ${uuid}_clean.fq.gz\n\t\"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "bbduk_out_ch1"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "spades": {
        "name_process": "spades",
        "string_process": "\tprocess spades {\n\t\n\tinput:\n\t\tset uuid, file(\"${uuid}_clean.1.fq.gz\"), file(\"${uuid}_clean.2.fq.gz\") from bbduk_out_ch2\n\t\n\toutput:\n\t\tfile \"${uuid}_*\"\n\t\t\n\ttag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/spades\", mode: 'copy', pattern: \"${uuid}_*\"\n\t\n\t\"\"\"\n\tspades.py --careful -o spades -1 ${uuid}_clean.1.fq.gz -2 ${uuid}_clean.2.fq.gz \\\n\t\t-t ${task.cpus} -m ${task.memory.toGiga()}\n\tcp spades/contigs.fasta ${uuid}_spades_contigs.fa\n\tcp spades/assembly_graph.fastg ${uuid}_spades_assembly_graph.fastg\n\tcp spades/assembly_graph_with_scaffolds.gfa ${uuid}_spades_assembly_graph_with_scaffolds.gfa\n\tcp spades/spades.log ${uuid}_spades.log\n\t\"\"\"\n\t}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n\tspades.py --careful -o spades -1 ${uuid}_clean.1.fq.gz -2 ${uuid}_clean.2.fq.gz \\\n\t\t-t ${task.cpus} -m ${task.memory.toGiga()}\n\tcp spades/contigs.fasta ${uuid}_spades_contigs.fa\n\tcp spades/assembly_graph.fastg ${uuid}_spades_assembly_graph.fastg\n\tcp spades/assembly_graph_with_scaffolds.gfa ${uuid}_spades_assembly_graph_with_scaffolds.gfa\n\tcp spades/spades.log ${uuid}_spades.log\n\t\"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bbduk_out_ch2"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "bwa": {
        "name_process": "bwa",
        "string_process": "\nprocess bwa {\n\n    input:\n    \tset uuid, file(\"${uuid}_clean.1.fq.gz\"), file(\"${uuid}_clean.2.fq.gz\") from bbduk_out_ch3\n    \tfile \"*\" from ref_index\n    \tfile refFasta\n\n    output:\n    \tset uuid, file(\"${uuid}.aligned.sam\") into bwa_mapped\n    \n    tag \"${getShortId(uuid)}\"\n\n\t                                                                      \n    \"\"\"\n    bwa mem -t ${task.cpus} \\\n    \t\t$refFasta \\\n    \t\t${uuid}_clean.1.fq.gz \\\n    \t\t${uuid}_clean.2.fq.gz \\\n    > ${uuid}.aligned.sam\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "\"\"\"\n    bwa mem -t ${task.cpus} \\\n    \t\t$refFasta \\\n    \t\t${uuid}_clean.1.fq.gz \\\n    \t\t${uuid}_clean.2.fq.gz \\\n    > ${uuid}.aligned.sam\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "bbduk_out_ch3",
            "ref_index",
            "refFasta"
        ],
        "nb_inputs": 3,
        "outputs": [
            "bwa_mapped"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "removeDuplicates": {
        "name_process": "removeDuplicates",
        "string_process": "\nprocess removeDuplicates {\n\n    input:\n    \tset uuid, file(\"${uuid}.aligned.sam\") from bwa_mapped\n    \tfile \"*\" from ref_index\n\n    output:\n    \tset uuid, file(\"${uuid}.bam\"), file(\"${uuid}.bam.bai\") into dup_removed\n\n    tag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/bam\", mode: 'copy', pattern: \"${uuid}.ba*\"\n\n\t                                                                                    \n\t                                                              \n    \"\"\"\n    samtools sort -@${task.cpus} -n -o sorted.bam ${uuid}.aligned.sam\n    samtools fixmate -m sorted.bam fixed.sorted.bam\n    samtools sort -@${task.cpus} -o fixed.resorted.bam fixed.sorted.bam\n    samtools markdup -r fixed.resorted.bam ${uuid}.bam\n    samtools index ${uuid}.bam\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n    samtools sort -@${task.cpus} -n -o sorted.bam ${uuid}.aligned.sam\n    samtools fixmate -m sorted.bam fixed.sorted.bam\n    samtools sort -@${task.cpus} -o fixed.resorted.bam fixed.sorted.bam\n    samtools markdup -r fixed.resorted.bam ${uuid}.bam\n    samtools index ${uuid}.bam\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bwa_mapped",
            "ref_index"
        ],
        "nb_inputs": 2,
        "outputs": [
            "dup_removed"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "freebayes": {
        "name_process": "freebayes",
        "string_process": "\nprocess freebayes {\n    input:\n    \tset uuid, file(\"${uuid}.bam\"), file(\"${uuid}.bam.bai\") from dup_removed\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"raw_var.vcf\") into raw_vcf\n   \n    tag \"${getShortId(uuid)}\"\n    publishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/freebayes\", mode: 'copy'\n\n\t                                                     \n \t\"\"\"\n   \tfreebayes -p 1 --fasta-reference $refFasta ${uuid}.bam > raw_var.vcf\n    \"\"\"\n\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n   \tfreebayes -p 1 --fasta-reference $refFasta ${uuid}.bam > raw_var.vcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "dup_removed",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "raw_vcf"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "normalise_snps": {
        "name_process": "normalise_snps",
        "string_process": "\nprocess normalise_snps {\n\n    input:\n    \tset uuid, file(\"raw_var.vcf\") from raw_vcf\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"${uuid}.bcf\") into snps_called\n   \n    tag \"${getShortId(uuid)}\"\n    publishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/freebayes\", mode: 'copy'\n\t\n\t\n    \"\"\"\n    vcfallelicprimitives -kg raw_var.vcf | bcftools view -Ou -o ${uuid}.bcf\n    \"\"\"\n\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n    vcfallelicprimitives -kg raw_var.vcf | bcftools view -Ou -o ${uuid}.bcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "raw_vcf",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "snps_called"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "filterSnps": {
        "name_process": "filterSnps",
        "string_process": "\nprocess filterSnps {\n\n    input:\n    \tset uuid, file(\"${uuid}.bcf\"), file(\"${uuid}.allsites.bcf\") from snps_called\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"${uuid}.snps.vcf.gz\"), file(\"${uuid}.snps.vcf.gz.csi\"), \n    \t\tfile(\"${uuid}.zero_coverage.vcf.gz\"), file(\"${uuid}.zero_coverage.vcf.gz.csi\") into filtered_snps\n    \tfile \"*\"\n   \n    tag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/vcf\", mode: 'copy', pattern: \"${uuid}.snps.*\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/vcf\", mode: 'copy', pattern: \"${uuid}.indels.*\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/vcf\", mode: 'copy', pattern: \"${uuid}.zero_coverage.*\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/vcf\", mode: 'copy', pattern: \"${uuid}.all.*\"\n\t                                                                                  \n\t\n\t                                                                             \n\t                                                  \n\t                                                             \n\t\n\t         \n\t\t              \n\t\t                                                \n\t\t                         \n\t\t                                                        \n\t\t                                 \n\t\t                                           \n\t\n    \"\"\"\n    #annotate vcf file with repetitive regions\n\tbcftools annotate -a ${refFasta.baseName}.rpt_mask.gz -c CHROM,FROM,TO,RPT \\\n\t\t-h ${refFasta.baseName}.rpt_mask.hdr ${uuid}.bcf -Ob -o ${uuid}.masked.bcf.gz\n    \n    #filter vcf\n    bcftools filter -s Q30 -e '%QUAL<30' -Ou ${uuid}.masked.bcf.gz | \\\n    \tbcftools filter -s HetroZ -e \"GT='het'\" -m+ -Ou | \\\n    \tbcftools filter -s OneEachWay -e 'DP4[2] == 0 || DP4[3] ==0' -m+ -Ou | \\\n    \tbcftools filter -s RptRegion -e 'RPT=1' -m+ -Ou | \\\n    \tbcftools filter -s Consensus90 -e '((DP4[2]+DP4[3])/(DP4[0]+DP4[1]+DP4[2]+DP4[3]))<=0.9' -m+ -Ou | \\\n    \tbcftools filter -s HQDepth5 -e '(DP4[2]+DP4[3])<=5' -m+ -Oz -o ${uuid}.all.vcf.gz\n    \n    #create vcf file with just SNPs\n    bcftools filter -i 'TYPE=\"snp\"' -m+ -Oz -o ${uuid}.snps.vcf.gz ${uuid}.all.vcf.gz \n    bcftools index ${uuid}.snps.vcf.gz\n    \n    #create vcf file with just INDELs\n    bcftools filter -i 'TYPE!=\"snp\"' -m+ -Oz -o ${uuid}.indels.vcf.gz ${uuid}.all.vcf.gz \n    bcftools index ${uuid}.indels.vcf.gz\n    \n    #create vcf file with just zero depth sites\n    bcftools filter -e 'DP>0' -Oz -o ${uuid}.zero_coverage.vcf.gz ${uuid}.allsites.bcf\n    bcftools index ${uuid}.zero_coverage.vcf.gz\n    \"\"\"\n\n}",
        "nb_lignes_process": 57,
        "string_script": "\"\"\"\n    #annotate vcf file with repetitive regions\n\tbcftools annotate -a ${refFasta.baseName}.rpt_mask.gz -c CHROM,FROM,TO,RPT \\\n\t\t-h ${refFasta.baseName}.rpt_mask.hdr ${uuid}.bcf -Ob -o ${uuid}.masked.bcf.gz\n    \n    #filter vcf\n    bcftools filter -s Q30 -e '%QUAL<30' -Ou ${uuid}.masked.bcf.gz | \\\n    \tbcftools filter -s HetroZ -e \"GT='het'\" -m+ -Ou | \\\n    \tbcftools filter -s OneEachWay -e 'DP4[2] == 0 || DP4[3] ==0' -m+ -Ou | \\\n    \tbcftools filter -s RptRegion -e 'RPT=1' -m+ -Ou | \\\n    \tbcftools filter -s Consensus90 -e '((DP4[2]+DP4[3])/(DP4[0]+DP4[1]+DP4[2]+DP4[3]))<=0.9' -m+ -Ou | \\\n    \tbcftools filter -s HQDepth5 -e '(DP4[2]+DP4[3])<=5' -m+ -Oz -o ${uuid}.all.vcf.gz\n    \n    #create vcf file with just SNPs\n    bcftools filter -i 'TYPE=\"snp\"' -m+ -Oz -o ${uuid}.snps.vcf.gz ${uuid}.all.vcf.gz \n    bcftools index ${uuid}.snps.vcf.gz\n    \n    #create vcf file with just INDELs\n    bcftools filter -i 'TYPE!=\"snp\"' -m+ -Oz -o ${uuid}.indels.vcf.gz ${uuid}.all.vcf.gz \n    bcftools index ${uuid}.indels.vcf.gz\n    \n    #create vcf file with just zero depth sites\n    bcftools filter -e 'DP>0' -Oz -o ${uuid}.zero_coverage.vcf.gz ${uuid}.allsites.bcf\n    bcftools index ${uuid}.zero_coverage.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 24,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "snps_called",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "filtered_snps"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "consensusFa": {
        "name_process": "consensusFa",
        "string_process": "\nprocess consensusFa {\n\n\tinput:\n\t\tset uuid, file(\"${uuid}.snps.vcf.gz\"), file(\"${uuid}.snps.vcf.gz.csi\"), \n    \t\tfile(\"${uuid}.zero_coverage.vcf.gz\"), file(\"${uuid}.zero_coverage.vcf.gz.csi\") from filtered_snps\n\t\tfile refFasta\n\t\n\toutput:\n\t\tset uuid, file(\"${uuid}.fa\") into fa_file\n\t\t           \n\t\n\ttag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/fasta\", mode: 'copy', pattern: \"${uuid}.*\"\n\t                                                                                    \n\n\t                          \n\t\t                                                                              \n\t\t                     \n\t\"\"\"\n\t#create a temporary bcf file with genotype of filtered variants set to .\n\tbcftools filter -S . -e 'FILTER != \"PASS\"' -Ob -o tmp.bcf.gz ${uuid}.snps.vcf.gz\n\tbcftools index tmp.bcf.gz\n\t\n\t#create consensus file with all the sites set to . above replaced as N\n\tcat $refFasta | bcftools consensus -H 1 -M \"N\" tmp.bcf.gz > tmp.fa\n\t\n\t#set all the sites with zero coverage to be -\n\tsamtools faidx tmp.fa \n\tcat tmp.fa | bcftools consensus -H 1 -M \"-\" ${uuid}.zero_coverage.vcf.gz > ${uuid}.fa\n\t\"\"\"\n}",
        "nb_lignes_process": 30,
        "string_script": "\"\"\"\n\t#create a temporary bcf file with genotype of filtered variants set to .\n\tbcftools filter -S . -e 'FILTER != \"PASS\"' -Ob -o tmp.bcf.gz ${uuid}.snps.vcf.gz\n\tbcftools index tmp.bcf.gz\n\t\n\t#create consensus file with all the sites set to . above replaced as N\n\tcat $refFasta | bcftools consensus -H 1 -M \"N\" tmp.bcf.gz > tmp.fa\n\t\n\t#set all the sites with zero coverage to be -\n\tsamtools faidx tmp.fa \n\tcat tmp.fa | bcftools consensus -H 1 -M \"-\" ${uuid}.zero_coverage.vcf.gz > ${uuid}.fa\n\t\"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "filtered_snps",
            "refFasta"
        ],
        "nb_inputs": 2,
        "outputs": [
            "fa_file"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "mpileup": {
        "name_process": "mpileup",
        "string_process": "\nprocess mpileup {\n\n    input:\n    \tset uuid, file(\"${uuid}.bam\"), file(\"${uuid}.bam.bai\") from dup_removed\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"pileup.bcf\") into pileup\n   \n    tag \"${getShortId(uuid)}\"\n                                                                                      \n\n\t                                           \n\t                                                             \n \t\"\"\"\n    bcftools mpileup -Q25 -q30 -E -o40 -e20 -h100 -m2 -F0.002 -Ou -f $refFasta ${uuid}.bam > pileup.bcf\n    \"\"\"\n\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n    bcftools mpileup -Q25 -q30 -E -o40 -e20 -h100 -m2 -F0.002 -Ou -f $refFasta ${uuid}.bam > pileup.bcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "dup_removed",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "pileup"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "snpCall": {
        "name_process": "snpCall",
        "string_process": "\nprocess snpCall {\n\n    input:\n    \tset uuid, file(\"pileup.bcf\") from pileup\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"${uuid}.bcf\"), file(\"${uuid}.allsites.bcf\") into snps_called\n   \n    tag \"${getShortId(uuid)}\"\n    publishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/vcf\", mode: 'copy'\n\n\t                                                                \n\t                         \n\t\t                                                                  \n\t\t                                             \n\t\n    \"\"\"      \n    # call variants only\n    # \t-m use multiallelic model\n    # \t-v output variants only\n    bcftools call --prior 0.01 -Ou -m -v pileup.bcf | \\\n    \tbcftools norm -f $refFasta -m +any -Ou -o ${uuid}.bcf\n    \t\n    # call all sites\n    bcftools call -Ou -m pileup.bcf | \\\n    \tbcftools norm -f $refFasta -m +any -Ou -o ${uuid}.allsites.bcf\n    \"\"\"\n\n}",
        "nb_lignes_process": 30,
        "string_script": "\"\"\"      \n    # call variants only\n    # \t-m use multiallelic model\n    # \t-v output variants only\n    bcftools call --prior 0.01 -Ou -m -v pileup.bcf | \\\n    \tbcftools norm -f $refFasta -m +any -Ou -o ${uuid}.bcf\n    \t\n    # call all sites\n    bcftools call -Ou -m pileup.bcf | \\\n    \tbcftools norm -f $refFasta -m +any -Ou -o ${uuid}.allsites.bcf\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "pileup",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "snps_called"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "gatk_clean": {
        "name_process": "gatk_clean",
        "string_process": "\nprocess gatk_clean {\n\n    input:\n    \tset uuid, file(\"${uuid}.bam\"), file(\"${uuid}.bam.bai\") from dup_removed1\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"${uuid}.clean.bam\"), file(\"${uuid}.clean.bam.bai\") into gatk_clean_bam\n   \n    tag \"${getShortId(uuid)}\"\n    publishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/gatk\", mode: 'copy'\n\n\t                                                                                        \n\t                                   \n\t\n\t                          \n \t\"\"\"\n \t# add appropriate read group headers\n \tgatk AddOrReplaceReadGroups \\\n \t\t-I ${uuid}.bam \\\n \t\t-O temp.bam \\\n \t\t--RGID=1 --RGLB=null_library --RGPL=illumina --RGPU=null_platform_unit --RGSM=${uuid}\n \t\n \t#fix any mate pair information\n \tgatk FixMateInformation -I temp.bam -O ${uuid}.clean.bam\n \t\n \tsamtools index ${uuid}.clean.bam\n \t\n \t#don't run validate for now\n \t#gatk ValidateSamFile -I ${uuid}.clean.bam -R $refFasta\n    \"\"\"\n\n}",
        "nb_lignes_process": 33,
        "string_script": "\"\"\"\n \t# add appropriate read group headers\n \tgatk AddOrReplaceReadGroups \\\n \t\t-I ${uuid}.bam \\\n \t\t-O temp.bam \\\n \t\t--RGID=1 --RGLB=null_library --RGPL=illumina --RGPU=null_platform_unit --RGSM=${uuid}\n \t\n \t#fix any mate pair information\n \tgatk FixMateInformation -I temp.bam -O ${uuid}.clean.bam\n \t\n \tsamtools index ${uuid}.clean.bam\n \t\n \t#don't run validate for now\n \t#gatk ValidateSamFile -I ${uuid}.clean.bam -R $refFasta\n    \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "GATK",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "dup_removed1",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "gatk_clean_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "gatk_haplotype": {
        "name_process": "gatk_haplotype",
        "string_process": "\nprocess gatk_haplotype {\n\n\techo true\n\n    input:\n    \tset uuid, file(\"${uuid}.clean.bam\"), file(\"${uuid}.clean.bam.bai\") from gatk_clean_bam\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"${uuid}.gatk.raw.vcf\") into gatk_raw_var\n   \n    tag \"${getShortId(uuid)}\"\n                                                                                                                  \n\n\t                                      \n\t                                               \n\t                                                                              \n \t\"\"\"\n    gatk HaplotypeCaller \\\n     -R $refFasta \\\n     -I ${uuid}.clean.bam \\\n     -O ${uuid}.gatk.raw.vcf \\\n     -ploidy 1 \\\n     -A DepthPerAlleleBySample -A Coverage -A StrandBiasBySample -A BaseQuality\n    \"\"\"\n\n}",
        "nb_lignes_process": 27,
        "string_script": "\"\"\"\n    gatk HaplotypeCaller \\\n     -R $refFasta \\\n     -I ${uuid}.clean.bam \\\n     -O ${uuid}.gatk.raw.vcf \\\n     -ploidy 1 \\\n     -A DepthPerAlleleBySample -A Coverage -A StrandBiasBySample -A BaseQuality\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gatk_clean_bam",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "gatk_raw_var"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [
            "echo true"
        ],
        "when": "",
        "stub": ""
    },
    "gatk_filterSnps": {
        "name_process": "gatk_filterSnps",
        "string_process": "\nprocess gatk_filterSnps {\n\n    input:\n    \tset uuid, file(\"${uuid}.gatk.raw.vcf\") from gatk_raw_var\n    \tfile refFasta\n    \tfile \"*\" from ref_index\n \n    output:\n    \tset uuid, file(\"${uuid}.snps.vcf.gz\"), file(\"${uuid}.snps.vcf.gz.csi\") into gatk_filtered_snps\n    \tfile \"*\"\n   \n    tag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/gatk\", mode: 'copy', pattern: \"${uuid}.snps.vcf.*\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/gatk\", mode: 'copy', pattern: \"${uuid}.indels.vcf.*\"\n\n\t\n\t                                                      \n\t                                                  \n\t                                                             \n\t\n\t         \n\t\t              \n\t\t                                                \n\t\t                         \n\t\t                                                        \n\t\t                                 \n\t\t                                           \n\t\t\n\t                                                                                   \n\t\n\t\n\t\"\"\"  \n    #annotate raw vcf file with repetitive regions\n\tbcftools annotate -a ${refFasta.baseName}.rpt_mask.gz -c CHROM,FROM,TO,RPT \\\n\t\t-h ${refFasta.baseName}.rpt_mask.hdr ${uuid}.gatk.raw.vcf -Oz -o ${uuid}.snps.indels.masked.vcf.gz\n\tbcftools index ${uuid}.snps.indels.masked.vcf.gz\n\t\n\t#filter vcf\n    bcftools filter -S . -s Q30 -e '%QUAL<30' -Ou ${uuid}.snps.indels.masked.vcf.gz | \\\n    \tbcftools filter -S . -s OneEachWay -e 'SB[0:2] == 0 || SB[0:3] ==0' -m+ -Ou | \\\n    \tbcftools filter -S . -s RptRegion -e 'RPT=1' -m+ -Ou | \\\n    \tbcftools filter -S . -s Consensus75 -e '((SB[0:2]+SB[0:3])/(SB[0:0]+SB[0:1]))<3' -m+ -Ou | \\\n    \tbcftools filter -s SnpGap --SnpGap 7 -m+ -Ou | \\\n    \tbcftools filter -S . -s SnpGap -e 'FILTER ~ \"SnpGap\"' -m+ -Ou | \\\n    \tbcftools filter -S . -s HQDepth5 -e '(SB[0:2]+SB[0:3])<=5' -m+ -Oz -o ${uuid}.filtered.vcf.gz\n    bcftools index ${uuid}.filtered.vcf.gz\n    \n    #output separate snps and indels files\n    bcftools filter -i 'TYPE=\"indel\"' -m+ -Oz -o ${uuid}.indels.vcf.gz ${uuid}.filtered.vcf.gz\n    bcftools index ${uuid}.indels.vcf.gz\n    \n    bcftools filter -i 'TYPE=\"snp\"' -m+ -Oz -o ${uuid}.snps.vcf.gz ${uuid}.filtered.vcf.gz\n    bcftools index ${uuid}.snps.vcf.gz\n\t\"\"\"\n\n\n}",
        "nb_lignes_process": 56,
        "string_script": "\"\"\"  \n    #annotate raw vcf file with repetitive regions\n\tbcftools annotate -a ${refFasta.baseName}.rpt_mask.gz -c CHROM,FROM,TO,RPT \\\n\t\t-h ${refFasta.baseName}.rpt_mask.hdr ${uuid}.gatk.raw.vcf -Oz -o ${uuid}.snps.indels.masked.vcf.gz\n\tbcftools index ${uuid}.snps.indels.masked.vcf.gz\n\t\n\t#filter vcf\n    bcftools filter -S . -s Q30 -e '%QUAL<30' -Ou ${uuid}.snps.indels.masked.vcf.gz | \\\n    \tbcftools filter -S . -s OneEachWay -e 'SB[0:2] == 0 || SB[0:3] ==0' -m+ -Ou | \\\n    \tbcftools filter -S . -s RptRegion -e 'RPT=1' -m+ -Ou | \\\n    \tbcftools filter -S . -s Consensus75 -e '((SB[0:2]+SB[0:3])/(SB[0:0]+SB[0:1]))<3' -m+ -Ou | \\\n    \tbcftools filter -s SnpGap --SnpGap 7 -m+ -Ou | \\\n    \tbcftools filter -S . -s SnpGap -e 'FILTER ~ \"SnpGap\"' -m+ -Ou | \\\n    \tbcftools filter -S . -s HQDepth5 -e '(SB[0:2]+SB[0:3])<=5' -m+ -Oz -o ${uuid}.filtered.vcf.gz\n    bcftools index ${uuid}.filtered.vcf.gz\n    \n    #output separate snps and indels files\n    bcftools filter -i 'TYPE=\"indel\"' -m+ -Oz -o ${uuid}.indels.vcf.gz ${uuid}.filtered.vcf.gz\n    bcftools index ${uuid}.indels.vcf.gz\n    \n    bcftools filter -i 'TYPE=\"snp\"' -m+ -Oz -o ${uuid}.snps.vcf.gz ${uuid}.filtered.vcf.gz\n    bcftools index ${uuid}.snps.vcf.gz\n\t\"\"\"",
        "nb_lignes_script": 22,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "gatk_raw_var",
            "refFasta",
            "ref_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "gatk_filtered_snps"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "gatk_consensusFa": {
        "name_process": "gatk_consensusFa",
        "string_process": "\nprocess gatk_consensusFa {\n\n\tinput:\n\t\tset uuid, file(\"${uuid}.snps.vcf.gz\"), file(\"${uuid}.snps.vcf.gz.csi\") from gatk_filtered_snps\n\t\tfile refFasta\n\t\n\toutput:\n\t\tset uuid, file(\"${uuid}.fa\") into fa_file\n\t\n\ttag \"${getShortId(uuid)}\"\n\tpublishDir \"$outputPath/$uuid/bwa_mapped/${refFasta.baseName}/gatk\", mode: 'copy', pattern: \"${uuid}.*\"\n\n\t                          \n\t\t                                                                              \n\t\t                     \n\t\"\"\"\n\tcat $refFasta | bcftools consensus -H 1 -M \"N\" ${uuid}.snps.vcf.gz > ${uuid}.fa\n\t\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n\tcat $refFasta | bcftools consensus -H 1 -M \"N\" ${uuid}.snps.vcf.gz > ${uuid}.fa\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "gatk_filtered_snps",
            "refFasta"
        ],
        "nb_inputs": 2,
        "outputs": [
            "fa_file"
        ],
        "nb_outputs": 1,
        "name_workflow": "davideyre__bug-flow",
        "directive": [],
        "when": "",
        "stub": ""
    }
}