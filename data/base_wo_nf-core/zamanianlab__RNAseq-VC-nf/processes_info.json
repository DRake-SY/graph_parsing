{
    "variant_annotate": {
        "name_process": "variant_annotate",
        "string_process": "\nprocess variant_annotate {\n\n      publishDir \"${output}/annotations\", mode: 'copy', pattern: '*_ann.vcf'\n      publishDir \"${output}/annotations\", mode: 'copy', pattern: '*.html'\n      publishDir \"${output}/annotations\", mode: 'copy', pattern: '*.txt'\n\n      input:\n          tuple val(id), file(vcf) from input_vcf\n\n      when:\n          params.vcf && params.filter\n\n      \"\"\"\n         bcftools view --threads ${large_core} -Ov ${vcf} | snpEff -v Aedes_aegypti_VB - > ${id}_ann.vcf\n      \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "\"\"\"\n         bcftools view --threads ${large_core} -Ov ${vcf} | snpEff -v Aedes_aegypti_VB - > ${id}_ann.vcf\n      \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "snpEff"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/snpeff"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "snpEff",
                "uri": "https://bio.tools/snpeff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "Single nucleotide polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP discovery"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP calling"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            },
                            {
                                "uri": "http://edamontology.org/data_3002",
                                "term": "Annotation track"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Variant annotation and effect prediction tool. It annotates and predicts the effects of variants on genes and proteins (such as amino acid changes).",
                "homepage": "http://snpeff.sourceforge.net/"
            }
        ],
        "inputs": [
            "input_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/annotations\", mode: 'copy', pattern: '*_ann.vcf'",
            "publishDir \"${output}/annotations\", mode: 'copy', pattern: '*.html'",
            "publishDir \"${output}/annotations\", mode: 'copy', pattern: '*.txt'"
        ],
        "when": "params.vcf && params.filter",
        "stub": ""
    },
    "remove_indels": {
        "name_process": "remove_indels",
        "string_process": "\nprocess remove_indels {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'\n\n      input:\n          tuple val(id), file(vcf) from vcf1\n\n      output:\n          tuple val(id), file(\"${id}_1_filter.bcf\") into snp_filter\n\n      when:\n          params.vcf\n\n      \"\"\"\n          bcftools view --threads 8 --exclude-types indels -Ob -o ${id}_1_filter.bcf ${vcf}\n          bcftools index ${id}_1_filter.bcf\n      \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n          bcftools view --threads 8 --exclude-types indels -Ob -o ${id}_1_filter.bcf ${vcf}\n          bcftools index ${id}_1_filter.bcf\n      \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "snp_filter"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'"
        ],
        "when": "params.vcf",
        "stub": ""
    },
    "quality_filter": {
        "name_process": "quality_filter",
        "string_process": "\nprocess quality_filter {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'\n\n      input:\n          tuple val(id), file(vcf) from snp_filter\n\n      output:\n          tuple val(id), file(\"${id}_2_filter.bcf\") into quality_filter\n\n      when:\n          params.vcf\n\n      \"\"\"\n          bcftools filter --threads 8 -e 'QUAL < 30' -Ob -o ${id}_2_filter.bcf ${vcf}\n          bcftools index ${id}_2_filter.bcf\n      \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n          bcftools filter --threads 8 -e 'QUAL < 30' -Ob -o ${id}_2_filter.bcf ${vcf}\n          bcftools index ${id}_2_filter.bcf\n      \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "snp_filter"
        ],
        "nb_inputs": 1,
        "outputs": [
            "quality_filter"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'"
        ],
        "when": "params.vcf",
        "stub": ""
    },
    "minimum_depth": {
        "name_process": "minimum_depth",
        "string_process": "\nprocess minimum_depth {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'\n\n      input:\n          tuple val(id), file(vcf) from quality_filter\n\n      output:\n          tuple val(id), file(\"${id}_3_filter.bcf\") into min_depth_filter\n\n      when:\n          params.vcf\n\n      \"\"\"\n          bcftools filter --threads 8 -e 'INFO/DP < 10' -Ob -o ${id}_3_filter.bcf ${vcf}\n          bcftools index ${id}_3_filter.bcf\n      \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n          bcftools filter --threads 8 -e 'INFO/DP < 10' -Ob -o ${id}_3_filter.bcf ${vcf}\n          bcftools index ${id}_3_filter.bcf\n      \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "quality_filter"
        ],
        "nb_inputs": 1,
        "outputs": [
            "min_depth_filter"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'"
        ],
        "when": "params.vcf",
        "stub": ""
    },
    "qual_by_depth": {
        "name_process": "qual_by_depth",
        "string_process": "\nprocess qual_by_depth {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'\n\n      input:\n          tuple val(id), file(og_vcf) from vcf2\n          tuple val(id), file(filt_vcf) from min_depth_filter\n\n      output:\n          tuple val(id), file(\"${id}_4_filter.bcf\") into qual_depth_filter\n\n      when:\n          params.vcf\n\n      \"\"\"\n          AVG_DP=`bcftools view -H ${og_vcf} | cut -f8 | grep -oe \"DP=[0-9]*\" | sed -s 's/DP=//g' | gawk '{ sum += \\$1; n++ } END { if (n > 0) print sum / n; }'`\n          DP_THRESH=`echo \"\\$AVG_DP + 4 * (sqrt(\\$AVG_DP))\" | bc`\n\n          bcftools filter --threads 8 -e \"QUAL < \\$DP_THRESH * 2 && INFO/DP > \\$DP_THRESH\" -Ob -o ${id}_4_filter.bcf ${filt_vcf}\n          bcftools index ${id}_4_filter.bcf\n      \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n          AVG_DP=`bcftools view -H ${og_vcf} | cut -f8 | grep -oe \"DP=[0-9]*\" | sed -s 's/DP=//g' | gawk '{ sum += \\$1; n++ } END { if (n > 0) print sum / n; }'`\n          DP_THRESH=`echo \"\\$AVG_DP + 4 * (sqrt(\\$AVG_DP))\" | bc`\n\n          bcftools filter --threads 8 -e \"QUAL < \\$DP_THRESH * 2 && INFO/DP > \\$DP_THRESH\" -Ob -o ${id}_4_filter.bcf ${filt_vcf}\n          bcftools index ${id}_4_filter.bcf\n      \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf2",
            "min_depth_filter"
        ],
        "nb_inputs": 2,
        "outputs": [
            "qual_depth_filter"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'"
        ],
        "when": "params.vcf",
        "stub": ""
    },
    "allelic_balance": {
        "name_process": "allelic_balance",
        "string_process": "\nprocess allelic_balance {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'\n\n      input:\n          tuple val(id), file(vcf) from qual_depth_filter\n\n      output:\n          tuple val(id), file(\"${id}_5_filter.bcf\") into allele_filter\n\n      when:\n          params.vcf\n\n      \"\"\"\n          bcftools filter --threads 8 -e 'MAF < 0.2' -Ou | bcftools filter --threads 8 -e 'FORMAT/AO < 3' -Ob -o ${id}_5_filter.bcf ${vcf}\n          bcftools index ${id}_5_filter.bcf\n      \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n          bcftools filter --threads 8 -e 'MAF < 0.2' -Ou | bcftools filter --threads 8 -e 'FORMAT/AO < 3' -Ob -o ${id}_5_filter.bcf ${vcf}\n          bcftools index ${id}_5_filter.bcf\n      \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "qual_depth_filter"
        ],
        "nb_inputs": 1,
        "outputs": [
            "allele_filter"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_filter.bcf'"
        ],
        "when": "params.vcf",
        "stub": ""
    },
    "trim_reads": {
        "name_process": "trim_reads",
        "string_process": "\nprocess trim_reads {\n\n    tag \"$id\"\n    publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.html'\n    publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.json'\n\n    input:\n        tuple val(id), file(forward), file(reverse) from input_fq\n\n    output:\n        tuple id, file(\"${id}_R1.fq.gz\"), file(\"${id}_R2.fq.gz\") into trimmed_reads_star1, trimmed_reads_star2, trimmed_reads_picard\n        tuple file(\"*.html\"), file(\"*.json\") into trim_log\n\n    when:\n        params.fq || params.bam\n\n   \"\"\"\n       fastp -i ${forward} -I ${reverse} -o ${id}_R1.fq.gz -O ${id}_R2.fq.gz -y -l 50 -h ${id}.html -j ${id}.json\n   \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n       fastp -i ${forward} -I ${reverse} -o ${id}_R1.fq.gz -O ${id}_R2.fq.gz -y -l 50 -h ${id}.html -j ${id}.json\n   \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "fastPHASE"
        ],
        "tools_url": [
            "https://bio.tools/fastphase"
        ],
        "tools_dico": [
            {
                "name": "fastPHASE",
                "uri": "https://bio.tools/fastphase",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3454",
                                    "term": "Phasing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "fastPHASE is a program to estimate missing genotypes and unobserved haplotypes. It is an implementation of the model described in Scheet & Stephens (2006). This is a cluster-based model for haplotype variation, and gains its utility from implicitly modeling the genealogy of chromosomes in a random sample from a population as a tree but summarizing all haplotype variation in the \"tips\" of the trees.",
                "homepage": "http://scheet.org/software.html"
            }
        ],
        "inputs": [
            "input_fq"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trimmed_reads_star1",
            "trimmed_reads_star2",
            "trimmed_reads_picard",
            "trim_log"
        ],
        "nb_outputs": 4,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.html'",
            "publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.json'"
        ],
        "when": "params.fq || params.bam",
        "stub": ""
    },
    "star_align_first": {
        "name_process": "star_align_first",
        "string_process": "\nprocess star_align_first {\n\n    publishDir \"${output}/star_log\", mode: 'copy', pattern: '*Log*'\n    publishDir \"${output}/sj\", mode: 'copy', pattern: '*.tab'\n\n    cpus large_core\n    tag \"$id\"\n\n    input:\n        tuple val(id), file(forward), file(reverse) from trimmed_reads_star1\n        file index from star_index\n\n    output:\n        file(\"*out.tab\") into mapped_splice_junctions\n\n    when:\n        params.fq && !params.bam\n\n    \"\"\"\n        STAR \\\\\n          --readFilesIn ${forward} ${reverse} \\\\\n          --readFilesCommand zcat \\\\\n          --genomeDir ${index} \\\\\n          --genomeLoad LoadAndRemove \\\\\n          --runThreadN ${task.cpus} \\\\\n          --outFilterType BySJout \\\\\n          --alignIntronMax 1000000 \\\\\n          --alignMatesGapMax 1000000 \\\\\n          --outFilterMismatchNmax 999 \\\\\n          --outFilterMismatchNoverReadLmax 0.04 \\\\\n          --outFilterMultimapNmax 20 \\\\\n          --outFileNamePrefix ${id}.\n    \"\"\"\n}",
        "nb_lignes_process": 33,
        "string_script": "\"\"\"\n        STAR \\\\\n          --readFilesIn ${forward} ${reverse} \\\\\n          --readFilesCommand zcat \\\\\n          --genomeDir ${index} \\\\\n          --genomeLoad LoadAndRemove \\\\\n          --runThreadN ${task.cpus} \\\\\n          --outFilterType BySJout \\\\\n          --alignIntronMax 1000000 \\\\\n          --alignMatesGapMax 1000000 \\\\\n          --outFilterMismatchNmax 999 \\\\\n          --outFilterMismatchNoverReadLmax 0.04 \\\\\n          --outFilterMultimapNmax 20 \\\\\n          --outFileNamePrefix ${id}.\n    \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "STAR"
        ],
        "tools_url": [
            "https://bio.tools/star"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            }
        ],
        "inputs": [
            "trimmed_reads_star1",
            "star_index"
        ],
        "nb_inputs": 2,
        "outputs": [
            "mapped_splice_junctions"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/star_log\", mode: 'copy', pattern: '*Log*'",
            "publishDir \"${output}/sj\", mode: 'copy', pattern: '*.tab'",
            "cpus large_core",
            "tag \"$id\""
        ],
        "when": "params.fq && !params.bam",
        "stub": ""
    },
    "star_align_second": {
        "name_process": "star_align_second",
        "string_process": "\nprocess star_align_second {\n\n    publishDir \"${output}/star_log\", mode: 'copy', pattern: '*Log*'\n    publishDir \"${output}/alignment_stats\", mode: 'copy', pattern: '*alignment_stats.log'\n    publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam'\n    publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam.bai'\n\n    cpus large_core\n    tag \"$id\"\n\n    input:\n        tuple val(id), file(forward), file(reverse) from trimmed_reads_star2\n        file index from star_index\n        file junctions from concatenated_junctions\n\n    output:\n        file \"${id}.Log.out\" into alignment_logs\n        tuple val(id), file(\"${id}.bam\") into bam_files\n\n    when:\n        params.fq && !params.bam\n\n    \"\"\"\n        SM=`echo ${id} | cut -c1-3 | tr -d '\\n'`\n        ID=${id}\n        LB=${id}\n\n        STAR \\\\\n        --readFilesIn ${forward} ${reverse} \\\\\n        --readFilesCommand zcat \\\\\n        --genomeDir ${index} \\\\\n        --sjdbFileChrStartEnd ${junctions} \\\\\n        --runThreadN ${task.cpus} \\\\\n        --outSAMtype BAM Unsorted \\\\\n        --outSAMattributes NH HI AS NM MD \\\\\n        --outSAMattrRGline ID:\"\\$ID\" PL:illumina SM:\"\\$SM\" LB:\"\\$LB\" \\\\\n        --outFilterType BySJout \\\\\n        --alignIntronMax 1000000 \\\\\n        --alignMatesGapMax 1000000 \\\\\n        --outFilterMismatchNmax 999 \\\\\n        --outFilterMismatchNoverReadLmax 0.04 \\\\\n        --outFilterMultimapNmax 20 \\\\\n        --outFileNamePrefix ${id}.\n\n        mv ${id}.Aligned.out.bam  ${id}.bam\n        samtools flagstat -@ ${task.cpus} ${id}.bam > ${id}_alignment_stats.log\n    \"\"\"\n}",
        "nb_lignes_process": 47,
        "string_script": "\"\"\"\n        SM=`echo ${id} | cut -c1-3 | tr -d '\\n'`\n        ID=${id}\n        LB=${id}\n\n        STAR \\\\\n        --readFilesIn ${forward} ${reverse} \\\\\n        --readFilesCommand zcat \\\\\n        --genomeDir ${index} \\\\\n        --sjdbFileChrStartEnd ${junctions} \\\\\n        --runThreadN ${task.cpus} \\\\\n        --outSAMtype BAM Unsorted \\\\\n        --outSAMattributes NH HI AS NM MD \\\\\n        --outSAMattrRGline ID:\"\\$ID\" PL:illumina SM:\"\\$SM\" LB:\"\\$LB\" \\\\\n        --outFilterType BySJout \\\\\n        --alignIntronMax 1000000 \\\\\n        --alignMatesGapMax 1000000 \\\\\n        --outFilterMismatchNmax 999 \\\\\n        --outFilterMismatchNoverReadLmax 0.04 \\\\\n        --outFilterMultimapNmax 20 \\\\\n        --outFileNamePrefix ${id}.\n\n        mv ${id}.Aligned.out.bam  ${id}.bam\n        samtools flagstat -@ ${task.cpus} ${id}.bam > ${id}_alignment_stats.log\n    \"\"\"",
        "nb_lignes_script": 24,
        "language_script": "bash",
        "tools": [
            "STAR",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/star",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "trimmed_reads_star2",
            "star_index",
            "concatenated_junctions"
        ],
        "nb_inputs": 3,
        "outputs": [
            "alignment_logs",
            "bam_files"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/star_log\", mode: 'copy', pattern: '*Log*'",
            "publishDir \"${output}/alignment_stats\", mode: 'copy', pattern: '*alignment_stats.log'",
            "publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam'",
            "publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam.bai'",
            "cpus large_core",
            "tag \"$id\""
        ],
        "when": "params.fq && !params.bam",
        "stub": ""
    },
    "picard_fastq_uBAM": {
        "name_process": "picard_fastq_uBAM",
        "string_process": "\nprocess picard_fastq_uBAM {\n\n    input:\n        tuple val(id), file(forward), file(reverse) from trimmed_reads_picard\n\n    output:\n        tuple id, file(\"${id}.ubam\") into sorted_ubams\n\n    when:\n        params.bam\n\n    \"\"\"\n        SM=`echo ${id} | cut -c1-3 | tr -d '\\n'`\n        ID=${id}\n        LB=${id}\n\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          FastqToSam \\\n          -F1 ${forward} \\\n          -F2 ${reverse} \\\n          -O ${id}.ubam \\\n          -SM \"\\$SM\" \\\n          -RG \"\\$ID\" \\\n          -LB \"\\$LB\" \\\n          -PL illumina \\\n          -SO queryname \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n    \"\"\"\n}",
        "nb_lignes_process": 30,
        "string_script": "\"\"\"\n        SM=`echo ${id} | cut -c1-3 | tr -d '\\n'`\n        ID=${id}\n        LB=${id}\n\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          FastqToSam \\\n          -F1 ${forward} \\\n          -F2 ${reverse} \\\n          -O ${id}.ubam \\\n          -SM \"\\$SM\" \\\n          -RG \"\\$ID\" \\\n          -LB \"\\$LB\" \\\n          -PL illumina \\\n          -SO queryname \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n    \"\"\"",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "trimmed_reads_picard"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sorted_ubams"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "picard_sort_bam": {
        "name_process": "picard_sort_bam",
        "string_process": "\nprocess picard_sort_bam {\n\n    cpus large_core\n\n    input:\n        tuple val(id), file(bam) from input_bam\n\n    output:\n        tuple val(id), file(\"${id}_qn_sorted.bam\") into sorted_bams\n\n    when:\n        params.bam\n\n    \"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          SortSam \\\n          -I ${bam} \\\n          -O ${id}_qn_sorted.bam \\\n          -SO queryname \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "\"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          SortSam \\\n          -I ${bam} \\\n          -O ${id}_qn_sorted.bam \\\n          -SO queryname \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "input_bam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sorted_bams"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "cpus large_core"
        ],
        "when": "params.bam",
        "stub": ""
    },
    "picard_merge": {
        "name_process": "picard_merge",
        "string_process": "\nprocess picard_merge {\n\n    input:\n        tuple val(id), file(bam), file(ubam) from joined_bams\n\n    output:\n        tuple val(id), file(\"${id}_merged.bam\") into merged_bams\n\n    when:\n        params.bam\n\n    \"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          MergeBamAlignment \\\n          -ALIGNED ${bam} \\\n          -UNMAPPED ${ubam} \\\n          -O \"${id}_merged.bam\" \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "\"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          MergeBamAlignment \\\n          -ALIGNED ${bam} \\\n          -UNMAPPED ${ubam} \\\n          -O \"${id}_merged.bam\" \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "joined_bams"
        ],
        "nb_inputs": 1,
        "outputs": [
            "merged_bams"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "picard_mark_duplicates": {
        "name_process": "picard_mark_duplicates",
        "string_process": "\nprocess picard_mark_duplicates {\n\n    publishDir \"${output}/picard_stats\", mode: 'copy', pattern: '*_marked_dup_stats.txt'\n\n    input:\n        tuple val(id), file(bam) from merged_bams\n\n    output:\n        tuple val(id), file(\"${id}_duplicates.bam\") into duplicate_bams\n        file \"${id}_marked_dup_stats.txt\" into picard_logs\n\n    when:\n        params.bam\n\n    \"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          MarkDuplicates \\\n          -I ${bam} \\\n          -O ${id}_duplicates.bam \\\n          -M ${id}_marked_dup_stats.txt \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "\"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx6g \\\n          MarkDuplicates \\\n          -I ${bam} \\\n          -O ${id}_duplicates.bam \\\n          -M ${id}_marked_dup_stats.txt \\\n          -TMP_DIR /home/BIOTECH/zamanian/tmp\n\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK",
            "MarkDuplicates (IP)"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/markduplicates_ip"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "MarkDuplicates (IP)",
                "uri": "https://bio.tools/markduplicates_ip",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0253",
                                    "term": "Sequence feature detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0253",
                                    "term": "Sequence feature recognition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0253",
                                    "term": "Sequence feature prediction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Marks all duplicate reads in a provided SAM or BAM file and either removes them or flags them.",
                "homepage": "https://galaxy.pasteur.fr/tool_runner?tool_id=toolshed.pasteur.fr/repos/fmareuil/picard_pasteur_wrapper/rgPicardMarkDups/1.56.0"
            }
        ],
        "inputs": [
            "merged_bams"
        ],
        "nb_inputs": 1,
        "outputs": [
            "duplicate_bams",
            "picard_logs"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/picard_stats\", mode: 'copy', pattern: '*_marked_dup_stats.txt'"
        ],
        "when": "params.bam",
        "stub": ""
    },
    "split_reads": {
        "name_process": "split_reads",
        "string_process": "\nprocess split_reads {\n\n    input:\n        tuple val(id), file(bam) from duplicate_bams\n\n    output:\n        tuple id, file(\"${id}_split.bam\") into split_bams1, split_bams2\n\n    when:\n        params.bam\n\n    \"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx4g \\\n          SplitNCigarReads \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          -I ${bam} \\\n          -O ${id}_split.bam \\\n          -tmp-dir /home/BIOTECH/zamanian/tmp\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n        gatk \\\n          --java-options \\\n          -Xmx4g \\\n          SplitNCigarReads \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          -I ${bam} \\\n          -O ${id}_split.bam \\\n          -tmp-dir /home/BIOTECH/zamanian/tmp\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "duplicate_bams"
        ],
        "nb_inputs": 1,
        "outputs": [
            "split_bams1",
            "split_bams2"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "fetch_variants": {
        "name_process": "fetch_variants",
        "string_process": "\nprocess fetch_variants {\n\n    output:\n        tuple file(\"known_variants.vcf.gz\"), file(\"known_variants.vcf.gz.csi\"), file(\"known_variants.vcf.gz.tbi\") into known_variants\n\n    when:\n        params.bam\n\n    \"\"\"\n        wget ftp://ftp.ensemblgenomes.org/pub/metazoa/release-46/variation/vcf/aedes_aegypti_lvpagwg/aedes_aegypti_lvpagwg.vcf.gz \\\n          -O known_variants.vcf.gz\n\n        wget ftp://ftp.ensemblgenomes.org/pub/metazoa/release-46/variation/vcf/aedes_aegypti_lvpagwg/aedes_aegypti_lvpagwg.vcf.gz.csi \\\n          -O known_variants.vcf.gz.csi\n\n        gatk IndexFeatureFile \\\n          -I known_variants.vcf.gz\n\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n        wget ftp://ftp.ensemblgenomes.org/pub/metazoa/release-46/variation/vcf/aedes_aegypti_lvpagwg/aedes_aegypti_lvpagwg.vcf.gz \\\n          -O known_variants.vcf.gz\n\n        wget ftp://ftp.ensemblgenomes.org/pub/metazoa/release-46/variation/vcf/aedes_aegypti_lvpagwg/aedes_aegypti_lvpagwg.vcf.gz.csi \\\n          -O known_variants.vcf.gz.csi\n\n        gatk IndexFeatureFile \\\n          -I known_variants.vcf.gz\n\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "known_variants"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "generate_intervals": {
        "name_process": "generate_intervals",
        "string_process": "\nprocess generate_intervals {\n\n      input:\n          file(gtf) from annotations\n\n      output:\n          file(\"transcript.interval_list\") into (intervals1, intervals2, intervals3)\n          file(\"genome_picard.dict\") into (dict1, dict2, dict3)\n          file(\"transcript_intervals.bed\") into intervals_bed\n\n      when:\n          params.bam\n\n      shell:\n      '''\n          cat !{gtf} | grep -E '\\\\stranscript\\\\s' | awk '{print $1 \"\\t\" $4-1 \"\\t\" $5}' > transcript_intervals.bed\n\n          picard CreateSequenceDictionary \\\n            R=\"!{aedesgenome}/genome.fa\" \\\n            O=genome_picard.dict\n\n          picard BedToIntervalList \\\n            I=transcript_intervals.bed \\\n            O=transcript.interval_list \\\n            SD=genome_picard.dict\n      '''\n\n}",
        "nb_lignes_process": 27,
        "string_script": "      '''\n          cat !{gtf} | grep -E '\\\\stranscript\\\\s' | awk '{print $1 \"\\t\" $4-1 \"\\t\" $5}' > transcript_intervals.bed\n\n          picard CreateSequenceDictionary \\\n            R=\"!{aedesgenome}/genome.fa\" \\\n            O=genome_picard.dict\n\n          picard BedToIntervalList \\\n            I=transcript_intervals.bed \\\n            O=transcript.interval_list \\\n            SD=genome_picard.dict\n      '''",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "annotations"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            "",
            "intervals_bed"
        ],
        "nb_outputs": 3,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "recalibrate_bases": {
        "name_process": "recalibrate_bases",
        "string_process": "\nprocess recalibrate_bases {\n\n    input:\n        tuple val(id), file(bam) from split_bams1\n        tuple file(vcf), file(index_csi), file(index_tbi) from known_variants\n        file(intervals) from intervals1.first()\n        file(reference_dict) from dict1.first()\n\n    output:\n        tuple id, file(\"${id}_recal_data.table\") into brdt1, brdt2\n\n    when:\n        params.bam\n\n    \"\"\"\n        gatk BaseRecalibrator \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          --sequence-dictionary ${reference_dict} \\\n          -I ${bam} \\\n          -L ${intervals} \\\n          --known-sites ${vcf} \\\n          -O \"${id}_recal_data.table\"\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "\"\"\"\n        gatk BaseRecalibrator \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          --sequence-dictionary ${reference_dict} \\\n          -I ${bam} \\\n          -L ${intervals} \\\n          --known-sites ${vcf} \\\n          -O \"${id}_recal_data.table\"\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "split_bams1",
            "known_variants",
            "intervals1",
            "dict1"
        ],
        "nb_inputs": 4,
        "outputs": [
            "brdt1",
            "brdt2"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "apply_recalibration": {
        "name_process": "apply_recalibration",
        "string_process": "\nprocess apply_recalibration {\n\n    input:\n        tuple val(id), file(bam), file(recal_table) from bam_recal_table\n        file(intervals) from intervals2.first()\n        file(reference_dict) from dict2.first()\n\n    output:\n        tuple stdout, file(\"${id}_recal.bam\") into recal_bams\n\n    when:\n        params.bam\n\n    \"\"\"\n        gatk ApplyBQSR \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          --sequence-dictionary ${reference_dict} \\\n          -I ${bam} \\\n          -L ${intervals} \\\n          --bqsr-recal-file ${recal_table} \\\n          -O \"${id}_recal.bam\"\n\n        echo ${id} | cut -c1-3 | tr -d '\\n'\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "\"\"\"\n        gatk ApplyBQSR \\\n          -R \"${aedesgenome}/genome.fa\" \\\n          --sequence-dictionary ${reference_dict} \\\n          -I ${bam} \\\n          -L ${intervals} \\\n          --bqsr-recal-file ${recal_table} \\\n          -O \"${id}_recal.bam\"\n\n        echo ${id} | cut -c1-3 | tr -d '\\n'\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "bam_recal_table",
            "intervals2",
            "dict2"
        ],
        "nb_inputs": 3,
        "outputs": [
            "recal_bams"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "plot_recalibration": {
        "name_process": "plot_recalibration",
        "string_process": "\nprocess plot_recalibration {\n\n      publishDir \"${output}/base_recalibration\", mode: 'copy', pattern: '*_AnalyzeCovariates.pdf'\n\n      input:\n          tuple val(id), file(recal_table) from brdt2\n\n      output:\n          file(\"${id}_AnalyzeCovariates.pdf\") into recal_plots\n\n      when:\n          params.bam\n\n      \"\"\"\n          gatk AnalyzeCovariates \\\n            -bqsr ${recal_table} \\\n            -plots \"${id}_AnalyzeCovariates.pdf\"\n \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n          gatk AnalyzeCovariates \\\n            -bqsr ${recal_table} \\\n            -plots \"${id}_AnalyzeCovariates.pdf\"\n \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "brdt2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "recal_plots"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/base_recalibration\", mode: 'copy', pattern: '*_AnalyzeCovariates.pdf'"
        ],
        "when": "params.bam",
        "stub": ""
    },
    "merge_bams_by_strain": {
        "name_process": "merge_bams_by_strain",
        "string_process": "\nprocess merge_bams_by_strain {\n\n    input:\n        tuple val(id), file(bams) from recal_bams.groupTuple()\n\n    output:\n        tuple id, file(\"${id}_rg_merged.bam\") into merged_by_strain_bams_hc, merged_by_strain_bams_fb\n\n    when:\n        params.bam\n\n    \"\"\"\n        samtools merge -cp ${id}_merged.bam ${bams.join(\" \")}\n\n        picard AddOrReplaceReadGroups \\\n          I=${id}_merged.bam \\\n          O=${id}_rg_merged.bam \\\n          RGID=${id} \\\n          RGLB=${id} \\\n          RGPL=ILLUMINA \\\n          RGPU=NA \\\n          RGSM=${id}\n\n        samtools index ${id}_rg_merged.bam\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "\"\"\"\n        samtools merge -cp ${id}_merged.bam ${bams.join(\" \")}\n\n        picard AddOrReplaceReadGroups \\\n          I=${id}_merged.bam \\\n          O=${id}_rg_merged.bam \\\n          RGID=${id} \\\n          RGLB=${id} \\\n          RGPL=ILLUMINA \\\n          RGPU=NA \\\n          RGSM=${id}\n\n        samtools index ${id}_rg_merged.bam\n    \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "recal_bams"
        ],
        "nb_inputs": 1,
        "outputs": [
            "merged_by_strain_bams_hc",
            "merged_by_strain_bams_fb"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [],
        "when": "params.bam",
        "stub": ""
    },
    "freebayes": {
        "name_process": "freebayes",
        "string_process": "\nprocess freebayes {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*.vcf'\n\n      input:\n          tuple val(id), file(bam) from merged_by_strain_bams_fb\n          file(intervals) from intervals_bed.first()\n\n      output:\n          file(\"${id}.vcf\") into vcfs_fb\n\n      when:\n          params.bam\n\n      \"\"\"\n          ## for attempting freebayes-parallel\n          # bedtools getfasta -fi \"${aedesgenome}/genome.fa\" -bed ${intervals} -fo transcript_intervals.fa\n          # samtools faidx transcript_intervals.fa\n          # cat transcript_intervals.bed | awk '{print \\$1 \":\" \\$2 \"-\" \\$3}' > transcript_intervals.txt\n\n          freebayes \\\n            -f \"${aedesgenome}/genome.fa\" \\\n            -b ${bam} > \"${id}.vcf\"\n\n          bgzip -@ 8 \"${id}.vcf > ${id}.vcf.gz\n      \"\"\"\n\n}",
        "nb_lignes_process": 27,
        "string_script": "\"\"\"\n          ## for attempting freebayes-parallel\n          # bedtools getfasta -fi \"${aedesgenome}/genome.fa\" -bed ${intervals} -fo transcript_intervals.fa\n          # samtools faidx transcript_intervals.fa\n          # cat transcript_intervals.bed | awk '{print \\$1 \":\" \\$2 \"-\" \\$3}' > transcript_intervals.txt\n\n          freebayes \\\n            -f \"${aedesgenome}/genome.fa\" \\\n            -b ${bam} > \"${id}.vcf\"\n\n          bgzip -@ 8 \"${id}.vcf > ${id}.vcf.gz\n      \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "merged_by_strain_bams_fb",
            "intervals_bed"
        ],
        "nb_inputs": 2,
        "outputs": [
            "vcfs_fb"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*.vcf'"
        ],
        "when": "params.bam",
        "stub": ""
    },
    "filter_variants": {
        "name_process": "filter_variants",
        "string_process": "\nprocess filter_variants {\n\n      publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_1_filter.vcf.gz'\n\n      input:\n          tuple val(id), file(vcf) from input_vcf\n\n      output:\n          file(\"${id}_1_filter.vcf.gz\")\n\n      when:\n          params.vcf\n\n      \"\"\"\n          bcftools filter --threads 8 -e 'QUAL < 30' -Ou ${vcf} | \\\n            bcftools filter --threads 8 -e 'INFO/DP < 10' -Ou | \\\n            bcftools filter --threads 8 -e 'MAF < 0.2' -Ou | \\\n            bcftools filter --threads 8 -e 'INFO/DP > 500' -Oz -o ${id}_1_filter.vcf.gz\n\n          bcftools index ${id}_1_filter.vcf.gz\n\n          bcftools view -r 1:1-20000000 -Oz -o ${id}_2_filter.vcf.gz ${id}_1_filter.vcf.gz\n      \"\"\"\n\n}",
        "nb_lignes_process": 24,
        "string_script": "\"\"\"\n          bcftools filter --threads 8 -e 'QUAL < 30' -Ou ${vcf} | \\\n            bcftools filter --threads 8 -e 'INFO/DP < 10' -Ou | \\\n            bcftools filter --threads 8 -e 'MAF < 0.2' -Ou | \\\n            bcftools filter --threads 8 -e 'INFO/DP > 500' -Oz -o ${id}_1_filter.vcf.gz\n\n          bcftools index ${id}_1_filter.vcf.gz\n\n          bcftools view -r 1:1-20000000 -Oz -o ${id}_2_filter.vcf.gz ${id}_1_filter.vcf.gz\n      \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "zamanianlab__RNAseq-VC-nf",
        "directive": [
            "publishDir \"${output}/vcfs\", mode: 'copy', pattern: '*_1_filter.vcf.gz'"
        ],
        "when": "params.vcf",
        "stub": ""
    }
}