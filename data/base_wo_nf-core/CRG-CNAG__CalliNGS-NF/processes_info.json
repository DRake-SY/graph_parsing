{
    "PREPARE_GENOME_SAMTOOLS": {
        "name_process": "PREPARE_GENOME_SAMTOOLS",
        "string_process": "\nprocess PREPARE_GENOME_SAMTOOLS { \n  tag \"$genome.baseName\"\n \n  input: \n    path genome\n \n  output: \n    path \"${genome}.fai\"\n  \n  script:\n  \"\"\"\n  samtools faidx ${genome}\n  \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  samtools faidx ${genome}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "genome"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$genome.baseName\""
        ],
        "when": "",
        "stub": ""
    },
    "PREPARE_GENOME_PICARD": {
        "name_process": "PREPARE_GENOME_PICARD",
        "string_process": "\nprocess PREPARE_GENOME_PICARD {\n  tag \"$genome.baseName\"\n  label 'mem_xlarge'\n\n  input:\n    path genome\n  output:\n    path \"${genome.baseName}.dict\"\n\n  script:\n  \"\"\"\n  gatk CreateSequenceDictionary -R $genome -O ${genome.baseName}.dict\n  \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  gatk CreateSequenceDictionary -R $genome -O ${genome.baseName}.dict\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genome"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$genome.baseName\"",
            "label 'mem_xlarge'"
        ],
        "when": "",
        "stub": ""
    },
    "PREPARE_STAR_GENOME_INDEX": {
        "name_process": "PREPARE_STAR_GENOME_INDEX",
        "string_process": "\nprocess PREPARE_STAR_GENOME_INDEX {\n  tag \"$genome.baseName\"\n\n  input:\n    path genome\n  output:\n    path \"genome_dir\"\n\n  script:\n  \"\"\"\n  mkdir genome_dir\n\n  STAR --runMode genomeGenerate \\\n       --genomeDir genome_dir \\\n       --genomeFastaFiles ${genome} \\\n       --runThreadN ${task.cpus}\n  \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "  \"\"\"\n  mkdir genome_dir\n\n  STAR --runMode genomeGenerate \\\n       --genomeDir genome_dir \\\n       --genomeFastaFiles ${genome} \\\n       --runThreadN ${task.cpus}\n  \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "STAR"
        ],
        "tools_url": [
            "https://bio.tools/star"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            }
        ],
        "inputs": [
            "genome"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$genome.baseName\""
        ],
        "when": "",
        "stub": ""
    },
    "PREPARE_VCF_FILE": {
        "name_process": "PREPARE_VCF_FILE",
        "string_process": "\nprocess PREPARE_VCF_FILE {\n  tag \"$variantsFile.baseName\"\n\n  input: \n    path variantsFile\n    path denylisted\n\n  output:\n    tuple \\\n      path(\"${variantsFile.baseName}.filtered.recode.vcf.gz\"), \\\n      path(\"${variantsFile.baseName}.filtered.recode.vcf.gz.tbi\")\n  \n  script:  \n  \"\"\"\n  vcftools --gzvcf $variantsFile -c \\\n           --exclude-bed ${denylisted} \\\n           --recode | bgzip -c \\\n           > ${variantsFile.baseName}.filtered.recode.vcf.gz\n\n  tabix ${variantsFile.baseName}.filtered.recode.vcf.gz\n  \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "  \"\"\"\n  vcftools --gzvcf $variantsFile -c \\\n           --exclude-bed ${denylisted} \\\n           --recode | bgzip -c \\\n           > ${variantsFile.baseName}.filtered.recode.vcf.gz\n\n  tabix ${variantsFile.baseName}.filtered.recode.vcf.gz\n  \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "variantsFile",
            "denylisted"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$variantsFile.baseName\""
        ],
        "when": "",
        "stub": ""
    },
    "RNASEQ_MAPPING_STAR": {
        "name_process": "RNASEQ_MAPPING_STAR",
        "string_process": "\nprocess RNASEQ_MAPPING_STAR {\n  tag \"$replicateId\"\n\n  input: \n    path genome\n    path genomeDir\n    tuple val(replicateId), path(reads) \n\n  output: \n    tuple \\\n      val(replicateId), \\\n      path('Aligned.sortedByCoord.uniq.bam'), \\\n      path('Aligned.sortedByCoord.uniq.bam.bai')\n\n  script:\n  \"\"\"\n  # ngs-nf-dev Align reads to genome\n  STAR --genomeDir $genomeDir \\\n       --readFilesIn $reads \\\n       --runThreadN $task.cpus \\\n       --readFilesCommand zcat \\\n       --outFilterType BySJout \\\n       --alignSJoverhangMin 8 \\\n       --alignSJDBoverhangMin 1 \\\n       --outFilterMismatchNmax 999\n\n  # Run 2-pass mapping (improve alignmets using table of splice junctions and create a new index)  \n  STAR --genomeDir $genomeDir \\\n       --readFilesIn $reads \\\n       --runThreadN $task.cpus \\\n       --readFilesCommand zcat \\\n       --outFilterType BySJout \\\n       --alignSJoverhangMin 8 \\\n       --alignSJDBoverhangMin 1 \\\n       --outFilterMismatchNmax 999 \\\n       --sjdbFileChrStartEnd SJ.out.tab \\\n       --outSAMtype BAM SortedByCoordinate \\\n       --outSAMattrRGline ID:$replicateId LB:library PL:illumina PU:machine SM:GM12878\n\n  # Select only unique alignments, no multimaps\n  (samtools view -H Aligned.sortedByCoord.out.bam; samtools view Aligned.sortedByCoord.out.bam| grep -w 'NH:i:1') \\\n  |samtools view -Sb - > Aligned.sortedByCoord.uniq.bam\n  \n  # Index the BAM file\n  samtools index Aligned.sortedByCoord.uniq.bam\n  \"\"\"\n}",
        "nb_lignes_process": 46,
        "string_script": "  \"\"\"\n  # ngs-nf-dev Align reads to genome\n  STAR --genomeDir $genomeDir \\\n       --readFilesIn $reads \\\n       --runThreadN $task.cpus \\\n       --readFilesCommand zcat \\\n       --outFilterType BySJout \\\n       --alignSJoverhangMin 8 \\\n       --alignSJDBoverhangMin 1 \\\n       --outFilterMismatchNmax 999\n\n  # Run 2-pass mapping (improve alignmets using table of splice junctions and create a new index)  \n  STAR --genomeDir $genomeDir \\\n       --readFilesIn $reads \\\n       --runThreadN $task.cpus \\\n       --readFilesCommand zcat \\\n       --outFilterType BySJout \\\n       --alignSJoverhangMin 8 \\\n       --alignSJDBoverhangMin 1 \\\n       --outFilterMismatchNmax 999 \\\n       --sjdbFileChrStartEnd SJ.out.tab \\\n       --outSAMtype BAM SortedByCoordinate \\\n       --outSAMattrRGline ID:$replicateId LB:library PL:illumina PU:machine SM:GM12878\n\n  # Select only unique alignments, no multimaps\n  (samtools view -H Aligned.sortedByCoord.out.bam; samtools view Aligned.sortedByCoord.out.bam| grep -w 'NH:i:1') \\\n  |samtools view -Sb - > Aligned.sortedByCoord.uniq.bam\n  \n  # Index the BAM file\n  samtools index Aligned.sortedByCoord.uniq.bam\n  \"\"\"",
        "nb_lignes_script": 30,
        "language_script": "bash",
        "tools": [
            "STAR",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/star",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "genome",
            "genomeDir",
            "replicateId",
            "reads"
        ],
        "nb_inputs": 4,
        "outputs": [
            "replicateId"
        ],
        "nb_outputs": 1,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$replicateId\""
        ],
        "when": "",
        "stub": ""
    },
    "RNASEQ_GATK_SPLITNCIGAR": {
        "name_process": "RNASEQ_GATK_SPLITNCIGAR",
        "string_process": "\nprocess RNASEQ_GATK_SPLITNCIGAR {\n  tag \"$replicateId\"\n  label 'mem_large'\n  \n  input: \n    path genome\n    path index\n    path genome_dict\n    tuple val(replicateId), path(bam), path(index)\n\n  output:\n    tuple val(replicateId), path('split.bam'), path('split.bai')\n  \n  script:\n  \"\"\"\n  # SplitNCigarReads and reassign mapping qualities\n  gatk SplitNCigarReads \\\n            -R $genome \\\n            -I $bam \\\n            --refactor-cigar-string \\\n            -O split.bam\n  \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "  \"\"\"\n  # SplitNCigarReads and reassign mapping qualities\n  gatk SplitNCigarReads \\\n            -R $genome \\\n            -I $bam \\\n            --refactor-cigar-string \\\n            -O split.bam\n  \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genome",
            "index",
            "genome_dict",
            "replicateId",
            "bam",
            "index"
        ],
        "nb_inputs": 6,
        "outputs": [
            "replicateId"
        ],
        "nb_outputs": 1,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$replicateId\"",
            "label 'mem_large'"
        ],
        "when": "",
        "stub": ""
    },
    "RNASEQ_GATK_RECALIBRATE": {
        "name_process": "RNASEQ_GATK_RECALIBRATE",
        "string_process": "\nprocess RNASEQ_GATK_RECALIBRATE {\n  tag \"$replicateId\"\n  label \"mem_large\"\n\n  input: \n    path genome\n    path index\n    path dict\n    tuple val(replicateId), path(bam), path(index)\n    tuple path(variants_file), path(variants_file_index)\n\n  output:\n    tuple \\\n      val(sampleId), \\\n      path(\"${replicateId}.final.uniq.bam\"), \\\n      path(\"${replicateId}.final.uniq.bam.bai\")\n  \n  script: \n  sampleId = replicateId.replaceAll(/[12]$/,'')\n  \"\"\"\n  # Indel Realignment and Base Recalibration\n  gatk BaseRecalibrator \\\n          -R $genome \\\n          -I $bam \\\n          --known-sites $variants_file \\\n          -O final.rnaseq.grp \n\n  gatk ApplyBQSR \\\n          -R $genome -I $bam \\\n          --bqsr-recal-file final.rnaseq.grp \\\n          -O ${replicateId}.final.uniq.bam\n\n  # Index BAM files\n  samtools index ${replicateId}.final.uniq.bam\n  \"\"\"\n}",
        "nb_lignes_process": 35,
        "string_script": "  sampleId = replicateId.replaceAll(/[12]$/,'')\n  \"\"\"\n  # Indel Realignment and Base Recalibration\n  gatk BaseRecalibrator \\\n          -R $genome \\\n          -I $bam \\\n          --known-sites $variants_file \\\n          -O final.rnaseq.grp \n\n  gatk ApplyBQSR \\\n          -R $genome -I $bam \\\n          --bqsr-recal-file final.rnaseq.grp \\\n          -O ${replicateId}.final.uniq.bam\n\n  # Index BAM files\n  samtools index ${replicateId}.final.uniq.bam\n  \"\"\"",
        "nb_lignes_script": 16,
        "language_script": "bash",
        "tools": [
            "GATK",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "genome",
            "index",
            "dict",
            "replicateId",
            "bam",
            "index",
            "variants_file",
            "variants_file_index"
        ],
        "nb_inputs": 8,
        "outputs": [
            "sampleId"
        ],
        "nb_outputs": 1,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$replicateId\"",
            "label \"mem_large\""
        ],
        "when": "",
        "stub": ""
    },
    "RNASEQ_CALL_VARIANTS": {
        "name_process": "RNASEQ_CALL_VARIANTS",
        "string_process": "\nprocess RNASEQ_CALL_VARIANTS {\n  tag \"$sampleId\"\n  label \"mem_xlarge\"\n\n  input:\n    path genome\n    path index\n    path dict\n    tuple val(sampleId), path(bam), path(bai)\n \n  output: \n    tuple val(sampleId), path('final.vcf')\n\n  script:\n  def bam_params = bam.collect{ \"-I $it\" }.join(' ')\n  \"\"\"\n  # fix absolute path in dict file\n  sed -i 's@UR:file:.*${genome}@UR:file:${genome}@g' $dict\n  \n  # Variant calling\n  gatk HaplotypeCaller \\\n          --native-pair-hmm-threads ${task.cpus} \\\n          --reference ${genome} \\\n          --output output.gatk.vcf.gz \\\n          ${bam_params} \\\n          --standard-min-confidence-threshold-for-calling 20.0 \\\n          --dont-use-soft-clipped-bases \n\n  # Variant filtering\n  gatk VariantFiltration \\\n          -R ${genome} -V output.gatk.vcf.gz \\\n          --cluster-window-size 35 --cluster-size 3 \\\n          --filter-name FS --filter-expression \\\"FS > 30.0\\\" \\\n          --filter-name QD --filter-expression \\\"QD < 2.0\\\" \\\n          -O final.vcf\n  \"\"\"\n}",
        "nb_lignes_process": 36,
        "string_script": "  def bam_params = bam.collect{ \"-I $it\" }.join(' ')\n  \"\"\"\n  # fix absolute path in dict file\n  sed -i 's@UR:file:.*${genome}@UR:file:${genome}@g' $dict\n  \n  # Variant calling\n  gatk HaplotypeCaller \\\n          --native-pair-hmm-threads ${task.cpus} \\\n          --reference ${genome} \\\n          --output output.gatk.vcf.gz \\\n          ${bam_params} \\\n          --standard-min-confidence-threshold-for-calling 20.0 \\\n          --dont-use-soft-clipped-bases \n\n  # Variant filtering\n  gatk VariantFiltration \\\n          -R ${genome} -V output.gatk.vcf.gz \\\n          --cluster-window-size 35 --cluster-size 3 \\\n          --filter-name FS --filter-expression \\\"FS > 30.0\\\" \\\n          --filter-name QD --filter-expression \\\"QD < 2.0\\\" \\\n          -O final.vcf\n  \"\"\"",
        "nb_lignes_script": 21,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genome",
            "index",
            "dict",
            "sampleId",
            "bam",
            "bai"
        ],
        "nb_inputs": 6,
        "outputs": [
            "sampleId"
        ],
        "nb_outputs": 1,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$sampleId\"",
            "label \"mem_xlarge\""
        ],
        "when": "",
        "stub": ""
    },
    "POST_PROCESS_VCF": {
        "name_process": "POST_PROCESS_VCF",
        "string_process": "\nprocess POST_PROCESS_VCF {\n  tag \"$sampleId\"\n  publishDir \"$params.results/$sampleId\" \n\n  input:\n    tuple val(sampleId), path('final.vcf')\n    tuple path('filtered.recode.vcf.gz'), path('filtered.recode.vcf.gz.tbi')\n  output: \n    tuple val(sampleId), path('final.vcf'), path('commonSNPs.diff.sites_in_files')\n  \n  script:\n  '''\n  grep -v '#' final.vcf | awk '$7~/PASS/' |perl -ne 'chomp($_); ($dp)=$_=~/DP\\\\=(\\\\d+)\\\\;/; if($dp>=8){print $_.\"\\\\n\"};' > result.DP8.vcf\n  \n  vcftools --vcf result.DP8.vcf --gzdiff filtered.recode.vcf.gz  --diff-site --out commonSNPs\n  '''\n}",
        "nb_lignes_process": 16,
        "string_script": "  '''\n  grep -v '#' final.vcf | awk '$7~/PASS/' |perl -ne 'chomp($_); ($dp)=$_=~/DP\\\\=(\\\\d+)\\\\;/; if($dp>=8){print $_.\"\\\\n\"};' > result.DP8.vcf\n  \n  vcftools --vcf result.DP8.vcf --gzdiff filtered.recode.vcf.gz  --diff-site --out commonSNPs\n  '''",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "sampleId"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sampleId"
        ],
        "nb_outputs": 1,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$sampleId\"",
            "publishDir \"$params.results/$sampleId\""
        ],
        "when": "",
        "stub": ""
    },
    "PREPARE_VCF_FOR_ASE": {
        "name_process": "PREPARE_VCF_FOR_ASE",
        "string_process": "\nprocess PREPARE_VCF_FOR_ASE {\n  tag \"$sampleId\"\n  publishDir \"$params.results/$sampleId\" \n\n  input: \n    tuple val(sampleId), path('final.vcf'), path('commonSNPs.diff.sites_in_files')\n  output: \n    tuple val(sampleId), path('known_snps.vcf.gz'), path('known_snps.vcf.gz.tbi')\n    path 'AF.histogram.pdf'\n\n  script:\n  '''\n  awk 'BEGIN{OFS=\"\\t\"} $4~/B/{print $1,$2,$3}' commonSNPs.diff.sites_in_files  > test.bed\n    \n  vcftools --vcf final.vcf --bed test.bed --recode --keep-INFO-all --stdout > known_snps.vcf\n\n  grep -v '#'  known_snps.vcf | awk -F '\\\\t' '{print $10}' \\\n               |awk -F ':' '{print $2}'|perl -ne 'chomp($_); \\\n               @v=split(/\\\\,/,$_); if($v[0]!=0 ||$v[1] !=0)\\\n               {print  $v[1]/($v[1]+$v[0]).\"\\\\n\"; }' |awk '$1!=1' \\\n               >AF.4R\n\n  gghist.R -i AF.4R -o AF.histogram.pdf\n  # Known SNPs have to be zipped and indexed for being used\n  bgzip -c known_snps.vcf  > known_snps.vcf.gz\n  tabix -p vcf known_snps.vcf.gz\n  '''\n}",
        "nb_lignes_process": 27,
        "string_script": "  '''\n  awk 'BEGIN{OFS=\"\\t\"} $4~/B/{print $1,$2,$3}' commonSNPs.diff.sites_in_files  > test.bed\n    \n  vcftools --vcf final.vcf --bed test.bed --recode --keep-INFO-all --stdout > known_snps.vcf\n\n  grep -v '#'  known_snps.vcf | awk -F '\\\\t' '{print $10}' \\\n               |awk -F ':' '{print $2}'|perl -ne 'chomp($_); \\\n               @v=split(/\\\\,/,$_); if($v[0]!=0 ||$v[1] !=0)\\\n               {print  $v[1]/($v[1]+$v[0]).\"\\\\n\"; }' |awk '$1!=1' \\\n               >AF.4R\n\n  gghist.R -i AF.4R -o AF.histogram.pdf\n  # Known SNPs have to be zipped and indexed for being used\n  bgzip -c known_snps.vcf  > known_snps.vcf.gz\n  tabix -p vcf known_snps.vcf.gz\n  '''",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "sampleId"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sampleId"
        ],
        "nb_outputs": 1,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$sampleId\"",
            "publishDir \"$params.results/$sampleId\""
        ],
        "when": "",
        "stub": ""
    },
    "ASE_KNOWNSNPS": {
        "name_process": "ASE_KNOWNSNPS",
        "string_process": "\nprocess ASE_KNOWNSNPS {\n  tag \"$sampleId\"\n  publishDir \"$params.results/$sampleId\" \n  label \"mem_large\"\n\n  input:\n    path genome\n    path index\n    path dict\n    tuple val(sampleId), path(vcf), path(tbi), path(bam), path(bai)\n  \n  output:\n    path \"ASE.tsv\"\n  \n  script:\n  def bam_params = bam.collect{ \"-I $it\" }.join(' ')\n  \"\"\"\n  gatk ASEReadCounter \\\n          -R ${genome} \\\n          -O ASE.tsv \\\n          ${bam_params} \\\n          -V ${vcf}\n  \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "  def bam_params = bam.collect{ \"-I $it\" }.join(' ')\n  \"\"\"\n  gatk ASEReadCounter \\\n          -R ${genome} \\\n          -O ASE.tsv \\\n          ${bam_params} \\\n          -V ${vcf}\n  \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genome",
            "index",
            "dict",
            "sampleId",
            "vcf",
            "tbi",
            "bam",
            "bai"
        ],
        "nb_inputs": 8,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "CRG-CNAG__CalliNGS-NF",
        "directive": [
            "tag \"$sampleId\"",
            "publishDir \"$params.results/$sampleId\"",
            "label \"mem_large\""
        ],
        "when": "",
        "stub": ""
    }
}