{
    "align": {
        "name_process": "align",
        "string_process": "\nprocess align {\n    publishDir \"${params.outdir}/aligned_reads\", mode:'copy'\n\t\n    input:\n    set pair_id, file(reads) from read_pairs_ch\n     \n    output:\n    file \"${pair_id}_aligned_reads.sam\" into aligned_reads_ch\n\t\n\tscript:\n    \"\"\"\n\tmodule load bwa/intel/0.7.15\n\tbwa mem -M -t ${task.cpus} ${ref} ${reads[0]} ${reads[1]} > ${pair_id}_aligned_reads.sam\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n\tmodule load bwa/intel/0.7.15\n\tbwa mem -M -t ${task.cpus} ${ref} ${reads[0]} ${reads[1]} > ${pair_id}_aligned_reads.sam\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "read_pairs_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "aligned_reads_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.outdir}/aligned_reads\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "markDuplicatesSpark": {
        "name_process": "markDuplicatesSpark",
        "string_process": "\nprocess markDuplicatesSpark {\n    publishDir \"${params.out}/dedup_sorted\", mode:'copy'\n\n    input:\n    set val(pair_id), file(aligned_reads) from aligned_reads_ch\n\n                                                     \n                                    \n    output:\n    set val(pair_id), \\\n\tval(1), \\\n\tfile(\"${pair_id}_sorted_dedup.bam\") \\\n\tinto bam_for_variant_calling, \\\n\tsorted_dedup_ch_for_metrics, \\\n\tbam_for_bqsr\n    set val(pair_id), \\\n\tfile (\"${pair_id}_dedup_metrics.txt\") \\\n\tinto dedup_qc_ch\n\n    script:\n    \"\"\"\n    module load $GATK\n    mkdir -p ${params.tmpdir}/${workflow.runName}/${pair_id}\n    gatk --java-options \"-Djava.io.tmpdir=${params.tmpdir}/${workflow.runName}/${pair_id}\" \\\n\t MarkDuplicatesSpark \\\n\t-I $aligned_reads \\\n\t-M ${pair_id}_dedup_metrics.txt \\\n\t-O ${pair_id}_sorted_dedup.bam \n    rm -r ${params.tmpdir}/${workflow.runName}/${pair_id}\n    \"\"\" \n}",
        "nb_lignes_process": 30,
        "string_script": "    \"\"\"\n    module load $GATK\n    mkdir -p ${params.tmpdir}/${workflow.runName}/${pair_id}\n    gatk --java-options \"-Djava.io.tmpdir=${params.tmpdir}/${workflow.runName}/${pair_id}\" \\\n\t MarkDuplicatesSpark \\\n\t-I $aligned_reads \\\n\t-M ${pair_id}_dedup_metrics.txt \\\n\t-O ${pair_id}_sorted_dedup.bam \n    rm -r ${params.tmpdir}/${workflow.runName}/${pair_id}\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "aligned_reads_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "pair_id",
            "",
            "bam_for_variant_calling",
            "sorted_dedup_ch_for_metrics",
            "bam_for_bqsr",
            "pair_id",
            "dedup_qc_ch"
        ],
        "nb_outputs": 7,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/dedup_sorted\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "getMetrics": {
        "name_process": "getMetrics",
        "string_process": "\nprocess getMetrics {\n    publishDir \"${params.out}/metrics\", mode:'copy'\n\n    input:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(sorted_dedup_reads) \\\n\tfrom sorted_dedup_ch_for_metrics\n\n    output:\n    set val(pair_id), \n\tfile(\"${pair_id}_alignment_metrics.txt\"), \\\n\tfile(\"${pair_id}_insert_metrics.txt\"), \\\n\tfile(\"${pair_id}_insert_size_histogram.pdf\"), \\\n\tfile(\"${pair_id}_depth_out.txt\") \\\n\tinto metrics_qc_ch\n\n    script:\n    \"\"\"\n    module load $PICARD\n    module load $R\n    module load $SAMTOOLS\n    java -jar \\$PICARD_JAR \\\n        CollectAlignmentSummaryMetrics \\\n\tR=${params.ref} \\\n        I=${sorted_dedup_reads} \\\n\tO=${pair_id}_alignment_metrics.txt\n    java -jar \\$PICARD_JAR \\\n        CollectInsertSizeMetrics \\\n        INPUT=${sorted_dedup_reads} \\\n\tOUTPUT=${pair_id}_insert_metrics.txt \\\n        HISTOGRAM_FILE=${pair_id}_insert_size_histogram.pdf \n    samtools depth -a ${sorted_dedup_reads} > ${pair_id}_depth_out.txt\n    \"\"\"\n}",
        "nb_lignes_process": 34,
        "string_script": "    \"\"\"\n    module load $PICARD\n    module load $R\n    module load $SAMTOOLS\n    java -jar \\$PICARD_JAR \\\n        CollectAlignmentSummaryMetrics \\\n\tR=${params.ref} \\\n        I=${sorted_dedup_reads} \\\n\tO=${pair_id}_alignment_metrics.txt\n    java -jar \\$PICARD_JAR \\\n        CollectInsertSizeMetrics \\\n        INPUT=${sorted_dedup_reads} \\\n\tOUTPUT=${pair_id}_insert_metrics.txt \\\n        HISTOGRAM_FILE=${pair_id}_insert_size_histogram.pdf \n    samtools depth -a ${sorted_dedup_reads} > ${pair_id}_depth_out.txt\n    \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "pair_id",
            "round",
            "sorted_dedup_ch_for_metrics"
        ],
        "nb_inputs": 3,
        "outputs": [
            "pair_id",
            "metrics_qc_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/metrics\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "haplotypeCaller": {
        "name_process": "haplotypeCaller",
        "string_process": "\nprocess haplotypeCaller {\n    input:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(input_bam) \\\n\tfrom bam_for_variant_calling.mix(recalibrated_bam_ch.take(num_samples))\n\n    output:\n    set val(pair_id), val(round), \\\n\tfile(\"${pair_id}_raw_variants_${round}.vcf\") \\\n\tinto hc_output_ch\n\n    script:\n    \"\"\"\n    module load $GATK\n    gatk HaplotypeCaller \\\n\t-R $ref \\\n\t-I $input_bam \\\n\t-O ${pair_id}_raw_variants_${round}.vcf \\\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    module load $GATK\n    gatk HaplotypeCaller \\\n\t-R $ref \\\n\t-I $input_bam \\\n\t-O ${pair_id}_raw_variants_${round}.vcf \\\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "pair_id",
            "round",
            "bam_for_variant_calling"
        ],
        "nb_inputs": 3,
        "outputs": [
            "round",
            "hc_output_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "selectVariants": {
        "name_process": "selectVariants",
        "string_process": "\nprocess selectVariants {\n    input:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(raw_variants) \\\n\tfrom hc_output_ch\n\n    output:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(\"${pair_id}_raw_snps_${round}.vcf\") \\\n\tinto raw_snps_ch\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(\"${pair_id}_raw_indels_${round}.vcf\") \\\n\tinto raw_indels_ch\n\n    script:\n    \"\"\"\n    module load $GATK\n    gatk SelectVariants \\\n\t-R $ref \\\n\t-V $raw_variants \\\n\t-select-type SNP \\\n\t-O ${pair_id}_raw_snps_${round}.vcf\n    gatk SelectVariants \\\n        -R $ref \\\n        -V $raw_variants \\\n        -select-type INDEL \\\n        -O ${pair_id}_raw_indels_${round}.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "    \"\"\"\n    module load $GATK\n    gatk SelectVariants \\\n\t-R $ref \\\n\t-V $raw_variants \\\n\t-select-type SNP \\\n\t-O ${pair_id}_raw_snps_${round}.vcf\n    gatk SelectVariants \\\n        -R $ref \\\n        -V $raw_variants \\\n        -select-type INDEL \\\n        -O ${pair_id}_raw_indels_${round}.vcf\n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "pair_id",
            "round",
            "hc_output_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "pair_id",
            "round",
            "raw_snps_ch",
            "pair_id",
            "round",
            "raw_indels_ch"
        ],
        "nb_outputs": 6,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "filterSnps": {
        "name_process": "filterSnps",
        "string_process": "\nprocess filterSnps {\n    publishDir \"${params.out}/filtered_snps\", mode:'copy'\n    \n    input:\n    set val(pair_id),\n\tval(round),\n\tfile(raw_snps) from raw_snps_ch\n\n    output:\n    set val(pair_id), \n\tval(round),\n\tfile(\"${pair_id}_filtered_snps_${round}.vcf\"),\n\tfile(\"${pair_id}_filtered_snps_${round}.vcf.idx\") \\\n\tinto filtered_snps_ch_1, filtered_snps_ch_2\n\n    script:\n    \"\"\"\n    module load $GATK\n    gatk VariantFiltration \\\n\t-R $ref \\\n\t-V $raw_snps \\\n\t-O ${pair_id}_filtered_snps_${round}.vcf \\\n\t-filter-name \"QD_filter\" -filter \"QD < 2.0\" \\\n\t-filter-name \"FS_filter\" -filter \"FS > 60.0\" \\\n\t-filter-name \"MQ_filter\" -filter \"MQ < 40.0\" \\\n\t-filter-name \"SOR_filter\" -filter \"SOR > 4.0\" \\\n\t-filter-name \"MQRankSum_filter\" -filter \"MQRankSum < -12.5\" \\\n\t-filter-name \"ReadPosRankSum_filter\" -filter \"ReadPosRankSum < -8.0\"\n    \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "    \"\"\"\n    module load $GATK\n    gatk VariantFiltration \\\n\t-R $ref \\\n\t-V $raw_snps \\\n\t-O ${pair_id}_filtered_snps_${round}.vcf \\\n\t-filter-name \"QD_filter\" -filter \"QD < 2.0\" \\\n\t-filter-name \"FS_filter\" -filter \"FS > 60.0\" \\\n\t-filter-name \"MQ_filter\" -filter \"MQ < 40.0\" \\\n\t-filter-name \"SOR_filter\" -filter \"SOR > 4.0\" \\\n\t-filter-name \"MQRankSum_filter\" -filter \"MQRankSum < -12.5\" \\\n\t-filter-name \"ReadPosRankSum_filter\" -filter \"ReadPosRankSum < -8.0\"\n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "raw_snps_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "filtered_snps_ch_1",
            "filtered_snps_ch_2"
        ],
        "nb_outputs": 2,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/filtered_snps\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "filterIndels": {
        "name_process": "filterIndels",
        "string_process": "\nprocess filterIndels {\n    publishDir \"${params.out}/filtered_indels\", mode:'copy'\n    \n    input:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(raw_indels) \\\n\tfrom raw_indels_ch\n\n    output:\n    set val(pair_id), \\\n\tfile(\"${pair_id}_filtered_indels_${round}.vcf\"), \\\n\tfile(\"${pair_id}_filtered_indels_${round}.vcf.idx\") \\\n\tinto filtered_indels_for_recal\n\n    script:\n    \"\"\"\n    module load $GATK\n    gatk VariantFiltration \\\n        -R $ref \\\n        -V $raw_indels \\\n        -O ${pair_id}_filtered_indels_${round}.vcf \\\n\t-filter-name \"QD_filter\" -filter \"QD < 2.0\" \\\n\t-filter-name \"FS_filter\" -filter \"FS > 200.0\" \\\n\t-filter-name \"SOR_filter\" -filter \"SOR > 10.0\"\n    \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "    \"\"\"\n    module load $GATK\n    gatk VariantFiltration \\\n        -R $ref \\\n        -V $raw_indels \\\n        -O ${pair_id}_filtered_indels_${round}.vcf \\\n\t-filter-name \"QD_filter\" -filter \"QD < 2.0\" \\\n\t-filter-name \"FS_filter\" -filter \"FS > 200.0\" \\\n\t-filter-name \"SOR_filter\" -filter \"SOR > 10.0\"\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "pair_id",
            "round",
            "raw_indels_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "pair_id",
            "filtered_indels_for_recal"
        ],
        "nb_outputs": 2,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/filtered_indels\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "bqsr": {
        "name_process": "bqsr",
        "string_process": "\nprocess bqsr{\n    publishDir \"${params.out}/bqsr\", mode:'copy'\n\n    input:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(input_bam), \\\n\tval(round), \\\n\tfile(filtered_snps), \\\n\tfile(filtered_snps_index), \\\n\tfile(filtered_indels), \\\n\tfile(filtered_indels_index) \\\n\tfrom bam_for_bqsr\n\t.join(filtered_snps_for_recal)\n\t.join(filtered_indels_for_recal)\n    \n    output:    \n    set val(pair_id), \\\n\tfile(\"${pair_id}_recal_data.table\"), \\\n\tfile(\"${pair_id}_post_recal_data.table\") \\\n\tinto analyze_covariates_in_ch\n    set val(pair_id), \\\n\tval(new_round), \\\n\tfile(\"${pair_id}_recal.bam\") \\\n\tinto recalibrated_bam_ch\n\n                                           \n                                            \n                               \n                                           \n                                              \n                                                       \n                                                     \n                                               \n    script:\n    new_round=round + 1\n    \"\"\"\n    echo \"New Round: \" $new_round\n    module load $GATK\n    gatk SelectVariants \\\n\t--exclude-filtered \\\n\t-V $filtered_snps \\\n\t-O ${pair_id}_bqsr_snps.vcf\n    gatk SelectVariants \\\n        --exclude-filtered \\\n        -V $filtered_indels \\\n        -O ${pair_id}_bqsr_indels.vcf\n    gatk BaseRecalibrator \\\n\t-R $ref \\\n\t-I $input_bam \\\n\t--known-sites ${pair_id}_bqsr_snps.vcf \\\n\t--known-sites ${pair_id}_bqsr_indels.vcf \\\n\t-O ${pair_id}_recal_data.table\n    gatk ApplyBQSR \\\n        -R $ref \\\n        -I $input_bam \\\n        -bqsr ${pair_id}_recal_data.table \\\n        -O ${pair_id}_recal.bam\n    gatk BaseRecalibrator \\\n        -R $ref \\\n\t-I ${pair_id}_recal.bam \\\n        --known-sites ${pair_id}_bqsr_snps.vcf \\\n\t--known-sites ${pair_id}_bqsr_indels.vcf \\\n\t-O ${pair_id}_post_recal_data.table\n    \"\"\"\t\n}",
        "nb_lignes_process": 65,
        "string_script": "    new_round=round + 1\n    \"\"\"\n    echo \"New Round: \" $new_round\n    module load $GATK\n    gatk SelectVariants \\\n\t--exclude-filtered \\\n\t-V $filtered_snps \\\n\t-O ${pair_id}_bqsr_snps.vcf\n    gatk SelectVariants \\\n        --exclude-filtered \\\n        -V $filtered_indels \\\n        -O ${pair_id}_bqsr_indels.vcf\n    gatk BaseRecalibrator \\\n\t-R $ref \\\n\t-I $input_bam \\\n\t--known-sites ${pair_id}_bqsr_snps.vcf \\\n\t--known-sites ${pair_id}_bqsr_indels.vcf \\\n\t-O ${pair_id}_recal_data.table\n    gatk ApplyBQSR \\\n        -R $ref \\\n        -I $input_bam \\\n        -bqsr ${pair_id}_recal_data.table \\\n        -O ${pair_id}_recal.bam\n    gatk BaseRecalibrator \\\n        -R $ref \\\n\t-I ${pair_id}_recal.bam \\\n        --known-sites ${pair_id}_bqsr_snps.vcf \\\n\t--known-sites ${pair_id}_bqsr_indels.vcf \\\n\t-O ${pair_id}_post_recal_data.table\n    \"\"\"",
        "nb_lignes_script": 29,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "pair_id",
            "round",
            "input_bam",
            "round",
            "filtered_snps",
            "filtered_snps_index",
            "filtered_indels",
            "bam_for_bqsr",
            "filtered_snps_for_recal",
            "filtered_indels_for_recal"
        ],
        "nb_inputs": 10,
        "outputs": [
            "pair_id",
            "analyze_covariates_in_ch",
            "pair_id",
            "new_round",
            "recalibrated_bam_ch"
        ],
        "nb_outputs": 5,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/bqsr\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "analyzeCovariates": {
        "name_process": "analyzeCovariates",
        "string_process": "\nprocess analyzeCovariates{\n    publishDir \"${params.out}/bqsr\", mode:'copy'\n\n    input:\n    set val(pair_id), file(recal_table), file(post_recal_table) \\\n\t from analyze_covariates_in_ch\n\n    output:\n    set val(pair_id), file(\"${pair_id}_recalibration_plots.pdf\") \\\n\tinto analyzed_covariates_ch\n\n    script:\n    \"\"\"\n    module load $R\n    module load $GATK\n    gatk AnalyzeCovariates \\\n\t-before $recal_table \\\n\t-after $post_recal_table \\\n\t-plots ${pair_id}_recalibration_plots.pdf\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    module load $R\n    module load $GATK\n    gatk AnalyzeCovariates \\\n\t-before $recal_table \\\n\t-after $post_recal_table \\\n\t-plots ${pair_id}_recalibration_plots.pdf\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "analyze_covariates_in_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "analyzed_covariates_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/bqsr\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "snpEff": {
        "name_process": "snpEff",
        "string_process": "\nprocess snpEff {\n    publishDir \"${params.out}/snpeff\", mode:'copy'    \n\n    input:\n    set val(pair_id), \\\n\tval(round), \\\n\tfile(filtered_snps), \\\n\tfile(filtered_snps_index) \\\n\tfrom filtered_snps_for_snpeff\n\n    output:\n    file '*' into snpeff_out\n\n    script:\n    \"\"\"\n    module load $SNPEFF\n    java -jar \\$SNPEFF_JAR -v \\\n\t-dataDir $params.snpeff_data \\\n\t$params.snpeff_db \\\n\t$filtered_snps > ${pair_id}_filtered_snps.ann.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    module load $SNPEFF\n    java -jar \\$SNPEFF_JAR -v \\\n\t-dataDir $params.snpeff_data \\\n\t$params.snpeff_db \\\n\t$filtered_snps > ${pair_id}_filtered_snps.ann.vcf\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "pair_id",
            "round",
            "filtered_snps",
            "filtered_snps_for_snpeff"
        ],
        "nb_inputs": 4,
        "outputs": [
            "snpeff_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.out}/snpeff\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "qc": {
        "name_process": "qc",
        "string_process": "\nprocess qc {\n    input:\n    set val(pair_id), \\\n\tfile(\"${pair_id}_dedup_metrics.txt\"), \\\n\tfile(\"${pair_id}_alignment_metrics.txt\"), \\\n        file(\"${pair_id}_insert_metrics.txt\"), \\\n        file(\"${pair_id}_insert_size_histogram.pdf\"), \\\n        file(\"${pair_id}_depth_out.txt\"), \\\n\tval(round_1), \\\n        file(\"${pair_id}_filtered_snps_1.vcf\"), \\\n        file(\"${pair_id}_filtered_snps_1.vcf.idx\"), \\\n\tval(round_2), \\\n        file(\"${pair_id}_filtered_snps_2.vcf\"), \\\n        file(\"${pair_id}_filtered_snps_2.vcf.idx\") \\\n\tfrom dedup_qc_ch\n\t.join(metrics_qc_ch)\n        .join(snps_1_qc_ch)\n        .join(snps_2_qc_ch)\n\n    output:\n    file (\"${pair_id}_report.csv\") into qc_output\n\n    script:\n    \"\"\"\n    parse_metrics.sh ${pair_id} > ${pair_id}_report.csv\n    \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "    \"\"\"\n    parse_metrics.sh ${pair_id} > ${pair_id}_report.csv\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "pair_id",
            "round_1",
            "round_2",
            "dedup_qc_ch",
            "metrics_qc_ch",
            "snps_1_qc_ch",
            "snps_2_qc_ch"
        ],
        "nb_inputs": 7,
        "outputs": [
            "qc_output"
        ],
        "nb_outputs": 1,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "extract": {
        "name_process": "extract",
        "string_process": "\nprocess extract {\n    publishDir \"${params.outdir}/extracted\", mode:'copy'\n\t\n    input:\n    file aligned_reads from aligned_reads_ch\n     \n    output:\n    file \"${aligned_reads}_unmapped.sam\" into unmapped_ch\n\t\n    script:\n    \"\"\"\n    module load samtools/intel/1.6\n    samtools view -f 12 -F 256 $aligned_reads > ${aligned_reads}_unmapped.sam\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    module load samtools/intel/1.6\n    samtools view -f 12 -F 256 $aligned_reads > ${aligned_reads}_unmapped.sam\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "aligned_reads_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "unmapped_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.outdir}/extracted\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "sam2fastq": {
        "name_process": "sam2fastq",
        "string_process": "\nprocess sam2fastq {\n    publishDir \"${params.outdir}/sam2fastq\", mode:'copy'\n\t\n    input:\n    file unmapped_sam from unmapped_ch\n\t\n    output:\n    file \"${unmapped_sam}.R{1,2}.fastq\" into unmapped_fastq_ch, unmapped_fastq_ch2\n    file \"${unmapped_sam}.merged.fastq\" into unmapped_merged_fastq_ch\n\t\n    script:\n    \"\"\"\n    module load picard/2.17.11\n    java -jar -Xmx2g \\$PICARD_JAR SamToFastq I=$unmapped_sam F=${unmapped_sam}.R1.fastq F2=${unmapped_sam}.R2.fastq\n    cat ${unmapped_sam}.R1.fastq ${unmapped_sam}.R2.fastq > ${unmapped_sam}.merged.fastq\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    module load picard/2.17.11\n    java -jar -Xmx2g \\$PICARD_JAR SamToFastq I=$unmapped_sam F=${unmapped_sam}.R1.fastq F2=${unmapped_sam}.R2.fastq\n    cat ${unmapped_sam}.R1.fastq ${unmapped_sam}.R2.fastq > ${unmapped_sam}.merged.fastq\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "unmapped_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "unmapped_fastq_ch",
            "unmapped_fastq_ch2",
            "unmapped_merged_fastq_ch"
        ],
        "nb_outputs": 3,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.outdir}/sam2fastq\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "spades": {
        "name_process": "spades",
        "string_process": "\nprocess spades {\n    publishDir \"${params.outdir}\", mode:'copy'\n\t\n    input:\n    file(reads) from unmapped_fastq_ch\n\n    output:\n    file '*' into spades_out_channel\n\t\n    script:\n    \"\"\"\n    module load spades/gnu/3.10.1\n    spades.py --meta -t 20 -m 300 -o spades -1 ${reads[0]} -2 ${reads[1]}\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    module load spades/gnu/3.10.1\n    spades.py --meta -t 20 -m 300 -o spades -1 ${reads[0]} -2 ${reads[1]}\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "unmapped_fastq_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "spades_out_channel"
        ],
        "nb_outputs": 1,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.outdir}\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "kraken": {
        "name_process": "kraken",
        "string_process": "\nprocess kraken {\n    publishDir \"${params.outdir}/kraken\", mode:'copy'\n\t\n    input:\n    file(reads) from unmapped_fastq_ch2\n    file kraken_db_path\n\n    output:\n    file \"kraken_out.txt\" into kraken_out_channel, kraken_out_channel2\n    file \"kraken_unclassified_out.txt\" into kraken_unclassified_out_channel\n    file \"kraken_classified_out.txt\" into kraken_classified_out_channel\n\n    script:\n    \"\"\"\n    module load kraken/intel/1.0\n    kraken \\\n    --threads ${task.cpus} \\\n    --fastq-input \\\n    --output kraken_out.txt \\\n    --preload \\\n    --db $kraken_db_path \\\n    --check-names \\\n    --unclassified-out kraken_unclassified_out.txt \\\n    --classified-out kraken_classified_out.txt \\\n    --paired ${reads[0]} ${reads[1]}    \n    \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "    \"\"\"\n    module load kraken/intel/1.0\n    kraken \\\n    --threads ${task.cpus} \\\n    --fastq-input \\\n    --output kraken_out.txt \\\n    --preload \\\n    --db $kraken_db_path \\\n    --check-names \\\n    --unclassified-out kraken_unclassified_out.txt \\\n    --classified-out kraken_classified_out.txt \\\n    --paired ${reads[0]} ${reads[1]}    \n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "Kraken"
        ],
        "tools_url": [
            "https://bio.tools/kraken"
        ],
        "tools_dico": [
            {
                "name": "Kraken",
                "uri": "https://bio.tools/kraken",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3174",
                            "term": "Metagenomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0637",
                            "term": "Taxonomy"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3460",
                                    "term": "Taxonomic classification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3460",
                                    "term": "Taxonomy assignment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3494",
                                "term": "DNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3028",
                                "term": "Taxonomy"
                            }
                        ]
                    }
                ],
                "description": "System for assigning taxonomic labels to short DNA sequences, usually obtained through metagenomic studies. Previous attempts by other bioinformatics software to accomplish this task have often used sequence alignment or machine learning techniques that were quite slow, leading to the development of less sensitive but much faster abundance estimation programs. It aims to achieve high sensitivity and high speed by utilizing exact alignments of k-mers and a novel classification algorithm.",
                "homepage": "https://ccb.jhu.edu/software/kraken/"
            }
        ],
        "inputs": [
            "unmapped_fastq_ch2",
            "kraken_db_path"
        ],
        "nb_inputs": 2,
        "outputs": [
            "kraken_out_channel",
            "kraken_out_channel2",
            "kraken_unclassified_out_channel",
            "kraken_classified_out_channel"
        ],
        "nb_outputs": 4,
        "name_workflow": "gencorefacility__nf-workflows",
        "directive": [
            "publishDir \"${params.outdir}/kraken\", mode:'copy'"
        ],
        "when": "",
        "stub": ""
    }
}