{
    "snpeff_annotate_vcf": {
        "name_process": "snpeff_annotate_vcf",
        "string_process": "\nprocess snpeff_annotate_vcf {\n\n                                                                \n    label 'annotation'\n\n    publishDir \"${params.output}/variation\", mode: 'copy', pattern: '*.snpeff.vcf*'\n    publishDir \"${params.output}/variation\", mode: 'copy', pattern: 'snpeff.stats.csv'\n\n    input:\n        tuple file(vcf), file(vcf_index), \\\n              path(vcfanno), \\\n              path(\"dust.bed.gz\"), \\\n              path(\"dust.bed.gz.tbi\"), \\\n              path(\"repeat_masker.bed.gz\"), \\\n              path(\"repeat_masker.bed.gz.tbi\")\n\n    output:\n        tuple path(\"*.snpeff.vcf.gz\"), path(\"*.snpeff.vcf.gz.tbi\"), emit: snpeff_vcf\n        path \"snpeff.stats.csv\"\n        path \"WI-snpeff.tsv\", emit: snpeff_flat\n\n\n    script:\n    \"\"\"\n        bcftools view -O v ${vcf} | \\\\\n        snpEff eff -csvStats snpeff.stats.csv \\\\\n                   -no-downstream \\\\\n                   -no-intergenic \\\\\n                   -no-upstream \\\\\n                   -nodownload \\\\\n        -dataDir ${params.snpeff_dir} \\\\\n        -config ${params.snpeff_dir}/snpEff.config \\\\\n        ${params.snpeff_reference} | \\\\\n        bcftools view -O z > out.vcf.gz\n\n\n        if [ ${params.species} = \"c_elegans\" ]\n        then\n            vcfanno ${vcfanno} out.vcf.gz | bcftools view -O z > WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n            bcftools index --tbi WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n        else\n            mv out.vcf.gz WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n            bcftools index --tbi WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n        fi\n\n        bcftools query -e 'INFO/ANN=\".\"' -f'%CHROM %POS %ID %REF %ALT %QUAL %FILTER %ANN\\n' WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz > WI-snpeff.tsv\n\n    \"\"\"\n\n}",
        "nb_lignes_process": 49,
        "string_script": "    \"\"\"\n        bcftools view -O v ${vcf} | \\\\\n        snpEff eff -csvStats snpeff.stats.csv \\\\\n                   -no-downstream \\\\\n                   -no-intergenic \\\\\n                   -no-upstream \\\\\n                   -nodownload \\\\\n        -dataDir ${params.snpeff_dir} \\\\\n        -config ${params.snpeff_dir}/snpEff.config \\\\\n        ${params.snpeff_reference} | \\\\\n        bcftools view -O z > out.vcf.gz\n\n\n        if [ ${params.species} = \"c_elegans\" ]\n        then\n            vcfanno ${vcfanno} out.vcf.gz | bcftools view -O z > WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n            bcftools index --tbi WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n        else\n            mv out.vcf.gz WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n            bcftools index --tbi WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz\n        fi\n\n        bcftools query -e 'INFO/ANN=\".\"' -f'%CHROM %POS %ID %REF %ALT %QUAL %FILTER %ANN\\n' WI.${params.date}.hard-filter.isotype.snpeff.vcf.gz > WI-snpeff.tsv\n\n    \"\"\"",
        "nb_lignes_script": 24,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "snpEff",
            "vcfanno"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/snpeff",
            "https://bio.tools/vcfanno"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "snpEff",
                "uri": "https://bio.tools/snpeff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "Single nucleotide polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP discovery"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP calling"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            },
                            {
                                "uri": "http://edamontology.org/data_3002",
                                "term": "Annotation track"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Variant annotation and effect prediction tool. It annotates and predicts the effects of variants on genes and proteins (such as amino acid changes).",
                "homepage": "http://snpeff.sourceforge.net/"
            },
            {
                "name": "vcfanno",
                "uri": "https://bio.tools/vcfanno",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0219",
                            "term": "Data submission, annotation and curation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3661",
                                    "term": "SNP annotation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fast, flexible annotation of genetic variants.",
                "homepage": "https://github.com/brentp/vcfanno"
            }
        ],
        "inputs": [
            "vcf",
            "vcf_index",
            "vcfanno"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "publishDir \"${params.output}/variation\", mode: 'copy', pattern: '*.snpeff.vcf*'",
            "publishDir \"${params.output}/variation\", mode: 'copy', pattern: 'snpeff.stats.csv'"
        ],
        "when": "",
        "stub": ""
    },
    "bcsq_annotate_vcf": {
        "name_process": "bcsq_annotate_vcf",
        "string_process": "\nprocess bcsq_annotate_vcf {\n\n                                                \n                                                           \n    label 'annotation'\n\n    memory 16.GB\n\n    input:\n        tuple file(vcf), file(vcf_index), file(gff)\n\n\n    output:\n        tuple file(\"bcsq.vcf.gz\"), file(\"bcsq.vcf.gz.tbi\"), emit:bcsq_vcf\n        path \"WI-BCSQ.tsv\", emit:bcsq_tsv\n\n    script:\n    \"\"\"\n        # bgzip -c $gff > csq.gff.gz\n        cp $gff csq.gff.gz\n        # tabix -p gff csq.gff.gz\n\n        bcftools csq -O z --fasta-ref ${params.reference} \\\\\n                     --gff-annot csq.gff.gz \\\\\n                     --ncsq ${params.ncsq_param} \\\\\n                     --phase a $vcf > bcsq.vcf.gz\n\n        bcftools index --tbi bcsq.vcf.gz\n\n        bcftools query -e 'INFO/BCSQ=\".\"' -f'%CHROM %POS %ID %REF %ALT %QUAL %FILTER %BCSQ\\n' bcsq.vcf.gz > WI-BCSQ.tsv\n    \"\"\"\n\n}",
        "nb_lignes_process": 32,
        "string_script": "    \"\"\"\n        # bgzip -c $gff > csq.gff.gz\n        cp $gff csq.gff.gz\n        # tabix -p gff csq.gff.gz\n\n        bcftools csq -O z --fasta-ref ${params.reference} \\\\\n                     --gff-annot csq.gff.gz \\\\\n                     --ncsq ${params.ncsq_param} \\\\\n                     --phase a $vcf > bcsq.vcf.gz\n\n        bcftools index --tbi bcsq.vcf.gz\n\n        bcftools query -e 'INFO/BCSQ=\".\"' -f'%CHROM %POS %ID %REF %ALT %QUAL %FILTER %BCSQ\\n' bcsq.vcf.gz > WI-BCSQ.tsv\n    \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf",
            "vcf_index",
            "gff"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "memory 16.GB"
        ],
        "when": "",
        "stub": ""
    },
    "prep_other_annotation": {
        "name_process": "prep_other_annotation",
        "string_process": "\nprocess prep_other_annotation {\n\n                                                                  \n    label 'R'\n    echo true\n    memory 16.GB\n\n    input:\n        tuple path(\"WI-BCSQ.tsv\"), path(\"gff_AA_Length.tsv\"), path(\"AA_Scores.tsv\")\n\n    output:\n        path(\"anno_vcf.vcf\")\n\n    \"\"\"\n      Rscript --vanilla ${workflow.projectDir}/bin/make_vcf_annotation.R WI-BCSQ.tsv AA_Scores.tsv gff_AA_Length.tsv\n    \"\"\"\n\n                                                                                  \n\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n      Rscript --vanilla ${workflow.projectDir}/bin/make_vcf_annotation.R WI-BCSQ.tsv AA_Scores.tsv gff_AA_Length.tsv\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'R'",
            "echo true",
            "memory 16.GB"
        ],
        "when": "",
        "stub": ""
    },
    "AA_annotate_vcf": {
        "name_process": "AA_annotate_vcf",
        "string_process": "\nprocess AA_annotate_vcf {\n\n                                                                \n    label 'annotation'\n\n    publishDir \"${params.output}/variation\", mode: 'copy'\n\n    memory 16.GB\n\n    input:\n        tuple file(vcf), file(vcf_index), file(\"anno_vcf.vcf\"), file(vcfanno), \\\n        file(\"dust.bed.gz\"), file(\"dust.bed.gz.tbi\"), file(\"repeat_masker.bed.gz\"), file(\"repeat_masker.bed.gz.tbi\")\n\n    output:\n        tuple file(\"*hard-filter.isotype.bcsq.vcf.gz\"), file(\"*hard-filter.isotype.bcsq.vcf.gz.tbi\"), emit: vcfanno_vcf\n        file(\"*.stats.txt\")\n\n\n    \"\"\"\n        bcftools reheader -h ${workflow.projectDir}/bin/new_header anno_vcf.vcf > header_anno_vcf.vcf\n        bgzip header_anno_vcf.vcf\n\t\tbcftools index -t header_anno_vcf.vcf.gz\n\n        # change vcfanno config\n        cat ${vcfanno} | sed 's/REPLACE_HEADER_VCF/header_anno_vcf.vcf.gz/' > vcfanno.config\n\n\t\tvcfanno vcfanno.config $vcf | bcftools view -O z > WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz\n        bcftools index --tbi WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz\n        bcftools stats -s- WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz > WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz.stats.txt\n\n    \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "\"\"\"\n        bcftools reheader -h ${workflow.projectDir}/bin/new_header anno_vcf.vcf > header_anno_vcf.vcf\n        bgzip header_anno_vcf.vcf\n\t\tbcftools index -t header_anno_vcf.vcf.gz\n\n        # change vcfanno config\n        cat ${vcfanno} | sed 's/REPLACE_HEADER_VCF/header_anno_vcf.vcf.gz/' > vcfanno.config\n\n\t\tvcfanno vcfanno.config $vcf | bcftools view -O z > WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz\n        bcftools index --tbi WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz\n        bcftools stats -s- WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz > WI.${params.date}.hard-filter.isotype.bcsq.vcf.gz.stats.txt\n\n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "vcfanno"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/vcfanno"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "vcfanno",
                "uri": "https://bio.tools/vcfanno",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0219",
                            "term": "Data submission, annotation and curation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3661",
                                    "term": "SNP annotation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fast, flexible annotation of genetic variants.",
                "homepage": "https://github.com/brentp/vcfanno"
            }
        ],
        "inputs": [
            "vcf",
            "vcf_index",
            "vcfanno"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "publishDir \"${params.output}/variation\", mode: 'copy'",
            "memory 16.GB"
        ],
        "when": "",
        "stub": ""
    },
    "bcsq_extract_samples": {
        "name_process": "bcsq_extract_samples",
        "string_process": "\nprocess bcsq_extract_samples {\n\n\n                                                           \n    label 'annotation'\n\n    memory 16.GB\n\n    input:\n        tuple file(bcsq_vcf), file(bcsq_vcf_index), file(divergent_regions)\n\n    output:\n        tuple file(\"BCSQ_samples.tsv\"), file(\"div.bed\")\n\n    \"\"\"\n        # Extract samples\n        bcftools view -e 'INFO/BCSQ=\".\"' -Ou ${bcsq_vcf}  | \\\\\n        bcftools query -i 'GT =\"alt\"' -f'%CHROM\\t%POS\\t%REF\\t%ALT\\t[%SAMPLE:%TBCSQ{*}=]\\n' > BCSQ_samples.tsv\n\n        # format divergent file\n        bedtools merge -i ${divergent_regions} > div.bed\n    \"\"\"\n\n}",
        "nb_lignes_process": 23,
        "string_script": "\"\"\"\n        # Extract samples\n        bcftools view -e 'INFO/BCSQ=\".\"' -Ou ${bcsq_vcf}  | \\\\\n        bcftools query -i 'GT =\"alt\"' -f'%CHROM\\t%POS\\t%REF\\t%ALT\\t[%SAMPLE:%TBCSQ{*}=]\\n' > BCSQ_samples.tsv\n\n        # format divergent file\n        bedtools merge -i ${divergent_regions} > div.bed\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "bcsq_vcf",
            "bcsq_vcf_index",
            "divergent_regions"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "memory 16.GB"
        ],
        "when": "",
        "stub": ""
    },
    "bcsq_extract_scores": {
        "name_process": "bcsq_extract_scores",
        "string_process": "\nprocess bcsq_extract_scores {\n\n\n                                                           \n    label 'annotation'\n\n    memory 16.GB\n\n    input:\n        tuple file(bcsq_vcf), file(bcsq_vcf_index)\n\n    output:\n        path \"BCSQ_scores.tsv\"\n\n    \"\"\"\n        # Extract scores\n        bcftools view -e 'INFO/BCSQ=\".\"' -Ou ${bcsq_vcf} | \\\\\n        bcftools query -i 'GT =\"alt\"' -f'%CHROM\\t%POS\\t%REF\\t%ALT\\t%BCSQ\\t%BLOSUM\\t%GRANTHAM\\t%PERCENT_PROTEIN\\n' > BCSQ_scores.tsv\n\n    \"\"\"\n\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n        # Extract scores\n        bcftools view -e 'INFO/BCSQ=\".\"' -Ou ${bcsq_vcf} | \\\\\n        bcftools query -i 'GT =\"alt\"' -f'%CHROM\\t%POS\\t%REF\\t%ALT\\t%BCSQ\\t%BLOSUM\\t%GRANTHAM\\t%PERCENT_PROTEIN\\n' > BCSQ_scores.tsv\n\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bcsq_vcf",
            "bcsq_vcf_index"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "memory 16.GB"
        ],
        "when": "",
        "stub": ""
    },
    "bcsq_parse_scores": {
        "name_process": "bcsq_parse_scores",
        "string_process": "\nprocess bcsq_parse_scores {\n\n\n                                                                  \n    label 'R'\n\n    memory 16.GB\n\n    input:\n        file(bcsq_scores)\n\n    output:\n        path \"BCSQ_scores_parsed.tsv\"\n\n    \"\"\"\n        Rscript --vanilla ${workflow.projectDir}/bin/parse_scores_bcsq.R $bcsq_scores\n    \"\"\"\n\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n        Rscript --vanilla ${workflow.projectDir}/bin/parse_scores_bcsq.R $bcsq_scores\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bcsq_scores"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'R'",
            "memory 16.GB"
        ],
        "when": "",
        "stub": ""
    },
    "bcsq_parse_samples": {
        "name_process": "bcsq_parse_samples",
        "string_process": "\nprocess bcsq_parse_samples {\n\n\n                                                                  \n    label 'R'\n\n    memory 64.GB\n\n    input:\n        tuple file(bcsq_samples), file(div_file)\n\n    output:\n        tuple file(\"BCSQ_samples_parsed.tsv\"), file(\"div.bed\")\n\n    \"\"\"\n        Rscript --vanilla ${workflow.projectDir}/bin/parse_samples_bcsq.R $bcsq_samples\n    \"\"\"\n\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n        Rscript --vanilla ${workflow.projectDir}/bin/parse_samples_bcsq.R $bcsq_samples\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bcsq_samples",
            "div_file"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'R'",
            "memory 64.GB"
        ],
        "when": "",
        "stub": ""
    },
    "make_flat_file": {
        "name_process": "make_flat_file",
        "string_process": "\nprocess make_flat_file {\n\n\n                                                                  \n    label 'R'\n    publishDir \"${params.output}/variation\", mode: 'copy'\n\n                  \n\n    memory 48.GB\n\n    input:\n        tuple file(bcsq_samples_parsed), file(div_file), file(bcsq_scores), file(wbgene_names), file(snpeff)\n\n    output:\n        path \"*.strain-annotation.tsv\"\n\n    \"\"\"\n        Rscript --vanilla ${workflow.projectDir}/bin/make_flat_file.R $bcsq_samples_parsed $bcsq_scores $wbgene_names $div_file ${snpeff} ${params.species}\n\n        # rename flatfile\n        mv WI-annotated-flatfile.tsv WI.${params.date}.strain-annotation.tsv\n    \"\"\"\n\n}",
        "nb_lignes_process": 24,
        "string_script": "\"\"\"\n        Rscript --vanilla ${workflow.projectDir}/bin/make_flat_file.R $bcsq_samples_parsed $bcsq_scores $wbgene_names $div_file ${snpeff} ${params.species}\n\n        # rename flatfile\n        mv WI-annotated-flatfile.tsv WI.${params.date}.strain-annotation.tsv\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bcsq_samples_parsed",
            "div_file",
            "bcsq_scores",
            "wbgene_names",
            "snpeff"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'R'",
            "publishDir \"${params.output}/variation\", mode: 'copy'",
            "memory 48.GB"
        ],
        "when": "",
        "stub": ""
    },
    "strain_list": {
        "name_process": "strain_list",
        "string_process": "\nprocess strain_list {\n\n                                                                \n    label 'annotation'\n\n    input:\n        tuple path(vcf), path(vcf_index)\n    \n    output:\n        file(\"samples.txt\")\n\n    \"\"\"\n        bcftools query --list-samples ${vcf} > samples.txt\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "\"\"\"\n        bcftools query --list-samples ${vcf} > samples.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf",
            "vcf_index"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'"
        ],
        "when": "",
        "stub": ""
    },
    "generate_strain_vcf": {
        "name_process": "generate_strain_vcf",
        "string_process": "\nprocess generate_strain_vcf {\n                                              \n\n                                                                \n    label 'annotation'\n\n    tag { strain }\n\n    publishDir \"${params.output}/strain_vcf\", mode: 'copy', pattern: \"*.vcf.gz*\"\n\n    input:\n        tuple val(strain), path(vcf), file(vcf_index)\n\n    output:\n        path(\"*.vcf.gz*\")\n                                                                                                                              \n\n    \"\"\"\n        bcftools view -s ${strain} ${vcf} > ${strain}.${params.date}.vcf\n        bgzip ${strain}.${params.date}.vcf\n        bcftools index -c ${strain}.${params.date}.vcf.gz\n        bcftools index -t ${strain}.${params.date}.vcf.gz\n\n        # keep both isotype and ref strain\n        if grep -q $strain ${workflow.projectDir}/bin/isotype_ref_strain.tsv; \n        then\n            new_strain=`grep ${strain} ${workflow.projectDir}/bin/isotype_ref_strain.tsv | awk '{print \\$2}'`\n            bcftools reheader --samples ${workflow.projectDir}/bin/isotype_ref_strain.tsv ${strain}.${params.date}.vcf.gz | \\\\\n            bcftools view -Oz > \\$new_strain.20220207.vcf.gz\n\n            bcftools index -c \\$new_strain.20220207.vcf.gz\n            bcftools index -t \\$new_strain.20220207.vcf.gz\n        fi\n\n    \"\"\"\n\n}",
        "nb_lignes_process": 36,
        "string_script": "\"\"\"\n        bcftools view -s ${strain} ${vcf} > ${strain}.${params.date}.vcf\n        bgzip ${strain}.${params.date}.vcf\n        bcftools index -c ${strain}.${params.date}.vcf.gz\n        bcftools index -t ${strain}.${params.date}.vcf.gz\n\n        # keep both isotype and ref strain\n        if grep -q $strain ${workflow.projectDir}/bin/isotype_ref_strain.tsv; \n        then\n            new_strain=`grep ${strain} ${workflow.projectDir}/bin/isotype_ref_strain.tsv | awk '{print \\$2}'`\n            bcftools reheader --samples ${workflow.projectDir}/bin/isotype_ref_strain.tsv ${strain}.${params.date}.vcf.gz | \\\\\n            bcftools view -Oz > \\$new_strain.20220207.vcf.gz\n\n            bcftools index -c \\$new_strain.20220207.vcf.gz\n            bcftools index -t \\$new_strain.20220207.vcf.gz\n        fi\n\n    \"\"\"",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "strain",
            "vcf_index",
            "vcf"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "tag { strain }",
            "publishDir \"${params.output}/strain_vcf\", mode: 'copy', pattern: \"*.vcf.gz*\""
        ],
        "when": "",
        "stub": ""
    },
    "snpeff_severity_tracks": {
        "name_process": "snpeff_severity_tracks",
        "string_process": "\nprocess snpeff_severity_tracks {\n      \n                                                             \n           \n                \n            \n                \n                                         \n                                                                                                                          \n      \n\n                                                                \n    label 'annotation'\n\n    publishDir \"${params.output}/tracks/snpeff/\", mode: 'copy'\n\n    tag { severity }\n\n    input:\n        tuple path(\"in.vcf.gz\"), path(\"in.vcf.gz.csi\"), val(severity)\n    output:\n        set file(\"${params.date}.${severity}.bed.gz\"), file(\"${params.date}.${severity}.bed.gz.tbi\")\n\n    \"\"\"\n        bcftools view --apply-filters PASS in.vcf.gz | \\\n        grep ${severity} | \\\n        awk '\\$0 !~ \"^#\" { print \\$1 \"\\\\t\" (\\$2 - 1) \"\\\\t\" (\\$2)  \"\\\\t\" \\$1 \":\" \\$2 \"\\\\t0\\\\t+\"  \"\\\\t\" \\$2 - 1 \"\\\\t\" \\$2 \"\\\\t0\\\\t1\\\\t1\\\\t0\" }' | \\\\\n        bgzip  > ${params.date}.${severity}.bed.gz\n        tabix -p bed ${params.date}.${severity}.bed.gz\n        fsize=\\$(zcat ${params.date}.${severity}.bed.gz | wc -c)\n        if [ \\${fsize} -lt 2000 ]; then\n            exit 1\n        fi;\n    \"\"\"\n}",
        "nb_lignes_process": 34,
        "string_script": "\"\"\"\n        bcftools view --apply-filters PASS in.vcf.gz | \\\n        grep ${severity} | \\\n        awk '\\$0 !~ \"^#\" { print \\$1 \"\\\\t\" (\\$2 - 1) \"\\\\t\" (\\$2)  \"\\\\t\" \\$1 \":\" \\$2 \"\\\\t0\\\\t+\"  \"\\\\t\" \\$2 - 1 \"\\\\t\" \\$2 \"\\\\t0\\\\t1\\\\t1\\\\t0\" }' | \\\\\n        bgzip  > ${params.date}.${severity}.bed.gz\n        tabix -p bed ${params.date}.${severity}.bed.gz\n        fsize=\\$(zcat ${params.date}.${severity}.bed.gz | wc -c)\n        if [ \\${fsize} -lt 2000 ]; then\n            exit 1\n        fi;\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "severity"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "publishDir \"${params.output}/tracks/snpeff/\", mode: 'copy'",
            "tag { severity }"
        ],
        "when": "",
        "stub": ""
    },
    "bcsq_severity_tracks": {
        "name_process": "bcsq_severity_tracks",
        "string_process": "\nprocess bcsq_severity_tracks {\n\n                                                                \n    label 'annotation'\n\n    publishDir \"${params.output}/tracks/bcsq/\", mode: 'copy'\n\n    tag { severity }\n\n    input:\n        tuple path(\"flatfile\"), val(severity)\n    output:\n        tuple file(\"${params.date}.${severity}.bed.gz\"), file(\"${params.date}.${severity}.bed.gz.tbi\")\n\n    \"\"\"\n        cat ${flatfile} | \\\n        grep ${severity} | \\\n        awk '\\$0 !~ \"^#\" { print \\$1 \"\\\\t\" (\\$2 - 1) \"\\\\t\" (\\$2)  \"\\\\t\" \\$1 \":\" \\$2 \"\\\\t0\\\\t+\"  \"\\\\t\" \\$2 - 1 \"\\\\t\" \\$2 \"\\\\t0\\\\t1\\\\t1\\\\t0\" }' | \\\\\n        bgzip  > ${params.date}.${severity}.bed.gz\n        tabix -p bed ${params.date}.${severity}.bed.gz\n        fsize=\\$(zcat ${params.date}.${severity}.bed.gz | wc -c)\n        if [ \\${fsize} -lt 2000 ]; then\n            exit 1\n        fi;\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "\"\"\"\n        cat ${flatfile} | \\\n        grep ${severity} | \\\n        awk '\\$0 !~ \"^#\" { print \\$1 \"\\\\t\" (\\$2 - 1) \"\\\\t\" (\\$2)  \"\\\\t\" \\$1 \":\" \\$2 \"\\\\t0\\\\t+\"  \"\\\\t\" \\$2 - 1 \"\\\\t\" \\$2 \"\\\\t0\\\\t1\\\\t1\\\\t0\" }' | \\\\\n        bgzip  > ${params.date}.${severity}.bed.gz\n        tabix -p bed ${params.date}.${severity}.bed.gz\n        fsize=\\$(zcat ${params.date}.${severity}.bed.gz | wc -c)\n        if [ \\${fsize} -lt 2000 ]; then\n            exit 1\n        fi;\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "severity"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__annotation-nf",
        "directive": [
            "label 'annotation'",
            "publishDir \"${params.output}/tracks/bcsq/\", mode: 'copy'",
            "tag { severity }"
        ],
        "when": "",
        "stub": ""
    }
}