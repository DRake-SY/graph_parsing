{
    "isec": {
        "name_process": "isec",
        "string_process": "\nprocess isec{\n    container \"halllab/bcftools:v1.9\"\n    cpus params.isec_threads\n\n    input:\n    file gatk_vcfgz\n    file gatk_vcfgz_tbi\n    file bcftools_vcfgz\n    file bcftools_vcfgz_tbi\n\n    output:\n    path(\"relatedness.isec.0002.vcf\") into exclude_mito_scaff_ch\n\n    script:\n    \"\"\"\n    mkdir isec\n    bcftools isec $bcftools_vcfgz $gatk_vcfgz -p isec --threads ${task.cpus}\n    mv isec/0002.vcf relatedness.isec.0002.vcf\n    \"\"\"\n    \n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    mkdir isec\n    bcftools isec $bcftools_vcfgz $gatk_vcfgz -p isec --threads ${task.cpus}\n    mv isec/0002.vcf relatedness.isec.0002.vcf\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "gatk_vcfgz",
            "gatk_vcfgz_tbi",
            "bcftools_vcfgz",
            "bcftools_vcfgz_tbi"
        ],
        "nb_inputs": 4,
        "outputs": [
            "exclude_mito_scaff_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"halllab/bcftools:v1.9\"",
            "cpus params.isec_threads"
        ],
        "when": "",
        "stub": ""
    },
    "exclude_mito_scaff": {
        "name_process": "exclude_mito_scaff",
        "string_process": " process exclude_mito_scaff{\n        container  \"biocontainers/vcftools:v0.1.16-1-deb_cv1\"\n        if (workflow.containerEngine == 'docker'){\n            containerOptions '-u $(id -u):$(id -g)'\n        }\n\n        input:\n        path(isec_vcf) from exclude_mito_scaff_ch\n\n        output:\n        path \"relatedness.isec.0002.exMito.vcf\" into thin_ch\n\n        script:\n        \"\"\"\n        vcftools --not-chr ${params.mito_scaff} --recode --recode-INFO-all --stdout --gzvcf $isec_vcf > relatedness.isec.0002.exMito.vcf\n        \"\"\"\n    }",
        "nb_lignes_process": 15,
        "string_script": "        \"\"\"\n        vcftools --not-chr ${params.mito_scaff} --recode --recode-INFO-all --stdout --gzvcf $isec_vcf > relatedness.isec.0002.exMito.vcf\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "exclude_mito_scaff_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "thin_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"biocontainers/vcftools:v0.1.16-1-deb_cv1\" if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }"
        ],
        "when": "",
        "stub": ""
    },
    "thin": {
        "name_process": "thin",
        "string_process": "\nprocess thin{\n    container \"biocontainers/vcftools:v0.1.16-1-deb_cv1\"\n    publishDir thinned_vcf_publish_dir, mode: \"copy\"\n    if (workflow.containerEngine == 'docker'){\n            containerOptions '-u $(id -u):$(id -g)'\n        }\n\n    input:\n    path vcf_to_thin from thin_ch\n\n    output:\n    path \"relatedness.isec.0002.exMito.thinned.vcf\" into lcmlkin_ch,read_ch,ngsrelate_ch\n\n    script:\n    \"\"\"\n    vcftools --vcf $vcf_to_thin --remove-filtered-all --remove-indels --maf 0.025 --recode --recode-INFO-all --stdout --max-missing 0.75 > relatedness.isec.0002.exMito.thinned.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    vcftools --vcf $vcf_to_thin --remove-filtered-all --remove-indels --maf 0.025 --recode --recode-INFO-all --stdout --max-missing 0.75 > relatedness.isec.0002.exMito.thinned.vcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "thin_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "lcmlkin_ch",
            "read_ch",
            "ngsrelate_ch"
        ],
        "nb_outputs": 3,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"biocontainers/vcftools:v0.1.16-1-deb_cv1\"",
            "publishDir thinned_vcf_publish_dir, mode: \"copy\" if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }"
        ],
        "when": "",
        "stub": ""
    },
    "generate_PCAngsd_input": {
        "name_process": "generate_PCAngsd_input",
        "string_process": " process generate_PCAngsd_input{\n        tag \"generate_PCAngsd_input\"\n        container 'autamus/angsd:latest'\n        cpus 4\n\n        input:\n        file bams from pca_bams_in_ch.collect(){it[1]}\n\n        output:\n        file \"genolike.beagle.gz\" into pcangsd_in_ch\n        file \"sample.names.order.txt\" into pc_sample_order_ch\n\n        shell:\n        '''\n        find ~+ -name '*.bam' > bam_list.full.txt\n        awk -F'/' '{print $NF}' bam_list.full.txt > bam_list.short.txt\n        awk -f !{bin_dir}/unique_names.awk bam_list.short.txt > sample.names.order.txt\n        angsd -GL 2 -out genolike -P I{task.cpus} -doGlf 2 -doMajorMinor 1 -SNP_pval 1e-6 -doMaf 1 -bam bam_list.full.txt\n        '''\n    }",
        "nb_lignes_process": 18,
        "string_script": "        '''\n        find ~+ -name '*.bam' > bam_list.full.txt\n        awk -F'/' '{print $NF}' bam_list.full.txt > bam_list.short.txt\n        awk -f !{bin_dir}/unique_names.awk bam_list.short.txt > sample.names.order.txt\n        angsd -GL 2 -out genolike -P I{task.cpus} -doGlf 2 -doMajorMinor 1 -SNP_pval 1e-6 -doMaf 1 -bam bam_list.full.txt\n        '''",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "ANGSD"
        ],
        "tools_url": [
            "https://bio.tools/angsd"
        ],
        "tools_dico": [
            {
                "name": "ANGSD",
                "uri": "https://bio.tools/angsd",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2269",
                            "term": "Statistics and probability"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "Software for analyzing next generation sequencing data. The software can handle a number of different input types from mapped reads to imputed genotype probabilities. Most methods take genotype uncertainty into account instead of basing the analysis on called genotypes. This is especially useful for low and medium depth data.",
                "homepage": "http://www.popgen.dk/angsd"
            }
        ],
        "inputs": [
            "pca_bams_in_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "pcangsd_in_ch",
            "pc_sample_order_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"generate_PCAngsd_input\"",
            "container 'autamus/angsd:latest'",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "generate_PCAngsd_cov_matrix": {
        "name_process": "generate_PCAngsd_cov_matrix",
        "string_process": " process generate_PCAngsd_cov_matrix{\n        tag \"generate_PCAngsd_cov_matrix\"\n        container 'didillysquat/pcangsd:latest'\n        cpus 4\n\n        input:\n        file genolike from pcangsd_in_ch\n\n        output:\n        file \"pcangsd.out.cov\" into generate_pcs_ch\n\n        script:\n        \"\"\"\n        pcangsd.py -beagle genolike.beagle.gz -out pcangsd.out -threads ${task.cpus}\n        \"\"\"\n    }",
        "nb_lignes_process": 14,
        "string_script": "        \"\"\"\n        pcangsd.py -beagle genolike.beagle.gz -out pcangsd.out -threads ${task.cpus}\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "pcangsd_in_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "generate_pcs_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"generate_PCAngsd_cov_matrix\"",
            "container 'didillysquat/pcangsd:latest'",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "generate_PCs": {
        "name_process": "generate_PCs",
        "string_process": " process generate_PCs{\n        tag \"generate_PCs\"\n        container 'didillysquat/r_multipurpose:latest'\n        publishDir pca_publish_dir\n\n        input:\n        file cov_file from generate_pcs_ch\n        file pc_sample_order from pc_sample_order_ch\n\n        output:\n        tuple file(\"PCs.txt\"), file(\"PC.values.txt\"), file(\"PC.plot.png\") into generate_pcs_out_ch\n\n        script:\n        \"\"\"\n        Rscript ${bin_dir}/compute_pcs.r \\$PWD $pc_sample_order $cov_file\n        \"\"\"\n    }",
        "nb_lignes_process": 15,
        "string_script": "        \"\"\"\n        Rscript ${bin_dir}/compute_pcs.r \\$PWD $pc_sample_order $cov_file\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "generate_pcs_ch",
            "pc_sample_order_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "generate_pcs_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"generate_PCs\"",
            "container 'didillysquat/r_multipurpose:latest'",
            "publishDir pca_publish_dir"
        ],
        "when": "",
        "stub": ""
    },
    "read_make_tped_tfam": {
        "name_process": "read_make_tped_tfam",
        "string_process": "\nprocess read_make_tped_tfam{\n    container \"biocontainers/vcftools:v0.1.16-1-deb_cv1\"\n    if (workflow.containerEngine == 'docker'){\n            containerOptions '-u $(id -u):$(id -g)'\n        }\n\n    input:\n    path read_vcf from read_ch\n\n    output:\n    tuple path(\"relatedness.isec.0002.exMito.thinned.tped\"), path(\"relatedness.isec.0002.exMito.thinned.tfam\") into read_run_ch\n\n    script:\n    \"\"\"\n    vcftools --vcf $read_vcf --plink-tped --out relatedness.isec.0002.exMito.thinned\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    vcftools --vcf $read_vcf --plink-tped --out relatedness.isec.0002.exMito.thinned\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "read_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "read_run_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"biocontainers/vcftools:v0.1.16-1-deb_cv1\" if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }"
        ],
        "when": "",
        "stub": ""
    },
    "read_run": {
        "name_process": "read_run",
        "string_process": "\nprocess read_run{\n    container \"didillysquat/read:latest\"\n    publishDir read_publish_dir, mode: \"copy\"\n\n    input:\n    tuple path(tped), path(tfam) from read_run_ch\n\n    output:\n    tuple path(\"READ_results\"), path(\"READ_results_plot.pdf\"), path(\"READ_output_ordered\"), path(\"Read_intermediate_output\"), path(\"meansP0_AncientDNA_normalized\") into read_out_ch\n\n    script:\n    base_name = tped.getName().replaceAll(\".tped\", \"\")\n    \"\"\"\n    READ.py $base_name\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    base_name = tped.getName().replaceAll(\".tped\", \"\")\n    \"\"\"\n    READ.py $base_name\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "read_run_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "read_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"didillysquat/read:latest\"",
            "publishDir read_publish_dir, mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "lcmlkin": {
        "name_process": "lcmlkin",
        "string_process": "\nprocess lcmlkin{\n    container \"didillysquat/lcmlkin:latest\"\n    publishDir lcmlkin_publish_dir, mode: \"copy\"\n    cpus params.lcmlkin_threads\n\n    input:\n    path vcf_in from lcmlkin_ch\n\n    output:\n    tuple path(\"relatedness.isec.0002.exMito.thinned.lcmlkin.results\"), path(\"relatedness.isec.0002.exMito.thinned.lcmlkin.results.log\") into lcmlkin_out_ch\n\n    script:\n    \"\"\"\n    lcmlkin -g all --likelihoodFormat phred -o relatedness.isec.0002.exMito.thinned.lcmlkin.results -i $vcf_in -t ${task.cpus}\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    lcmlkin -g all --likelihoodFormat phred -o relatedness.isec.0002.exMito.thinned.lcmlkin.results -i $vcf_in -t ${task.cpus}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "lcmlkin_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "lcmlkin_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"didillysquat/lcmlkin:latest\"",
            "publishDir lcmlkin_publish_dir, mode: \"copy\"",
            "cpus params.lcmlkin_threads"
        ],
        "when": "",
        "stub": ""
    },
    "ngsrelate_threads": {
        "name_process": "ngsrelate_threads",
        "string_process": "\nprocess ngsrelate_threads{\n    container \"didillysquat/ngsrelate:latest\"\n    publishDir ngsrelate_publish_dir, mode: \"copy\"\n    cpus params.ngsrelate_threads\n\n    input:\n    path vcf_in from ngsrelate_ch\n\n    output:\n    path(\"relatedness.isec.0002.exMito.thinned.ngsrelate.results\") into ngsrelate_threads_out_ch\n\n    script:\n    \"\"\"\n    awk '/#CHROM/ {for(i=10; i<=NF; i++){print \\$i}}' relatedness.isec.0002.exMito.thinned.vcf > sample_names.txt\n    ngsRelate -h $vcf_in -O relatedness.isec.0002.exMito.thinned.ngsrelate.results -c 1 -p ${task.cpus} -z sample_names.txt\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    awk '/#CHROM/ {for(i=10; i<=NF; i++){print \\$i}}' relatedness.isec.0002.exMito.thinned.vcf > sample_names.txt\n    ngsRelate -h $vcf_in -O relatedness.isec.0002.exMito.thinned.ngsrelate.results -c 1 -p ${task.cpus} -z sample_names.txt\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "NgsRelate"
        ],
        "tools_url": [
            "https://bio.tools/ngsrelate"
        ],
        "tools_dico": [
            {
                "name": "NgsRelate",
                "uri": "https://bio.tools/ngsrelate",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2269",
                            "term": "Statistics and probability"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2451",
                                    "term": "Sequence comparison"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Used to infer relatedness coefficients for pairs of individuals from low coverage Next Generation Sequencing (NGS) data by using genotype likelihoods instead of called genotypes.",
                "homepage": "http://www.popgen.dk/software/index.php/NgsRelate"
            }
        ],
        "inputs": [
            "ngsrelate_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ngsrelate_threads_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container \"didillysquat/ngsrelate:latest\"",
            "publishDir ngsrelate_publish_dir, mode: \"copy\"",
            "cpus params.ngsrelate_threads"
        ],
        "when": "",
        "stub": ""
    },
    "index_dictionary_refgenome": {
        "name_process": "index_dictionary_refgenome",
        "string_process": "\nprocess index_dictionary_refgenome{\n    container 'broadinstitute/gatk:4.2.0.0'\n\n    input:\n    path ref_genome from params.ref\n\n    output:\n    tuple path(ref_genome), path(\"*.dict\"), path(\"*.fai\") into index_dictionary_refgenome_out_ch\n\n    script:\n    \"\"\"\n    gatk CreateSequenceDictionary -R ${ref_genome}\n    samtools faidx ${ref_genome}\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    gatk CreateSequenceDictionary -R ${ref_genome}\n    samtools faidx ${ref_genome}\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "params"
        ],
        "nb_inputs": 1,
        "outputs": [
            "index_dictionary_refgenome_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container 'broadinstitute/gatk:4.2.0.0'"
        ],
        "when": "",
        "stub": ""
    },
    "gatk_haplotype_caller_gvcf_split": {
        "name_process": "gatk_haplotype_caller_gvcf_split",
        "string_process": " process gatk_haplotype_caller_gvcf_split{\n            tag {pair_id}\n            container 'broadinstitute/gatk:4.2.0.0'\n            cpus Math.max(params.gatk_haplotype_caller_cpus - 1 , 1)\n\n            input:\n            each scaffold from Channel.fromList(scaffold_list)\n            tuple val(pair_id), path(merged), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from gatk_haplotype_caller_gvcf_ch.combine(gatk_haplotype_caller_ref_genome_ch)\n\n            output:\n            tuple val(pair_id), val(scaffold), path(\"${pair_id}.${scaffold}.merged.g.vcf.gz\") into genomics_db_import_ch\n            tuple val(pair_id), val(scaffold), path(\"${pair_id}.${scaffold}.merged.g.vcf.gz.tbi\") into genomics_db_import_tbi_ch\n\n            script:\n            \"\"\"\n            gatk --java-options \"-Xmx${params.haplotypecaller_max_mem}g\" HaplotypeCaller --native-pair-hmm-threads ${task.cpus} -R $ref_genome -I ${merged[0]} -O ${pair_id}.${scaffold}.merged.g.vcf.gz -ERC GVCF -L $scaffold\n            \"\"\"\n        }",
        "nb_lignes_process": 16,
        "string_script": "            \"\"\"\n            gatk --java-options \"-Xmx${params.haplotypecaller_max_mem}g\" HaplotypeCaller --native-pair-hmm-threads ${task.cpus} -R $ref_genome -I ${merged[0]} -O ${pair_id}.${scaffold}.merged.g.vcf.gz -ERC GVCF -L $scaffold\n            \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gatk_haplotype_caller_gvcf_ch",
            "gatk_haplotype_caller_ref_genome_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "genomics_db_import_ch",
            "genomics_db_import_tbi_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {pair_id}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "cpus Math.max(params.gatk_haplotype_caller_cpus - 1 , 1)"
        ],
        "when": "",
        "stub": ""
    },
    "genomics_db_import_split": {
        "name_process": "genomics_db_import_split",
        "string_process": " process genomics_db_import_split{\n            tag \"${scaffold}\"\n            cpus 1\n            container 'broadinstitute/gatk:4.2.0.0'\n\n            input:\n            tuple val(pair_id_list), val(scaffold), path(gvcf_list) from genomics_db_import_ch.groupTuple(by: 1)\n            tuple val(pair_id), val(scaffold), path(gvcf_tbi) from genomics_db_import_tbi_ch.groupTuple(by: 1)\n            \n            output:\n            tuple val(scaffold), file(\"genomicsdbi.out.${scaffold}\") into genotype_GVCFs_ch\n            \n            script:\n            \"\"\"\n            gatk  --java-options '-DGATK_STACKTRACE_ON_USER_EXCEPTION=true' GenomicsDBImport ${gvcf_list.collect { \"-V $it \" }.join()} --genomicsdb-workspace-path genomicsdbi.out.${scaffold} -L $scaffold --batch-size 50\n            \"\"\"\n        }",
        "nb_lignes_process": 15,
        "string_script": "            \"\"\"\n            gatk  --java-options '-DGATK_STACKTRACE_ON_USER_EXCEPTION=true' GenomicsDBImport ${gvcf_list.collect { \"-V $it \" }.join()} --genomicsdb-workspace-path genomicsdbi.out.${scaffold} -L $scaffold --batch-size 50\n            \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genomics_db_import_ch",
            "genomics_db_import_tbi_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "genotype_GVCFs_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${scaffold}\"",
            "cpus 1",
            "container 'broadinstitute/gatk:4.2.0.0'"
        ],
        "when": "",
        "stub": ""
    },
    "gatk_haplotype_caller_gvcf_no_split": {
        "name_process": "gatk_haplotype_caller_gvcf_no_split",
        "string_process": " process gatk_haplotype_caller_gvcf_no_split{\n            tag {pair_id}\n            container 'broadinstitute/gatk:4.2.0.0'\n            cpus params.gatk_haplotype_caller_cpus\n\n            input:\n            tuple val(pair_id), path(merged), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from gatk_haplotype_caller_gvcf_ch.combine(gatk_haplotype_caller_ref_genome_ch)\n\n            output:\n            tuple val(pair_id), path(\"${pair_id}.merged.g.vcf.gz\") into genomics_db_import_ch\n            tuple val(pair_id), path(\"${pair_id}.merged.g.vcf.gz.tbi\") into genomics_db_import_tbi_ch\n\n            script:\n            \"\"\"\n            gatk --java-options \"-Xmx${params.haplotypecaller_max_mem}g\" HaplotypeCaller --native-pair-hmm-threads ${task.cpus} -R $ref_genome -I ${merged[0]} -O ${pair_id}.merged.g.vcf.gz -ERC GVCF\n            \"\"\"\n        }",
        "nb_lignes_process": 15,
        "string_script": "            \"\"\"\n            gatk --java-options \"-Xmx${params.haplotypecaller_max_mem}g\" HaplotypeCaller --native-pair-hmm-threads ${task.cpus} -R $ref_genome -I ${merged[0]} -O ${pair_id}.merged.g.vcf.gz -ERC GVCF\n            \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gatk_haplotype_caller_gvcf_ch",
            "gatk_haplotype_caller_ref_genome_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "genomics_db_import_ch",
            "genomics_db_import_tbi_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {pair_id}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "cpus params.gatk_haplotype_caller_cpus"
        ],
        "when": "",
        "stub": ""
    },
    "genomics_db_import_no_split": {
        "name_process": "genomics_db_import_no_split",
        "string_process": " process genomics_db_import_no_split{\n            tag \"${scaffold}\"\n            cpus 1\n            container 'broadinstitute/gatk:4.2.0.0'\n\n            input:\n            each scaffold from Channel.fromList(scaffold_list)\n            path(gvcf) from genomics_db_import_ch.collect{it[1]}\n            path(gvcf_tbi) from genomics_db_import_tbi_ch.collect{it[1]}\n            \n            output:\n            tuple val(scaffold), path(\"genomicsdbi.out.${scaffold}\") into genotype_GVCFs_ch\n            \n            script:\n            \"\"\"\n            gatk  --java-options '-DGATK_STACKTRACE_ON_USER_EXCEPTION=true' GenomicsDBImport ${gvcf.collect { \"-V $it \" }.join()} --genomicsdb-workspace-path genomicsdbi.out.${scaffold} -L $scaffold --batch-size 50\n            \"\"\"\n        }",
        "nb_lignes_process": 16,
        "string_script": "            \"\"\"\n            gatk  --java-options '-DGATK_STACKTRACE_ON_USER_EXCEPTION=true' GenomicsDBImport ${gvcf.collect { \"-V $it \" }.join()} --genomicsdb-workspace-path genomicsdbi.out.${scaffold} -L $scaffold --batch-size 50\n            \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genomics_db_import_ch",
            "genomics_db_import_tbi_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "genotype_GVCFs_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${scaffold}\"",
            "cpus 1",
            "container 'broadinstitute/gatk:4.2.0.0'"
        ],
        "when": "",
        "stub": ""
    },
    "GenotypeGVCFs": {
        "name_process": "GenotypeGVCFs",
        "string_process": " process GenotypeGVCFs{\n        container 'broadinstitute/gatk:4.2.0.0'\n        cpus 3\n        tag \"${scaffold}\"\n\n        input:\n        tuple val(scaffold), file(workspace), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from genotype_GVCFs_ch.combine(GenotypeGVCFs_ref_genome_ch)\n\n        output:\n        file(\"GenotypeGVCFs.out.${scaffold}.vcf\") into gather_vcfs_for_eval_ch\n        file(\"GenotypeGVCFs.out.${scaffold}.vcf.idx\") into gather_vcfs_idx_for_eval_ch\n\n        script:\n        \"\"\"\n        WORKSPACE=\\$( basename ${workspace} )\n        gatk GenotypeGVCFs -R ${ref_genome} -O GenotypeGVCFs.out.${scaffold}.vcf \\\n        --only-output-calls-starting-in-intervals -V gendb://\\$WORKSPACE -L ${scaffold}\n        \"\"\"\n    }",
        "nb_lignes_process": 17,
        "string_script": "        \"\"\"\n        WORKSPACE=\\$( basename ${workspace} )\n        gatk GenotypeGVCFs -R ${ref_genome} -O GenotypeGVCFs.out.${scaffold}.vcf \\\n        --only-output-calls-starting-in-intervals -V gendb://\\$WORKSPACE -L ${scaffold}\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genotype_GVCFs_ch",
            "GenotypeGVCFs_ref_genome_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "gather_vcfs_for_eval_ch",
            "gather_vcfs_idx_for_eval_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container 'broadinstitute/gatk:4.2.0.0'",
            "cpus 3",
            "tag \"${scaffold}\""
        ],
        "when": "",
        "stub": ""
    },
    "gather_vcfs_for_eval": {
        "name_process": "gather_vcfs_for_eval",
        "string_process": " process gather_vcfs_for_eval{\n        tag \"GatherVcfs_for_eval\"\n        container 'broadinstitute/gatk:4.2.0.0'\n        publishDir gatk_output_vcf_publishDir, mode: 'copy', pattern: '*.{gz,gz.tbi}'\n\n        input:\n        val(scaffolds) from Channel.fromList(scaffold_list).collect()\n        path(vcf) from gather_vcfs_for_eval_ch.collect()\n        path(vcf_idx) from gather_vcfs_idx_for_eval_ch.collect()\n\n        output:\n        tuple path(\"gatk.out.vcf.gz\"), path(\"gatk.out.vcf.gz.tbi\") into gatk_out_ch\n\n        script:\n        \"\"\"\n        gatk GatherVcfs ${scaffolds.collect{ \"--INPUT GenotypeGVCFs.out.${it}.vcf \" }.join()} --OUTPUT gatk.out.vcf\n        bgzip -c gatk.out.vcf > gatk.out.vcf.gz\n        tabix -p vcf gatk.out.vcf.gz\n        \"\"\"\n    }",
        "nb_lignes_process": 18,
        "string_script": "        \"\"\"\n        gatk GatherVcfs ${scaffolds.collect{ \"--INPUT GenotypeGVCFs.out.${it}.vcf \" }.join()} --OUTPUT gatk.out.vcf\n        bgzip -c gatk.out.vcf > gatk.out.vcf.gz\n        tabix -p vcf gatk.out.vcf.gz\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gather_vcfs_for_eval_ch",
            "gather_vcfs_idx_for_eval_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "gatk_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"GatherVcfs_for_eval\"",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "publishDir gatk_output_vcf_publishDir, mode: 'copy', pattern: '*.{gz,gz.tbi}'"
        ],
        "when": "",
        "stub": ""
    },
    "bcftools_vcfstats": {
        "name_process": "bcftools_vcfstats",
        "string_process": "\nprocess bcftools_vcfstats{\n    tag \"bcftools_stats\"\n    container \"halllab/bcftools:v1.9\"\n    publishDir gatk_vcf_stats_publishDir, mode: \"copy\", pattern: \"*gatk*\"\n    publishDir bcftools_vcf_stats_publishDir, mode: \"copy\", pattern: \"*bcftools.call*\"\n\n    input:\n    tuple path(vcfgz), path(vcfgz_tbi), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from bcftools_stats_ch.combine(bcftools_vcfstats_ref_genome_ch)\n\n    output:\n    path(\"*.bcftools.stats.txt\") into bcftools_stats_out_ch\n\n    script:\n    stats_out_file = vcfgz.getName().replaceAll(\".vcf.gz\", \".bcftools.stats.txt\")\n    \"\"\"\n    bcftools stats -F $ref_genome -s - $vcfgz > $stats_out_file\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    stats_out_file = vcfgz.getName().replaceAll(\".vcf.gz\", \".bcftools.stats.txt\")\n    \"\"\"\n    bcftools stats -F $ref_genome -s - $vcfgz > $stats_out_file\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bcftools_stats_ch",
            "bcftools_vcfstats_ref_genome_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bcftools_stats_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"bcftools_stats\"",
            "container \"halllab/bcftools:v1.9\"",
            "publishDir gatk_vcf_stats_publishDir, mode: \"copy\", pattern: \"*gatk*\"",
            "publishDir bcftools_vcf_stats_publishDir, mode: \"copy\", pattern: \"*bcftools.call*\""
        ],
        "when": "",
        "stub": ""
    },
    "rtg_vcfstats_per_sample": {
        "name_process": "rtg_vcfstats_per_sample",
        "string_process": "\nprocess rtg_vcfstats_per_sample{\n    tag \"rtg_vcfstats\"\n    container 'realtimegenomics/rtg-tools:latest'\n    publishDir gatk_vcf_stats_publishDir, mode: \"copy\", pattern: \"*gatk*\"\n    publishDir bcftools_vcf_stats_publishDir, mode: \"copy\", pattern: \"*bcftools.call*\"\n\n    input:\n    tuple path(vcfgz), path(vcfgz_tbi) from rtg_vcfstats_ch\n\n    output:\n    path(\"*.rtg.stats.per_sample.txt\") into rtg_vcfstats_out_ch\n\n    script:\n    stats_out_file = vcfgz.getName().replaceAll(\".vcf.gz\", \".rtg.stats.per_sample.txt\")\n    \"\"\"\n    rtg vcfstats $vcfgz > $stats_out_file\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    stats_out_file = vcfgz.getName().replaceAll(\".vcf.gz\", \".rtg.stats.per_sample.txt\")\n    \"\"\"\n    rtg vcfstats $vcfgz > $stats_out_file\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "sortgff"
        ],
        "tools_url": [
            "https://bio.tools/sortgff"
        ],
        "tools_dico": [
            {
                "name": "sortgff",
                "uri": "https://bio.tools/sortgff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3802",
                                    "term": "Sorting"
                                }
                            ],
                            []
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "Sorts a gff file.",
                "homepage": "https://urgi.versailles.inra.fr/Tools/REPET"
            }
        ],
        "inputs": [
            "rtg_vcfstats_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "rtg_vcfstats_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"rtg_vcfstats\"",
            "container 'realtimegenomics/rtg-tools:latest'",
            "publishDir gatk_vcf_stats_publishDir, mode: \"copy\", pattern: \"*gatk*\"",
            "publishDir bcftools_vcf_stats_publishDir, mode: \"copy\", pattern: \"*bcftools.call*\""
        ],
        "when": "",
        "stub": ""
    },
    "rtg_vcfstats_summary": {
        "name_process": "rtg_vcfstats_summary",
        "string_process": "\nprocess rtg_vcfstats_summary{\n    tag \"rtg_vcfstats_summary\"\n    container 'broadinstitute/gatk:4.2.0.0'\n    publishDir gatk_vcf_stats_publishDir, mode: \"copy\", pattern: \"*gatk*\"\n    publishDir bcftools_vcf_stats_publishDir, mode: \"copy\", pattern: \"*bcftools.call*\"\n\n    input:\n    path(rtg_vcfstats_output) from rtg_vcfstats_out_ch\n\n    output:\n    path(\"*rtg.stats.summary.txt\") into rtg_vcfstats_summary_out_ch\n\n    script:\n    stats_out_file = rtg_vcfstats_output.getName().replaceAll(\"per_sample\", \"summary\")\n    \"\"\"\n    python3 ${bin_dir}/summarise_rtg_vcfstats.py $rtg_vcfstats_output $stats_out_file\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    stats_out_file = rtg_vcfstats_output.getName().replaceAll(\"per_sample\", \"summary\")\n    \"\"\"\n    python3 ${bin_dir}/summarise_rtg_vcfstats.py $rtg_vcfstats_output $stats_out_file\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "rtg_vcfstats_out_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "rtg_vcfstats_summary_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"rtg_vcfstats_summary\"",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "publishDir gatk_vcf_stats_publishDir, mode: \"copy\", pattern: \"*gatk*\"",
            "publishDir bcftools_vcf_stats_publishDir, mode: \"copy\", pattern: \"*bcftools.call*\""
        ],
        "when": "",
        "stub": ""
    },
    "split_vcf_by_scaffold": {
        "name_process": "split_vcf_by_scaffold",
        "string_process": " process split_vcf_by_scaffold{\n        tag {scaffold}\n        cpus 1\n        memory \"24GB\"\n        container 'broadinstitute/gatk:4.2.0.0'\n\n        input:\n        each scaffold from Channel.fromList(scaffold_list)\n        path(vcf) from split_vcf_by_scaffold_vcf_ch\n        tuple path(vcf_idx), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from split_vcf_by_scaffold_vcf_idx_ch.combine(split_vcf_by_scaffold_ref_genome_ch)\n\n        output:\n        tuple val(scaffold), file(\"GenotypeGVCFs.out.${scaffold}.vcf\"), file(\"GenotypeGVCFs.out.${scaffold}.vcf.idx\") into hard_filter_ch\n\n        script:\n        \"\"\"\n        gatk SelectVariants -R $ref_genome -V $vcf -L $scaffold -O \"GenotypeGVCFs.out.${scaffold}.vcf\"\n        \"\"\"\n\n    }",
        "nb_lignes_process": 18,
        "string_script": "        \"\"\"\n        gatk SelectVariants -R $ref_genome -V $vcf -L $scaffold -O \"GenotypeGVCFs.out.${scaffold}.vcf\"\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "split_vcf_by_scaffold_vcf_ch",
            "split_vcf_by_scaffold_vcf_idx_ch",
            "split_vcf_by_scaffold_ref_genome_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "hard_filter_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {scaffold}",
            "cpus 1",
            "memory \"24GB\"",
            "container 'broadinstitute/gatk:4.2.0.0'"
        ],
        "when": "",
        "stub": ""
    },
    "hard_filter": {
        "name_process": "hard_filter",
        "string_process": "\nprocess hard_filter{\n\ttag {scaffold}\n    container 'broadinstitute/gatk:4.2.0.0'\n    cpus 5\n\n    input:\n\ttuple val(scaffold), path(vcf), path(vcfidx) from hard_filter_ch\n\n\toutput:\n    file(\"${scaffold}.filtered.vcf\") into vcf_gather_vcfs_ch\n    file(\"${scaffold}.filtered.vcf.idx\") into vcf_idx_gather_vcfs_ch\n\n    script:\n\t\"\"\"\n\tgatk VariantFiltration \\\n    -filter \"Qual >= 100\" --filter-name \"Qual100\" \\\n    -filter \"QD < 2.0\" --filter-name \"QD2\" \\\n    -filter \"MQ < 35.0\" --filter-name \"MQ35\" \\\n    -filter \"FS > 60.0\" --filter-name \"FS60\" \\\n    -filter \"HaplotypeScore > 13.0\" --filter-name \"Haplo13\" \\\n    -filter \"MQRankSum < -12.5\" --filter-name \"MQRankSum-12\" \\\n    -filter \"ReadPosRankSum < -8.0\" --filter-name \"ReadPosRank-8\" \\\n    -V ${vcf} -O ${scaffold}.markfiltered.vcf\n\n    gatk SelectVariants --exclude-filtered \\\n      -V ${scaffold}.markfiltered.vcf \\\n      -O ${scaffold}.filtered.vcf\n\t\"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "\t\"\"\"\n\tgatk VariantFiltration \\\n    -filter \"Qual >= 100\" --filter-name \"Qual100\" \\\n    -filter \"QD < 2.0\" --filter-name \"QD2\" \\\n    -filter \"MQ < 35.0\" --filter-name \"MQ35\" \\\n    -filter \"FS > 60.0\" --filter-name \"FS60\" \\\n    -filter \"HaplotypeScore > 13.0\" --filter-name \"Haplo13\" \\\n    -filter \"MQRankSum < -12.5\" --filter-name \"MQRankSum-12\" \\\n    -filter \"ReadPosRankSum < -8.0\" --filter-name \"ReadPosRank-8\" \\\n    -V ${vcf} -O ${scaffold}.markfiltered.vcf\n\n    gatk SelectVariants --exclude-filtered \\\n      -V ${scaffold}.markfiltered.vcf \\\n      -O ${scaffold}.filtered.vcf\n\t\"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "hard_filter_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_gather_vcfs_ch",
            "vcf_idx_gather_vcfs_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {scaffold}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "cpus 5"
        ],
        "when": "",
        "stub": ""
    },
    "gather_vcfs": {
        "name_process": "gather_vcfs",
        "string_process": "\nprocess gather_vcfs{\n\ttag \"GatherVcfs\"\n    container 'broadinstitute/gatk:4.2.0.0'\n\n    input:\n    val(scaffolds) from Channel.fromList(scaffold_list).collect()\n    path(vcf) from vcf_gather_vcfs_ch.collect()\n\tpath(vcf_idx) from vcf_idx_gather_vcfs_ch.collect()\n\n\toutput:\n    tuple path(\"fowl.filtered.vcf\"), path(\"fowl.filtered.vcf.idx\") into make_bqsr_tables_known_variants_ch,make_bqsr_tables_known_variants_round_2_ch\n\n    script:\n\t\"\"\"\n\tgatk GatherVcfs ${scaffolds.collect{ \"--INPUT ${it}.filtered.vcf \" }.join()} --OUTPUT fowl.filtered.vcf\n\t\"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "\t\"\"\"\n\tgatk GatherVcfs ${scaffolds.collect{ \"--INPUT ${it}.filtered.vcf \" }.join()} --OUTPUT fowl.filtered.vcf\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "vcf_gather_vcfs_ch",
            "vcf_idx_gather_vcfs_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "make_bqsr_tables_known_variants_ch",
            "make_bqsr_tables_known_variants_round_2_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"GatherVcfs\"",
            "container 'broadinstitute/gatk:4.2.0.0'"
        ],
        "when": "",
        "stub": ""
    },
    "make_bqsr_tables": {
        "name_process": "make_bqsr_tables",
        "string_process": "\nprocess make_bqsr_tables{\n    tag {pair_id}\n    container 'broadinstitute/gatk:4.2.0.0'\n    cpus 4\n\n    input:\n    tuple val(pair_id), path(merged_bam), path(known_variants), path(known_variants_idx), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from make_bqsr_tables_bam_ch.combine(make_bqsr_tables_known_variants_ch).combine(make_bqsr_tables_ref_genome_ch)\n\n    output:\n    tuple val(pair_id), path(merged_bam), path(\"${pair_id}.table\") into apply_bqsr_tables_ch\n    tuple val(pair_id), path(\"${pair_id}.table\") into compare_tables_round_1_ch\n\n    script:\n    \"\"\"\n    gatk BaseRecalibrator -I ${merged_bam[0]} -R $ref_genome \\\n    --known-sites $known_variants -O ${pair_id}.table\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    gatk BaseRecalibrator -I ${merged_bam[0]} -R $ref_genome \\\n    --known-sites $known_variants -O ${pair_id}.table\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "make_bqsr_tables_bam_ch",
            "make_bqsr_tables_known_variants_ch",
            "make_bqsr_tables_ref_genome_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "apply_bqsr_tables_ch",
            "compare_tables_round_1_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {pair_id}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "apply_bqsr_tables": {
        "name_process": "apply_bqsr_tables",
        "string_process": "\nprocess apply_bqsr_tables{\n    tag {pair_id}\n    container 'broadinstitute/gatk:4.2.0.0'\n    publishDir gatk_bqsr_bam_publishDir, mode: \"copy\"\n\n    input:\n    tuple val(pair_id), path(merged_bam), path(table), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from apply_bqsr_tables_ch.combine(apply_bqsr_tables_ref_genome_ch)\n\n    output:\n    tuple val(pair_id), path(\"${pair_id}*.recalibrated*.bam{,.bai}\") into apply_bqsr_tables_out_ch,apply_bqsr_tables_round_2_ch\n\n    script:\n    out_bam = merged_bam[0].getName().replaceAll(\".bam\", \".recalibrated.bam\")\n    out_bam_index_original = merged_bam[0].getName().replaceAll(\".bam\", \".recalibrated.bai\")\n    out_bam_index_new = merged_bam[0].getName().replaceAll(\".bam\", \".recalibrated.bam.bai\")\n    \"\"\"\n    gatk ApplyBQSR -R $ref_genome -I ${merged_bam[0]} \\\n    --bqsr-recal-file $table \\\n    -O ${out_bam} --create-output-bam-index\n    \n    mv ${out_bam_index_original} ${out_bam_index_new}\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    out_bam = merged_bam[0].getName().replaceAll(\".bam\", \".recalibrated.bam\")\n    out_bam_index_original = merged_bam[0].getName().replaceAll(\".bam\", \".recalibrated.bai\")\n    out_bam_index_new = merged_bam[0].getName().replaceAll(\".bam\", \".recalibrated.bam.bai\")\n    \"\"\"\n    gatk ApplyBQSR -R $ref_genome -I ${merged_bam[0]} \\\n    --bqsr-recal-file $table \\\n    -O ${out_bam} --create-output-bam-index\n    \n    mv ${out_bam_index_original} ${out_bam_index_new}\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "apply_bqsr_tables_ch",
            "apply_bqsr_tables_ref_genome_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "apply_bqsr_tables_out_ch",
            "apply_bqsr_tables_round_2_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {pair_id}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "publishDir gatk_bqsr_bam_publishDir, mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "make_bqsr_tables_round_2": {
        "name_process": "make_bqsr_tables_round_2",
        "string_process": "\nprocess make_bqsr_tables_round_2{\n    tag {pair_id}\n    container 'broadinstitute/gatk:4.2.0.0'\n    cpus 4\n\n    input:\n    tuple val(pair_id), path(merged_bam), path(known_variants), path(known_variants_idx), path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from apply_bqsr_tables_round_2_ch.combine(make_bqsr_tables_known_variants_round_2_ch).combine(make_bqsr_tables_ref_genome_round_2_ch)\n\n    output:\n    tuple val(pair_id), path(\"${pair_id}.after.table\") into compare_tables_round_2_ch\n\n    script:\n    \"\"\"\n    gatk BaseRecalibrator -I ${merged_bam[0]} -R $ref_genome \\\n    --known-sites $known_variants -O ${pair_id}.after.table\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    gatk BaseRecalibrator -I ${merged_bam[0]} -R $ref_genome \\\n    --known-sites $known_variants -O ${pair_id}.after.table\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "apply_bqsr_tables_round_2_ch",
            "make_bqsr_tables_known_variants_round_2_ch",
            "make_bqsr_tables_ref_genome_round_2_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "compare_tables_round_2_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {pair_id}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "AnalyzeCovariates": {
        "name_process": "AnalyzeCovariates",
        "string_process": "\nprocess AnalyzeCovariates{\n    tag {pair_id}\n    container 'broadinstitute/gatk:4.2.0.0'\n    publishDir gatk_bqsr_analyze_covariates_publishDir, mode: \"copy\"\n\n    input:\n    tuple val(pair_id), path(table_before), path(table_after) from compare_tables_round_1_ch.join(compare_tables_round_2_ch)\n\n    output:\n    tuple val(pair_id), path(\"${pair_id}.BQSR.csv\"), path(\"${pair_id}.BQSR.pdf\") into compare_tables_round_2_out_ch\n    \n    script:\n    \"\"\"\n    gatk AnalyzeCovariates \\\n      -before $table_before \\\n      -after $table_after \\\n      -csv ${pair_id}.BQSR.csv \\\n      -plots ${pair_id}.BQSR.pdf\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    gatk AnalyzeCovariates \\\n      -before $table_before \\\n      -after $table_after \\\n      -csv ${pair_id}.BQSR.csv \\\n      -plots ${pair_id}.BQSR.pdf\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "compare_tables_round_1_ch",
            "compare_tables_round_2_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "compare_tables_round_2_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag {pair_id}",
            "container 'broadinstitute/gatk:4.2.0.0'",
            "publishDir gatk_bqsr_analyze_covariates_publishDir, mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "subsample": {
        "name_process": "subsample",
        "string_process": " process subsample{\n        tag \"${pair_id}\"\n        cache 'lenient'\n        container 'biocontainers/seqtk:v1.3-1-deb_cv1'\n        if (workflow.containerEngine == 'docker'){\n            containerOptions '-u $(id -u):$(id -g)'\n        }\n        publishDir \"${params.output_dir}/${params.subsample_depth}_subsampled_reads\", mode: 'copy'\n        cpus 1\n\n        input:\n        tuple val(pair_id), path(reads) from ch_subsample\n\n        output:\n        tuple val(\"${pair_id}_sub_${params.subsample_depth}\"), file(\"${pair_id}_sub_${params.subsample_depth}*.fastq.gz\") into ch_fastqc_pre_trim,ch_trimmomatic_input\n\n        script:\n        read_out_one = reads[0].getName().replaceAll(\"${pair_id}\", \"${pair_id}_sub_${params.subsample_depth}\")\n        read_out_two = reads[1].getName().replaceAll(\"${pair_id}\", \"${pair_id}_sub_${params.subsample_depth}\")\n        \n        \"\"\"\n        seqtk sample -s100 ${reads[0]} ${params.subsample_depth} | gzip > ${read_out_one}\n        seqtk sample -s100 ${reads[1]} ${params.subsample_depth} | gzip > ${read_out_two}\n        \"\"\"\n    }",
        "nb_lignes_process": 23,
        "string_script": "        read_out_one = reads[0].getName().replaceAll(\"${pair_id}\", \"${pair_id}_sub_${params.subsample_depth}\")\n        read_out_two = reads[1].getName().replaceAll(\"${pair_id}\", \"${pair_id}_sub_${params.subsample_depth}\")\n        \n        \"\"\"\n        seqtk sample -s100 ${reads[0]} ${params.subsample_depth} | gzip > ${read_out_one}\n        seqtk sample -s100 ${reads[1]} ${params.subsample_depth} | gzip > ${read_out_two}\n        \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "seqtk"
        ],
        "tools_url": [
            "https://bio.tools/seqtk"
        ],
        "tools_dico": [
            {
                "name": "seqtk",
                "uri": "https://bio.tools/seqtk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool for processing sequences in the FASTA or FASTQ format. It parses both FASTA and FASTQ files which can also be optionally compressed by gzip.",
                "homepage": "https://github.com/lh3/seqtk"
            }
        ],
        "inputs": [
            "ch_subsample"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_fastqc_pre_trim",
            "ch_trimmomatic_input"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "cache 'lenient'",
            "container 'biocontainers/seqtk:v1.3-1-deb_cv1' if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }",
            "publishDir \"${params.output_dir}/${params.subsample_depth}_subsampled_reads\", mode: 'copy'",
            "cpus 1"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_pre_trim": {
        "name_process": "fastqc_pre_trim",
        "string_process": "\nprocess fastqc_pre_trim{\n    tag \"${pair_id}\"\n    container 'singlecellpipeline/fastqc:v0.0.2'\n    publishDir fastqc_pre_trim_publish_dir, mode: 'copy'\n    cpus 1\n    cache 'lenient'\n\n    input:\n    tuple val(pair_id), path(fastq_file) from ch_fastqc_pre_trim.flatMap{[[\"${it[0]}_1\", it[1][0]], [\"${it[0]}_2\", it[1][1]]]}\n\n    output:\n    file \"${out_name}\" into ch_fastqc_pre_trim_output\n\n    script:\n    out_name = fastq_file.getName().replaceAll('.fastq.gz', '.pre_trim.fastqc.html').replaceAll('.fq.gz', '.pre_trim.fastqc.html')\n    \"\"\"\n    fastqc -t 2 -o . $fastq_file\n    mv *.html ${out_name}\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    out_name = fastq_file.getName().replaceAll('.fastq.gz', '.pre_trim.fastqc.html').replaceAll('.fq.gz', '.pre_trim.fastqc.html')\n    \"\"\"\n    fastqc -t 2 -o . $fastq_file\n    mv *.html ${out_name}\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "ch_fastqc_pre_trim"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_fastqc_pre_trim_output"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'singlecellpipeline/fastqc:v0.0.2'",
            "publishDir fastqc_pre_trim_publish_dir, mode: 'copy'",
            "cpus 1",
            "cache 'lenient'"
        ],
        "when": "",
        "stub": ""
    },
    "trimmomatic": {
        "name_process": "trimmomatic",
        "string_process": "\nprocess trimmomatic{\n    cache 'lenient'\n\ttag \"${pair_id}\"\n    container 'davelabhub/trimmomatic:0.39--1'\n    if (workflow.containerEngine == 'docker'){\n            containerOptions '-u $(id -u):$(id -g)'\n        }\n    cpus params.trimmomatic_threads\n\t\n\tinput:\n\ttuple val(pair_id), path(fastqs) from ch_trimmomatic_input\n\t\n\toutput:\n\ttuple val(pair_id), file(\"${pair_id}*{1,2}P.fq.gz\") into ch_fastqc_post_trim_paired,ch_ngm_paired\n    tuple val(pair_id), file(\"${pair_id}*{1,2}U.fq.gz\") into ch_fastqc_post_trim_unpaired,ch_ngm_unpaired\n\n\tscript:\n\toutbase = fastqs[0].getName().replaceAll('.fastq.gz', '.trimmed.fq.gz').replaceAll('.fq.gz', '.trimmed.fq.gz')\n\t\"\"\"\n\ttrimmomatic PE -threads ${params.trimmomatic_threads} -basein ${fastqs[0]} \\\\\n\t\t-baseout $outbase \\\\\n\t\tILLUMINACLIP:${tru_seq_pe_fasta_path}:2:30:10:2:keepBothReads \\\\\n\t\tSLIDINGWINDOW:4:20 MINLEN:70 LEADING:10 HEADCROP:5 TRAILING:10 \n\t\"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "\toutbase = fastqs[0].getName().replaceAll('.fastq.gz', '.trimmed.fq.gz').replaceAll('.fq.gz', '.trimmed.fq.gz')\n\t\"\"\"\n\ttrimmomatic PE -threads ${params.trimmomatic_threads} -basein ${fastqs[0]} \\\\\n\t\t-baseout $outbase \\\\\n\t\tILLUMINACLIP:${tru_seq_pe_fasta_path}:2:30:10:2:keepBothReads \\\\\n\t\tSLIDINGWINDOW:4:20 MINLEN:70 LEADING:10 HEADCROP:5 TRAILING:10 \n\t\"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "Trimmomatic"
        ],
        "tools_url": [
            "https://bio.tools/trimmomatic"
        ],
        "tools_dico": [
            {
                "name": "Trimmomatic",
                "uri": "https://bio.tools/trimmomatic",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "A flexible read trimming tool for Illumina NGS data",
                "homepage": "http://www.usadellab.org/cms/index.php?page=trimmomatic"
            }
        ],
        "inputs": [
            "ch_trimmomatic_input"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_fastqc_post_trim_paired",
            "ch_ngm_paired",
            "ch_fastqc_post_trim_unpaired",
            "ch_ngm_unpaired"
        ],
        "nb_outputs": 4,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "cache 'lenient'",
            "tag \"${pair_id}\"",
            "container 'davelabhub/trimmomatic:0.39--1' if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }",
            "cpus params.trimmomatic_threads"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_post_trim": {
        "name_process": "fastqc_post_trim",
        "string_process": "\nprocess fastqc_post_trim{\n    tag \"${pair_id}\"\n    container 'singlecellpipeline/fastqc:v0.0.2'\n    publishDir fastqc_post_trim_publish_dir, mode: 'copy'\n    cpus 1\n    cache 'lenient'\n\n    input:\n    tuple val(pair_id), file(paired_files), file(unpaired_files) from ch_fastqc_post_trim_paired.join(ch_fastqc_post_trim_unpaired)\n\n    output:\n    tuple file(\"${pair_id}*1P*fastqc.html\"), file(\"${pair_id}*2P*fastqc.html\"), file(\"${pair_id}*1U*fastqc.html\"), file(\"${pair_id}*2U*fastqc.html\") into ch_fastqc_post_trim_output\n\n    script:\n    \"\"\"\n    fastqc -t 2 -o . ${paired_files[0]}\n    fastqc -t 2 -o . ${paired_files[1]}\n    fastqc -t 2 -o . ${unpaired_files[0]}\n    fastqc -t 2 -o . ${unpaired_files[1]}\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    fastqc -t 2 -o . ${paired_files[0]}\n    fastqc -t 2 -o . ${paired_files[1]}\n    fastqc -t 2 -o . ${unpaired_files[0]}\n    fastqc -t 2 -o . ${unpaired_files[1]}\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "ch_fastqc_post_trim_paired",
            "ch_fastqc_post_trim_unpaired"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_fastqc_post_trim_output"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'singlecellpipeline/fastqc:v0.0.2'",
            "publishDir fastqc_post_trim_publish_dir, mode: 'copy'",
            "cpus 1",
            "cache 'lenient'"
        ],
        "when": "",
        "stub": ""
    },
    "nextgenmap_indexing": {
        "name_process": "nextgenmap_indexing",
        "string_process": " process nextgenmap_indexing{\n            conda 'envs/ngm.yaml'\n            cpus params.mapping_threads\n\n            input:\n            path ref_genome from params.ref\n\n            output:\n            tuple path(ref_genome), path(\"*.ngm\") into ngm_index_ch\n\n            script:\n            \"\"\"\n            ngm -t ${task.cpus} -r ${ref_genome}\n            \"\"\"\n        }",
        "nb_lignes_process": 13,
        "string_script": "            \"\"\"\n            ngm -t ${task.cpus} -r ${ref_genome}\n            \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "NGMLR"
        ],
        "tools_url": [
            "https://bio.tools/ngmlr"
        ],
        "tools_dico": [
            {
                "name": "NGMLR",
                "uri": "https://bio.tools/ngmlr",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "Structural variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "Genomic structural variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "DNA structural variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2520",
                                    "term": "DNA mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3497",
                                "term": "DNA sequence (raw)"
                            },
                            {
                                "uri": "http://edamontology.org/data_2093",
                                "term": "Data reference"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_1383",
                                "term": "Nucleic acid sequence alignment"
                            }
                        ]
                    }
                ],
                "description": "An algorithm to map third generation long-read sequencing data (PacBio and Oxford Nanopore) to a reference genome with a focus on reads that span structural variation.",
                "homepage": "https://github.com/philres/ngmlr"
            }
        ],
        "inputs": [
            "params"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ngm_index_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "conda 'envs/ngm.yaml'",
            "cpus params.mapping_threads"
        ],
        "when": "",
        "stub": ""
    },
    "nextgenmap_mapping": {
        "name_process": "nextgenmap_mapping",
        "string_process": " process nextgenmap_mapping{\n        tag \"${pair_id}\"\n        conda 'envs/ngm.yaml'\n        cpus params.mapping_threads\n\n        input:\n        tuple val(pair_id), file(paired), file(unpaired), path(ref_genome), path(ref_genome_indices) from ch_ngm_paired.join(ch_ngm_unpaired).combine(ngm_index_ch)\n\n        output:\n        tuple val(pair_id), file(\"${pair_id}_P_mapped.unsorted.bam\"), file(\"${pair_id}_U1_mapped.unsorted.bam\"), file(\"${pair_id}_U2_mapped.unsorted.bam\") into samtools_sort_ch\n\n        script:\n        \"\"\"\n        ngm -b -t ${task.cpus} -r ${ref_genome} -1 ${paired[0]} -2 ${paired[1]} -o ${pair_id}_P_mapped.unsorted.bam;\n        ngm -b -t ${task.cpus} -r ${ref_genome} -q ${unpaired[0]} -o ${pair_id}_U1_mapped.unsorted.bam;\n        ngm -b -t ${task.cpus} -r ${ref_genome} -q ${unpaired[1]} -o ${pair_id}_U2_mapped.unsorted.bam;\n        \"\"\"\n    }",
        "nb_lignes_process": 16,
        "string_script": "        \"\"\"\n        ngm -b -t ${task.cpus} -r ${ref_genome} -1 ${paired[0]} -2 ${paired[1]} -o ${pair_id}_P_mapped.unsorted.bam;\n        ngm -b -t ${task.cpus} -r ${ref_genome} -q ${unpaired[0]} -o ${pair_id}_U1_mapped.unsorted.bam;\n        ngm -b -t ${task.cpus} -r ${ref_genome} -q ${unpaired[1]} -o ${pair_id}_U2_mapped.unsorted.bam;\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "NGMLR"
        ],
        "tools_url": [
            "https://bio.tools/ngmlr"
        ],
        "tools_dico": [
            {
                "name": "NGMLR",
                "uri": "https://bio.tools/ngmlr",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "Structural variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "Genomic structural variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "DNA structural variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2520",
                                    "term": "DNA mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3497",
                                "term": "DNA sequence (raw)"
                            },
                            {
                                "uri": "http://edamontology.org/data_2093",
                                "term": "Data reference"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_1383",
                                "term": "Nucleic acid sequence alignment"
                            }
                        ]
                    }
                ],
                "description": "An algorithm to map third generation long-read sequencing data (PacBio and Oxford Nanopore) to a reference genome with a focus on reads that span structural variation.",
                "homepage": "https://github.com/philres/ngmlr"
            }
        ],
        "inputs": [
            "ch_ngm_paired",
            "ch_ngm_unpaired",
            "ngm_index_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "samtools_sort_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "conda 'envs/ngm.yaml'",
            "cpus params.mapping_threads"
        ],
        "when": "",
        "stub": ""
    },
    "samtools_sort": {
        "name_process": "samtools_sort",
        "string_process": " process samtools_sort{\n        tag \"${pair_id}\"\n        container 'singlecellpipeline/samtools:v0.0.3'\n        cpus params.mapping_threads\n\n        input:\n        tuple val(pair_id), file(paired), file(unpaired_1), path(unpaired_2) from samtools_sort_ch\n\n        output:\n        tuple val(pair_id), file(\"${pair_id}_P_mapped.bam\"), file(\"${pair_id}_U1_mapped.bam\"), file(\"${pair_id}_U2_mapped.bam\") into merge_paired_unpaired_ch\n\n        script:\n        \"\"\"\n        samtools sort --threads ${task.cpus - 1} ${paired} --output-fmt BAM > ${pair_id}_P_mapped.bam;\n        samtools sort --threads ${task.cpus - 1} ${unpaired_1} --output-fmt BAM > ${pair_id}_U1_mapped.bam;\n        samtools sort --threads ${task.cpus - 1} ${unpaired_2} --output-fmt BAM > ${pair_id}_U2_mapped.bam;\n        \"\"\"\n    }",
        "nb_lignes_process": 16,
        "string_script": "        \"\"\"\n        samtools sort --threads ${task.cpus - 1} ${paired} --output-fmt BAM > ${pair_id}_P_mapped.bam;\n        samtools sort --threads ${task.cpus - 1} ${unpaired_1} --output-fmt BAM > ${pair_id}_U1_mapped.bam;\n        samtools sort --threads ${task.cpus - 1} ${unpaired_2} --output-fmt BAM > ${pair_id}_U2_mapped.bam;\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "samtools_sort_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "merge_paired_unpaired_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'singlecellpipeline/samtools:v0.0.3'",
            "cpus params.mapping_threads"
        ],
        "when": "",
        "stub": ""
    },
    "bwa_indexing": {
        "name_process": "bwa_indexing",
        "string_process": " process bwa_indexing{\n            container 'biocontainers/bwa:v0.7.17_cv1'\n            if (workflow.containerEngine == 'docker'){\n                containerOptions '-u $(id -u):$(id -g)'\n            }\n            cpus params.mapping_threads\n\n            input:\n            path ref_genome from params.ref\n\n            output:\n            tuple path(ref_genome), path(\"*{.sa,.amb,.ann,.pac,.bwt}\") into ngm_index_ch\n\n            script:\n            \"\"\"\n            bwa index ${ref_genome}\n            \"\"\"\n        }",
        "nb_lignes_process": 16,
        "string_script": "            \"\"\"\n            bwa index ${ref_genome}\n            \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "params"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ngm_index_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container 'biocontainers/bwa:v0.7.17_cv1' if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }",
            "cpus params.mapping_threads"
        ],
        "when": "",
        "stub": ""
    },
    "bwa_mapping_sort": {
        "name_process": "bwa_mapping_sort",
        "string_process": " process bwa_mapping_sort{\n        tag \"${pair_id}\"\n        container 'dukegcb/bwa-samtools:latest'\n        if (workflow.containerEngine == 'docker'){\n            containerOptions '-u $(id -u):$(id -g)'\n        }\n        cpus params.mapping_threads\n\n        input:\n        tuple val(pair_id), file(paired), file(unpaired), path(ref_genome), path(ref_genome_indices) from ch_ngm_paired.join(ch_ngm_unpaired).combine(ngm_index_ch)\n\n        output:\n        tuple val(pair_id), file(\"${pair_id}_P_mapped.bam\"), file(\"${pair_id}_U1_mapped.bam\"), file(\"${pair_id}_U2_mapped.bam\") into merge_paired_unpaired_ch\n\n        script:\n        \"\"\"\n        bwa mem -t ${task.cpus} ${ref_genome} ${paired[0]} ${paired[1]} | samtools sort -@${task.cpus} -o ${pair_id}_P_mapped.bam -\n        bwa mem -t ${task.cpus} ${ref_genome} ${unpaired[0]} | samtools sort -@${task.cpus} -o ${pair_id}_U1_mapped.bam -\n        bwa mem -t ${task.cpus} ${ref_genome} ${unpaired[1]} | samtools sort -@${task.cpus} -o ${pair_id}_U2_mapped.bam -\n        \"\"\"\n    }",
        "nb_lignes_process": 19,
        "string_script": "        \"\"\"\n        bwa mem -t ${task.cpus} ${ref_genome} ${paired[0]} ${paired[1]} | samtools sort -@${task.cpus} -o ${pair_id}_P_mapped.bam -\n        bwa mem -t ${task.cpus} ${ref_genome} ${unpaired[0]} | samtools sort -@${task.cpus} -o ${pair_id}_U1_mapped.bam -\n        bwa mem -t ${task.cpus} ${ref_genome} ${unpaired[1]} | samtools sort -@${task.cpus} -o ${pair_id}_U2_mapped.bam -\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_ngm_paired",
            "ch_ngm_unpaired",
            "ngm_index_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "merge_paired_unpaired_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'dukegcb/bwa-samtools:latest' if (workflow.containerEngine == 'docker'){ containerOptions '-u $(id -u):$(id -g)' }",
            "cpus params.mapping_threads"
        ],
        "when": "",
        "stub": ""
    },
    "merge_paired_and_unpaired": {
        "name_process": "merge_paired_and_unpaired",
        "string_process": "\nprocess merge_paired_and_unpaired{\n    tag \"${pair_id}\"\n    container 'broadinstitute/gatk:4.2.4.1'\n    cpus 1\n\n    input:\n    tuple val(pair_id), file(paired), file(unpaired_one), file(unpaired_two) from merge_paired_unpaired_ch\n\n    output:\n    tuple val(pair_id), file(\"${pair_id}.merged.mapped.bam\"), file(\"${pair_id}.merged.mapped*.bai\") into add_read_group_headers_ch\n\n    script:\n    \"\"\"\n    gatk --java-options \"-XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" MergeSamFiles --SORT_ORDER coordinate --CREATE_INDEX --INPUT $paired --INPUT $unpaired_one --INPUT $unpaired_two --OUTPUT ${pair_id}.merged.mapped.bam\n    \"\"\"\n\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    gatk --java-options \"-XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" MergeSamFiles --SORT_ORDER coordinate --CREATE_INDEX --INPUT $paired --INPUT $unpaired_one --INPUT $unpaired_two --OUTPUT ${pair_id}.merged.mapped.bam\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "merge_paired_unpaired_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "add_read_group_headers_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'broadinstitute/gatk:4.2.4.1'",
            "cpus 1"
        ],
        "when": "",
        "stub": ""
    },
    "add_read_group_headers": {
        "name_process": "add_read_group_headers",
        "string_process": "\nprocess add_read_group_headers{\n    tag \"${pair_id}\"\n    container 'broadinstitute/gatk:4.2.4.1'\n    cpus 1\n\n    input:\n    tuple val(pair_id), file(merged), file(merged_bai), val(read_group_string) from add_read_group_headers_ch.join(Channel.fromList(read_group_map))\n\n    output:\n    tuple val(pair_id), file(\"${pair_id}.merged.mapped.readGroupHeaders.bam\"), file(\"${pair_id}.merged.mapped.readGroupHeaders*.bai\") into mark_duplicates_ch, mapping_stats_prededup_ch, estimate_library_complexity_ch, bamtobed_ch\n\n    script:\n    \"\"\"\n    gatk --java-options \"-XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" AddOrReplaceReadGroups --CREATE_INDEX true --INPUT ${merged} --OUTPUT ${pair_id}.merged.mapped.readGroupHeaders.bam ${read_group_string}\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    gatk --java-options \"-XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" AddOrReplaceReadGroups --CREATE_INDEX true --INPUT ${merged} --OUTPUT ${pair_id}.merged.mapped.readGroupHeaders.bam ${read_group_string}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "add_read_group_headers_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "mark_duplicates_ch",
            "mapping_stats_prededup_ch",
            "estimate_library_complexity_ch",
            "bamtobed_ch"
        ],
        "nb_outputs": 4,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'broadinstitute/gatk:4.2.4.1'",
            "cpus 1"
        ],
        "when": "",
        "stub": ""
    },
    "bamtobed_preseq": {
        "name_process": "bamtobed_preseq",
        "string_process": "\nprocess bamtobed_preseq{\n    tag \"${pair_id}\"\n    container \"didillysquat/bedtools_preseq:latest\"\n    publishDir preseq_complexity_prediction_publishDir, mode: \"copy\"\n\n    input:\n    tuple val(pair_id), file(bam), file(bai) from bamtobed_ch\n\n    output:\n    tuple file(\"${pair_id}.c_curve.txt\"), file(\"${pair_id}.lc_extrap.txt\") into preseq_out_ch\n\n    script:\n    \"\"\"\n    bedtools bamtobed -i $bam > ${pair_id}.merged.mapped.readGroupHeaders.bed\n    preseq c_curve -P ${pair_id}.merged.mapped.readGroupHeaders.bed > ${pair_id}.c_curve.txt\n    preseq lc_extrap -P ${pair_id}.merged.mapped.readGroupHeaders.bed > ${pair_id}.lc_extrap.txt\n    rm ${pair_id}.merged.mapped.readGroupHeaders.bed\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    bedtools bamtobed -i $bam > ${pair_id}.merged.mapped.readGroupHeaders.bed\n    preseq c_curve -P ${pair_id}.merged.mapped.readGroupHeaders.bed > ${pair_id}.c_curve.txt\n    preseq lc_extrap -P ${pair_id}.merged.mapped.readGroupHeaders.bed > ${pair_id}.lc_extrap.txt\n    rm ${pair_id}.merged.mapped.readGroupHeaders.bed\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BEDTools",
            "preseq"
        ],
        "tools_url": [
            "https://bio.tools/bedtools",
            "https://bio.tools/preseq"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            },
            {
                "name": "preseq",
                "uri": "https://bio.tools/preseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2423",
                                    "term": "Prediction and recognition"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package is aimed at predicting and number of distinct reads and how many will be expected from additional sequencing using an initial sequencing experiment. The estimates can then be used to examine the utility of further sequencing, optimize the sequencing depth, or to screen multiple libraries to avoid low complexity samples.",
                "homepage": "http://smithlabresearch.org/software/preseq/"
            }
        ],
        "inputs": [
            "bamtobed_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "preseq_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container \"didillysquat/bedtools_preseq:latest\"",
            "publishDir preseq_complexity_prediction_publishDir, mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "plot_preseq_complexity_curves": {
        "name_process": "plot_preseq_complexity_curves",
        "string_process": "\nprocess plot_preseq_complexity_curves{\n    tag \"plot_preseq_complexity_curves\"\n    container \"didillysquat/r_multipurpose:latest\"\n    publishDir preseq_complexity_prediction_publishDir, mode: \"copy\"\n\n    input:\n    path curve_files from preseq_out_ch.collect()\n\n    output:\n    file \"library.complexity.png\" into plot_preseq_complexity_curves_out_ch\n\n    script:\n    \"\"\"\n    Rscript ${bin_dir}/plot_preseq_lib_complex.r \\$PWD\n    \"\"\"\n\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    Rscript ${bin_dir}/plot_preseq_lib_complex.r \\$PWD\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "preseq_out_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "plot_preseq_complexity_curves_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"plot_preseq_complexity_curves\"",
            "container \"didillysquat/r_multipurpose:latest\"",
            "publishDir preseq_complexity_prediction_publishDir, mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "samtools_mapping_stats_pre_deduplication": {
        "name_process": "samtools_mapping_stats_pre_deduplication",
        "string_process": "\nprocess samtools_mapping_stats_pre_deduplication{\n    tag \"${sample}\"\n    publishDir samtools_mapping_stats_prededup_publishDir, mode: \"copy\"\n    container 'singlecellpipeline/samtools:v0.0.3'\n\n    input:\n    tuple val(sample), path(bam), path(bai) from mapping_stats_prededup_ch\n\n    output:\n    path \"${sample}.bam.prededup.stats.txt\" into samtools_stats_prededup_out\n\n    script:\n    \"\"\"\n    samtools stats $bam > ${sample}.bam.prededup.stats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    samtools stats $bam > ${sample}.bam.prededup.stats.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "mapping_stats_prededup_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "samtools_stats_prededup_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${sample}\"",
            "publishDir samtools_mapping_stats_prededup_publishDir, mode: \"copy\"",
            "container 'singlecellpipeline/samtools:v0.0.3'"
        ],
        "when": "",
        "stub": ""
    },
    "markduplicates_spark": {
        "name_process": "markduplicates_spark",
        "string_process": "\nprocess markduplicates_spark{\n    tag \"${pair_id}\"\n    container 'broadinstitute/gatk:4.2.4.1'\n    publishDir markduplicates_metrics_publishDir, pattern: \"*.metrics.txt\", mode: 'copy'\n    publishDir output_bam_publishDir, pattern: \"*.bam{,.bai}\", mode: 'copy'\n    cpus params.mark_duplicate_threads\n\n    input:\n    tuple val(pair_id), file(merged), file(merged_bai) from mark_duplicates_ch\n\n    output:\n    tuple val(pair_id), file(\"${pair_id}.merged.deduplicated.sorted.bam{,.bai}\") into collect_gc_bias_metrics_ch,pcr_bottleneck_coefficient_ch,mosdepth_sequencing_coverage_ch,samtools_depth_stats_ch,samtools_mapping_stats_postdedup_ch,perprocess_overview_bams_ch\n    file(\"${pair_id}.merged.deduplicated.sorted.metrics.txt\") into mark_duplicate_metrics_ch\n\n    script:\n    \"\"\"\n    gatk MarkDuplicatesSpark --java-options \"-XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" --create-output-bam-index true --remove-all-duplicates -I ${merged} -O ${pair_id}.merged.deduplicated.sorted.bam -M ${pair_id}.merged.deduplicated.sorted.metrics.txt --conf 'spark.port.maxRetries=${num_samples}' --spark-master local[${task.cpus}]\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    gatk MarkDuplicatesSpark --java-options \"-XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" --create-output-bam-index true --remove-all-duplicates -I ${merged} -O ${pair_id}.merged.deduplicated.sorted.bam -M ${pair_id}.merged.deduplicated.sorted.metrics.txt --conf 'spark.port.maxRetries=${num_samples}' --spark-master local[${task.cpus}]\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "mark_duplicates_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "collect_gc_bias_metrics_ch",
            "pcr_bottleneck_coefficient_ch",
            "mosdepth_sequencing_coverage_ch",
            "samtools_depth_stats_ch",
            "samtools_mapping_stats_postdedup_ch",
            "perprocess_overview_bams_ch",
            "mark_duplicate_metrics_ch"
        ],
        "nb_outputs": 7,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'broadinstitute/gatk:4.2.4.1'",
            "publishDir markduplicates_metrics_publishDir, pattern: \"*.metrics.txt\", mode: 'copy'",
            "publishDir output_bam_publishDir, pattern: \"*.bam{,.bai}\", mode: 'copy'",
            "cpus params.mark_duplicate_threads"
        ],
        "when": "",
        "stub": ""
    },
    "estimate_library_complexity": {
        "name_process": "estimate_library_complexity",
        "string_process": "\nprocess estimate_library_complexity{\n    tag \"${pair_id}\"\n    container 'broadinstitute/gatk:4.2.4.1'\n    publishDir estimatelibrarycomplexity_metrics_publishDir, pattern: \"*.metrics.txt\", mode: 'copy'\n\n    input:\n    tuple val(pair_id), file(merged), file(merged_bai) from estimate_library_complexity_ch\n\n    output:\n    file(\"${pair_id}.estlibcomp.txt\") into est_lib_comp_metrics_ch\n\n    script:\n    \"\"\"\n    gatk EstimateLibraryComplexity --java-options \"-Xmx${params.estlibcomp_max_mem}g -XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" -I ${merged} -O ${pair_id}.estlibcomp.txt\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    gatk EstimateLibraryComplexity --java-options \"-Xmx${params.estlibcomp_max_mem}g -XX:ParallelGCThreads=1 -XX:ConcGCThreads=1\" -I ${merged} -O ${pair_id}.estlibcomp.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "estimate_library_complexity_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "est_lib_comp_metrics_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "container 'broadinstitute/gatk:4.2.4.1'",
            "publishDir estimatelibrarycomplexity_metrics_publishDir, pattern: \"*.metrics.txt\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "collect_gc_bias_metrics": {
        "name_process": "collect_gc_bias_metrics",
        "string_process": "\nprocess collect_gc_bias_metrics{\n    tag \"${pair_id}\"\n    publishDir collect_gc_bias_metrics_publishDir, mode: 'copy'\n    container 'broadinstitute/gatk:4.2.4.1'\n    cpus 1\n\n    input:\n    tuple val(pair_id), path(merged) from collect_gc_bias_metrics_ch\n    path ref_genome from params.ref\n    \n    output:\n    tuple path(\"${pair_id}.merged.GCBias.txt\"), path(\"${pair_id}.merged.GCBias.pdf\"), path(\"${pair_id}.merged.SumBias.txt\")\n\n    script:\n    \"\"\"\n    gatk CollectGcBiasMetrics I=${merged[0]} O=${pair_id}.merged.GCBias.txt \\\n\tCHART=${pair_id}.merged.GCBias.pdf S=${pair_id}.merged.SumBias.txt R=${ref_genome}\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    gatk CollectGcBiasMetrics I=${merged[0]} O=${pair_id}.merged.GCBias.txt \\\n\tCHART=${pair_id}.merged.GCBias.pdf S=${pair_id}.merged.SumBias.txt R=${ref_genome}\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "collect_gc_bias_metrics_ch",
            "params"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "publishDir collect_gc_bias_metrics_publishDir, mode: 'copy'",
            "container 'broadinstitute/gatk:4.2.4.1'",
            "cpus 1"
        ],
        "when": "",
        "stub": ""
    },
    "pcr_bottleneck_coefficient": {
        "name_process": "pcr_bottleneck_coefficient",
        "string_process": "\nprocess pcr_bottleneck_coefficient{\n    tag \"${pair_id}\"\n    publishDir pcr_bottleneck_coefficient_publishDir, mode: 'copy'\n    container 'encodedcc/atac-seq-pipeline:PIP-1469_pbam_b92239a0-82a0-4297-b8b3-3a655a4626a8'\n    cpus 1\n    maxRetries 5\n    errorStrategy  { task.attempt <= maxRetries  ? 'retry' : 'ignore' }\n\n    input:\n    tuple val(pair_id), path(merged) from pcr_bottleneck_coefficient_ch\n    \n    output:\n    tuple path(\"${pair_id}.merged.allout.txt\"), path(\"${pair_id}.pbc.merged.txt\") into pcr_bottleneck_coefficient_out_ch\n\n    shell:\n    '''\n    bedtools bamtobed -bedpe -i !{merged[0]} | awk 'BEGIN{{OFS=\"\\\\t\"}}{{print $1, $2, $4, $6, $9, $10}}' | grep -v \"^{}\\\\s\" | sort | uniq -c  | \\\n    awk 'BEGIN{{mt=0;m0=0;m1=0;m2=0}} ($1==1) {{m1=m1+1}} ($1==2) {{m2=m2+1}} {{m0=m0+1}} {{mt=mt+$1}} END{{m1_m2=-1.0;\n    if (m2>0) m1_m2=m1/m2;\n    m0_mt=0;\n    if (mt>0) m0_mt=m0/mt;\n    m1_m0=0;\n    if (m0>0) m1_m0=m1/m0;\n    printf \"%d %d %d %d %f %f %f\\\\n\",mt,m0,m1,m2,m0_mt,m1_m0,m1_m2}}\\' > l.txt;\n    cat l.txt >> !{pair_id}.merged.allout.txt;\n    awk '{print $5}' l.txt > a.txt;\n    cat a.txt >> !{pair_id}.pbc.merged.txt;\n    '''\n}",
        "nb_lignes_process": 28,
        "string_script": "    '''\n    bedtools bamtobed -bedpe -i !{merged[0]} | awk 'BEGIN{{OFS=\"\\\\t\"}}{{print $1, $2, $4, $6, $9, $10}}' | grep -v \"^{}\\\\s\" | sort | uniq -c  | \\\n    awk 'BEGIN{{mt=0;m0=0;m1=0;m2=0}} ($1==1) {{m1=m1+1}} ($1==2) {{m2=m2+1}} {{m0=m0+1}} {{mt=mt+$1}} END{{m1_m2=-1.0;\n    if (m2>0) m1_m2=m1/m2;\n    m0_mt=0;\n    if (mt>0) m0_mt=m0/mt;\n    m1_m0=0;\n    if (m0>0) m1_m0=m1/m0;\n    printf \"%d %d %d %d %f %f %f\\\\n\",mt,m0,m1,m2,m0_mt,m1_m0,m1_m2}}\\' > l.txt;\n    cat l.txt >> !{pair_id}.merged.allout.txt;\n    awk '{print $5}' l.txt > a.txt;\n    cat a.txt >> !{pair_id}.pbc.merged.txt;\n    '''",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "pcr_bottleneck_coefficient_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "pcr_bottleneck_coefficient_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "publishDir pcr_bottleneck_coefficient_publishDir, mode: 'copy'",
            "container 'encodedcc/atac-seq-pipeline:PIP-1469_pbam_b92239a0-82a0-4297-b8b3-3a655a4626a8'",
            "cpus 1",
            "maxRetries 5",
            "errorStrategy { task.attempt <= maxRetries ? 'retry' : 'ignore' }"
        ],
        "when": "",
        "stub": ""
    },
    "mosdepth_sequencing_coverage": {
        "name_process": "mosdepth_sequencing_coverage",
        "string_process": "\nprocess mosdepth_sequencing_coverage{\n    tag \"${pair_id}\"\n    publishDir mosdepth_sequencing_coverage_publishDir, mode: 'copy'\n    container 'davelabhub/mosdepth:0.2.5--hb763d49_0'\n    cpus 1\n    \n    input:\n    tuple val(pair_id), path(merged) from mosdepth_sequencing_coverage_ch\n    \n    output:\n    tuple val(pair_id), path(\"${pair_id}.merged.mosdepth.global.dist.txt\") into mosdepth_sequencing_coverage_out_ch\n\n    script:\n    \"\"\"\n    mosdepth -nx ${pair_id}.merged ${merged[0]}\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    mosdepth -nx ${pair_id}.merged ${merged[0]}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "mosdepth"
        ],
        "tools_url": [
            "https://bio.tools/mosdepth"
        ],
        "tools_dico": [
            {
                "name": "mosdepth",
                "uri": "https://bio.tools/mosdepth",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2269",
                            "term": "Statistics and probability"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2478",
                                    "term": "Nucleic acid sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3230",
                                    "term": "Read depth analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2478",
                                    "term": "Sequence analysis (nucleic acid)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fast BAM/CRAM depth calculation for WGS, exome, or targeted sequencing.",
                "homepage": "https://github.com/brentp/mosdepth"
            }
        ],
        "inputs": [
            "mosdepth_sequencing_coverage_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "mosdepth_sequencing_coverage_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "publishDir mosdepth_sequencing_coverage_publishDir, mode: 'copy'",
            "container 'davelabhub/mosdepth:0.2.5--hb763d49_0'",
            "cpus 1"
        ],
        "when": "",
        "stub": ""
    },
    "mosdepth_plot_seq_coverage": {
        "name_process": "mosdepth_plot_seq_coverage",
        "string_process": "\nprocess mosdepth_plot_seq_coverage{\n    tag \"${pair_id}\"\n    publishDir mosdepth_sequencing_coverage_publishDir, mode: 'copy'\n    container \"quay.io/biocontainers/python:3.8.3\"\n    cpus 1\n\n    input:\n    tuple val(pair_id), path(merged) from mosdepth_sequencing_coverage_out_ch\n\n    output:\n    path(\"${pair_id}.merged.mostdepth.html\") into mosdepth_plot_seq_coverage_out_ch\n\n    script:\n    \"\"\"\n    python3 ${bin_dir}/plot-dist.py -o ${pair_id}.merged.mostdepth.html ${merged}\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    python3 ${bin_dir}/plot-dist.py -o ${pair_id}.merged.mostdepth.html ${merged}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "mosdepth_sequencing_coverage_out_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "mosdepth_plot_seq_coverage_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${pair_id}\"",
            "publishDir mosdepth_sequencing_coverage_publishDir, mode: 'copy'",
            "container \"quay.io/biocontainers/python:3.8.3\"",
            "cpus 1"
        ],
        "when": "",
        "stub": ""
    },
    "samtools_mapping_stats_post_deduplication": {
        "name_process": "samtools_mapping_stats_post_deduplication",
        "string_process": "\nprocess samtools_mapping_stats_post_deduplication{\n    tag \"${sample}\"\n    publishDir samtools_mapping_stats_postdedup_publishDir, mode: \"copy\"\n    container 'singlecellpipeline/samtools:v0.0.3'\n\n    input:\n    tuple val(sample), path(bam) from samtools_mapping_stats_postdedup_ch\n\n    output:\n    path \"${sample}.bam.postdedup.stats.txt\" into samtools_stats_postdedup_out\n\n    script:\n    \"\"\"\n    samtools stats ${bam[0]} > ${sample}.bam.postdedup.stats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    samtools stats ${bam[0]} > ${sample}.bam.postdedup.stats.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "samtools_mapping_stats_postdedup_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "samtools_stats_postdedup_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${sample}\"",
            "publishDir samtools_mapping_stats_postdedup_publishDir, mode: \"copy\"",
            "container 'singlecellpipeline/samtools:v0.0.3'"
        ],
        "when": "",
        "stub": ""
    },
    "samtools_coverage_stats": {
        "name_process": "samtools_coverage_stats",
        "string_process": "\nprocess samtools_coverage_stats{\n    tag \"${sample}\"\n    publishDir samtools_coverage_stats_publishDir, mode: \"copy\"\n    container 'singlecellpipeline/samtools:v0.0.3'\n\n    input:\n    tuple val(sample), path(bam) from samtools_depth_stats_ch\n\n    output:\n    path \"${sample}.depth.txt\" into samtools_depth_out\n\n    script:\n    \"\"\"\n    samtools depth -a ${bam[0]} | LC_NUMERIC=en_US.UTF-8 awk '{sum+=\\$3; sumsq+=\\$3*\\$3} END { print \"Average = \",sum/NR; print \"Stdev = \",sqrt(sumsq/NR - (sum/NR)^2)}' > ${sample}.depth.txt\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    samtools depth -a ${bam[0]} | LC_NUMERIC=en_US.UTF-8 awk '{sum+=\\$3; sumsq+=\\$3*\\$3} END { print \"Average = \",sum/NR; print \"Stdev = \",sqrt(sumsq/NR - (sum/NR)^2)}' > ${sample}.depth.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "samtools_depth_stats_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "samtools_depth_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"${sample}\"",
            "publishDir samtools_coverage_stats_publishDir, mode: \"copy\"",
            "container 'singlecellpipeline/samtools:v0.0.3'"
        ],
        "when": "",
        "stub": ""
    },
    "preprocess_summary": {
        "name_process": "preprocess_summary",
        "string_process": "\nprocess preprocess_summary{\n    tag \"preprocess_summary\"\n    publishDir preprocessing_summary_publishDir, mode: \"copy\"\n    container 'amancevice/pandas:1.3.1'\n\n    input:\n    path pretrim from ch_fastqc_pre_trim_output.collect()\n    path posttrim from ch_fastqc_post_trim_output.collect()\n    path bams from perprocess_overview_bams_ch.collect{it[1]}\n    path depth from samtools_depth_out.collect()\n    path postdedup_stats from samtools_stats_postdedup_out.collect()\n    path duplication_metric from mark_duplicate_metrics_ch.collect()\n    path prededup_stats from samtools_stats_prededup_out.collect()\n    path est_lib_comp from est_lib_comp_metrics_ch.collect()\n    path input_tsv\n    \n    output:\n    path \"preprocessing_overview.tsv\" into preprocess_summary_out_ch\n\n    script:\n    \"\"\"\n    python3 ${bin_dir}/pre_process_stats_overview.py \\$PWD $input_tsv\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    \"\"\"\n    python3 ${bin_dir}/pre_process_stats_overview.py \\$PWD $input_tsv\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_fastqc_pre_trim_output",
            "ch_fastqc_post_trim_output",
            "perprocess_overview_bams_ch",
            "samtools_depth_out",
            "samtools_stats_postdedup_out",
            "mark_duplicate_metrics_ch",
            "samtools_stats_prededup_out",
            "est_lib_comp_metrics_ch",
            "input_tsv"
        ],
        "nb_inputs": 9,
        "outputs": [
            "preprocess_summary_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "tag \"preprocess_summary\"",
            "publishDir preprocessing_summary_publishDir, mode: \"copy\"",
            "container 'amancevice/pandas:1.3.1'"
        ],
        "when": "",
        "stub": ""
    },
    "bcftools_mpileup": {
        "name_process": "bcftools_mpileup",
        "string_process": " process bcftools_mpileup{\n        container 'halllab/bcftools:v1.9'\n\n        input:\n        each scaffold from Channel.fromList(scaffold_list)\n        tuple path(ref_genome), path(ref_genome_dict), path(ref_genome_fai) from bcftools_mpileup_ref_genome_ch\n        path(bam_bai) from bcftools_mpileup_ch.collect{it[1]}\n\n        output:\n        tuple val(scaffold), path(\"${scaffold}.vcf.gz\"), path(\"${scaffold}.vcf.gz.csi\") into bcftools_call_ch\n\n        script:\n        \"\"\"\n        bcftools mpileup -f ${ref_genome} -d 100 -Oz -r $scaffold -o ${scaffold}.vcf.gz ${bam_bai.findResults { i -> if(i.getName().endsWith(\".bam\")){\"$i \"}else{null}}.join()}\n        bcftools index ${scaffold}.vcf.gz\n        \"\"\"\n    }",
        "nb_lignes_process": 15,
        "string_script": "        \"\"\"\n        bcftools mpileup -f ${ref_genome} -d 100 -Oz -r $scaffold -o ${scaffold}.vcf.gz ${bam_bai.findResults { i -> if(i.getName().endsWith(\".bam\")){\"$i \"}else{null}}.join()}\n        bcftools index ${scaffold}.vcf.gz\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bcftools_mpileup_ref_genome_ch",
            "bcftools_mpileup_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bcftools_call_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container 'halllab/bcftools:v1.9'"
        ],
        "when": "",
        "stub": ""
    },
    "bcftools_call": {
        "name_process": "bcftools_call",
        "string_process": " process bcftools_call{\n        container 'halllab/bcftools:v1.9'\n        \n        input:\n        tuple val(scaffold), path(scaffold_vcf), path(scaffold_vcf_csi) from bcftools_call_ch\n\n        output:\n        path(\"${scaffold}.call.vcf.gz\") into bcftools_concat_ch\n        path(\"${scaffold}.call.vcf.gz.csi\") into bcftools_concat_csi_ch\n\n        script:\n        \"\"\"\n        bcftools call -Oz -o ${scaffold}.call.vcf.gz -r ${scaffold} -m -v $scaffold_vcf\n        bcftools index ${scaffold}.call.vcf.gz\n        \"\"\"\n\n    }",
        "nb_lignes_process": 15,
        "string_script": "        \"\"\"\n        bcftools call -Oz -o ${scaffold}.call.vcf.gz -r ${scaffold} -m -v $scaffold_vcf\n        bcftools index ${scaffold}.call.vcf.gz\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bcftools_call_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bcftools_concat_ch",
            "bcftools_concat_csi_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container 'halllab/bcftools:v1.9'"
        ],
        "when": "",
        "stub": ""
    },
    "bcftools_concat": {
        "name_process": "bcftools_concat",
        "string_process": " process bcftools_concat{\n        container 'halllab/bcftools:v1.9'\n        publishDir bcftools_call_publishDir, mode: \"copy\"\n\n        input:\n        path(per_scaffold_bcfs) from bcftools_concat_ch.collect()\n        path(per_scaffold_bcfs_csi) from bcftools_concat_csi_ch.collect()\n\n        output:\n        tuple path(\"bcftools.call.concat.vcf.gz\"), path(\"bcftools.call.concat.vcf.gz.tbi\") into bcftools_out_ch\n\n        script:\n        \"\"\"\n        bcftools concat -Oz -o bcftools.call.concat.vcf.gz ${per_scaffold_bcfs.collect{ i -> \"$i \"}.join()}\n        tabix -p vcf bcftools.call.concat.vcf.gz\n        \"\"\"\n    }",
        "nb_lignes_process": 15,
        "string_script": "        \"\"\"\n        bcftools concat -Oz -o bcftools.call.concat.vcf.gz ${per_scaffold_bcfs.collect{ i -> \"$i \"}.join()}\n        tabix -p vcf bcftools.call.concat.vcf.gz\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bcftools_concat_ch",
            "bcftools_concat_csi_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bcftools_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "didillysquat__kopp_2021_fowl",
        "directive": [
            "container 'halllab/bcftools:v1.9'",
            "publishDir bcftools_call_publishDir, mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    }
}