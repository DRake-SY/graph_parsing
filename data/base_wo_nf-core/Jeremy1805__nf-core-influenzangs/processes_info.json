{
    "get_software_versions": {
        "name_process": "get_software_versions",
        "string_process": "\nprocess get_software_versions {\n    publishDir \"${params.outdir}/pipeline_info\", mode: params.publishDirMode,\n    saveAs: {filename ->\n        if (filename.indexOf(\".csv\") > 0) filename\n        else null\n    }\n\n    output:\n    file 'software_versions_mqc.yaml' into software_versions_yaml\n    file \"software_versions.csv\"\n\n    script:\n    \"\"\"\n    echo \"${workflow.manifest.version}\" &> v_pipeline.txt 2>&1 || true\n    echo \"${workflow.nextflow.version}\" &> v_nextflow.txt 2>&1 || true\n    fastqc --version > v_fastqc.txt 2>&1 || true\n    trim_galore --version &> v_trim_galore.txt 2>&1 || true\n    samtools --version &> v_samtools.txt 2>&1 || true\n    bwa &> v_bwa.txt 2>&1 || true\n    picard MarkDuplicates --version &> v_picard_mark_dup.txt 2>&1 || true\n    picard CreateSequenceDictionary --version &> v_picard_dict.txt 2>&1 || true\n    multiqc --version &> v_multiqc.txt 2>&1 || true\n    scrape_software_versions.py &> software_versions_mqc.yaml\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    echo \"${workflow.manifest.version}\" &> v_pipeline.txt 2>&1 || true\n    echo \"${workflow.nextflow.version}\" &> v_nextflow.txt 2>&1 || true\n    fastqc --version > v_fastqc.txt 2>&1 || true\n    trim_galore --version &> v_trim_galore.txt 2>&1 || true\n    samtools --version &> v_samtools.txt 2>&1 || true\n    bwa &> v_bwa.txt 2>&1 || true\n    picard MarkDuplicates --version &> v_picard_mark_dup.txt 2>&1 || true\n    picard CreateSequenceDictionary --version &> v_picard_dict.txt 2>&1 || true\n    multiqc --version &> v_multiqc.txt 2>&1 || true\n    scrape_software_versions.py &> software_versions_mqc.yaml\n    \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "FastQC",
            "SAMtools",
            "BWA",
            "Picard",
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc",
            "https://bio.tools/samtools",
            "https://bio.tools/bwa",
            "https://bio.tools/picard_tools",
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            },
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "software_versions_yaml"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "publishDir \"${params.outdir}/pipeline_info\", mode: params.publishDirMode , saveAs: {filename -> if (filename.indexOf(\".csv\") > 0) filename else null }"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc": {
        "name_process": "fastqc",
        "string_process": "\nprocess fastqc {\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/fastqc\",  mode: params.publishDirMode,\n        saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}\n\n    input:\n    set val(id), file(reads) from raw_reads_fastqc\n\n    output:\n    file \"*_fastqc.{zip,html}\" into fastqc_results\n\n    script:\n    \"\"\"\n    fastqc -q $reads\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    fastqc -q $reads\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "raw_reads_fastqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/fastqc\", mode: params.publishDirMode , saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}"
        ],
        "when": "",
        "stub": ""
    },
    "trim_samples": {
        "name_process": "trim_samples",
        "string_process": "\nprocess trim_samples {\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/trimmed_samples\",  mode: params.publishDirMode,\n        saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}\n\n    input:\n    set val(id), file(reads) from raw_reads_trimgalore\n\n    output:\n    set val(id), file(\"${id}*val_1.fq\"), file(\"${id}*val_2.fq\")  into (trimmed_samples_ch,sample_count_ch)\n    file \"*_fastqc.{zip,html}\" into trimqc_results\n    file \"*_trimming_report.txt\" into trim_reports\n\n    script:\n    \"\"\"\n    trim_galore --dont_gzip --fastqc --paired ${reads[0]} ${reads[1]}\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    trim_galore --dont_gzip --fastqc --paired ${reads[0]} ${reads[1]}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "raw_reads_trimgalore"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            "trimqc_results",
            "trim_reports"
        ],
        "nb_outputs": 3,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/trimmed_samples\", mode: params.publishDirMode , saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}"
        ],
        "when": "",
        "stub": ""
    },
    "index_reference": {
        "name_process": "index_reference",
        "string_process": "\nprocess index_reference {\n    tag \"$reference\"\n\n    publishDir \"${params.outdir}/reference_indices\", mode: params.publishDirMode\n\n  \tinput:\n  \tset val(reference),file(referencepath) from labelled_reference_ch\n\n  \toutput:\n    set val(reference),file(\"*.{amb,ann,bwt,pac,sa}\") into bwa_ref_ch\n    set val(reference),file(referencepath),file(\"${reference}.{fasta.fai,dict}\") into gatk_mutect_reference_ch\n  \t\"\"\"\n  \tbwa index -p ${reference} -a is ${referencepath}\n\n  \tsamtools faidx ${referencepath}\n\n  \tpicard CreateSequenceDictionary R=${referencepath} O=${reference}.dict\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n  \tbwa index -p ${reference} -a is ${referencepath}\n\n  \tsamtools faidx ${referencepath}\n\n  \tpicard CreateSequenceDictionary R=${referencepath} O=${reference}.dict\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "labelled_reference_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bwa_ref_ch",
            "gatk_mutect_reference_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$reference\"",
            "publishDir \"${params.outdir}/reference_indices\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "build_bwa_mem_alignments": {
        "name_process": "build_bwa_mem_alignments",
        "string_process": "\nprocess build_bwa_mem_alignments {\n    tag { id + \"-\" + reference }\n\n    publishDir \"${params.outdir}/bwa_alignment\", mode: params.publishDirMode\n\n    input:\n    set val(id), file(trimreads1), file(trimreads2), val(reference), file(bwaindices) from bwa_mem_input_ch\n\n    output:\n    set val(id), val(reference), file(\"${id}.${reference}.bam.bai\"),\n    file(\"${id}.${reference}.bam\") into (built_bam_ch, bwa_count_ch)\n\n    script:\n    \"\"\"\n    bwa mem -t 4 -M -B 2 -R \"@RG\\\\tID:${id}\\\\tLB:${id}\\\\tSM:${id}\\\\tPL:ILLUMINA\" \\\\\n    ${reference} ${trimreads1} ${trimreads2}| samtools sort -@8 -O BAM -o ${id}.${reference}.bam -\n\n    samtools index ${id}.${reference}.bam\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    bwa mem -t 4 -M -B 2 -R \"@RG\\\\tID:${id}\\\\tLB:${id}\\\\tSM:${id}\\\\tPL:ILLUMINA\" \\\\\n    ${reference} ${trimreads1} ${trimreads2}| samtools sort -@8 -O BAM -o ${id}.${reference}.bam -\n\n    samtools index ${id}.${reference}.bam\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bwa_mem_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag { id + \"-\" + reference }",
            "publishDir \"${params.outdir}/bwa_alignment\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "picard_remove_duplicates": {
        "name_process": "picard_remove_duplicates",
        "string_process": "\nprocess picard_remove_duplicates{\n    tag { id + \"-\" + reference }\n\n    publishDir \"${params.outdir}/bam_no_duplicates\", mode: params.publishDirMode,\n      saveAs: {filename -> filename.indexOf(\".metrics\") > 0 ? \"metrics/$filename\" : \"$filename\"}\n\n    input:\n    set val(id),val(reference),file(bamindex),file(bamfile) from built_bam_ch\n\n    output:\n    set val(reference), val(id), file(\"${id}.${reference}.dedup.bam.bai\"),\n    file(\"${id}.${reference}.dedup.bam\") into bam_no_dup_ch\n\n    file \"${id}.${reference}.dedup.metrics\" into picardmetrics\n\n    script:\n \t  \"\"\"\n \t  picard MarkDuplicates REMOVE_DUPLICATES=true VALIDATION_STRINGENCY=LENIENT \\\\\n \t\tINPUT=$bamfile OUTPUT=${id}.${reference}.dedup.bam \\\\\n \t\tMETRICS_FILE=${id}.${reference}.dedup.metrics TMP_DIR=tmp\n\n    samtools index ${id}.${reference}.dedup.bam\n    \"\"\"\n }",
        "nb_lignes_process": 23,
        "string_script": " \t  \"\"\"\n \t  picard MarkDuplicates REMOVE_DUPLICATES=true VALIDATION_STRINGENCY=LENIENT \\\\\n \t\tINPUT=$bamfile OUTPUT=${id}.${reference}.dedup.bam \\\\\n \t\tMETRICS_FILE=${id}.${reference}.dedup.metrics TMP_DIR=tmp\n\n    samtools index ${id}.${reference}.dedup.bam\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "built_bam_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bam_no_dup_ch",
            "picardmetrics"
        ],
        "nb_outputs": 2,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag { id + \"-\" + reference }",
            "publishDir \"${params.outdir}/bam_no_duplicates\", mode: params.publishDirMode , saveAs: {filename -> filename.indexOf(\".metrics\") > 0 ? \"metrics/$filename\" : \"$filename\"}"
        ],
        "when": "",
        "stub": ""
    },
    "GATK_mutect": {
        "name_process": "GATK_mutect",
        "string_process": "\nprocess GATK_mutect {\n    tag {id + \"-\" + reference}\n\n    publishDir \"${params.outdir}/gatk_mutect\", mode: params.publishDirMode\n\n    input:\n    set val(reference), val(id), file(dupindex), file(dupfile),\n    file(reffasta), file(refindex) from GATK_input_mutect_ch\n\n    output:\n    set val(id),val(reference),file(\"${id}.${reference}.prelim.vcf\"),\n    file(\"${id}.${reference}.prelim.vcf.idx\") into GATK_output_mutect_ch\n\n    script:\n    \"\"\"\n    gatk --java-options -Xmx32g Mutect2 -R ${reffasta} -I ${dupfile} --tumor-sample ${id} \\\\\n    -O ${id}.${reference}.prelim.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    gatk --java-options -Xmx32g Mutect2 -R ${reffasta} -I ${dupfile} --tumor-sample ${id} \\\\\n    -O ${id}.${reference}.prelim.vcf\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "GATK_input_mutect_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "GATK_output_mutect_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + reference}",
            "publishDir \"${params.outdir}/gatk_mutect\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "GATK_realign": {
        "name_process": "GATK_realign",
        "string_process": "\nprocess GATK_realign {\n    tag {id + \"-\" + reference}\n\n    label 'OldversionGATK'\n\n    publishDir \"${params.outdir}/gatk_realign\", mode: params.publishDirMode\n\n    input:\n    set val(reference), val(id), file(dupindex), file(dupfile),\n    file(reffasta), file(refindex) from GATK_input_realign_ch\n\n    output:\n    set val(id), val(reference), file(\"${id}.${reference}.pe.realigned.bam\"),\n    file(\"${id}.${reference}.pe.realigned.bai\"), file(reffasta),file(refindex) into GATK_output_realign_ch\n\n    script:\n    \"\"\"\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T RealignerTargetCreator -R ${reffasta} \\\\\n \t\t-I ${dupfile} -o ${id}.${reference}.intervals\n\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T IndelRealigner -R ${reffasta} \\\\\n \t\t-I ${dupfile} -targetIntervals ${id}.${reference}.intervals \\\\\n \t\t-o ${id}.${reference}.pe.realigned.bam\n    \"\"\"\n }",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T RealignerTargetCreator -R ${reffasta} \\\\\n \t\t-I ${dupfile} -o ${id}.${reference}.intervals\n\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T IndelRealigner -R ${reffasta} \\\\\n \t\t-I ${dupfile} -targetIntervals ${id}.${reference}.intervals \\\\\n \t\t-o ${id}.${reference}.pe.realigned.bam\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "GATK_input_realign_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "GATK_output_realign_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + reference}",
            "label 'OldversionGATK'",
            "publishDir \"${params.outdir}/gatk_realign\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "GATK_recalib": {
        "name_process": "GATK_recalib",
        "string_process": "\nprocess GATK_recalib {\n    tag {id + \"-\" + reference}\n\n    label 'OldversionGATK'\n\n    publishDir \"${params.outdir}/GATK_recalib\", mode: params.publishDirMode\n\n    input:\n    set val(id),val(reference),file(mutectvcf),file(mutectidx),file(realignbam),\n    file(realignidx),file(reffasta),file(refindex) from GATK_input_recalib_ch\n\n    output:\n    set val(id),val(reference), file(\"${id}.${reference}.pe.recalib.bam\"),\n    file(\"${id}.${reference}.pe.recalib.bai\") into (GATK_output_recalib_ch, gatk_count_ch, gatk_extract_fastq_ch)\n\n    script:\n    \"\"\"\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T BaseRecalibrator -R ${reffasta} \\\\\n \t\t-I ${realignbam} -knownSites ${mutectvcf} \\\\\n \t\t-o ${id}.${reference}.recalibration.table\n\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T PrintReads -R ${reffasta} \\\\\n \t\t-I ${realignbam} -BQSR ${id}.${reference}.recalibration.table \\\\\n \t\t-o ${id}.${reference}.pe.recalib.bam\n    \"\"\"\n }",
        "nb_lignes_process": 25,
        "string_script": "    \"\"\"\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T BaseRecalibrator -R ${reffasta} \\\\\n \t\t-I ${realignbam} -knownSites ${mutectvcf} \\\\\n \t\t-o ${id}.${reference}.recalibration.table\n\n    java -Xmx32g -jar /usr/GenomeAnalysisTK.jar -T PrintReads -R ${reffasta} \\\\\n \t\t-I ${realignbam} -BQSR ${id}.${reference}.recalibration.table \\\\\n \t\t-o ${id}.${reference}.pe.recalib.bam\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "GATK_input_recalib_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + reference}",
            "label 'OldversionGATK'",
            "publishDir \"${params.outdir}/GATK_recalib\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "split_bam": {
        "name_process": "split_bam",
        "string_process": "\nprocess split_bam {\n    tag {id + \"-\" + reference}\n\n    publishDir \"${params.outdir}/alignments_split/${id}/${reference}\", mode: params.publishDirMode\n\n    input:\n    set val(id),val(reference), file(gatkbam), file(gatkbai) from GATK_output_recalib_ch\n\n    output:\n    file(\"${id}.${reference}_*.bam\") optional true into split_bam_ch\n\n    script:\n    \"\"\"\n    bam splitChromosome --in ${gatkbam}  --out ${id}. --bamout\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    bam splitChromosome --in ${gatkbam}  --out ${id}. --bamout\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BaMM"
        ],
        "tools_url": [
            "https://bio.tools/bamm"
        ],
        "tools_dico": [
            {
                "name": "BaMM",
                "uri": "https://bio.tools/bamm",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "ChIP-seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "Chip-sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "Chip Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "ChIP-sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "Chip sequencing"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Sequence motif recognition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3501",
                                    "term": "Enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0238",
                                    "term": "Sequence motif discovery"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Motif scanning"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Sequence signature recognition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Sequence signature detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3501",
                                    "term": "Enrichment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3501",
                                    "term": "Over-representation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0238",
                                    "term": "Motif discovery"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "de-novo motif discovery and regulatory sequence analysis.\nDiscovery of regulatory motifs with higher-order Bayesian Markov Models (BaMMs)",
                "homepage": "https://bammmotif.mpibpc.mpg.de"
            }
        ],
        "inputs": [
            "GATK_output_recalib_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "split_bam_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + reference}",
            "publishDir \"${params.outdir}/alignments_split/${id}/${reference}\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "split_reference": {
        "name_process": "split_reference",
        "string_process": "\nprocess split_reference {\n    tag \"$reference\"\n\n    publishDir \"${params.outdir}/split_ref\", mode: params.publishDirMode\n\n    input:\n    set val(reference),file(referencepath) from reference_tosplit_ch\n\n    output:\n    file(\"${reference}_*.fasta\") into split_reference_ch\n\n    script:\n    \"\"\"\n    faidx -x $referencepath\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    faidx -x $referencepath\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "pyfaidx"
        ],
        "tools_url": [
            "https://bio.tools/pyfaidx"
        ],
        "tools_dico": [
            {
                "name": "pyfaidx",
                "uri": "https://bio.tools/pyfaidx",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This python module implements pure Python classes for indexing, retrieval, and in-place modification of FASTA files using a samtools compatible index.",
                "homepage": "https://pythonhosted.org/pyfaidx/"
            }
        ],
        "inputs": [
            "reference_tosplit_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "split_reference_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$reference\"",
            "publishDir \"${params.outdir}/split_ref\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "split_fasta_size": {
        "name_process": "split_fasta_size",
        "string_process": "\nprocess split_fasta_size {\n    tag \"$reference\"\n\n    publishDir \"${params.outdir}/split_fastasize\", mode: params.publishDirMode\n\n    input:\n    set val(reference),file(referencepath) from fastasize_input_ch\n\n    output:\n \t  set val(reference),file(\"${reference}.fasta.sizes\") into (split_fasta_size_ch, fasta_size_align_ch)\n\n \t  \"\"\"\n \t  picard CreateSequenceDictionary R=${referencepath} O=${reference}.dict\n\n \t  grep \"^@SQ\" ${reference}.dict | awk '{ print \\$2\"\\t\"\\$3}' | \\\\\n \t  sed \"s;..:;;g\" > ${reference}.fasta.sizes\n \t  \"\"\"\n }",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n \t  picard CreateSequenceDictionary R=${referencepath} O=${reference}.dict\n\n \t  grep \"^@SQ\" ${reference}.dict | awk '{ print \\$2\"\\t\"\\$3}' | \\\\\n \t  sed \"s;..:;;g\" > ${reference}.fasta.sizes\n \t  \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fastasize_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$reference\"",
            "publishDir \"${params.outdir}/split_fastasize\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "build_coverage": {
        "name_process": "build_coverage",
        "string_process": "\nprocess build_coverage {\n    tag {id + \"-\" + refseg}\n\n    publishDir \"${params.outdir}/coverage_sum\", mode: params.publishDirMode\n\n    input:\n    set val(refseg), val(id), file(splitbam), file(refseg_fasta), file(fastasizes) from cov_input_ch\n\n    output:\n    set val(id),val(refseg),file(\"${id}.${refseg}.cov.summary\") into (cov_summary_choose_consensus_ch, cov_summary_plot_ch, big_cov_input_ch)\n    set val(id),val(refseg),file(\"${id}.${refseg}.cov\") into (cov_choose_consensus_ch, cov_graph_ch)\n\n    script:\n    \"\"\"\n    bedtools genomecov -d -ibam ${splitbam} -g  ${fastasizes} | grep ${refseg} > \\\\\n  \t${id}.${refseg}.cov\n\n    coverage_summary_from_genomecov.perl -i ${id}.${refseg}.cov -b ${fastasizes} \\\\\n \t\t-o ${id}.${refseg}.cov.summary\n \t  \"\"\"\n }",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    bedtools genomecov -d -ibam ${splitbam} -g  ${fastasizes} | grep ${refseg} > \\\\\n  \t${id}.${refseg}.cov\n\n    coverage_summary_from_genomecov.perl -i ${id}.${refseg}.cov -b ${fastasizes} \\\\\n \t\t-o ${id}.${refseg}.cov.summary\n \t  \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "cov_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            ""
        ],
        "nb_outputs": 2,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + refseg}",
            "publishDir \"${params.outdir}/coverage_sum\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "make_mpileup": {
        "name_process": "make_mpileup",
        "string_process": "\nprocess make_mpileup {\n    tag {id + \"-\" + referenceseg}\n\n    publishDir \"${params.outdir}/mpileup\", mode: params.publishDirMode\n\n    input:\n    set val(referenceseg), val(id), file(splitbam), file(ref_fasta) from mpileup_input_ch\n\n    output:\n    set val(id), val(referenceseg), file(\"${splitbam}.mpileup\") into (mpileup_make_consensus_ch, mpileup_varscan_ch)\n\n    script:\n    \"\"\"\n    samtools mpileup -a -f ${ref_fasta} -O -d 100000 -B -o \\\\\n    ${splitbam}.mpileup ${splitbam}\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    samtools mpileup -a -f ${ref_fasta} -O -d 100000 -B -o \\\\\n    ${splitbam}.mpileup ${splitbam}\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "mpileup_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + referenceseg}",
            "publishDir \"${params.outdir}/mpileup\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "align_references": {
        "name_process": "align_references",
        "string_process": "\nprocess align_references {\n    tag {shred_fasta + \"-\" + ref_fasta}\n\n    publishDir \"${params.outdir}/reference_cov\", mode: params.publishDirMode\n\n    input:\n    set val(segment), file(shred_fasta), file(ref_fasta),\n    file(ref_fasta_size) from reference_to_align_ch\n\n    output:\n    set file(\"*.*.cov\"), val(segment) into aligned_references_true_ch\n\n    script:\n    \"\"\"\n    shred_id=\\$(echo \"${shred_fasta}\" | cut -f 1 -d '.')\n    ref_id=\\$(echo \"${ref_fasta}\" | cut -f 1 -d '.')\n\n    randomreads.sh -Xmx640m ref=${shred_fasta} out=\\${shred_id}.fastq reads=100000 adderrors=f paired=t minlength=300 maxlength=350 illuminanames=t\n\n    bwa index ${ref_fasta}\n    bwa mem -p -t 4 -M -B 2 ${ref_fasta} \\${shred_id}.fastq | samtools sort -@8 -O BAM -o \\${shred_id}.\\${ref_id}.bam -\n\n    bedtools genomecov -d -ibam \\${shred_id}.\\${ref_id}.bam -g ${ref_fasta_size} > \\${shred_id}.\\${ref_id}.cov\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    shred_id=\\$(echo \"${shred_fasta}\" | cut -f 1 -d '.')\n    ref_id=\\$(echo \"${ref_fasta}\" | cut -f 1 -d '.')\n\n    randomreads.sh -Xmx640m ref=${shred_fasta} out=\\${shred_id}.fastq reads=100000 adderrors=f paired=t minlength=300 maxlength=350 illuminanames=t\n\n    bwa index ${ref_fasta}\n    bwa mem -p -t 4 -M -B 2 ${ref_fasta} \\${shred_id}.fastq | samtools sort -@8 -O BAM -o \\${shred_id}.\\${ref_id}.bam -\n\n    bedtools genomecov -d -ibam \\${shred_id}.\\${ref_id}.bam -g ${ref_fasta_size} > \\${shred_id}.\\${ref_id}.cov\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools",
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools",
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "reference_to_align_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "aligned_references_true_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {shred_fasta + \"-\" + ref_fasta}",
            "publishDir \"${params.outdir}/reference_cov\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "dummy_align_references": {
        "name_process": "dummy_align_references",
        "string_process": "\nprocess dummy_align_references {\n    tag \"$refseg\"\n\n    publishDir \"${params.outdir}/reference_cov\", mode: params.publishDirMode\n\n    input:\n    set val(refseg), file(fastafile) from ref_dummy_align_ch\n\n    output:\n    set file(\"${refseg}.${refseg}.cov\"), val(refseg) into dummy_align_out_ch\n\n    script:\n    \"\"\"\n    echo \"dummy\" > ${refseg}.${refseg}.cov\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    echo \"dummy\" > ${refseg}.${refseg}.cov\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ref_dummy_align_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "dummy_align_out_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$refseg\"",
            "publishDir \"${params.outdir}/reference_cov\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "choose_best_references": {
        "name_process": "choose_best_references",
        "string_process": "\nprocess choose_best_references {\n    tag {id + \"-\" + segment}\n\n    publishDir \"${params.outdir}/finalchosenref\", mode: params.publishDirMode, pattern: \"*.finalchosen\"\n    publishDir \"${params.outdir}/pass_fail_mix\", mode: params.publishDirMode, pattern: \"*.filter\"\n\n    input:\n    set val(segment), val(id), file(bamlist), file(fastalist), file(summarylist), file(covlist), file(referencecov) from choose_consensus_input_ch\n\n    output:\n    file(\"${id}.${segment}.finalchosen\") into (finalchosen_ch,plotchosen_ch)\n    file(\"${id}.${segment}.filter\") into chosenfilter_ch\n\n    script:\n    \"\"\"\n    get_best_reference.R ${id} ${segment}\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    get_best_reference.R ${id} ${segment}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "choose_consensus_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            "chosenfilter_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + segment}",
            "publishDir \"${params.outdir}/finalchosenref\", mode: params.publishDirMode, pattern: \"*.finalchosen\"",
            "publishDir \"${params.outdir}/pass_fail_mix\", mode: params.publishDirMode, pattern: \"*.filter\""
        ],
        "when": "",
        "stub": ""
    },
    "make_consensus": {
        "name_process": "make_consensus",
        "string_process": "\nprocess make_consensus {\n    tag {id + \"-\" + chosenrefseg}\n\n    publishDir \"${params.outdir}/consensus/$state\", mode: params.publishDirMode,\n      saveAs: {\n        filename -> filename.indexOf(\".log\") > 0 ? \"log/$filename\"\n        : params.consensus_by_seg ? \"${chosenrefseg.split(\"_\")[1]}/$filename\"\n        : \"${id}/$filename\"\n        }\n\n    input:\n    set val(chosenrefseg), val(id), val(state), file(mpileupfile), file(chosenfasta) from make_consensus_input_ch\n\n    output:\n    set val(id), val(state), file(\"${id}.${chosenrefseg}.fa\") optional true into consensus_to_concat_ch\n    file \"${mpileupfile}.log\"\n\n    script:\n    \"\"\"\n    build_consensus_from_variants.perl -i ${mpileupfile} -r ${chosenfasta} -l 0.2 \\\\\n    -u 0.8 -c 10 -o ${id}.${chosenrefseg}.fa\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    build_consensus_from_variants.perl -i ${mpileupfile} -r ${chosenfasta} -l 0.2 \\\\\n    -u 0.8 -c 10 -o ${id}.${chosenrefseg}.fa\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "make_consensus_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "consensus_to_concat_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + chosenrefseg}",
            "publishDir \"${params.outdir}/consensus/$state\", mode: params.publishDirMode , saveAs: { filename -> filename.indexOf(\".log\") > 0 ? \"log/$filename\" : params.consensus_by_seg ? \"${chosenrefseg.split(\"_\")[1]}/$filename\" : \"${id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "concatenate_consensus": {
        "name_process": "concatenate_consensus",
        "string_process": "\nprocess concatenate_consensus {\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/consensus\", mode: params.publishDirMode\n\n    input:\n    set val(id), file(consfiles) from grouped_consensus_to_concat_ch\n\n    output:\n    file \"${id}.cons.fasta\"\n\n    script:\n    \"\"\"\n    cat ${consfiles} > ${id}.cons.fasta\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    cat ${consfiles} > ${id}.cons.fasta\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "grouped_consensus_to_concat_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/consensus\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "create_filter_sheet": {
        "name_process": "create_filter_sheet",
        "string_process": "\nprocess create_filter_sheet {\n    publishDir \"${params.outdir}\", mode: params.publishDirMode\n\n \t  input:\n \t  file filter from chosenfilter_ch.collect()\n\n \t  output:\n \t  file \"all_samples_filtered.csv\" into filter_report\n\n \t  \"\"\"\n \t  filter_sheet.R\n \t  \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "\"\"\"\n \t  filter_sheet.R\n \t  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "chosenfilter_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "filter_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "publishDir \"${params.outdir}\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "call_varscan": {
        "name_process": "call_varscan",
        "string_process": "\nprocess call_varscan {\n    tag {id + \"-\" + refseg}\n\n    publishDir \"${params.outdir}/prevariants\", mode: params.publishDirMode\n\n    input:\n    set val(id), val(refseg), file(mpileupfile) from chosen_varscan_ch\n\n    output:\n    set val(id),file(\"${id}.${refseg}.varscan.vcf.{gz,gz.tbi}\") optional true into vcf_varscan_ch\n\n    script:\n    \"\"\"\n    varscan mpileup2cns ${mpileupfile} --variants --min-avg-qual 30 --min-var-freq 0.01 \\\\\n    --output-vcf 1 > ${id}.${refseg}.varscan.vcf\n    if [ \\$(cat ${id}.${refseg}.varscan.vcf | grep -v '^#' | wc -c) -ne 0 ]; then\n        bgzip ${id}.${refseg}.varscan.vcf\n        tabix ${id}.${refseg}.varscan.vcf.gz\n    fi\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    varscan mpileup2cns ${mpileupfile} --variants --min-avg-qual 30 --min-var-freq 0.01 \\\\\n    --output-vcf 1 > ${id}.${refseg}.varscan.vcf\n    if [ \\$(cat ${id}.${refseg}.varscan.vcf | grep -v '^#' | wc -c) -ne 0 ]; then\n        bgzip ${id}.${refseg}.varscan.vcf\n        tabix ${id}.${refseg}.varscan.vcf.gz\n    fi\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "VarScan"
        ],
        "tools_url": [
            "https://bio.tools/varscan"
        ],
        "tools_dico": [
            {
                "name": "VarScan",
                "uri": "https://bio.tools/varscan",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "VarScan, an open source tool for variant detection that is compatible with several short read align-ers.",
                "homepage": "http://dkoboldt.github.io/varscan/"
            }
        ],
        "inputs": [
            "chosen_varscan_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_varscan_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + refseg}",
            "publishDir \"${params.outdir}/prevariants\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "call_bcftools": {
        "name_process": "call_bcftools",
        "string_process": "\nprocess call_bcftools {\n    tag {id + \"-\" + refseg}\n\n    publishDir \"${params.outdir}/prevariants\", mode: params.publishDirMode\n\n    input:\n    set val(refseg), val(id), file(recalibfile), file(refsegfasta) from chosen_bcftools_ch\n\n    output:\n    set val(id), file(\"${id}.${refseg}.multiallelic.bcftools.vcf.{gz,gz.tbi}\") optional true into vcf_bcftools_ch\n\n    script:\n    \"\"\"\n    bcftools mpileup -Ou -a AD --per-sample-mF --redo-BAQ -d 10000 --min-BQ 20 -f ${refsegfasta} ${recalibfile} | bcftools call -P 1.0e-2 -m -v -Ov | \\\\\n    vcfutils.pl varFilter -a 1 -w 1 -W 3 -d 5 -1 0.05 -2 0.05 -3 0.05 -4 0.05 > ${id}.${refseg}.multiallelic.bcftools.vcf\n    if [ \\$(cat ${id}.${refseg}.multiallelic.bcftools.vcf | grep -v '^#' | wc -c) -ne 0 ]; then\n        bgzip ${id}.${refseg}.multiallelic.bcftools.vcf\n        tabix ${id}.${refseg}.multiallelic.bcftools.vcf.gz\n    fi\n    \"\"\"\n }",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    bcftools mpileup -Ou -a AD --per-sample-mF --redo-BAQ -d 10000 --min-BQ 20 -f ${refsegfasta} ${recalibfile} | bcftools call -P 1.0e-2 -m -v -Ov | \\\\\n    vcfutils.pl varFilter -a 1 -w 1 -W 3 -d 5 -1 0.05 -2 0.05 -3 0.05 -4 0.05 > ${id}.${refseg}.multiallelic.bcftools.vcf\n    if [ \\$(cat ${id}.${refseg}.multiallelic.bcftools.vcf | grep -v '^#' | wc -c) -ne 0 ]; then\n        bgzip ${id}.${refseg}.multiallelic.bcftools.vcf\n        tabix ${id}.${refseg}.multiallelic.bcftools.vcf.gz\n    fi\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "chosen_bcftools_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_bcftools_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + refseg}",
            "publishDir \"${params.outdir}/prevariants\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "vcf_concat": {
        "name_process": "vcf_concat",
        "string_process": "\nprocess vcf_concat {\n    tag {id + \"-\" + vcf_label}\n\n    publishDir \"${params.outdir}/prevariants\", mode: params.publishDirMode\n\n    input:\n    set val(id), file(vcf_files), val(vcf_label) from vcf_concat_input_ch\n\n    output:\n    set val(id), file(\"${id}.${vcf_label}.concat.vcf.gz\"), file(\"${id}.${vcf_label}.concat.vcf.gz.tbi\") into vcf_concat_ch\n\n    script:\n    \"\"\"\n    vcf-concat ${id}.*.vcf.gz > ${id}.${vcf_label}.concat.vcf\n    bgzip ${id}.${vcf_label}.concat.vcf\n    tabix ${id}.${vcf_label}.concat.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    vcf-concat ${id}.*.vcf.gz > ${id}.${vcf_label}.concat.vcf\n    bgzip ${id}.${vcf_label}.concat.vcf\n    tabix ${id}.${vcf_label}.concat.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf_concat_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_concat_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag {id + \"-\" + vcf_label}",
            "publishDir \"${params.outdir}/prevariants\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "combine_vcf": {
        "name_process": "combine_vcf",
        "string_process": "\nprocess combine_vcf{\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/variants\", mode: params.publishDirMode\n\n  \tinput:\n  \tset val(id), file(vcf_file), file(vcf_index) from vcf_concat_ch.groupTuple()\n\n  \toutput:\n  \tset val(id), file(\"${id}.variants.vcf\") into combine_vcf_ch\n\n  \tscript:\n  \t\"\"\"\n  \tvcf-merge ${vcf_file} > ${id}.variants.vcf\n  \t\"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "  \t\"\"\"\n  \tvcf-merge ${vcf_file} > ${id}.variants.vcf\n  \t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf_concat_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "combine_vcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/variants\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "get_variant_frequency": {
        "name_process": "get_variant_frequency",
        "string_process": " process get_variant_frequency {\n     tag \"$id\"\n\n     publishDir \"${params.outdir}/variant_frequencies\", mode: params.publishDirMode\n\n     input:\n     set val(id), file(vcf_file) from combine_vcf_ch\n\n     output:\n     file \"${id}.variants.csv\"\n\n     script:\n     \"\"\"\n     short_vcf.R ${vcf_file} > ${id}.variants.csv\n     \"\"\"\n }",
        "nb_lignes_process": 14,
        "string_script": "     \"\"\"\n     short_vcf.R ${vcf_file} > ${id}.variants.csv\n     \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "combine_vcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/variant_frequencies\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "plot_graphs": {
        "name_process": "plot_graphs",
        "string_process": "\nprocess plot_graphs {\n    tag \"$segment\"\n\n    publishDir \"${params.outdir}/reports/coverage_graphs\", mode: params.publishDirMode\n\n    input:\n    set val(segment), file(coverage_sum), file(chosenref) from Rplotin_ch\n\n    output:\n    file(\"10x_coverage_${segment}.png\")\n    file(\"10x_coverage_${segment}.html\")\n\n    script:\n    \"\"\"\n    plotscript_perseg.R ${segment} cov.summary\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    plotscript_perseg.R ${segment} cov.summary\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "Rplotin_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$segment\"",
            "publishDir \"${params.outdir}/reports/coverage_graphs\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "get_big_table": {
        "name_process": "get_big_table",
        "string_process": "\nprocess get_big_table {\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/reports/coverage_tables\", mode: params.publishDirMode\n\n    input:\n    set val(id), val(refseg), file(coverage_sum) from big_cov_input_ch.groupTuple()\n\n    output:\n    file(\"${id}.all_coverage.csv\")\n\n    script:\n    \"\"\"\n    create_big_coverage.R ${id} cov.summary\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    create_big_coverage.R ${id} cov.summary\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "big_cov_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/reports/coverage_tables\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "count_report": {
        "name_process": "count_report",
        "string_process": "\nprocess count_report {\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/reports/count_reports\", mode: params.publishDirMode\n\n    input:\n\t  set val(id), val(referencelist), file(bwaindex), file(bwafile),\n    file(gatkfile), file(gatkindex), file(read1),file(read2) from count_input_ch\n\n\t  output:\n\t  file(\"counts.${id}.xls\") into count_table_ch\n\n    script:\n    bashreflist = referencelist.collect{\"$it\"}.join(' ')\n\n    \"\"\"\n    echo -ne \"\\t${id}\\n\" > counts.${id}.xls\n    COUNT_READ1=`echo \\$( cat ${read1}|wc -l )/4|bc`\n    COUNT_READ2=`echo \\$( cat ${read2}|wc -l )/4|bc`\n    COUNTS=\\$(( COUNT_READ1 + COUNT_READ2 ))\n    echo -ne \"\\t\\${COUNTS}\\n\" >> counts.${id}.xls\n\n    for reference in ${bashreflist}\n    do\n        echo -ne \"\\${reference} RAW\\t\" >> counts.${id}.xls\n\n\t\t    BAM_COUNTS=`samtools view -F 260 -c \\\\\n        ${id}.\\${reference}.bam`\n\n\t\t    echo -ne \"\\${BAM_COUNTS}\\n\" >> counts.${id}.xls\n\n\t\t    echo -ne \"\\${reference} RECAL\\t\" >> counts.${id}.xls\n\n\t\t    RECALIB_COUNTS=`samtools view -F 260 -c \\\\\n\t\t    ${id}.\\${reference}.pe.recalib.bam`\n\n\t      echo -ne \"\\${RECALIB_COUNTS}\\n\" >> counts.${id}.xls\n    done\n\t\"\"\"\n}",
        "nb_lignes_process": 39,
        "string_script": "    bashreflist = referencelist.collect{\"$it\"}.join(' ')\n\n    \"\"\"\n    echo -ne \"\\t${id}\\n\" > counts.${id}.xls\n    COUNT_READ1=`echo \\$( cat ${read1}|wc -l )/4|bc`\n    COUNT_READ2=`echo \\$( cat ${read2}|wc -l )/4|bc`\n    COUNTS=\\$(( COUNT_READ1 + COUNT_READ2 ))\n    echo -ne \"\\t\\${COUNTS}\\n\" >> counts.${id}.xls\n\n    for reference in ${bashreflist}\n    do\n        echo -ne \"\\${reference} RAW\\t\" >> counts.${id}.xls\n\n\t\t    BAM_COUNTS=`samtools view -F 260 -c \\\\\n        ${id}.\\${reference}.bam`\n\n\t\t    echo -ne \"\\${BAM_COUNTS}\\n\" >> counts.${id}.xls\n\n\t\t    echo -ne \"\\${reference} RECAL\\t\" >> counts.${id}.xls\n\n\t\t    RECALIB_COUNTS=`samtools view -F 260 -c \\\\\n\t\t    ${id}.\\${reference}.pe.recalib.bam`\n\n\t      echo -ne \"\\${RECALIB_COUNTS}\\n\" >> counts.${id}.xls\n    done\n\t\"\"\"",
        "nb_lignes_script": 25,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "count_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "count_table_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/reports/count_reports\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "make_list": {
        "name_process": "make_list",
        "string_process": "\nprocess make_list {\n    publishDir \"${params.outdir}/reports\", mode: params.publishDirMode\n\n    input:\n    file counttablelist from count_table_ch.collect(sort:true)\n\n    output:\n    file \"all_samples.counts.xls\"\n\n    script:\n    \"\"\"\n    COMMAND=(paste)\n    for counttable in ${counttablelist}\n    do\n\t\t    COMMAND+=( \\${counttable} )\n    done\n    \"\\${COMMAND[@]}\" > all_samples.counts.xls\n\t\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    COMMAND=(paste)\n    for counttable in ${counttablelist}\n    do\n\t\t    COMMAND+=( \\${counttable} )\n    done\n    \"\\${COMMAND[@]}\" > all_samples.counts.xls\n\t\"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "count_table_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "publishDir \"${params.outdir}/reports\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "extract_fastq": {
        "name_process": "extract_fastq",
        "string_process": "\nprocess extract_fastq {\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/extract_fastq\", mode: params.publishDirMode\n\n    input:\n    set val(id), val(reference), file(gatklist), file(gatkindex) from gatk_extract_fastq_ch.groupTuple()\n\n\t  output:\n\t  file(\"${id}.R1.fastq.gz\")\n    file(\"${id}.R2.fastq.gz\")\n\n    script:\n    \"\"\"\n    for gatkfile in ${gatklist}\n    do\n        samtools view -b -F 4 \\${gatkfile} > \\${gatkfile}.filtered\n    done\n\n    samtools merge ${id}.merged.bam *.bam.filtered\n\n    samtools sort -n ${id}.merged.bam | samtools fastq -N -F 256 -1 \\\\\n\t\t${id}.R1.fastq.gz -2 \\\\\n\t\t${id}.R2.fastq.gz -\n\t\"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "    \"\"\"\n    for gatkfile in ${gatklist}\n    do\n        samtools view -b -F 4 \\${gatkfile} > \\${gatkfile}.filtered\n    done\n\n    samtools merge ${id}.merged.bam *.bam.filtered\n\n    samtools sort -n ${id}.merged.bam | samtools fastq -N -F 256 -1 \\\\\n\t\t${id}.R1.fastq.gz -2 \\\\\n\t\t${id}.R2.fastq.gz -\n\t\"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "gatk_extract_fastq_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/extract_fastq\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "plot_depth": {
        "name_process": "plot_depth",
        "string_process": "\nprocess plot_depth{\n    tag \"$id\"\n\n    publishDir \"${params.outdir}/depth_plots\", mode: params.publishDirMode\n\n    input:\n    set val(id), val(refseg), file(depthfiles) from depth_input_ch.groupTuple(sort:true)\n\n    output:\n    file(\"${id}.basedepth.pdf\")\n\n    script:\n    \"\"\"\n    for depthfile in $depthfiles\n    do\n        cat \\${depthfile} >> ${id}.all_segments.depth\n    done\n\n    pandocloc=`which pandoc`\n\n    base_cov.R ${id}.all_segments.depth ${id} \\${pandocloc}\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    for depthfile in $depthfiles\n    do\n        cat \\${depthfile} >> ${id}.all_segments.depth\n    done\n\n    pandocloc=`which pandoc`\n\n    base_cov.R ${id}.all_segments.depth ${id} \\${pandocloc}\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "depth_input_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "tag \"$id\"",
            "publishDir \"${params.outdir}/depth_plots\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc": {
        "name_process": "multiqc",
        "string_process": "\nprocess multiqc {\n    publishDir \"${params.outdir}/MultiQC\", mode: params.publishDirMode\n\n    input:\n    file multiqc_config from ch_multiqc_config\n    file mqc_custom_config from ch_multiqc_custom_config.collect().ifEmpty([])\n                                                                                  \n    file ('fastqc/*') from fastqc_results.collect().ifEmpty([])\n    file ('trimqc/*') from trimqc_results.collect().ifEmpty([])\n    file ('trimrep/*') from trim_reports.collect().ifEmpty([])\n    file ('picardmetrics/*') from picardmetrics.collect().ifEmpty([])\n    file ('software_versions/*') from software_versions_yaml.collect()\n    file workflow_summary from ch_workflow_summary.collectFile(name: \"workflow_summary_mqc.yaml\")\n\n    output:\n    file \"*multiqc_report.html\" into multiqc_report\n    file \"*_data\"\n    file \"multiqc_plots\"\n\n    script:\n    rtitle = custom_runName ? \"--title \\\"$custom_runName\\\"\" : ''\n    rfilename = custom_runName ? \"--filename \" + custom_runName.replaceAll('\\\\W','_').replaceAll('_+','_') + \"_multiqc_report\" : ''\n    custom_config_file = params.multiqc_config ? \"--config $mqc_custom_config\" : ''\n\n    \"\"\"\n    multiqc -f $rtitle $rfilename $custom_config_file .\n    \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "    rtitle = custom_runName ? \"--title \\\"$custom_runName\\\"\" : ''\n    rfilename = custom_runName ? \"--filename \" + custom_runName.replaceAll('\\\\W','_').replaceAll('_+','_') + \"_multiqc_report\" : ''\n    custom_config_file = params.multiqc_config ? \"--config $mqc_custom_config\" : ''\n\n    \"\"\"\n    multiqc -f $rtitle $rfilename $custom_config_file .\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "ch_multiqc_config",
            "ch_multiqc_custom_config",
            "fastqc_results",
            "trimqc_results",
            "trim_reports",
            "picardmetrics",
            "software_versions_yaml",
            "ch_workflow_summary"
        ],
        "nb_inputs": 8,
        "outputs": [
            "multiqc_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "publishDir \"${params.outdir}/MultiQC\", mode: params.publishDirMode"
        ],
        "when": "",
        "stub": ""
    },
    "output_documentation": {
        "name_process": "output_documentation",
        "string_process": "\nprocess output_documentation {\n    publishDir \"${params.outdir}/pipeline_info\", mode: 'copy'\n\n    input:\n    file output_docs from ch_output_docs\n\n    output:\n    file \"results_description.html\"\n\n    script:\n    \"\"\"\n    markdown_to_html.py $output_docs -o results_description.html\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    markdown_to_html.py $output_docs -o results_description.html\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_output_docs"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "Jeremy1805__nf-core-influenzangs",
        "directive": [
            "publishDir \"${params.outdir}/pipeline_info\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}