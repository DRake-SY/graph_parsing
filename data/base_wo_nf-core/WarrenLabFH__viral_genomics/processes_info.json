{
    "runFastQC": {
        "name_process": "runFastQC",
        "string_process": "\nprocess runFastQC {\n  container \"$params.fastqc\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  publishDir \"$params.out_path/fastqc/${mode}\", mode : \"copy\"\n  input:\n    tuple val(sample), path(fastq_paths)\n    val mode\n  output:\n    path \"${sample}_${mode}_fastqc.zip\", emit: fastqc_results\n  script:\n    rone = fastq_paths[0]\n    rtwo = fastq_paths[1]\n    rthree = fastq_paths[2]\n    rfour = fastq_paths[3]\n    extension = rone.getExtension()\n    if (mode == \"raw\") \n      \"\"\"\n      zcat ${rone} ${rtwo} ${rthree} ${rfour} > ${sample}_${mode}.fastq\n      fastqc -q ${sample}_${mode}.fastq  > stdout.txt 2> stderr.txt\n      \"\"\"\n    else if ((mode == \"trimmed\" | mode == \"host_removed\" | mode == \"public\") & (extension != \"gz\"))\n      \"\"\"\n      cat ${rone} ${rtwo} > ${sample}_${mode}.fastq\n      fastqc -q ${sample}_${mode}.fastq  > stdout.txt 2> stderr.txt\n      \"\"\"\n    else if ((mode == \"trimmed\" | mode == \"host_removed\" | mode == \"public\") & (extension == \"gz\"))\n      \"\"\"\n      zcat ${rone} ${rtwo} > ${sample}_${mode}.fastq\n      fastqc -q ${sample}_${mode}.fastq  > stdout.txt 2> stderr.txt\n      \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "    rone = fastq_paths[0]\n    rtwo = fastq_paths[1]\n    rthree = fastq_paths[2]\n    rfour = fastq_paths[3]\n    extension = rone.getExtension()\n    if (mode == \"raw\") \n      \"\"\"\n      zcat ${rone} ${rtwo} ${rthree} ${rfour} > ${sample}_${mode}.fastq\n      fastqc -q ${sample}_${mode}.fastq  > stdout.txt 2> stderr.txt\n      \"\"\"\n    else if ((mode == \"trimmed\" | mode == \"host_removed\" | mode == \"public\") & (extension != \"gz\"))\n      \"\"\"\n      cat ${rone} ${rtwo} > ${sample}_${mode}.fastq\n      fastqc -q ${sample}_${mode}.fastq  > stdout.txt 2> stderr.txt\n      \"\"\"\n    else if ((mode == \"trimmed\" | mode == \"host_removed\" | mode == \"public\") & (extension == \"gz\"))\n      \"\"\"\n      zcat ${rone} ${rtwo} > ${sample}_${mode}.fastq\n      fastqc -q ${sample}_${mode}.fastq  > stdout.txt 2> stderr.txt\n      \"\"\"",
        "nb_lignes_script": 19,
        "language_script": "bash",
        "tools": [
            "Xaperones",
            "FastQC",
            "MoDEL"
        ],
        "tools_url": [
            "https://bio.tools/xaperones",
            "https://bio.tools/fastqc",
            "https://bio.tools/model"
        ],
        "tools_dico": [
            {
                "name": "Xaperones",
                "uri": "https://bio.tools/xaperones",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_1317",
                            "term": "Structural biology"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0250",
                                    "term": "Protein property calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0250",
                                    "term": "Protein property rendering"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Generates Xaperones to facilitate the crystallization of proteins of interest.",
                "homepage": "http://www.xaperones.com"
            },
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            },
            {
                "name": "MoDEL",
                "uri": "https://bio.tools/model",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0176",
                            "term": "Molecular dynamics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2426",
                                    "term": "Modelling and simulation"
                                }
                            ],
                            []
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0842",
                                "term": "Identifier"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2080",
                                "term": "Database search results"
                            }
                        ]
                    }
                ],
                "description": "Database of protein Molecular Dynamics simulations, with 1800 trajectories representing different structural clusters of the PDB.",
                "homepage": "http://mmb.irbbarcelona.org/MoDEL"
            }
        ],
        "inputs": [
            "sample",
            "fastq_paths",
            "mode"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.fastqc\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "publishDir \"$params.out_path/fastqc/${mode}\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "runMultiQC": {
        "name_process": "runMultiQC",
        "string_process": "\nprocess runMultiQC {\n  container \"$params.multiqc\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  publishDir \"$params.out_path/mutli_qc\", mode : \"copy\"\n  input:\n    path raw_fastqc_out \n    path trimmed_fastqc_out\n    path bbduk_stats\n    path host_bowtie_stats\n    path ebv_bowtie_stats\n    path ebv_fastqc_out\n    path prokka_spadeess\n    path prokka_unicycler \n    path config\n  output:\n    path \"multiqc_report.html\", emit: mutli_qc_out\n  script:\n    \"\"\"\n    multiqc -c ${config} .\n    \"\"\"\n    \n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    multiqc -c ${config} .\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "raw_fastqc_out",
            "trimmed_fastqc_out",
            "bbduk_stats",
            "host_bowtie_stats",
            "ebv_bowtie_stats",
            "ebv_fastqc_out",
            "prokka_spadeess",
            "prokka_unicycler",
            "config"
        ],
        "nb_inputs": 9,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.multiqc\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "publishDir \"$params.out_path/mutli_qc\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "prep_quast": {
        "name_process": "prep_quast",
        "string_process": "\nprocess prep_quast {\n  container \"$params.quast\"\n  errorStrategy 'retry'\n  label 'mid_mem'\n  publishDir \"$params.out_path/contigs\", mode : \"copy\"\n  input:\n    tuple val(sample), path(genome_assembly)\n  output:\n    path(\"${sample}.fasta\"), emit: quast_inputs\n  script:\n    memory = \"$task.memory\" =~ /\\d+/\n    \"\"\"\n    cp ${genome_assembly}/contigs.fasta ${sample}.fasta\n    \"\"\"\n    \n}",
        "nb_lignes_process": 15,
        "string_script": "    memory = \"$task.memory\" =~ /\\d+/\n    \"\"\"\n    cp ${genome_assembly}/contigs.fasta ${sample}.fasta\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "memory(LSTM"
        ],
        "tools_url": [
            "https://bio.tools/memoryLSTM"
        ],
        "tools_dico": [
            {
                "name": "memory(LSTM",
                "uri": "https://bio.tools/memoryLSTM",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3474",
                            "term": "Machine learning"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0128",
                            "term": "Protein interactions"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2464",
                                    "term": "Protein-protein binding site prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0272",
                                    "term": "Residue contact prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2492",
                                    "term": "Protein interaction prediction"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2464",
                                    "term": "Protein-protein binding site detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0272",
                                    "term": "Residue interaction prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2492",
                                    "term": "Protein-protein interaction detection"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Attention mechanism enhanced LSTM with residual architecture and its application for protein-protein interaction residue pairs prediction.\n\nBACKGROUND:Recurrent neural network(RNN) is a good way to process sequential data, but the capability of RNN to compute long sequence data is inefficient. As a variant of RNN, long short term memory(LSTM) solved the problem in some extent. Here we improved LSTM for big data application in protein-protein interaction interface residue pairs prediction based on the following two reasons. On the one hand, there are some deficiencies in LSTM, such as shallow layers, gradient explosion or vanishing, etc. With a dramatic data increasing, the imbalance between algorithm innovation and big data processing has been more serious and urgent.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'LSTM' (bio.tools/LSTM)",
                "homepage": "https://github.com/Jiale-Liu/LSTM"
            }
        ],
        "inputs": [
            "sample",
            "genome_assembly"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.quast\"",
            "errorStrategy 'retry'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/contigs\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "quast": {
        "name_process": "quast",
        "string_process": "\nprocess quast {\n  container \"$params.quast\"\n  errorStrategy 'retry'\n  label 'mid_mem'\n  publishDir \"$params.out_path/quast\", mode : \"copy\"\n  input:\n    path genome_assemblies\n    path reference_genome\n    val mode\n  output:\n    path \"${mode}\", emit: quast\n  script:\n    memory = \"$task.memory\" =~ /\\d+/\n    \"\"\"\n    quast.py -r ${reference_genome}/genome.fa --circos --glimmer -o ${mode} *.fasta > stdout.log 2> stderr.log\n    \"\"\"\n    \n}",
        "nb_lignes_process": 17,
        "string_script": "    memory = \"$task.memory\" =~ /\\d+/\n    \"\"\"\n    quast.py -r ${reference_genome}/genome.fa --circos --glimmer -o ${mode} *.fasta > stdout.log 2> stderr.log\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "memory(LSTM"
        ],
        "tools_url": [
            "https://bio.tools/memoryLSTM"
        ],
        "tools_dico": [
            {
                "name": "memory(LSTM",
                "uri": "https://bio.tools/memoryLSTM",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3474",
                            "term": "Machine learning"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0128",
                            "term": "Protein interactions"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2464",
                                    "term": "Protein-protein binding site prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0272",
                                    "term": "Residue contact prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2492",
                                    "term": "Protein interaction prediction"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2464",
                                    "term": "Protein-protein binding site detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0272",
                                    "term": "Residue interaction prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2492",
                                    "term": "Protein-protein interaction detection"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Attention mechanism enhanced LSTM with residual architecture and its application for protein-protein interaction residue pairs prediction.\n\nBACKGROUND:Recurrent neural network(RNN) is a good way to process sequential data, but the capability of RNN to compute long sequence data is inefficient. As a variant of RNN, long short term memory(LSTM) solved the problem in some extent. Here we improved LSTM for big data application in protein-protein interaction interface residue pairs prediction based on the following two reasons. On the one hand, there are some deficiencies in LSTM, such as shallow layers, gradient explosion or vanishing, etc. With a dramatic data increasing, the imbalance between algorithm innovation and big data processing has been more serious and urgent.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'LSTM' (bio.tools/LSTM)",
                "homepage": "https://github.com/Jiale-Liu/LSTM"
            }
        ],
        "inputs": [
            "genome_assemblies",
            "reference_genome",
            "mode"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.quast\"",
            "errorStrategy 'retry'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/quast\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "getFastq": {
        "name_process": "getFastq",
        "string_process": "\nprocess getFastq {\n  module \"SRA-Toolkit\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  publishDir \"$params.public_fastq\", mode : \"copy\"\n  input:\n    each sra_number\n  output:\n    tuple val(sra_number), path(\"*.fastq\") , emit: public_fastq\n  script:\n    \"\"\"\n    fasterq-dump ${sra_number} --split-3 -m 4GB -e 20 -L 0\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    fasterq-dump ${sra_number} --split-3 -m 4GB -e 20 -L 0\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sra_number"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "module \"SRA-Toolkit\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "publishDir \"$params.public_fastq\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "generateFastq": {
        "name_process": "generateFastq",
        "string_process": "\nprocess generateFastq {\n  container \"$params.art\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  publishDir \"$params.out_path/simulated_reads\", mode : \"copy\"\n  input:\n    each index\n    path reference_path\n  output:\n    tuple val(sample), path(\"*.fastq\") , emit: sim_fastq\n  script:\n    sample = \"simulated_data\" + index\n    \"\"\"\n    art_illumina -sam -i ${reference_path}/genome.fa -p -l 150 -f 100 -m 200 -s 10 -o ${sample} \n    cp ${sample}1.fq ${sample}_R1.fastq\n    cp ${sample}2.fq ${sample}_R2.fastq\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    sample = \"simulated_data\" + index\n    \"\"\"\n    art_illumina -sam -i ${reference_path}/genome.fa -p -l 150 -f 100 -m 200 -s 10 -o ${sample} \n    cp ${sample}1.fq ${sample}_R1.fastq\n    cp ${sample}2.fq ${sample}_R2.fastq\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMPLE"
        ],
        "tools_url": [
            "https://bio.tools/sample"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            }
        ],
        "inputs": [
            "index",
            "reference_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.art\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "publishDir \"$params.out_path/simulated_reads\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "repairFastq": {
        "name_process": "repairFastq",
        "string_process": "\nprocess repairFastq {\n  container \"$params.bbmap\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  publishDir \"$params.out_path/ebv_reads\", mode : \"copy\"\n  input:\n    tuple val(sample), path(ebv_dedup_reads)\n  output:\n    tuple val(sample), path(\"*.fastq\") , emit: repaired_fastq\n  script:\n    \"\"\"\n    repair.sh in=${sample}_R1_deduped_unrep.fq in2=${sample}_R2_deduped_unrep.fq \\\n    out=${sample}_R1_deduped.fastq out2=${sample}_R2_deduped.fastq\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    repair.sh in=${sample}_R1_deduped_unrep.fq in2=${sample}_R2_deduped_unrep.fq \\\n    out=${sample}_R1_deduped.fastq out2=${sample}_R2_deduped.fastq\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sample",
            "ebv_dedup_reads"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.bbmap\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "publishDir \"$params.out_path/ebv_reads\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "bbduk": {
        "name_process": "bbduk",
        "string_process": "\nprocess bbduk {\n  errorStrategy 'retry'\n  container \"$params.bbmap\"\n  label 'high_mem'\n                                                               \n  input:\n    tuple val(sample), path(fastq_path)\n  output:\n    tuple val(sample), path(\"*clean.fq\"), emit: trimmed_reads\n    path \"${sample}_bbduk_stats.txt\", emit: trimmed_stats\n  script:\n  if ( fastq_path.size() == 2 )\n    \"\"\"\n    bbduk.sh -Xmx400g in1=${fastq_path[0]} in2=${fastq_path[1]} \\\n    out1=${sample}_R1.clean.fq out2=${sample}_R2.clean.fq \\\n    ref=adapters qtrim=rl minlength=100 stats=${sample}_bbduk_stats.txt \\\n    ktrim=r k=23 mink=11 hdist=1 tpe=f tbo=t > stdout.log 2> stderr.log\n    \"\"\"\n  else\n    \"\"\"\n    zcat ${fastq_path[0]} ${fastq_path[2]} > ${sample}_R1.fastq \n    zcat ${fastq_path[1]} ${fastq_path[3]} > ${sample}_R2.fastq \n    bbduk.sh -Xmx400g in1=${sample}_R1.fastq in2=${sample}_R2.fastq \\\n    out1=${sample}_R1.clean.fq out2=${sample}_R2.clean.fq stats=${sample}_bbduk_stats.txt\\\n    ref=adapters qtrim=rl minlength=100 \\\n    ktrim=r k=23 mink=11 hdist=1 tpe=f tbo=t > stdout.log 2> stderr.log\n    \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "  if ( fastq_path.size() == 2 )\n    \"\"\"\n    bbduk.sh -Xmx400g in1=${fastq_path[0]} in2=${fastq_path[1]} \\\n    out1=${sample}_R1.clean.fq out2=${sample}_R2.clean.fq \\\n    ref=adapters qtrim=rl minlength=100 stats=${sample}_bbduk_stats.txt \\\n    ktrim=r k=23 mink=11 hdist=1 tpe=f tbo=t > stdout.log 2> stderr.log\n    \"\"\"\n  else\n    \"\"\"\n    zcat ${fastq_path[0]} ${fastq_path[2]} > ${sample}_R1.fastq \n    zcat ${fastq_path[1]} ${fastq_path[3]} > ${sample}_R2.fastq \n    bbduk.sh -Xmx400g in1=${sample}_R1.fastq in2=${sample}_R2.fastq \\\n    out1=${sample}_R1.clean.fq out2=${sample}_R2.clean.fq stats=${sample}_bbduk_stats.txt\\\n    ref=adapters qtrim=rl minlength=100 \\\n    ktrim=r k=23 mink=11 hdist=1 tpe=f tbo=t > stdout.log 2> stderr.log\n    \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sample",
            "fastq_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "errorStrategy 'retry'",
            "container \"$params.bbmap\"",
            "label 'high_mem'"
        ],
        "when": "",
        "stub": ""
    },
    "bbnorm": {
        "name_process": "bbnorm",
        "string_process": "\nprocess bbnorm {\n  errorStrategy 'retry'\n  container \"$params.bbmap\"\n  label 'mid_mem'\n  publishDir \"$params.out_path/sampled_reads/\", mode : \"copy\"\n  input:\n    tuple val(sample), path(fastq_path)\n  output:\n    tuple val(sample), path(\"*_sampled_R*.fq\"), emit: sampled_reads\n  script:\n  if ( fastq_path.size() == 2 )\n    \"\"\"\n    mkdir -p temp_storage\n    export TMPDIR=$workDir\n    bbnorm.sh -Xmx20g in=${fastq_path[0]} in2=${fastq_path[1]} \\\n    out=${sample}_sampled_R1.fq out2=${sample}_sampled_R2.fq \\\n    target=1000 tmpdir=temp_dir 1> stdout.log 2> stderr.log\n    \"\"\"\n  else\n    \"\"\"\n    mkdir -p temp_storage\n    export TMPDIR=$workDir\n    zcat ${fastq_path[0]} ${fastq_path[2]} > ${sample}_R1.fastq \n    zcat ${fastq_path[1]} ${fastq_path[3]} > ${sample}_R2.fastq \n    bbnorm.sh -Xmx20g in=${sample}_R1.fastq in2=${sample}_R2.fastq \\\n    out=${sample}_sampled_R1.fq out2=${sample}_sampled_R2.fq \\\n    target=1000  tmpdir=temp_dir 1> stdout.log 2> stderr.log\n    \"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "  if ( fastq_path.size() == 2 )\n    \"\"\"\n    mkdir -p temp_storage\n    export TMPDIR=$workDir\n    bbnorm.sh -Xmx20g in=${fastq_path[0]} in2=${fastq_path[1]} \\\n    out=${sample}_sampled_R1.fq out2=${sample}_sampled_R2.fq \\\n    target=1000 tmpdir=temp_dir 1> stdout.log 2> stderr.log\n    \"\"\"\n  else\n    \"\"\"\n    mkdir -p temp_storage\n    export TMPDIR=$workDir\n    zcat ${fastq_path[0]} ${fastq_path[2]} > ${sample}_R1.fastq \n    zcat ${fastq_path[1]} ${fastq_path[3]} > ${sample}_R2.fastq \n    bbnorm.sh -Xmx20g in=${sample}_R1.fastq in2=${sample}_R2.fastq \\\n    out=${sample}_sampled_R1.fq out2=${sample}_sampled_R2.fq \\\n    target=1000  tmpdir=temp_dir 1> stdout.log 2> stderr.log\n    \"\"\"",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sample",
            "fastq_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "errorStrategy 'retry'",
            "container \"$params.bbmap\"",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/sampled_reads/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "biosino_download": {
        "name_process": "biosino_download",
        "string_process": "\nprocess biosino_download {\n  label 'high_mem'\n  errorStrategy 'retry'\n  input:\n    each row\n  output:\n    tuple val(sample), path(\"${sample}_*.fq.gz\"), emit: fastq_files\n  script:\n    def sample = row.sample_id + '_' + row.fileName.replaceAll(\"_{1,2}.fq.gz\", \"\")\n    def read_name = row.fileName\n    def read_url = row.url\n    def read_out = row.sample_id + '_' + row.fileName\n    \"\"\"\n    wget -c --retry-connrefused --retry-on-http-error=552,502 -t 0 -T 600 -O ${read_out} ${read_url}\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    def sample = row.sample_id + '_' + row.fileName.replaceAll(\"_{1,2}.fq.gz\", \"\")\n    def read_name = row.fileName\n    def read_url = row.url\n    def read_out = row.sample_id + '_' + row.fileName\n    \"\"\"\n    wget -c --retry-connrefused --retry-on-http-error=552,502 -t 0 -T 600 -O ${read_out} ${read_url}\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "row"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "label 'high_mem'",
            "errorStrategy 'retry'"
        ],
        "when": "",
        "stub": ""
    },
    "bwa_index": {
        "name_process": "bwa_index",
        "string_process": "\nprocess bwa_index {\n    container \"${container__bwa}\"\n\n    input:\n        file fasta\n\n    output:\n        file \"reference.tar.gz\"\n\n\"\"\"#!/bin/bash\nset -e\n# Build the BWA index\nbwa index ${fasta}\n# Make the tarball\ntar cvf reference.tar \"${fasta}*\"\n# Compress it\ngzip reference.tar\n\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"#!/bin/bash\nset -e\n# Build the BWA index\nbwa index ${fasta}\n# Make the tarball\ntar cvf reference.tar \"${fasta}*\"\n# Compress it\ngzip reference.tar\n\"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "fasta"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"${container__bwa}\""
        ],
        "when": "",
        "stub": ""
    },
    "bwa_filter": {
        "name_process": "bwa_filter",
        "string_process": "\nprocess bwa_filter {\n    container \"${container__bwa}\"\n\n    input:\n        tuple file(index_tgz), val(sample_name), file(R1), file(R2)\n\n    output:\n        tuple val(sample_name), file(\"${R1}.filtered.fq.gz\"), file(\"${R2}.filtered.fq.gz\")\n\n\n\"\"\"#!/bin/bash\n# Stop execution if any of the individual commands have a non-zero exit status\nset -e\n# Get the name of the indexed genome\nbwa_index_fn=\\$(tar -ztvf ${index_tgz} | head -1 | sed \\'s/.* //\\')\nbwa_index_prefix=\\${bwa_index_fn%.*}\necho BWA index prefix is \\${bwa_index_prefix}\n# Extract the tarball containing the indexed genome\necho Extracting BWA index\nmkdir -p bwa_index/ \ntar -I pigz -xf ${index_tgz} -C bwa_index/\necho Files in index directory: \nls -l -h bwa_index \necho Running BWA \nbwa mem -t ${task.cpus} \\\n\t-T ${params.min_align_score} \\\n\t-o alignment.sam \\\n\tbwa_index/\\$bwa_index_prefix \\\n\t${R1} ${R2}\n# The line below will raise an error if the file is empty\necho Checking if alignment is empty\n[[ -s alignment.sam ]]\n# In the comand below, the \"-F 12\" flag will instruct samtools to filter\n# out any pairs in which both reads are unmapped. This will retain any\n# pairs in which either read is mapped.\n# For an intuitive explanation of these numeric flags, see \n# https://broadinstitute.github.io/picard/explain-flags.html\necho Extracting Unaligned Pairs \nsamtools fastq alignment.sam \\\n\t--threads ${task.cpus} -F 12 \\\n\t-1 ${R1}.filtered.fq.gz -2 ${R2}.filtered.fq.gz\necho Done\n\"\"\"\n}",
        "nb_lignes_process": 43,
        "string_script": "\"\"\"#!/bin/bash\n# Stop execution if any of the individual commands have a non-zero exit status\nset -e\n# Get the name of the indexed genome\nbwa_index_fn=\\$(tar -ztvf ${index_tgz} | head -1 | sed \\'s/.* //\\')\nbwa_index_prefix=\\${bwa_index_fn%.*}\necho BWA index prefix is \\${bwa_index_prefix}\n# Extract the tarball containing the indexed genome\necho Extracting BWA index\nmkdir -p bwa_index/ \ntar -I pigz -xf ${index_tgz} -C bwa_index/\necho Files in index directory: \nls -l -h bwa_index \necho Running BWA \nbwa mem -t ${task.cpus} \\\n\t-T ${params.min_align_score} \\\n\t-o alignment.sam \\\n\tbwa_index/\\$bwa_index_prefix \\\n\t${R1} ${R2}\n# The line below will raise an error if the file is empty\necho Checking if alignment is empty\n[[ -s alignment.sam ]]\n# In the comand below, the \"-F 12\" flag will instruct samtools to filter\n# out any pairs in which both reads are unmapped. This will retain any\n# pairs in which either read is mapped.\n# For an intuitive explanation of these numeric flags, see \n# https://broadinstitute.github.io/picard/explain-flags.html\necho Extracting Unaligned Pairs \nsamtools fastq alignment.sam \\\n\t--threads ${task.cpus} -F 12 \\\n\t-1 ${R1}.filtered.fq.gz -2 ${R2}.filtered.fq.gz\necho Done\n\"\"\"",
        "nb_lignes_script": 32,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample_name",
            "index_tgz",
            "R1",
            "R2"
        ],
        "nb_inputs": 4,
        "outputs": [
            "sample_name"
        ],
        "nb_outputs": 1,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"${container__bwa}\""
        ],
        "when": "",
        "stub": ""
    },
    "indexBowtie": {
        "name_process": "indexBowtie",
        "string_process": "\nprocess indexBowtie{\n  container \"$params.bowtie2\"\n  label 'high_mem'\n  errorStrategy 'retry'\n  publishDir \"$params.out_path/index/bowtie\", mode : \"copy\"\n  input:\n    path reference_fasta\n  output:\n    path \"${index_name}.*\", emit: bowtie_index\n  script:\n    index_name = reference_fasta.getSimpleName()\n    \"\"\"\n    bowtie2-build ${reference_fasta} ${index_name}\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    index_name = reference_fasta.getSimpleName()\n    \"\"\"\n    bowtie2-build ${reference_fasta} ${index_name}\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "reference_fasta"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.bowtie2\"",
            "label 'high_mem'",
            "errorStrategy 'retry'",
            "publishDir \"$params.out_path/index/bowtie\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "hostRemoval": {
        "name_process": "hostRemoval",
        "string_process": "\nprocess hostRemoval {\n  container \"$params.bowtie2\"\n  label 'mid_mem'\n  errorStrategy 'retry'\n  time { 1.day * task.attempt }\n                                                                                   \n  publishDir \"$params.out_path/organism/unaligned_reads/\", mode: \"copy\", pattern : \"*filtered.fq.gz\"\n  publishDir \"$params.out_path/organism/deduplicated_reads/\", mode: \"copy\", pattern : \"*deduped.fq.gz\"\n  publishDir \"$params.out_path/alignment_reports/\", mode: \"copy\", pattern : \"*txt\"\n\n  input:\n    tuple val(sample), path(fastq_path), path(bowtie_index), path(org_index)\n  output:\n    tuple val(sample), path(\"${sample}_*_filtered.fq\"), emit: unaligned_reads\n    tuple val(sample), path(\"${sample}_*_deduped_unrep.fq\"), emit: deduped_reads\n    path \"${sample}_host_sorted.ba*\", emit: host_bam\n    path \"${sample}_host_alignment.txt\", emit: host_alignment_stats\n    path \"${sample}_ebv_alignment.txt\", emit: ebv_alignment_stats\n                                                                             \n    path \"${sample}_ebv_dedup.ba*\" , emit: ebv_dedup_bam\n  script:\n    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}.sam > stdout.log 2> ${sample}_host_alignment.txt  \n    samtools view -S -b -f 12 -F 256 ${sample}.sam >> ${sample}_unmapped.bam\n    samtools view -S -b -F 1280 ${sample}.sam >> ${sample}_host_mapped.bam\n    samtools sort ${sample}_unmapped.bam -o ${sample}_unmapped_sorted.bam\n    samtools sort ${sample}_host_mapped.bam -o ${sample}_host_sorted.bam\n    samtools index ${sample}_unmapped_sorted.bam ${sample}_unmapped_sorted.bai\n    samtools index ${sample}_host_sorted.bam ${sample}_host_sorted.bai\n    samtools fastq -G 1024 ${sample}_unmapped_sorted.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_filtered.fq -2 ${sample}_R2_filtered.fq >> stdout.log 2> stderr.log\n    samtools fastq -f 3 ${sample}_host_sorted.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_host.fq -2 ${sample}_R2_host.fq >> stdout.log 2>> stderr.log\n    bowtie2 --very-sensitive-local -x ${org_index}/genome \\\n      -1 ${sample}_R1_filtered.fq -2 ${sample}_R2_filtered.fq \\\n      -S ${sample}_ebv_mapped.sam >> stdout.log 2>> ${sample}_ebv_alignment.txt\n    samtools view -S -b ${sample}_ebv_mapped.sam >> ${sample}_ebv_mapped.bam\n    samtools fixmate -m ${sample}_ebv_mapped.bam ${sample}_ebv_mapped_fixmate.bam\n    samtools sort -o ${sample}_ebv_sorted.bam ${sample}_ebv_mapped_fixmate.bam\n    samtools markdup -r ${sample}_ebv_sorted.bam ${sample}_ebv_dedup.bam\n    samtools index ${sample}_ebv_dedup.bam ${sample}_ebv_dedup.bai\n    samtools fastq -f 3 ${sample}_ebv_dedup.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_deduped_unrep.fq -2 ${sample}_R2_deduped_unrep.fq \\\n      >> stdout.log 2>> stderr.log\n    ##bowtie2 --very-sensitive-local -x ${org_index}/genome \\\n    ##  -1 ${sample}_R1_host.fq -2 ${sample}_R2_host.fq \\\n    ##  -S ${sample}_ebv_host_reads.sam >> stdout.log 2>> ${sample}_ebv_host_alignment.txt\n    \n    \"\"\"\n}",
        "nb_lignes_process": 55,
        "string_script": "    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}.sam > stdout.log 2> ${sample}_host_alignment.txt  \n    samtools view -S -b -f 12 -F 256 ${sample}.sam >> ${sample}_unmapped.bam\n    samtools view -S -b -F 1280 ${sample}.sam >> ${sample}_host_mapped.bam\n    samtools sort ${sample}_unmapped.bam -o ${sample}_unmapped_sorted.bam\n    samtools sort ${sample}_host_mapped.bam -o ${sample}_host_sorted.bam\n    samtools index ${sample}_unmapped_sorted.bam ${sample}_unmapped_sorted.bai\n    samtools index ${sample}_host_sorted.bam ${sample}_host_sorted.bai\n    samtools fastq -G 1024 ${sample}_unmapped_sorted.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_filtered.fq -2 ${sample}_R2_filtered.fq >> stdout.log 2> stderr.log\n    samtools fastq -f 3 ${sample}_host_sorted.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_host.fq -2 ${sample}_R2_host.fq >> stdout.log 2>> stderr.log\n    bowtie2 --very-sensitive-local -x ${org_index}/genome \\\n      -1 ${sample}_R1_filtered.fq -2 ${sample}_R2_filtered.fq \\\n      -S ${sample}_ebv_mapped.sam >> stdout.log 2>> ${sample}_ebv_alignment.txt\n    samtools view -S -b ${sample}_ebv_mapped.sam >> ${sample}_ebv_mapped.bam\n    samtools fixmate -m ${sample}_ebv_mapped.bam ${sample}_ebv_mapped_fixmate.bam\n    samtools sort -o ${sample}_ebv_sorted.bam ${sample}_ebv_mapped_fixmate.bam\n    samtools markdup -r ${sample}_ebv_sorted.bam ${sample}_ebv_dedup.bam\n    samtools index ${sample}_ebv_dedup.bam ${sample}_ebv_dedup.bai\n    samtools fastq -f 3 ${sample}_ebv_dedup.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_deduped_unrep.fq -2 ${sample}_R2_deduped_unrep.fq \\\n      >> stdout.log 2>> stderr.log\n    ##bowtie2 --very-sensitive-local -x ${org_index}/genome \\\n    ##  -1 ${sample}_R1_host.fq -2 ${sample}_R2_host.fq \\\n    ##  -S ${sample}_ebv_host_reads.sam >> stdout.log 2>> ${sample}_ebv_host_alignment.txt\n    \n    \"\"\"",
        "nb_lignes_script": 33,
        "language_script": "bash",
        "tools": [
            "CR10",
            "R2",
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/CR10",
            "https://bio.tools/R2",
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "CR10",
                "uri": "https://bio.tools/CR10",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database administration"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "PUBLIC DATABASE OF COSMIC RADIATION MEASUREMENTS AT AVIATION ALTITUDES OF ABOUT 10 KM.\n\nWhen using these data, please read this info",
                "homepage": "http://cr10.odz.ujf.cas.cz"
            },
            {
                "name": "R2",
                "uri": "https://bio.tools/R2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Model organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Expression correlation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Co-expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "R2 is a biologist friendly web based genomics analysis and visualization application",
                "homepage": "http://r2.amc.nl"
            },
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "fastq_path",
            "bowtie_index",
            "org_index"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.bowtie2\"",
            "label 'mid_mem'",
            "errorStrategy 'retry'",
            "time { 1.day * task.attempt }",
            "publishDir \"$params.out_path/organism/unaligned_reads/\", mode: \"copy\", pattern : \"*filtered.fq.gz\"",
            "publishDir \"$params.out_path/organism/deduplicated_reads/\", mode: \"copy\", pattern : \"*deduped.fq.gz\"",
            "publishDir \"$params.out_path/alignment_reports/\", mode: \"copy\", pattern : \"*txt\""
        ],
        "when": "",
        "stub": ""
    },
    "bowtie_Align": {
        "name_process": "bowtie_Align",
        "string_process": "\nprocess bowtie_Align {\n  container \"$params.bowtie2\"\n  label 'high_mem'\n  errorStrategy 'retry'\n  time '1d 6h'\n  publishDir \"$params.out_path/host/alignment/\", mode : \"copy\", pattern : \"*.ba*\"\n  publishDir \"$params.out_path/organism/unaligned_reads/\", mode: \"copy\", pattern : \"*.fq.gz\"\n  input:\n    tuple val(sample), path(fastq_path), path(bowtie_index)\n  output:\n    tuple val(sample), path(\"${sample}_*_filtered.fq.gz\"), emit: unaligned_reads\n    path \"${sample}_host_sorted.ba*\", emit: host_bam\n    path \"${sample}_${ref_type}_alignment.txt\", emit: alignment_stats\n  script:\n    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}.sam > stdout.log 2> ${sample}_${ref_type}_alignment.txt  \n    samtools view -S -b -f 12 -F 256 ${sam_path} > ${sample}_unmapped.bam\n    samtools view -S -b -F 1280 ${sam_path} > ${sample}_host_mapped.bam\n    samtools sort  ${sample}_unmapped.bam -o ${sample}_unmapped_sorted.bam\n    samtools sort  ${sample}_host_mapped.bam -o ${sample}_host_sorted.bam\n    samtools index ${sample}_unmapped_sorted.bam ${sample}_unmapped_sorted.bai\n    samtools index ${sample}_host_sorted.bam ${sample}_host_sorted.bai\n    samtools fastq ${sample}_unmapped_sorted.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_filtered.fq.gz -2 ${sample}_R2_filtered.fq.gz > stdout.log 2> stderr.log\n    \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}.sam > stdout.log 2> ${sample}_${ref_type}_alignment.txt  \n    samtools view -S -b -f 12 -F 256 ${sam_path} > ${sample}_unmapped.bam\n    samtools view -S -b -F 1280 ${sam_path} > ${sample}_host_mapped.bam\n    samtools sort  ${sample}_unmapped.bam -o ${sample}_unmapped_sorted.bam\n    samtools sort  ${sample}_host_mapped.bam -o ${sample}_host_sorted.bam\n    samtools index ${sample}_unmapped_sorted.bam ${sample}_unmapped_sorted.bai\n    samtools index ${sample}_host_sorted.bam ${sample}_host_sorted.bai\n    samtools fastq ${sample}_unmapped_sorted.bam \\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_filtered.fq.gz -2 ${sample}_R2_filtered.fq.gz > stdout.log 2> stderr.log\n    \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "CR10",
            "R2",
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/CR10",
            "https://bio.tools/R2",
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "CR10",
                "uri": "https://bio.tools/CR10",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database administration"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "PUBLIC DATABASE OF COSMIC RADIATION MEASUREMENTS AT AVIATION ALTITUDES OF ABOUT 10 KM.\n\nWhen using these data, please read this info",
                "homepage": "http://cr10.odz.ujf.cas.cz"
            },
            {
                "name": "R2",
                "uri": "https://bio.tools/R2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Model organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Expression correlation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Co-expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "R2 is a biologist friendly web based genomics analysis and visualization application",
                "homepage": "http://r2.amc.nl"
            },
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "fastq_path",
            "bowtie_index"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.bowtie2\"",
            "label 'high_mem'",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "publishDir \"$params.out_path/host/alignment/\", mode : \"copy\", pattern : \"*.ba*\"",
            "publishDir \"$params.out_path/organism/unaligned_reads/\", mode: \"copy\", pattern : \"*.fq.gz\""
        ],
        "when": "",
        "stub": ""
    },
    "align_ebv": {
        "name_process": "align_ebv",
        "string_process": "\nprocess align_ebv {\n  container \"$params.samtools_bowtie\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'high_mem'\n  publishDir \"$params.out_path/alignment/ebv/bam\", mode : \"copy\"\n  input:\n    tuple val(sample), path(fastq_path), path(bowtie_index)\n\n  output:\n    tuple val(sample), path(\"${sample}_sorted.bam\"), \n      path(\"${sample}_sorted.bai\"), emit: sam_path\n  script:\n    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}.sam > stdout.log 2> stderr.log  \n    samtools view -S -b ${sample}.sam > ${sample}.bam\n    samtools sort ${sample}.bam -o ${sample}_sorted.bam\n    samtools index ${sample}_sorted.bam ${sample}_sorted.bai\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}.sam > stdout.log 2> stderr.log  \n    samtools view -S -b ${sample}.sam > ${sample}.bam\n    samtools sort ${sample}.bam -o ${sample}_sorted.bam\n    samtools index ${sample}_sorted.bam ${sample}_sorted.bai\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "CR10",
            "R2",
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/CR10",
            "https://bio.tools/R2",
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "CR10",
                "uri": "https://bio.tools/CR10",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database administration"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "PUBLIC DATABASE OF COSMIC RADIATION MEASUREMENTS AT AVIATION ALTITUDES OF ABOUT 10 KM.\n\nWhen using these data, please read this info",
                "homepage": "http://cr10.odz.ujf.cas.cz"
            },
            {
                "name": "R2",
                "uri": "https://bio.tools/R2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Model organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Expression correlation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Co-expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "R2 is a biologist friendly web based genomics analysis and visualization application",
                "homepage": "http://r2.amc.nl"
            },
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "fastq_path",
            "bowtie_index"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools_bowtie\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'high_mem'",
            "publishDir \"$params.out_path/alignment/ebv/bam\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "align_filtered_ebv": {
        "name_process": "align_filtered_ebv",
        "string_process": "\nprocess align_filtered_ebv {\n  container \"$params.samtools_bowtie\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'high_mem'\n  publishDir \"$params.out_path/alignment/ebv/bam_filtered\", mode : \"copy\"\n  input:\n    tuple val(sample), path(fastq_path), path(bowtie_index)\n\n  output:\n    tuple val(sample), path(\"${sample}_filtered_sorted.bam\"), \n      path(\"${sample}_filtered_sorted.bai\"), emit: sam_path\n  script:\n    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}_filtered.sam > stdout.log 2> stderr.log  \n    samtools view -S -b ${sample}_filtered.sam > ${sample}_filtered.bam\n    samtools sort ${sample}_filtered.bam -o ${sample}_filtered_sorted.bam\n    samtools index ${sample}_filtered_sorted.bam ${sample}_filtered_sorted.bai\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    r1 = fastq_path[0]\n    r2 = fastq_path[1]\n    \"\"\"\n    bowtie2 --very-sensitive-local -x ${bowtie_index}/genome -1 ${r1} -2 ${r2} \\\n      -S ${sample}_filtered.sam > stdout.log 2> stderr.log  \n    samtools view -S -b ${sample}_filtered.sam > ${sample}_filtered.bam\n    samtools sort ${sample}_filtered.bam -o ${sample}_filtered_sorted.bam\n    samtools index ${sample}_filtered_sorted.bam ${sample}_filtered_sorted.bai\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "CR10",
            "R2",
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/CR10",
            "https://bio.tools/R2",
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "CR10",
                "uri": "https://bio.tools/CR10",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3489",
                            "term": "Database administration"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "PUBLIC DATABASE OF COSMIC RADIATION MEASUREMENTS AT AVIATION ALTITUDES OF ABOUT 10 KM.\n\nWhen using these data, please read this info",
                "homepage": "http://cr10.odz.ujf.cas.cz"
            },
            {
                "name": "R2",
                "uri": "https://bio.tools/R2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Model organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Expression correlation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Co-expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "R2 is a biologist friendly web based genomics analysis and visualization application",
                "homepage": "http://r2.amc.nl"
            },
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "fastq_path",
            "bowtie_index"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools_bowtie\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'high_mem'",
            "publishDir \"$params.out_path/alignment/ebv/bam_filtered\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "sam_to_bam": {
        "name_process": "sam_to_bam",
        "string_process": "\nprocess sam_to_bam {\n  container \"$params.samtools\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  publishDir \"$params.out_path/alignment/bam/\", mode : \"copy\"\n  input:\n    tuple val(sample), path(sam_path)\n  output:\n    tuple val(sample), path(\"${sample}_unmapped.bam\"), emit: bam_files\n  script:\n    \"\"\"\n    samtools view -S -b -f 12 -F 256 ${sam_path} > ${sample}_unmapped.bam\n    \"\"\"\n    \n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    samtools view -S -b -f 12 -F 256 ${sam_path} > ${sample}_unmapped.bam\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "sam_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "publishDir \"$params.out_path/alignment/bam/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "bam_sort": {
        "name_process": "bam_sort",
        "string_process": "\nprocess bam_sort {\n  container \"$params.samtools\"\n  errorStrategy 'retry'\n  label 'high_mem'\n  time '1d 6h'\n  publishDir \"$params.out_path/alignment/sorted/\", mode : \"copy\", pattern: \"*_sorted.ba*\"\n  input:\n    tuple val(sample), path(bam_file)\n  output:\n    tuple val(sample), path(\"${sample}_unmapped_sorted.bam\"), \n      path(\"${sample}_unmapped_sorted.bai\"), emit: sorted_bam_file\n  script:\n    \"\"\"\n    samtools sort -n ${bam_file} -o ${sample}_unmapped_sorted.bam\n    samtools index ${sample}_unmapped_sorted.bam ${sample}_unmapped_sorted.bai\n    \"\"\"\n    \n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    samtools sort -n ${bam_file} -o ${sample}_unmapped_sorted.bam\n    samtools index ${sample}_unmapped_sorted.bam ${sample}_unmapped_sorted.bai\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "bam_file"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools\"",
            "errorStrategy 'retry'",
            "label 'high_mem'",
            "time '1d 6h'",
            "publishDir \"$params.out_path/alignment/sorted/\", mode : \"copy\", pattern: \"*_sorted.ba*\""
        ],
        "when": "",
        "stub": ""
    },
    "idxstats": {
        "name_process": "idxstats",
        "string_process": "\nprocess idxstats {\n  container \"$params.samtools\"\n  errorStrategy 'retry'\n  label 'low_mem'\n  time '1d 6h'\n  publishDir \"$params.out_path/idxstats/\", mode : \"copy\"\n  input:\n    tuple val(sample), path(bam_file), path(index_file)\n  output:\n    path \"${sample}_idxstats.txt\", emit: idx_output\n  script:\n    \"\"\"\n    samtools idxstats ${bam_file} > ${sample}_idxstats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    samtools idxstats ${bam_file} > ${sample}_idxstats.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "bam_file",
            "index_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools\"",
            "errorStrategy 'retry'",
            "label 'low_mem'",
            "time '1d 6h'",
            "publishDir \"$params.out_path/idxstats/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "coverage": {
        "name_process": "coverage",
        "string_process": "\nprocess coverage {\n  container \"$params.samtools\"\n  errorStrategy 'retry'\n  label 'mid_mem'\n  time '1d 6h'\n  publishDir \"$params.out_path/coverage/${organism}\", mode : \"copy\"\n  input:\n    tuple val(sample), path(sam_file), val(organism)\n  output:\n    path \"${sample}_coverage.txt\", emit: coverage_output\n  script:\n    \"\"\"\n    samtools view -S -b ${sam_file} > ${sample}.bam\n    samtools sort ${sample}.bam -o ${sample}_sorted.bam\n    samtools index ${sample}_sorted.bam ${sample}_sorted.bai\n    samtools coverage -Q 30 -q 20 -o ${sample}_coverage.txt ${sample}_sorted.bam\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    samtools view -S -b ${sam_file} > ${sample}.bam\n    samtools sort ${sample}.bam -o ${sample}_sorted.bam\n    samtools index ${sample}_sorted.bam ${sample}_sorted.bai\n    samtools coverage -Q 30 -q 20 -o ${sample}_coverage.txt ${sample}_sorted.bam\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "organism",
            "sam_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools\"",
            "errorStrategy 'retry'",
            "label 'mid_mem'",
            "time '1d 6h'",
            "publishDir \"$params.out_path/coverage/${organism}\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "keep_unaligned": {
        "name_process": "keep_unaligned",
        "string_process": "\nprocess keep_unaligned {\n  container \"$params.samtools\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'mid_mem'\n  publishDir \"$params.out_path/unaligned/\", mode : \"copy\"\n  input:\n    tuple val(sample), path(bam_file), path(index_file)\n  output:\n    tuple val(sample), path(\"${sample}_R*_filtered.fq.gz\"), emit : filtered_reads\n  script:\n    \"\"\"\n    samtools fastq ${bam_file}\\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_filtered.fq.gz -2 ${sample}_R2_filtered.fq.gz > stdout.log 2> stderr.log\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    samtools fastq ${bam_file}\\\n      --threads ${task.cpus} \\\n      -1 ${sample}_R1_filtered.fq.gz -2 ${sample}_R2_filtered.fq.gz > stdout.log 2> stderr.log\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "bam_file",
            "index_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/unaligned/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "mpileup": {
        "name_process": "mpileup",
        "string_process": "\nprocess mpileup {\n  container \"$params.samtools\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'high_mem'\n  publishDir \"$params.out_path/mpileup/\", mode : \"copy\"\n  input:\n    tuple val(sample), path(bam_file), path(index_file), path(reference)\n  output:\n    tuple val(sample), path(\"${sample}_mpileup.txt\"), emit: mpileup_output\n  script:\n    \"\"\"\n    samtools mpileup -f ${reference}/genome.fa -q 20 -Q 30 -a -o ${sample}_mpileup.txt ${bam_file}\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    samtools mpileup -f ${reference}/genome.fa -q 20 -Q 30 -a -o ${sample}_mpileup.txt ${bam_file}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "bam_file",
            "index_file",
            "reference"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.samtools\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'high_mem'",
            "publishDir \"$params.out_path/mpileup/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "prokka": {
        "name_process": "prokka",
        "string_process": "\nprocess prokka {\n  container \"$params.prokka\"\n  label 'high_mem'\n  errorStrategy 'retry'\n  publishDir \"$params.out_path/genome_annotation/${assembly_mode}/${sample}\", \n    mode : \"copy\"\n  input:\n    each path(assembled_genome)\n    val assembly_mode\n  output:\n    path \"${sample}_${assembly_mode}\", emit: gene_annotation\n  script:\n    sample = assembled_genome.getSimpleName()\n    \"\"\"\n    mkdir -p temp_storage\n    export TMPDIR=$workDir\n    prokka --outdir ${sample}_${assembly_mode} --kingdom Viruses --genus Lymphocryptovirus --rfam --mincontiglen 200 --usegenus ${assembled_genome} > stdout.log 2> stderr.log  \n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    sample = assembled_genome.getSimpleName()\n    \"\"\"\n    mkdir -p temp_storage\n    export TMPDIR=$workDir\n    prokka --outdir ${sample}_${assembly_mode} --kingdom Viruses --genus Lymphocryptovirus --rfam --mincontiglen 200 --usegenus ${assembled_genome} > stdout.log 2> stderr.log  \n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMPLE",
            "Prokka"
        ],
        "tools_url": [
            "https://bio.tools/sample",
            "https://bio.tools/prokka"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            },
            {
                "name": "Prokka",
                "uri": "https://bio.tools/prokka",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Model organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0781",
                            "term": "Virology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Organisms"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0436",
                                    "term": "Coding region prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2454",
                                    "term": "Gene prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0362",
                                    "term": "Genome annotation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0436",
                                    "term": "ORF prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0436",
                                    "term": "ORF finding"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2454",
                                    "term": "Gene finding"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2454",
                                    "term": "Gene calling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Software tool to annotate bacterial, archaeal and viral genomes quickly and produce standards-compliant output files.",
                "homepage": "https://github.com/tseemann/prokka"
            }
        ],
        "inputs": [
            "assembled_genome",
            "assembly_mode"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.prokka\"",
            "label 'high_mem'",
            "errorStrategy 'retry'",
            "publishDir \"$params.out_path/genome_annotation/${assembly_mode}/${sample}\" , mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "haplotype_caller": {
        "name_process": "haplotype_caller",
        "string_process": "\nprocess haplotype_caller {\n  container \"$params.gatk\"\n  errorStrategy 'retry'\n  label 'mid_mem'\n  publishDir \"$params.out_path/variant_calls/${sample}/\", mode : \"copy\"\n  input:\n    each path(bam_path)\n    path reference_path\n  output:\n    path \"${sample}.vcf.gz*\" , emit: vcf_paths\n    \n  script:\n    def bam_file = bam_path[1]\n    sample =  bam_file.getSimpleName().replaceAll(/_ebv_dedup/, \"\")\n    \"\"\"\n    gatk AddOrReplaceReadGroups \\\n      -I ${bam_file} \\\n      -O ${sample}_rg.bam \\\n      -LB ebv \\\n      -PL ILLUMINA \\\n      -PU NA \\\n      -SM ${sample} \\\n      --CREATE_INDEX  true\n    gatk --java-options \"-Xmx4g\" HaplotypeCaller \\\n      -R ${reference_path}/genome.fa \\\n      -I ${sample}_rg.bam \\\n      -ploidy 1 \\\n      --output ${sample}.vcf.gz  > stdout.log 2> stderr.log \n    \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "    def bam_file = bam_path[1]\n    sample =  bam_file.getSimpleName().replaceAll(/_ebv_dedup/, \"\")\n    \"\"\"\n    gatk AddOrReplaceReadGroups \\\n      -I ${bam_file} \\\n      -O ${sample}_rg.bam \\\n      -LB ebv \\\n      -PL ILLUMINA \\\n      -PU NA \\\n      -SM ${sample} \\\n      --CREATE_INDEX  true\n    gatk --java-options \"-Xmx4g\" HaplotypeCaller \\\n      -R ${reference_path}/genome.fa \\\n      -I ${sample}_rg.bam \\\n      -ploidy 1 \\\n      --output ${sample}.vcf.gz  > stdout.log 2> stderr.log \n    \"\"\"",
        "nb_lignes_script": 16,
        "language_script": "bash",
        "tools": [
            "SAMPLE",
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/sample",
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            },
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "bam_path",
            "reference_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.gatk\"",
            "errorStrategy 'retry'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/variant_calls/${sample}/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "cnn_score_variants": {
        "name_process": "cnn_score_variants",
        "string_process": "\nprocess cnn_score_variants {\n  container \"$params.gatk\"\n  errorStrategy 'retry'\n  label 'mid_mem'\n  publishDir \"$params.out_path/variant_calls/${sample}/\", mode : \"copy\"\n  input:\n    each path(vcf_path)\n    path reference_path\n  output:\n    path \"${sample}_annotated.vcf\", emit: annotated_vcf_paths\n  script:\n    def vcf_file = vcf_path[0]\n    sample = vcf_file.getSimpleName()\n    \"\"\"\n    mkdir temp_dir\n    gatk CNNScoreVariants \\\n      -V ${vcf_file} \\\n      -R ${reference_path}/genome.fa \\\n      --tmp-dir temp_dir \\\n      -O ${sample}_annotated.vcf > stdout.log 2> stderr.log\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    def vcf_file = vcf_path[0]\n    sample = vcf_file.getSimpleName()\n    \"\"\"\n    mkdir temp_dir\n    gatk CNNScoreVariants \\\n      -V ${vcf_file} \\\n      -R ${reference_path}/genome.fa \\\n      --tmp-dir temp_dir \\\n      -O ${sample}_annotated.vcf > stdout.log 2> stderr.log\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "SAMPLE",
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/sample",
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            },
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "vcf_path",
            "reference_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.gatk\"",
            "errorStrategy 'retry'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/variant_calls/${sample}/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "annotate_vcfs": {
        "name_process": "annotate_vcfs",
        "string_process": "\nprocess annotate_vcfs {\n  conda '/home/ebrierch/.conda/envs/ebv_enktl'\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'local'\n  publishDir \"$params.out_path/variant_calls/${sample}/\", mode : \"copy\"\n  input:  \n    each path(vcf_path) \n  output:\n    path \"${sample}_snpeff.vcf\" , emit: snpeff_vcf_paths\n    path \"${sample}_summary.html\" , emit: snpeff_vcf_summary\n    path \"${sample}_snpeff.tsv\", emit: snpeff_vcf_tsv\n  script:\n    sample = vcf_path.getSimpleName().replaceAll(\"_annotated\", \"\")\n    \"\"\"\n    snpEff -v ebv -s ${sample}_summary.html ${vcf_path} > ${sample}_snpeff.vcf\n    cat ${sample}_snpeff.vcf | ~/.conda/pkgs/snpsift-4.3.1t-hdfd78af_3/share/snpsift-4.3.1t-3/scripts/vcfEffOnePerLine.pl  > ${sample}_oneperline.vcf \n    SnpSift extractFields ${sample}_oneperline.vcf CHROM POS REF ALT \"ANN[*].EFFECT\" \"ANN[*].GENE\" \"ANN[*].HGVS_P\" > ${sample}_snpeff.tsv \n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    sample = vcf_path.getSimpleName().replaceAll(\"_annotated\", \"\")\n    \"\"\"\n    snpEff -v ebv -s ${sample}_summary.html ${vcf_path} > ${sample}_snpeff.vcf\n    cat ${sample}_snpeff.vcf | ~/.conda/pkgs/snpsift-4.3.1t-hdfd78af_3/share/snpsift-4.3.1t-3/scripts/vcfEffOnePerLine.pl  > ${sample}_oneperline.vcf \n    SnpSift extractFields ${sample}_oneperline.vcf CHROM POS REF ALT \"ANN[*].EFFECT\" \"ANN[*].GENE\" \"ANN[*].HGVS_P\" > ${sample}_snpeff.tsv \n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMPLE",
            "snpEff",
            "SnpSift"
        ],
        "tools_url": [
            "https://bio.tools/sample",
            "https://bio.tools/snpeff",
            "https://bio.tools/snpsift"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            },
            {
                "name": "snpEff",
                "uri": "https://bio.tools/snpeff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "Single nucleotide polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP discovery"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP calling"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            },
                            {
                                "uri": "http://edamontology.org/data_3002",
                                "term": "Annotation track"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Variant annotation and effect prediction tool. It annotates and predicts the effects of variants on genes and proteins (such as amino acid changes).",
                "homepage": "http://snpeff.sourceforge.net/"
            },
            {
                "name": "SnpSift",
                "uri": "https://bio.tools/snpsift",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3365",
                            "term": "Data architecture, analysis and design"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Toolbox that allows you to filter and manipulate annotated vcf files.",
                "homepage": "http://snpeff.sourceforge.net/SnpSift.html"
            }
        ],
        "inputs": [
            "vcf_path"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "conda '/home/ebrierch/.conda/envs/ebv_enktl'",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'local'",
            "publishDir \"$params.out_path/variant_calls/${sample}/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "call_host_variants": {
        "name_process": "call_host_variants",
        "string_process": "\nprocess call_host_variants {\n  container \"$params.gatk\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'mid_mem'\n  publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\"\n  input:\n    each path(bam_file)\n    path reference_path\n  output:\n    path \"${sample}.g.vcf.gz\", emit: gvcf_paths\n    path \"${sample}.g.vcf.gz.tbi\", emit: gvcf_index_paths\n  script:\n    def bam_path = bam_file[0]\n    def bam_index_path = bam_file[1]\n    def sample =  ${bam_path}.replaceAll(/_ebv_dedup.bam/, \"\")\n    \"\"\"\n    gatk --java-options \"-Xmx4g\" HaplotypeCaller \\\n      -R ${reference_path}/genome.fa \\\n      -I ${bam_file} \\\n      -O ${sample}.g.vcf.gz \\\n      -ERC GVCF\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    def bam_path = bam_file[0]\n    def bam_index_path = bam_file[1]\n    def sample =  ${bam_path}.replaceAll(/_ebv_dedup.bam/, \"\")\n    \"\"\"\n    gatk --java-options \"-Xmx4g\" HaplotypeCaller \\\n      -R ${reference_path}/genome.fa \\\n      -I ${bam_file} \\\n      -O ${sample}.g.vcf.gz \\\n      -ERC GVCF\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "bam_file",
            "reference_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.gatk\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "generate_gvcf_table": {
        "name_process": "generate_gvcf_table",
        "string_process": "\nprocess generate_gvcf_table {\n  module \"R/4.1.0-foss-2020b\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'mid_mem'\n\n  publishDir \"$params.out_path/variant_calls/\", mode : \"copy\"\n  input:\n    path gvcf_paths\n    path gvcf_index_paths\n  output:\n    path \"gvcf_map_file.tsv\", emit: gvcf_map_file\n  script:\n    \"\"\"\n    Rscript $moduleDir/rscripts/map_gvcfs.R -p ./ -o gvcf_map_file.tsv \n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    Rscript $moduleDir/rscripts/map_gvcfs.R -p ./ -o gvcf_map_file.tsv \n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "gvcf_paths",
            "gvcf_index_paths"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "module \"R/4.1.0-foss-2020b\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/variant_calls/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "consolidate_gvcfs": {
        "name_process": "consolidate_gvcfs",
        "string_process": "\nprocess consolidate_gvcfs {\n  conda \"/home/sravisha/.conda/envs/ebv_enktl\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'mid_mem'\n\n  publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\"\n  input:\n    path gvcf_paths \n    path gvcf_index_paths\n    path gvcf_map_file\n  output:\n    path \"gvcf_database\", emit: gvcf_database\n  script:\n    \"\"\"\n    gatk --java-options \"-Xmx4g -Xms4g\" GenomicsDBImport \\\n      --genomicsdb-workspace-path gvcf_database --batch-size 0 \\\n      -L 20 --sample-name-map gvcf_map_file.tsv \\\n      --reader-threads 4 > stdout.log 2> stderr.log  \n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    gatk --java-options \"-Xmx4g -Xms4g\" GenomicsDBImport \\\n      --genomicsdb-workspace-path gvcf_database --batch-size 0 \\\n      -L 20 --sample-name-map gvcf_map_file.tsv \\\n      --reader-threads 4 > stdout.log 2> stderr.log  \n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gvcf_paths",
            "gvcf_index_paths",
            "gvcf_map_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "conda \"/home/sravisha/.conda/envs/ebv_enktl\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "genotype_gvcfs": {
        "name_process": "genotype_gvcfs",
        "string_process": "\nprocess genotype_gvcfs {\n  container \"$params.gatk\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'mid_mem'\n  publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\"\n  input:\n    path gvcf_database\n    path reference_path\n  output:\n    path \"host_variant_calls.vcf.gz\", emit : joint_vcf\n    path \"host_variant_calls.vcf.gz.tbi\", emit : joint_vcf_index\n  script:\n    \"\"\"\n    mkdir temp_dir\n    gatk --java-options \"-Xmx4g\" GenotypeGVCFs \\\n      -R ${reference_path}/genome.fa \\\n      -V gendb://gvcf_database \\\n      --tmp-dir temp_dir \\\n      -O host_variant_calls.vcf.gz > stdout.log 2> stderr.log  \n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    mkdir temp_dir\n    gatk --java-options \"-Xmx4g\" GenotypeGVCFs \\\n      -R ${reference_path}/genome.fa \\\n      -V gendb://gvcf_database \\\n      --tmp-dir temp_dir \\\n      -O host_variant_calls.vcf.gz > stdout.log 2> stderr.log  \n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "gvcf_database",
            "reference_path"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.gatk\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "variant_scoring": {
        "name_process": "variant_scoring",
        "string_process": "\nprocess variant_scoring {\n  container \"$params.gatk\"\n  errorStrategy 'retry'\n  time '1d 6h'\n  label 'mid_mem'\n  publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\"  \n  input:\n    path joint_vcf\n    path joint_vcf_index\n    path reference_path\n  output:\n    path \"host_variant_calls.vcf.gz\", emit : annotated_vcf\n    path \"host_variant_calls.vcf.gz.tbi\", emit : annotated_vcf_index\n  script:  \n    \"\"\" \n    mkdir temp_dir\n    gatk VariantRecalibrator \\\n      --tmp-dir temp_dir \\\n      -R ${reference_path}/genome.fa \\\n      -V host_variant_calls_scored.vcf.gz \\\n      --resource hapmap,known=false,training=true,truth=true,prior=15.0:$params.variants.hapmap \\\n      --resource mills,known=false,training=true,truth=true,prior=12:$params.variants.mills \\\n      --resource axiomPoly,known=false,training=true,truth=false,prior=10:$params.variants.axiom \\\n      --resource omni,known=false,training=true,truth=false,prior=12.0:$params.variants.1000gomni \\\n      --resource 1000G,known=false,training=true,truth=false,prior=10.0:$params.variants.1000gphase3 \\\n      --resource dbsnp,known=true,training=false,truth=false,prior=2.0:$params.variants.dbsnp \\\n      -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR \\\n      -mode BOTH \\\n      -O host_variant_calls.recal \\\n      --tranches-file host_variant_calls.tranches \n    gatk ApplyVQSR \\\n      --tmp-dir temp_dir \\\n      -R ${reference_path}/genome.fa \\\n      -V host_variant_calls.vcf.gz \\\n      -O host_variant_calls_scored.vcf.gz \\\n      --ts_filter_level 99.0 \\\n      --tranches-file host_variant_calls.tranches \\\n      --recal-file host_variant_calls.recal \\\n      -mode BOTH\n    \"\"\"\n}",
        "nb_lignes_process": 40,
        "string_script": "    \"\"\" \n    mkdir temp_dir\n    gatk VariantRecalibrator \\\n      --tmp-dir temp_dir \\\n      -R ${reference_path}/genome.fa \\\n      -V host_variant_calls_scored.vcf.gz \\\n      --resource hapmap,known=false,training=true,truth=true,prior=15.0:$params.variants.hapmap \\\n      --resource mills,known=false,training=true,truth=true,prior=12:$params.variants.mills \\\n      --resource axiomPoly,known=false,training=true,truth=false,prior=10:$params.variants.axiom \\\n      --resource omni,known=false,training=true,truth=false,prior=12.0:$params.variants.1000gomni \\\n      --resource 1000G,known=false,training=true,truth=false,prior=10.0:$params.variants.1000gphase3 \\\n      --resource dbsnp,known=true,training=false,truth=false,prior=2.0:$params.variants.dbsnp \\\n      -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR \\\n      -mode BOTH \\\n      -O host_variant_calls.recal \\\n      --tranches-file host_variant_calls.tranches \n    gatk ApplyVQSR \\\n      --tmp-dir temp_dir \\\n      -R ${reference_path}/genome.fa \\\n      -V host_variant_calls.vcf.gz \\\n      -O host_variant_calls_scored.vcf.gz \\\n      --ts_filter_level 99.0 \\\n      --tranches-file host_variant_calls.tranches \\\n      --recal-file host_variant_calls.recal \\\n      -mode BOTH\n    \"\"\"",
        "nb_lignes_script": 25,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "joint_vcf",
            "joint_vcf_index",
            "reference_path"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.gatk\"",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "label 'mid_mem'",
            "publishDir \"$params.out_path/host_variant_calls/\", mode : \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "spades": {
        "name_process": "spades",
        "string_process": "\nprocess spades {\n  container \"$params.spades\"\n                   \n  label 'high_mem'\n  errorStrategy 'retry'\n  time '1d 6h'\n  publishDir \"$params.out_path/genome_assembly/$params.assembly_type/${sample}\", \n    mode : \"copy\", pattern : \"${sample}/*fa*\"\n  publishDir \"$params.out_path/contigs/$params.assembly_type/\", mode : \"copy\", \n    pattern : \"${sample}.fasta\"\n  input:\n    tuple val(sample), path(trimmed_reads)\n  output:\n    tuple val(sample), path(\"${sample}/contigs.fasta\"), \n      path(\"${sample}/scaffolds.fasta\"), path(\"${sample}/assembly_graph.fastg\"),\n      path(\"${sample}/assembly_graph_with_scaffolds.gfa\"), emit: genome_assembly\n    path \"${sample}.fasta\", emit: contigs\n  script:\n    def forward = trimmed_reads[0]\n    def reverse = trimmed_reads[1]\n    def memory = \"$task.memory\" =~ /\\d+/\n    if (\"$params.assembly_type\" == \"reference_guided\")\n      \"\"\"\n      spades.py -k 11,21,33,55,77 -t $task.cpus --trusted-contigs ${org_reference}/genome.fa --careful \\\n        -1 ${forward} -2 ${reverse} -m ${memory[0]}  -o ${sample} > stdout.log 2> stderr.log  \n      cp ${sample}/contigs.fasta ${sample}.fasta\n      \"\"\"\n    else if (\"$params.assembly_type\" == \"de_novo\")\n      \"\"\"\n      spades.py -k 11,21,33,55,77 -t $task.cpus --careful \\\n        -1 ${forward} -2 ${reverse} -m ${memory[0]}  -o ${sample} > stdout.log 2> stderr.log\n      cp ${sample}/contigs.fasta ${sample}.fasta\n      \"\"\"\n}",
        "nb_lignes_process": 33,
        "string_script": "    def forward = trimmed_reads[0]\n    def reverse = trimmed_reads[1]\n    def memory = \"$task.memory\" =~ /\\d+/\n    if (\"$params.assembly_type\" == \"reference_guided\")\n      \"\"\"\n      spades.py -k 11,21,33,55,77 -t $task.cpus --trusted-contigs ${org_reference}/genome.fa --careful \\\n        -1 ${forward} -2 ${reverse} -m ${memory[0]}  -o ${sample} > stdout.log 2> stderr.log  \n      cp ${sample}/contigs.fasta ${sample}.fasta\n      \"\"\"\n    else if (\"$params.assembly_type\" == \"de_novo\")\n      \"\"\"\n      spades.py -k 11,21,33,55,77 -t $task.cpus --careful \\\n        -1 ${forward} -2 ${reverse} -m ${memory[0]}  -o ${sample} > stdout.log 2> stderr.log\n      cp ${sample}/contigs.fasta ${sample}.fasta\n      \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sample",
            "trimmed_reads"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.spades\"",
            "label 'high_mem'",
            "errorStrategy 'retry'",
            "time '1d 6h'",
            "publishDir \"$params.out_path/genome_assembly/$params.assembly_type/${sample}\" , mode : \"copy\", pattern : \"${sample}/*fa*\"",
            "publishDir \"$params.out_path/contigs/$params.assembly_type/\", mode : \"copy\" , pattern : \"${sample}.fasta\""
        ],
        "when": "",
        "stub": ""
    },
    "unicycler": {
        "name_process": "unicycler",
        "string_process": "\nprocess unicycler {\n  container \"$params.unicycler\"\n  errorStrategy 'retry'\n  time { 1.day * task.attempt }\n  label 'high_mem'\n  publishDir \"$params.out_path/genome_assembly/unicycler/${sample}\", \n    mode : \"copy\", pattern : \"${sample}/assembly.*\"\n  publishDir \"$params.out_path/contigs/unicycler/\", mode : \"copy\", \n    pattern : \"${sample}.fasta\"\n  input:\n    tuple val(sample), path(trimmed_reads)\n  output:\n    tuple val(sample), path(\"${sample}/assembly.fasta\"), \n    path(\"${sample}/assembly.gfa\"), emit: unicycler\n    path \"${sample}.fasta\", emit: contigs\n  script:\n    def forward = trimmed_reads[0]\n    def reverse = trimmed_reads[1]\n    def memory = \"$task.memory\" =~ /\\d+/\n    \"\"\"\n    unicycler -1 ${forward} -2 ${reverse} --mode bold --verbosity 0 -o ${sample} > stdout.log 2> stderr.log\n    cp ${sample}/assembly.fasta ${sample}.fasta\n    cp ${sample}/assembly.gfa ${sample}.gfa\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    def forward = trimmed_reads[0]\n    def reverse = trimmed_reads[1]\n    def memory = \"$task.memory\" =~ /\\d+/\n    \"\"\"\n    unicycler -1 ${forward} -2 ${reverse} --mode bold --verbosity 0 -o ${sample} > stdout.log 2> stderr.log\n    cp ${sample}/assembly.fasta ${sample}.fasta\n    cp ${sample}/assembly.gfa ${sample}.gfa\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "Unicycler"
        ],
        "tools_url": [
            "https://bio.tools/unicycler"
        ],
        "tools_dico": [
            {
                "name": "Unicycler",
                "uri": "https://bio.tools/unicycler",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3301",
                            "term": "Microbiology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3436",
                                    "term": "Aggregation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Genome assembly"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Sequence assembly (genome assembly)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Genomic assembly"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0925",
                                "term": "Sequence assembly"
                            }
                        ]
                    }
                ],
                "description": "A tool for assembling bacterial genomes from a combination of short (2nd generation) and long (3rd generation) sequencing reads.",
                "homepage": "https://github.com/rrwick/Unicycler"
            }
        ],
        "inputs": [
            "sample",
            "trimmed_reads"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.unicycler\"",
            "errorStrategy 'retry'",
            "time { 1.day * task.attempt }",
            "label 'high_mem'",
            "publishDir \"$params.out_path/genome_assembly/unicycler/${sample}\" , mode : \"copy\", pattern : \"${sample}/assembly.*\"",
            "publishDir \"$params.out_path/contigs/unicycler/\", mode : \"copy\" , pattern : \"${sample}.fasta\""
        ],
        "when": "",
        "stub": ""
    },
    "abacas": {
        "name_process": "abacas",
        "string_process": "\nprocess abacas {\n  container \"$params.abacas\"\n  label 'high_mem'\n  time '1d 6h'\n  errorStrategy 'retry'\n  publishDir \"$params.out_path/contigs/abacas/${mode}\", mode : \"copy\", pattern : \"${sample}_abacas.fasta\"\n  input:\n    each path(assembly)\n    val mode\n    path org_reference\n  output:\n    path \"${sample}_abacas.fasta\", emit: abacas_contigs\n  script:\n    sample = assembly.getSimpleName()\n    \"\"\"\n    abacas.pl -r ${org_reference}/genome.fa -q ${assembly} -p nucmer > stdout.log 2> stderr.log\n    awk '/^>/ {printf(\">%s\\\\n\",\"${sample}\");next;} {print}' ${sample}.fasta_genome.fa.fasta > ${sample}_abacas.fasta \n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    sample = assembly.getSimpleName()\n    \"\"\"\n    abacas.pl -r ${org_reference}/genome.fa -q ${assembly} -p nucmer > stdout.log 2> stderr.log\n    awk '/^>/ {printf(\">%s\\\\n\",\"${sample}\");next;} {print}' ${sample}.fasta_genome.fa.fasta > ${sample}_abacas.fasta \n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMPLE",
            "NextSV"
        ],
        "tools_url": [
            "https://bio.tools/sample",
            "https://bio.tools/nextsv"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            },
            {
                "name": "NextSV",
                "uri": "https://bio.tools/nextsv",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "Structural variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "Genomic structural variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3175",
                            "term": "DNA structural variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3228",
                                    "term": "Structural variation detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3228",
                                    "term": "Structural variation discovery"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A meta SV caller and a computational pipeline to perform SV calling from low coverage long-read sequencing data. It integrates three aligners and three SV callers and generates two integrated call sets (sensitive/stringent) for different analysis purpose.",
                "homepage": "http://github.com/Nextomics/NextSV"
            }
        ],
        "inputs": [
            "assembly",
            "mode",
            "org_reference"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.abacas\"",
            "label 'high_mem'",
            "time '1d 6h'",
            "errorStrategy 'retry'",
            "publishDir \"$params.out_path/contigs/abacas/${mode}\", mode : \"copy\", pattern : \"${sample}_abacas.fasta\""
        ],
        "when": "",
        "stub": ""
    },
    "repeat_masker": {
        "name_process": "repeat_masker",
        "string_process": "\nprocess repeat_masker {\n  container \"$params.repeatmasker\"\n  label 'high_mem'\n  time '1d 6h'\n  errorStrategy 'retry'\n  publishDir \"$params.out_path/repeatmasker\", mode : \"copy\", pattern : \"${sample}.fasta*\"\n  publishDir \"$params.out_path/contigs/repeat_masked\", mode : \"copy\", pattern : \"${sample}.fasta.masked\", saveAs: { \"${sample}_masked.fasta\"}\n  input:\n    each abacas_path\n    path repeat_table \n  output:\n    path \"${sample}.fasta.masked\", emit: masked_fasta\n    path \"${sample}_masked.fasta\", emit: contigs\n    path \"${sample}.fasta.cat\", emit: repeat_catalog\n    path \"${sample}.fasta.out\", emit: repeat_output\n    path \"${sample}.fasta.tbl\", emit: repeat_table\n  script:\n    sample = abacas_path.getBaseName()\n    \"\"\"\n    RepeatMasker -pa 4 -lib ${repeat_table} -s -e rmblast -dir ./ ${abacas_path} > stdout.log 2> stderr.log\n    cp ${sample}.fasta.masked ${sample}_masked.fasta\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    sample = abacas_path.getBaseName()\n    \"\"\"\n    RepeatMasker -pa 4 -lib ${repeat_table} -s -e rmblast -dir ./ ${abacas_path} > stdout.log 2> stderr.log\n    cp ${sample}.fasta.masked ${sample}_masked.fasta\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMPLE",
            "RepeatMasker"
        ],
        "tools_url": [
            "https://bio.tools/sample",
            "https://bio.tools/repeatmasker"
        ],
        "tools_dico": [
            {
                "name": "SAMPLE",
                "uri": "https://bio.tools/sample",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The tool is designed to identify regions that are linked to a recessive disease by analysing genotype data from the parents and unaffected sibs of affected individuals. Since this analysis does not use data from affected patients, it is suited to the identification of lethal recessive genes, when the patients may have died before DNA samples could be obtained.",
                "homepage": "http://dna.leeds.ac.uk/sample/"
            },
            {
                "name": "RepeatMasker",
                "uri": "https://bio.tools/repeatmasker",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0157",
                            "term": "Sequence composition, complexity and repeats"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0362",
                                    "term": "Genome annotation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A program that screens DNA sequences for interspersed repeats and low complexity DNA sequences. The output of the program is a detailed annotation of the repeats that are present in the query sequence as well as a modified version of the query sequence in which all the annotated repeats have been masked (default: replaced by Ns).",
                "homepage": "http://www.repeatmasker.org/"
            }
        ],
        "inputs": [
            "abacas_path",
            "repeat_table"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "WarrenLabFH__viral_genomics",
        "directive": [
            "container \"$params.repeatmasker\"",
            "label 'high_mem'",
            "time '1d 6h'",
            "errorStrategy 'retry'",
            "publishDir \"$params.out_path/repeatmasker\", mode : \"copy\", pattern : \"${sample}.fasta*\"",
            "publishDir \"$params.out_path/contigs/repeat_masked\", mode : \"copy\", pattern : \"${sample}.fasta.masked\", saveAs: { \"${sample}_masked.fasta\"}"
        ],
        "when": "",
        "stub": ""
    }
}