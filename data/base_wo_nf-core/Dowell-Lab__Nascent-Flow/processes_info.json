{
    "get_software_versions": {
        "name_process": "get_software_versions",
        "string_process": "\nprocess get_software_versions {\n    validExitStatus 0,1,127\n    time '1h'\n\n    output:\n    stdout into software_versions\n\n    script:\n    \"\"\"\n    printf \"nascentflow_version: %s\\n\" ${params.version}\n    printf \"nextflow_version: %s\\n\" ${workflow.nextflow.version}\n    printf \"fastqc_version: %s\\n\" \\$(fastqc -v | head -1 | awk -F \" v\" '{print \\$2}')\n    printf \"bbmap_version: %s\\n\" \\$(bbversion.sh --version | head -1)\n    printf \"hisat2_version: %s\\n\" \\$(hisat2 --version | head -1 | awk '{print \\$NF}')\n    printf \"samtools_version: %s\\n\" \\$(samtools --version | head -1 | awk '{print \\$NF}')\n    printf \"sratools_version: %s\\n\" \\$(fastq-dump --version | head -2 | tail -1 | awk '{print \\$NF}')\n    printf \"preseq_version: %s\\n\" \\$(preseq 2>&1 | head -2 | tail -1 | awk '{print \\$NF}')\n    printf \"java_version: %s\\n\" \\$(java -version 2>&1 | head -1 | awk -F '\"' '{print \\$2}')\n    printf \"picard_gc_version: %s\\n\" \\$(java -jar ${params.picard_path} CollectGcBiasMetrics --version 2>&1 | head -1 | awk -F \"-\" '{print \\$1}')\n    printf \"picard_dups_version: %s\\n\" \\$(java -jar ${params.picard_path} MarkDuplicates --version 2>&1 | head -1 | awk -F \"-\" '{print \\$1}')\n    printf \"bedtools_version: %s\\n\" \\$(bedtools --version | head -1 | awk -F \" v\" '{print \\$2}')\n    printf \"igvtools_version: %s\\n\" \\$(igvtools version | head -1 | awk '{print \\$3}')\n    printf \"rseqc_version: %s\\n\" \\$(infer_experiment.py --version | head -1 | awk '{print \\$NF}')\n    printf \"seqkit_version: %s\\n\" \\$(seqkit version | head -1 | awk -F \" v\" '{print \\$2}')\n    printf \"mpich_version: %s\\n\" \\$(mpichversion | head -1 | awk '{print \\$NF}')\n    printf \"gcc_version: %s\\n\" \\$(gcc --version | head -1 | awk '{print \\$NF}')\n    printf \"python_version: %s\\n\" \\$(python3 --version | head -1 | awk '{print \\$NF}')\n    printf \"numpy_version: %s\\n\" \\$(python3 -c \"import numpy; print(numpy.__version__)\" | head -1)\n    printf \"fstitch_version: %s\\n\" \\$(${params.fstitch_path} train --version | head -1)\n    printf \"tfit_version: %s\\n\" \\$(${params.tfit_path} model --version | head -1)\n    printf \"pipeline_hash: %s\\n\" ${workflow.scriptId}\n    \"\"\"\n}",
        "nb_lignes_process": 32,
        "string_script": "    \"\"\"\n    printf \"nascentflow_version: %s\\n\" ${params.version}\n    printf \"nextflow_version: %s\\n\" ${workflow.nextflow.version}\n    printf \"fastqc_version: %s\\n\" \\$(fastqc -v | head -1 | awk -F \" v\" '{print \\$2}')\n    printf \"bbmap_version: %s\\n\" \\$(bbversion.sh --version | head -1)\n    printf \"hisat2_version: %s\\n\" \\$(hisat2 --version | head -1 | awk '{print \\$NF}')\n    printf \"samtools_version: %s\\n\" \\$(samtools --version | head -1 | awk '{print \\$NF}')\n    printf \"sratools_version: %s\\n\" \\$(fastq-dump --version | head -2 | tail -1 | awk '{print \\$NF}')\n    printf \"preseq_version: %s\\n\" \\$(preseq 2>&1 | head -2 | tail -1 | awk '{print \\$NF}')\n    printf \"java_version: %s\\n\" \\$(java -version 2>&1 | head -1 | awk -F '\"' '{print \\$2}')\n    printf \"picard_gc_version: %s\\n\" \\$(java -jar ${params.picard_path} CollectGcBiasMetrics --version 2>&1 | head -1 | awk -F \"-\" '{print \\$1}')\n    printf \"picard_dups_version: %s\\n\" \\$(java -jar ${params.picard_path} MarkDuplicates --version 2>&1 | head -1 | awk -F \"-\" '{print \\$1}')\n    printf \"bedtools_version: %s\\n\" \\$(bedtools --version | head -1 | awk -F \" v\" '{print \\$2}')\n    printf \"igvtools_version: %s\\n\" \\$(igvtools version | head -1 | awk '{print \\$3}')\n    printf \"rseqc_version: %s\\n\" \\$(infer_experiment.py --version | head -1 | awk '{print \\$NF}')\n    printf \"seqkit_version: %s\\n\" \\$(seqkit version | head -1 | awk -F \" v\" '{print \\$2}')\n    printf \"mpich_version: %s\\n\" \\$(mpichversion | head -1 | awk '{print \\$NF}')\n    printf \"gcc_version: %s\\n\" \\$(gcc --version | head -1 | awk '{print \\$NF}')\n    printf \"python_version: %s\\n\" \\$(python3 --version | head -1 | awk '{print \\$NF}')\n    printf \"numpy_version: %s\\n\" \\$(python3 -c \"import numpy; print(numpy.__version__)\" | head -1)\n    printf \"fstitch_version: %s\\n\" \\$(${params.fstitch_path} train --version | head -1)\n    printf \"tfit_version: %s\\n\" \\$(${params.tfit_path} model --version | head -1)\n    printf \"pipeline_hash: %s\\n\" ${workflow.scriptId}\n    \"\"\"",
        "nb_lignes_script": 23,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "software_versions"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0,1,127",
            "time '1h'"
        ],
        "when": "",
        "stub": ""
    },
    "sra_dump": {
        "name_process": "sra_dump",
        "string_process": "\nprocess sra_dump {\n    tag \"$prefix\"\n    if (params.threadfqdump) {\n        cpus 8 }\n    else {\n        cpus 1\n    }\n    if (params.savefq || params.saveAllfq) {\n        publishDir \"${params.outdir}/fastq\", mode: 'copy'\n    }\n    \n    input:\n    set val(prefix), file(reads) from read_files_sra\n\n    output:\n    set val(prefix), file(\"*.fastq.gz\") into fastq_reads_qc_sra, fastq_reads_trim_sra, fastq_reads_hisat2_notrim_sra\n   \n\n    script:\n    prefix = reads.baseName\n    if (!params.threadfqdump && !params.singleEnd) {\n        \"\"\"\n        echo ${prefix}\n        fastq-dump --split-3 ${reads} --gzip\n        \"\"\"\n    } else if (!params.threadfqdump) {\n        \"\"\"\n        echo ${prefix}\n        fastq-dump ${reads} --gzip\n        \"\"\"\n    } else if (!params.singleEnd) {\n         \"\"\"\n        export PATH=~/.local/bin:$PATH\n        parallel-fastq-dump \\\n            --threads 8 \\\n            --gzip \\\n            --split-3 \\\n            --sra-id ${reads}\n        \"\"\"\n    } else {\n        \"\"\"\n        export PATH=~/.local/bin:$PATH\n        parallel-fastq-dump \\\n            --threads 8 \\\n            --gzip \\\n            --sra-id ${reads}\n        \"\"\"\n    }\n}",
        "nb_lignes_process": 48,
        "string_script": "    prefix = reads.baseName\n    if (!params.threadfqdump && !params.singleEnd) {\n        \"\"\"\n        echo ${prefix}\n        fastq-dump --split-3 ${reads} --gzip\n        \"\"\"\n    } else if (!params.threadfqdump) {\n        \"\"\"\n        echo ${prefix}\n        fastq-dump ${reads} --gzip\n        \"\"\"\n    } else if (!params.singleEnd) {\n         \"\"\"\n        export PATH=~/.local/bin:$PATH\n        parallel-fastq-dump \\\n            --threads 8 \\\n            --gzip \\\n            --split-3 \\\n            --sra-id ${reads}\n        \"\"\"\n    } else {\n        \"\"\"\n        export PATH=~/.local/bin:$PATH\n        parallel-fastq-dump \\\n            --threads 8 \\\n            --gzip \\\n            --sra-id ${reads}\n        \"\"\"\n    }",
        "nb_lignes_script": 28,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "read_files_sra"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_reads_qc_sra",
            "fastq_reads_trim_sra",
            "fastq_reads_hisat2_notrim_sra"
        ],
        "nb_outputs": 3,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$prefix\" if (params.threadfqdump) { cpus 8 } else { cpus 1 } if (params.savefq || params.saveAllfq) { publishDir \"${params.outdir}/fastq\", mode: 'copy' }"
        ],
        "when": "",
        "stub": ""
    },
    "fastQC": {
        "name_process": "fastQC",
        "string_process": "\nprocess fastQC {\n    validExitStatus 0,1\n    tag \"$prefix\"\n    memory '8 GB'\n    publishDir \"${params.outdir}\" , mode: 'copy',\n    saveAs: {filename ->\n             if (filename.indexOf(\"zip\") > 0)     \"qc/fastqc/zips/$filename\"\n        else if (filename.indexOf(\"html\") > 0)    \"qc/fastqc/$filename\"\n        else if (filename.indexOf(\"txt\") > 0)     \"qc/fastqc_stats/$filename\"\n        else null            \n    }\n    \n    when:\n    !params.skipFastQC && !params.skipAllQC\n\n    input:\n    set val(prefix), file(reads) from fastq_reads_qc.mix(fastq_reads_qc_sra)\n\n    output:\n    file \"*.{zip,html}\" into fastqc_results\n    file \"*.fastqc_stats.txt\" into fastqc_stats\n\n    script:\n    \"\"\"\n    echo ${prefix}\n    fastqc $reads\n    \n    ${params.extract_fastqc_stats} \\\n        --srr=${prefix} \\\n        > ${prefix}.fastqc_stats.txt    \n    \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "    \"\"\"\n    echo ${prefix}\n    fastqc $reads\n    \n    ${params.extract_fastqc_stats} \\\n        --srr=${prefix} \\\n        > ${prefix}.fastqc_stats.txt    \n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "fastq_reads_qc",
            "fastq_reads_qc_sra"
        ],
        "nb_inputs": 2,
        "outputs": [
            "fastqc_results",
            "fastqc_stats"
        ],
        "nb_outputs": 2,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0,1",
            "tag \"$prefix\"",
            "memory '8 GB'",
            "publishDir \"${params.outdir}\" , mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"zip\") > 0) \"qc/fastqc/zips/$filename\" else if (filename.indexOf(\"html\") > 0) \"qc/fastqc/$filename\" else if (filename.indexOf(\"txt\") > 0) \"qc/fastqc_stats/$filename\" else null }"
        ],
        "when": "!params.skipFastQC && !params.skipAllQC",
        "stub": ""
    },
    "bbduk_hisat2": {
        "name_process": "bbduk_hisat2",
        "string_process": "\nprocess bbduk_hisat2 {\n    validExitStatus 0\n    tag \"$name\"\n    cpus 32\n    time '2h'\n    memory '40 GB'\n    publishDir \"${params.outdir}/qc/trimstats\", mode: 'copy', pattern: \"*.{refstats,trimstats}.txt\"\n    publishDir \"${params.outdir}/qc/hisat2_mapstats\", mode: 'copy', pattern: \"*hisat2_mapstats.txt\"    \n    if (params.saveTrim || params.saveAllfq) {\n        publishDir \"${params.outdir}/fastq_trimmed\", mode: 'copy', pattern: \"*.fastq.gz\"\n    }\n    \n    when:\n    !params.noTrim\n\n    input:\n    file(indices) from hisat2_indices\n    val(indices_path) from hisat2_indices        \n    set val(name), file(reads) from fastq_reads_trim.mix(fastq_reads_trim_sra)\n\n    output:\n    set val(name), file(\"*.trim.fastq.gz\") into trimmed_reads_fastqc\n    file \"*.{refstats,trimstats}.txt\" into trim_stats\n    set val(name), file(\"*.sam\") into hisat2_sam\n    file(\"*hisat2_mapstats.txt\") into hisat2_mapstats       \n\n    script:\n    prefix_pe = reads[0].toString() - ~/(_1\\.)?(_R1)?(\\.fq)?(fq)?(\\.fastq)?(fastq)?(\\.gz)?$/\n    prefix_se = reads[0].toString() - ~/(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \n    def rnastrandness = ''\n    if (params.forwardStranded && !params.unStranded){\n        rnastrandness = params.singleEnd ? '--rna-strandness F' : '--rna-strandness FR'\n    } else if (params.reverseStranded && !params.unStranded){\n        rnastrandness = params.singleEnd ? '--rna-strandness R' : '--rna-strandness RF'\n    }\n    \n    if (!params.singleEnd && params.flip) {\n        \"\"\"\n        echo ${name}         \n                \n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads[0]} \\\n                  in2=${reads[1]} \\\n                  out=${prefix_pe}_1.trim.fastq.gz \\\n                  out2=${prefix_pe}_2.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  tpe tbo \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_pe}.trimstats.txt \\\n                  refstats=${prefix_pe}.refstats.txt\n\n        reformat.sh -Xmx40g \\\n                t=32 \\\n                in=${prefix_pe}_1.trim.fastq.gz \\\n                in2=${prefix_pe}_2.trim.fastq.gz \\\n                out=${prefix_pe}_1.flip.trim.fastq.gz \\\n                out2=${prefix_pe}_2.flip.trim.fastq.gz \\\n                rcomp=t\n          \n        hisat2 -p 32 \\\n               --very-sensitive \\\n               --no-spliced-alignment \\\n               -x ${indices_path} \\\n               -1 ${prefix_pe}_1.flip.trim.fastq.gz \\\n               -2 ${prefix_pe}_2.flip.trim.fastq.gz \\\n               ${rnastrandness} \\\n               --new-summary \\\n               > ${prefix_pe}.sam \\\n               2> ${prefix_pe}.hisat2_mapstats.txt                  \n        \"\"\"\n    } else if (params.singleEnd && params.flip) {\n        \"\"\"\n        echo ${name}        \n        \n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads} \\\n                  out=${prefix_se}.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_se}.trimstats.txt \\\n                  refstats=${prefix_se}.refstats.txt\n                  \n        reformat.sh -Xmx40g \\\n                t=32 \\\n                in=${prefix_se}.trim.fastq.gz \\\n                out=${prefix_se}.flip.trim.fastq.gz \\\n                rcomp=t\n\n        hisat2  -p 32 \\\n                --very-sensitive \\\n                --no-spliced-alignment \\\n                -x ${indices_path}\\\n                -U ${prefix_se}.flip.trim.fastq.gz  \\\n                ${rnastrandness} \\\n                --new-summary \\\n                > ${prefix_se}.sam \\\n                2> ${prefix_se}.hisat2_mapstats.txt                  \n        \"\"\"\n    } else if (!params.singleEnd && params.flipR2) {\n                \"\"\"\n        echo ${prefix_pe}\n\n        bbduk.sh -Xmx40g \\\n                t=32 \\\n                in=${reads[0]} \\\n                in2=${reads[1]} \\\n                out=${prefix_pe}_1.trim.fastq.gz \\\n                out2=${prefix_pe}_2.trim.fastq.gz \\\n                ref=${bbmap_adapters} \\\n                ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                nullifybrokenquality=t \\\n                maq=10 minlen=25 \\\n                tpe tbo \\\n                literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                stats=${prefix_pe}.trimstats.txt \\\n                refstats=${prefix_pe}.refstats.txt\n                \n        reformat.sh -Xmx40g \\\n                t=32 \\\n                in=${prefix_pe}_1.trim.fastq.gz \\\n                in2=${prefix_pe}_2.trim.fastq.gz \\\n                out=${prefix_pe}_1.flip.trim.fastq.gz \\\n                out2=${prefix_pe}_2.flip.trim.fastq.gz \\\n                rcompmate=t\n\n        hisat2 -p 32 \\\n               --very-sensitive \\\n               --no-spliced-alignment \\\n               -x ${indices_path} \\\n               -1 ${prefix_pe}_1.flip.trim.fastq.gz \\\n               -2 ${prefix_pe}_2.flip.trim.fastq.gz \\\n               ${rnastrandness} \\\n               --new-summary \\\n               > ${prefix_pe}.sam \\\n               2> ${prefix_pe}.hisat2_mapstats.txt                   \n        \"\"\"\n    } else if (!params.singleEnd) {\n        \"\"\"\n        echo ${prefix_pe}\n\n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads[0]} \\\n                  in2=${reads[1]} \\\n                  out=${prefix_pe}_1.trim.fastq.gz \\\n                  out2=${prefix_pe}_2.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  tpe tbo \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_pe}.trimstats.txt \\\n                  refstats=${prefix_pe}.refstats.txt\n                  \n        hisat2 -p 32 \\\n               --very-sensitive \\\n               --no-spliced-alignment \\\n               -x ${indices_path} \\\n               -1 ${prefix_pe}_1.trim.fastq.gz \\\n               -2 ${prefix_pe}_2.trim.fastq.gz \\\n               ${rnastrandness} \\\n               --new-summary \\\n               > ${prefix_pe}.sam \\\n               2> ${prefix_pe}.hisat2_mapstats.txt                          \n        \"\"\"\n    } else {\n        \"\"\"\n        echo ${prefix_se}\n\n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads} \\\n                  out=${prefix_se}.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_se}.trimstats.txt \\\n                  refstats=${prefix_se}.refstats.txt\n                  \n        hisat2  -p 32 \\\n                --very-sensitive \\\n                --no-spliced-alignment \\\n                -x ${indices_path}\\\n                -U ${prefix_se}.trim.fastq.gz \\\n                ${rnastrandness} \\\n                --new-summary \\\n                > ${prefix_se}.sam \\\n                2> ${prefix_se}.hisat2_mapstats.txt                  \n        \"\"\"\n    } \n}",
        "nb_lignes_process": 198,
        "string_script": "    prefix_pe = reads[0].toString() - ~/(_1\\.)?(_R1)?(\\.fq)?(fq)?(\\.fastq)?(fastq)?(\\.gz)?$/\n    prefix_se = reads[0].toString() - ~/(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \n    def rnastrandness = ''\n    if (params.forwardStranded && !params.unStranded){\n        rnastrandness = params.singleEnd ? '--rna-strandness F' : '--rna-strandness FR'\n    } else if (params.reverseStranded && !params.unStranded){\n        rnastrandness = params.singleEnd ? '--rna-strandness R' : '--rna-strandness RF'\n    }\n    \n    if (!params.singleEnd && params.flip) {\n        \"\"\"\n        echo ${name}         \n                \n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads[0]} \\\n                  in2=${reads[1]} \\\n                  out=${prefix_pe}_1.trim.fastq.gz \\\n                  out2=${prefix_pe}_2.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  tpe tbo \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_pe}.trimstats.txt \\\n                  refstats=${prefix_pe}.refstats.txt\n\n        reformat.sh -Xmx40g \\\n                t=32 \\\n                in=${prefix_pe}_1.trim.fastq.gz \\\n                in2=${prefix_pe}_2.trim.fastq.gz \\\n                out=${prefix_pe}_1.flip.trim.fastq.gz \\\n                out2=${prefix_pe}_2.flip.trim.fastq.gz \\\n                rcomp=t\n          \n        hisat2 -p 32 \\\n               --very-sensitive \\\n               --no-spliced-alignment \\\n               -x ${indices_path} \\\n               -1 ${prefix_pe}_1.flip.trim.fastq.gz \\\n               -2 ${prefix_pe}_2.flip.trim.fastq.gz \\\n               ${rnastrandness} \\\n               --new-summary \\\n               > ${prefix_pe}.sam \\\n               2> ${prefix_pe}.hisat2_mapstats.txt                  \n        \"\"\"\n    } else if (params.singleEnd && params.flip) {\n        \"\"\"\n        echo ${name}        \n        \n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads} \\\n                  out=${prefix_se}.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_se}.trimstats.txt \\\n                  refstats=${prefix_se}.refstats.txt\n                  \n        reformat.sh -Xmx40g \\\n                t=32 \\\n                in=${prefix_se}.trim.fastq.gz \\\n                out=${prefix_se}.flip.trim.fastq.gz \\\n                rcomp=t\n\n        hisat2  -p 32 \\\n                --very-sensitive \\\n                --no-spliced-alignment \\\n                -x ${indices_path}\\\n                -U ${prefix_se}.flip.trim.fastq.gz  \\\n                ${rnastrandness} \\\n                --new-summary \\\n                > ${prefix_se}.sam \\\n                2> ${prefix_se}.hisat2_mapstats.txt                  \n        \"\"\"\n    } else if (!params.singleEnd && params.flipR2) {\n                \"\"\"\n        echo ${prefix_pe}\n\n        bbduk.sh -Xmx40g \\\n                t=32 \\\n                in=${reads[0]} \\\n                in2=${reads[1]} \\\n                out=${prefix_pe}_1.trim.fastq.gz \\\n                out2=${prefix_pe}_2.trim.fastq.gz \\\n                ref=${bbmap_adapters} \\\n                ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                nullifybrokenquality=t \\\n                maq=10 minlen=25 \\\n                tpe tbo \\\n                literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                stats=${prefix_pe}.trimstats.txt \\\n                refstats=${prefix_pe}.refstats.txt\n                \n        reformat.sh -Xmx40g \\\n                t=32 \\\n                in=${prefix_pe}_1.trim.fastq.gz \\\n                in2=${prefix_pe}_2.trim.fastq.gz \\\n                out=${prefix_pe}_1.flip.trim.fastq.gz \\\n                out2=${prefix_pe}_2.flip.trim.fastq.gz \\\n                rcompmate=t\n\n        hisat2 -p 32 \\\n               --very-sensitive \\\n               --no-spliced-alignment \\\n               -x ${indices_path} \\\n               -1 ${prefix_pe}_1.flip.trim.fastq.gz \\\n               -2 ${prefix_pe}_2.flip.trim.fastq.gz \\\n               ${rnastrandness} \\\n               --new-summary \\\n               > ${prefix_pe}.sam \\\n               2> ${prefix_pe}.hisat2_mapstats.txt                   \n        \"\"\"\n    } else if (!params.singleEnd) {\n        \"\"\"\n        echo ${prefix_pe}\n\n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads[0]} \\\n                  in2=${reads[1]} \\\n                  out=${prefix_pe}_1.trim.fastq.gz \\\n                  out2=${prefix_pe}_2.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  tpe tbo \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_pe}.trimstats.txt \\\n                  refstats=${prefix_pe}.refstats.txt\n                  \n        hisat2 -p 32 \\\n               --very-sensitive \\\n               --no-spliced-alignment \\\n               -x ${indices_path} \\\n               -1 ${prefix_pe}_1.trim.fastq.gz \\\n               -2 ${prefix_pe}_2.trim.fastq.gz \\\n               ${rnastrandness} \\\n               --new-summary \\\n               > ${prefix_pe}.sam \\\n               2> ${prefix_pe}.hisat2_mapstats.txt                          \n        \"\"\"\n    } else {\n        \"\"\"\n        echo ${prefix_se}\n\n        bbduk.sh -Xmx40g \\\n                  t=32 \\\n                  in=${reads} \\\n                  out=${prefix_se}.trim.fastq.gz \\\n                  ref=${bbmap_adapters} \\\n                  ktrim=r qtrim=rl trimq=10 k=23 mink=11 hdist=1 \\\n                  maq=10 minlen=25 \\\n                  literal=AAAAAAAAAAAAAAAAAAAAAAA \\\n                  stats=${prefix_se}.trimstats.txt \\\n                  refstats=${prefix_se}.refstats.txt\n                  \n        hisat2  -p 32 \\\n                --very-sensitive \\\n                --no-spliced-alignment \\\n                -x ${indices_path}\\\n                -U ${prefix_se}.trim.fastq.gz \\\n                ${rnastrandness} \\\n                --new-summary \\\n                > ${prefix_se}.sam \\\n                2> ${prefix_se}.hisat2_mapstats.txt                  \n        \"\"\"\n    }",
        "nb_lignes_script": 170,
        "language_script": "bash",
        "tools": [
            "TPES",
            "HISAT2"
        ],
        "tools_url": [
            "https://bio.tools/TPES",
            "https://bio.tools/hisat2"
        ],
        "tools_dico": [
            {
                "name": "TPES",
                "uri": "https://bio.tools/TPES",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Tumor Purity Estimation from SNVs.",
                "homepage": "https://bitbucket.org/l0ka/tpes.git"
            },
            {
                "name": "HISAT2",
                "uri": "https://bio.tools/hisat2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Alignment program for mapping next-generation sequencing reads (both DNA and RNA) to a population of human genomes (as well as to a single reference genome).",
                "homepage": "https://ccb.jhu.edu/software/hisat2/index.shtml"
            }
        ],
        "inputs": [
            "hisat2_indices",
            "hisat2_indices",
            "fastq_reads_trim",
            "fastq_reads_trim_sra"
        ],
        "nb_inputs": 4,
        "outputs": [
            "trimmed_reads_fastqc",
            "trim_stats",
            "hisat2_sam",
            "hisat2_mapstats"
        ],
        "nb_outputs": 4,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0",
            "tag \"$name\"",
            "cpus 32",
            "time '2h'",
            "memory '40 GB'",
            "publishDir \"${params.outdir}/qc/trimstats\", mode: 'copy', pattern: \"*.{refstats,trimstats}.txt\"",
            "publishDir \"${params.outdir}/qc/hisat2_mapstats\", mode: 'copy', pattern: \"*hisat2_mapstats.txt\" if (params.saveTrim || params.saveAllfq) { publishDir \"${params.outdir}/fastq_trimmed\", mode: 'copy', pattern: \"*.fastq.gz\" }"
        ],
        "when": "!params.noTrim",
        "stub": ""
    },
    "fastQC_trim": {
        "name_process": "fastQC_trim",
        "string_process": "\nprocess fastQC_trim {\n    validExitStatus 0,1\n    tag \"$name\"\n    memory '4 GB'\n    publishDir \"${params.outdir}\" , mode: 'copy',\n    saveAs: {filename ->\n             if (filename.indexOf(\"zip\") > 0)   \"qc/fastqc/zips/$filename\"\n        else if (filename.indexOf(\"html\") > 0)  \"qc/fastqc/$filename\"\n        else null            \n    }\n    \n    when:\n    !params.skipFastQC && !params.skipAllQC && !noTrim\n\n    input:\n    set val(name), file(trimmed_reads) from trimmed_reads_fastqc\n\n    output:\n    file \"*_fastqc.{zip,html}\" into trimmed_fastqc_results\n\n    script:\n    \"\"\"\n    echo ${name}\n    \n    fastqc ${trimmed_reads}\n    \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "    \"\"\"\n    echo ${name}\n    \n    fastqc ${trimmed_reads}\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "trimmed_reads_fastqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trimmed_fastqc_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0,1",
            "tag \"$name\"",
            "memory '4 GB'",
            "publishDir \"${params.outdir}\" , mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"zip\") > 0) \"qc/fastqc/zips/$filename\" else if (filename.indexOf(\"html\") > 0) \"qc/fastqc/$filename\" else null }"
        ],
        "when": "!params.skipFastQC && !params.skipAllQC && !noTrim",
        "stub": ""
    },
    "hisat2": {
        "name_process": "hisat2",
        "string_process": " process hisat2 {\n        tag \"$name\"\n        validExitStatus 0\n        cpus 32\n        memory '40 GB'\n        time '2h'\n        publishDir \"${params.outdir}/qc/hisat2_mapstats\", mode: 'copy', pattern: \"*.txt\"\n    \n        input:\n        file(indices) from hisat2_indices\n        val(indices_path) from hisat2_indices\n        set val(name), file(reads) from fastq_reads_hisat2_notrim_sra.mix(fastq_reads_hisat2_notrim)\n    \n        output:\n        set val(name), file(\"*.sam\") into hisat2_sam\n        file(\"*.txt\") into hisat2_mapstats\n    \n        script:\n        prefix_pe = trimmed_reads[0].toString() - ~/(_1\\.)?(_R1)?(flip)?(trim)?(\\.flip)?(\\.fq)?(fq)?(\\.fastq)?(fastq)?(\\.gz)?$/\n        prefix_se = trimmed_reads[0].toString() - ~/(\\.flip)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n        \n        def rnastrandness = ''\n        if (params.forwardStranded && !params.unStranded){\n            rnastrandness = params.singleEnd ? '--rna-strandness F' : '--rna-strandness FR'\n        } else if (params.reverseStranded && !params.unStranded){\n            rnastrandness = params.singleEnd ? '--rna-strandness R' : '--rna-strandness RF'\n        }\n        \n        if (!params.singleEnd) {\n            \"\"\"\n            echo ${prefix_pe}\n        \n            hisat2 -p 32 \\\n                   --very-sensitive \\\n                   --no-spliced-alignment \\\n                    $rnastrandness \\\n                   -x ${indices_path} \\\n                   -1 ${reads[0]} \\\n                   -2 ${reads[1]} \\\n                   --new-summary \\\n                   > ${prefix_pe}.sam \\\n                   2> ${prefix_pe}.hisat2_mapstats.txt                \n            \"\"\"\n        }\n        else {\n            \"\"\"\n            echo ${prefix_se}\n        \n            hisat2  -p 32 \\\n                    --very-sensitive \\\n                    --no-spliced-alignment \\\n                    $rnastrandness \\\n                    -x ${indices_path} \\\n                    -U ${reads} \\\n                    --new-summary \\\n                    > ${prefix_se}.sam \\\n                    2> ${prefix_se}.hisat2_mapstats.txt                \n            \"\"\"\n        }\n    }",
        "nb_lignes_process": 58,
        "string_script": "        prefix_pe = trimmed_reads[0].toString() - ~/(_1\\.)?(_R1)?(flip)?(trim)?(\\.flip)?(\\.fq)?(fq)?(\\.fastq)?(fastq)?(\\.gz)?$/\n        prefix_se = trimmed_reads[0].toString() - ~/(\\.flip)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n        \n        def rnastrandness = ''\n        if (params.forwardStranded && !params.unStranded){\n            rnastrandness = params.singleEnd ? '--rna-strandness F' : '--rna-strandness FR'\n        } else if (params.reverseStranded && !params.unStranded){\n            rnastrandness = params.singleEnd ? '--rna-strandness R' : '--rna-strandness RF'\n        }\n        \n        if (!params.singleEnd) {\n            \"\"\"\n            echo ${prefix_pe}\n        \n            hisat2 -p 32 \\\n                   --very-sensitive \\\n                   --no-spliced-alignment \\\n                    $rnastrandness \\\n                   -x ${indices_path} \\\n                   -1 ${reads[0]} \\\n                   -2 ${reads[1]} \\\n                   --new-summary \\\n                   > ${prefix_pe}.sam \\\n                   2> ${prefix_pe}.hisat2_mapstats.txt                \n            \"\"\"\n        }\n        else {\n            \"\"\"\n            echo ${prefix_se}\n        \n            hisat2  -p 32 \\\n                    --very-sensitive \\\n                    --no-spliced-alignment \\\n                    $rnastrandness \\\n                    -x ${indices_path} \\\n                    -U ${reads} \\\n                    --new-summary \\\n                    > ${prefix_se}.sam \\\n                    2> ${prefix_se}.hisat2_mapstats.txt                \n            \"\"\"\n        }",
        "nb_lignes_script": 40,
        "language_script": "bash",
        "tools": [
            "HISAT2"
        ],
        "tools_url": [
            "https://bio.tools/hisat2"
        ],
        "tools_dico": [
            {
                "name": "HISAT2",
                "uri": "https://bio.tools/hisat2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Alignment program for mapping next-generation sequencing reads (both DNA and RNA) to a population of human genomes (as well as to a single reference genome).",
                "homepage": "https://ccb.jhu.edu/software/hisat2/index.shtml"
            }
        ],
        "inputs": [
            "hisat2_indices",
            "hisat2_indices",
            "fastq_reads_hisat2_notrim_sra",
            "fastq_reads_hisat2_notrim"
        ],
        "nb_inputs": 4,
        "outputs": [
            "hisat2_sam",
            "hisat2_mapstats"
        ],
        "nb_outputs": 2,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "validExitStatus 0",
            "cpus 32",
            "memory '40 GB'",
            "time '2h'",
            "publishDir \"${params.outdir}/qc/hisat2_mapstats\", mode: 'copy', pattern: \"*.txt\""
        ],
        "when": "",
        "stub": ""
    },
    "samtools": {
        "name_process": "samtools",
        "string_process": "\nprocess samtools {\n    tag \"$name\"\n    memory '60 GB'\n    cpus 16\n    publishDir \"${params.outdir}\" , mode: 'copy',\n    saveAs: {filename ->\n             if ((filename.indexOf(\"sorted.bam\") > 0) & params.saveBAM)     \"mapped/bams/$filename\"\n        else if ((filename.indexOf(\"sorted.bam.bai\") > 0) & params.saveBAM) \"mapped/bams/$filename\"\n        else if (filename.indexOf(\"flagstat\") > 0)                          \"qc/mapstats/$filename\"\n        else if (filename.indexOf(\"millionsmapped\") > 0)                    \"qc/mapstats/$filename\"\n        else if (filename.indexOf(\"sorted.cram\") > 0)                       \"mapped/crams/$filename\"\n        else if (filename.indexOf(\"sorted.cram.crai\") > 0)                  \"mapped/crams/$filename\"\n        else null            \n    }\n\n    input:\n    set val(name), file(mapped_sam) from hisat2_sam\n\n    output:\n    set val(name), file(\"${name}.sorted.bam\") into sorted_bam_ch\n    set val(name), file(\"${name}.sorted.bam.bai\") into sorted_bam_indices_ch\n    set val(name), file(\"${name}.flagstat\") into bam_flagstat\n    set val(name), file(\"${name}.millionsmapped\") into bam_milmapped_bedgraph\n    set val(name), file(\"${name}.sorted.cram\") into cram_ch\n    set val(name), file(\"${name}.sorted.cram.crai\") into cram_index_ch\n\n    script:\n    \"\"\"\n    samtools view -@ 16 -bS -o ${name}.bam ${mapped_sam}\n    samtools sort -@ 16 ${name}.bam > ${name}.sorted.bam\n    samtools flagstat ${name}.sorted.bam > ${name}.flagstat\n    samtools view -@ 16 -F 0x904 -c ${name}.sorted.bam > ${name}.millionsmapped\n    samtools index ${name}.sorted.bam ${name}.sorted.bam.bai\n    samtools view -@ 16 -C -T ${genome} -o ${name}.cram ${name}.sorted.bam\n    samtools sort -@ 16 -O cram ${name}.cram > ${name}.sorted.cram\n    samtools index -c ${name}.sorted.cram ${name}.sorted.cram.crai\n    \"\"\"\n}",
        "nb_lignes_process": 37,
        "string_script": "    \"\"\"\n    samtools view -@ 16 -bS -o ${name}.bam ${mapped_sam}\n    samtools sort -@ 16 ${name}.bam > ${name}.sorted.bam\n    samtools flagstat ${name}.sorted.bam > ${name}.flagstat\n    samtools view -@ 16 -F 0x904 -c ${name}.sorted.bam > ${name}.millionsmapped\n    samtools index ${name}.sorted.bam ${name}.sorted.bam.bai\n    samtools view -@ 16 -C -T ${genome} -o ${name}.cram ${name}.sorted.bam\n    samtools sort -@ 16 -O cram ${name}.cram > ${name}.sorted.cram\n    samtools index -c ${name}.sorted.cram ${name}.sorted.cram.crai\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "hisat2_sam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sorted_bam_ch",
            "sorted_bam_indices_ch",
            "bam_flagstat",
            "bam_milmapped_bedgraph",
            "cram_ch",
            "cram_index_ch"
        ],
        "nb_outputs": 6,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '60 GB'",
            "cpus 16",
            "publishDir \"${params.outdir}\" , mode: 'copy' , saveAs: {filename -> if ((filename.indexOf(\"sorted.bam\") > 0) & params.saveBAM) \"mapped/bams/$filename\" else if ((filename.indexOf(\"sorted.bam.bai\") > 0) & params.saveBAM) \"mapped/bams/$filename\" else if (filename.indexOf(\"flagstat\") > 0) \"qc/mapstats/$filename\" else if (filename.indexOf(\"millionsmapped\") > 0) \"qc/mapstats/$filename\" else if (filename.indexOf(\"sorted.cram\") > 0) \"mapped/crams/$filename\" else if (filename.indexOf(\"sorted.cram.crai\") > 0) \"mapped/crams/$filename\" else null }"
        ],
        "when": "",
        "stub": ""
    },
    "picard": {
        "name_process": "picard",
        "string_process": "\nprocess picard {\n    tag \"$name\"\n    memory '20 GB'\n    time '8h'\n    errorStrategy 'ignore'\n    publishDir \"${params.outdir}\" , mode: 'copy',\n    saveAs: {filename ->\n             if (filename.indexOf(\"marked_dup_metrics.txt\") > 0)            \"qc/picard/dups/$filename\"\n        else if (filename.indexOf(\"gc_bias_metrics.pdf\") > 0)               \"qc/picard/gc_bias/$filename\"\n        else if (filename.indexOf(\"gc_bias_metrics.txt\") > 0)               \"qc/picard/gc_bias/$filename\"\n        else if (filename.indexOf(\"summary_metrics.txt\") > 0)               \"qc/picard/gc_bias/$filename\"\n        else null            \n    }\n    \n    when:\n    !params.skippicard && !params.skipAllQC    \n\n    input:\n    set val(name), file(bam_file) from sorted_bams_for_picard\n    file(bam_indices) from sorted_bam_indices_for_picard\n\n    output:\n    file \"*.{txt,pdf}\" into picard_stats_multiqc, picard_stats_nqc\n    \n    script:\n    \"\"\"\n    java -jar -Xmx20g ${picard_path} MarkDuplicates \\\n         I=${bam_file} \\\n         O=${name}.marked_duplicates.bam \\\n         M=${name}.marked_dup_metrics.txt             \n         \n    java -jar -Xmx20g ${picard_path} CollectGcBiasMetrics \\\n          I=${bam_file} \\\n          O=${name}.gc_bias_metrics.txt \\\n          CHART=${name}.gc_bias_metrics.pdf \\\n          S=${name}.summary_metrics.txt \\\n          R=${genome}    \n    \"\"\"\n}",
        "nb_lignes_process": 38,
        "string_script": "    \"\"\"\n    java -jar -Xmx20g ${picard_path} MarkDuplicates \\\n         I=${bam_file} \\\n         O=${name}.marked_duplicates.bam \\\n         M=${name}.marked_dup_metrics.txt             \n         \n    java -jar -Xmx20g ${picard_path} CollectGcBiasMetrics \\\n          I=${bam_file} \\\n          O=${name}.gc_bias_metrics.txt \\\n          CHART=${name}.gc_bias_metrics.pdf \\\n          S=${name}.summary_metrics.txt \\\n          R=${genome}    \n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sorted_bams_for_picard",
            "sorted_bam_indices_for_picard"
        ],
        "nb_inputs": 2,
        "outputs": [
            "picard_stats_multiqc",
            "picard_stats_nqc"
        ],
        "nb_outputs": 2,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '20 GB'",
            "time '8h'",
            "errorStrategy 'ignore'",
            "publishDir \"${params.outdir}\" , mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"marked_dup_metrics.txt\") > 0) \"qc/picard/dups/$filename\" else if (filename.indexOf(\"gc_bias_metrics.pdf\") > 0) \"qc/picard/gc_bias/$filename\" else if (filename.indexOf(\"gc_bias_metrics.txt\") > 0) \"qc/picard/gc_bias/$filename\" else if (filename.indexOf(\"summary_metrics.txt\") > 0) \"qc/picard/gc_bias/$filename\" else null }"
        ],
        "when": "!params.skippicard && !params.skipAllQC",
        "stub": ""
    },
    "preseq": {
        "name_process": "preseq",
        "string_process": "\nprocess preseq {\n    tag \"$name\"\n    memory '20 GB'\n    time '8h'\n    errorStrategy 'ignore'\n    publishDir \"${params.outdir}/qc/preseq/\", mode: 'copy', pattern: \"*.txt\"\n    \n    when:\n    !params.skippreseq && !params.skipAllQC    \n\n    input:\n    set val(name), file(bam_file) from sorted_bams_for_preseq\n    file(bam_indices) from sorted_bam_indices_for_preseq\n\n    output:\n    file(\"*.txt\") into preseq_results\n\n    script:\n    \"\"\"\n    preseq c_curve -B -o ${name}.c_curve.txt \\\n           ${bam_file}\n    preseq lc_extrap -B -o ${name}.lc_extrap.txt \\\n           ${bam_file}\n    \"\"\"\n }",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    preseq c_curve -B -o ${name}.c_curve.txt \\\n           ${bam_file}\n    preseq lc_extrap -B -o ${name}.lc_extrap.txt \\\n           ${bam_file}\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "preseq"
        ],
        "tools_url": [
            "https://bio.tools/preseq"
        ],
        "tools_dico": [
            {
                "name": "preseq",
                "uri": "https://bio.tools/preseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2423",
                                    "term": "Prediction and recognition"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package is aimed at predicting and number of distinct reads and how many will be expected from additional sequencing using an initial sequencing experiment. The estimates can then be used to examine the utility of further sequencing, optimize the sequencing depth, or to screen multiple libraries to avoid low complexity samples.",
                "homepage": "http://smithlabresearch.org/software/preseq/"
            }
        ],
        "inputs": [
            "sorted_bams_for_preseq",
            "sorted_bam_indices_for_preseq"
        ],
        "nb_inputs": 2,
        "outputs": [
            "preseq_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '20 GB'",
            "time '8h'",
            "errorStrategy 'ignore'",
            "publishDir \"${params.outdir}/qc/preseq/\", mode: 'copy', pattern: \"*.txt\""
        ],
        "when": "!params.skippreseq && !params.skipAllQC",
        "stub": ""
    },
    "rseqc": {
        "name_process": "rseqc",
        "string_process": "\nprocess rseqc {\n    tag \"$name\"\n    time '8h'\n    validExitStatus 0,1,143\n    memory '40 GB'\n    publishDir \"${params.outdir}/qc/rseqc\" , mode: 'copy',\n        saveAs: {filename ->\n                 if (filename.indexOf(\"infer_experiment.txt\") > 0)              \"infer_experiment/$filename\"\n            else if (filename.indexOf(\"read_distribution.txt\") > 0)             \"read_distribution/$filename\"\n            else if (filename.indexOf(\"read_duplication.DupRate_plot.pdf\") > 0) \"read_duplication/$filename\"\n            else if (filename.indexOf(\"read_duplication.DupRate_plot.r\") > 0)   \"read_duplication/rscripts/$filename\"\n            else if (filename.indexOf(\"read_duplication.pos.DupRate.xls\") > 0)  \"read_duplication/dup_pos/$filename\"\n            else if (filename.indexOf(\"read_duplication.seq.DupRate.xls\") > 0)  \"read_duplication/dup_seq/$filename\"\n            else if (filename.indexOf(\"RPKM_saturation.eRPKM.xls\") > 0)         \"RPKM_saturation/rpkm/$filename\"\n            else if (filename.indexOf(\"RPKM_saturation.rawCount.xls\") > 0)      \"RPKM_saturation/counts/$filename\"\n            else if (filename.indexOf(\"RPKM_saturation.saturation.pdf\") > 0)    \"RPKM_saturation/$filename\"\n            else if (filename.indexOf(\"RPKM_saturation.saturation.r\") > 0)      \"RPKM_saturation/rscripts/$filename\"\n            else null\n        }\n    \n    when:\n    !params.skipRSeQC && !params.skipAllQC\n\n    input:\n    set val(name), file(bam_file) from sorted_bams_for_rseqc\n    file(bam_indices) from sorted_bam_indices_for_rseqc\n\n    output:\n    file \"*.{txt,pdf,r,xls}\" into rseqc_results\n\n    script:\n    \"\"\"\n    read_distribution.py -i ${bam_file} \\\n                         -r ${genome_refseq} \\\n                         > ${name}.read_distribution.txt\n    read_duplication.py -i ${bam_file} \\\n                        -o ${name}.read_duplication\n    infer_experiment.py -i ${bam_file} \\\n                        -r ${genome_refseq} \\\n                        > ${name}.infer_experiment.txt\n    \"\"\"\n }",
        "nb_lignes_process": 41,
        "string_script": "    \"\"\"\n    read_distribution.py -i ${bam_file} \\\n                         -r ${genome_refseq} \\\n                         > ${name}.read_distribution.txt\n    read_duplication.py -i ${bam_file} \\\n                        -o ${name}.read_duplication\n    infer_experiment.py -i ${bam_file} \\\n                        -r ${genome_refseq} \\\n                        > ${name}.infer_experiment.txt\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sorted_bams_for_rseqc",
            "sorted_bam_indices_for_rseqc"
        ],
        "nb_inputs": 2,
        "outputs": [
            "rseqc_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "time '8h'",
            "validExitStatus 0,1,143",
            "memory '40 GB'",
            "publishDir \"${params.outdir}/qc/rseqc\" , mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"infer_experiment.txt\") > 0) \"infer_experiment/$filename\" else if (filename.indexOf(\"read_distribution.txt\") > 0) \"read_distribution/$filename\" else if (filename.indexOf(\"read_duplication.DupRate_plot.pdf\") > 0) \"read_duplication/$filename\" else if (filename.indexOf(\"read_duplication.DupRate_plot.r\") > 0) \"read_duplication/rscripts/$filename\" else if (filename.indexOf(\"read_duplication.pos.DupRate.xls\") > 0) \"read_duplication/dup_pos/$filename\" else if (filename.indexOf(\"read_duplication.seq.DupRate.xls\") > 0) \"read_duplication/dup_seq/$filename\" else if (filename.indexOf(\"RPKM_saturation.eRPKM.xls\") > 0) \"RPKM_saturation/rpkm/$filename\" else if (filename.indexOf(\"RPKM_saturation.rawCount.xls\") > 0) \"RPKM_saturation/counts/$filename\" else if (filename.indexOf(\"RPKM_saturation.saturation.pdf\") > 0) \"RPKM_saturation/$filename\" else if (filename.indexOf(\"RPKM_saturation.saturation.r\") > 0) \"RPKM_saturation/rscripts/$filename\" else null }"
        ],
        "when": "!params.skipRSeQC && !params.skipAllQC",
        "stub": ""
    },
    "pileup": {
        "name_process": "pileup",
        "string_process": "\nprocess pileup {\n    tag \"$name\"\n    memory '40 GB'\n    publishDir \"${params.outdir}/qc/pileup\", mode: 'copy', pattern: \"*.txt\"\n    \n    when:\n    !params.skippileup && !params.skipAllQC    \n\n    input:\n    set val(name), file(bam_file) from sorted_bams_for_pileup\n    file(bam_indices) from sorted_bam_indicies_for_pileup\n\n    output:\n    file(\"*.txt\") into pileup_results\n\n    script:\n    \"\"\"\n    pileup.sh -Xmx40g \\\n              in=${bam_file} \\\n              out=${name}.coverage.stats.txt \\\n              hist=${name}.coverage.hist.txt\n    \"\"\"\n }",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    pileup.sh -Xmx40g \\\n              in=${bam_file} \\\n              out=${name}.coverage.stats.txt \\\n              hist=${name}.coverage.hist.txt\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sorted_bams_for_pileup",
            "sorted_bam_indicies_for_pileup"
        ],
        "nb_inputs": 2,
        "outputs": [
            "pileup_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '40 GB'",
            "publishDir \"${params.outdir}/qc/pileup\", mode: 'copy', pattern: \"*.txt\""
        ],
        "when": "!params.skippileup && !params.skipAllQC",
        "stub": ""
    },
    "bedgraphs": {
        "name_process": "bedgraphs",
        "string_process": "\nprocess bedgraphs {\n    validExitStatus 0,143\n    tag \"$name\"\n    memory '40 GB'\n    time '4h'\n    publishDir \"${params.outdir}/mapped/bedgraphs\", mode: 'copy', pattern: \"${name}.bedGraph\"      \n\n    input:\n    set val(name), file(bam_file) from sorted_bam_for_bedgraph\n    set val(name), file(bam_indices) from sorted_bam_index_for_bedgraph\n    set val(name), file(millions_mapped) from bam_milmapped_bedgraph\n\n    output:\n    set val(name), file(\"${name}.pos.bedGraph\") into pos_non_normalized_bedgraphs, pos_fstitch_bg\n    set val(name), file(\"${name}.neg.bedGraph\") into neg_non_normalized_bedgraphs, neg_fstitch_bg\n    set val(name), file(\"${name}.bedGraph\") into non_normalized_bedgraphs, fstitch_bg, tfit_bg, prelimtfit_bg, nqc_bg\n    set val(name), file(\"${name}.rcc.bedGraph\") into bedgraph_tdf\n    set val(name), file(\"${name}.pos.rcc.bedGraph\") into bedgraph_bigwig_pos\n    set val(name), file(\"${name}.neg.rcc.bedGraph\") into bedgraph_bigwig_neg\n\n    script:\n    if (params.singleEnd) {\n    \"\"\"    \n    genomeCoverageBed \\\n        -bg \\\n        -strand + \\\n        -g ${chrom_sizes} \\\n        -ibam ${bam_file} \\\n        > ${name}.pos.bedGraph\n    genomeCoverageBed \\\n        -bg \\\n        -strand - \\\n        -g ${chrom_sizes} \\\n        -ibam ${bam_file} \\\n        | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' \\\n        > ${name}.neg.bedGraph\n\n    cat ${name}.pos.bedGraph \\\n        ${name}.neg.bedGraph \\\n        > ${name}.unsorted.bedGraph\n        \n    sortBed \\\n        -i ${name}.unsorted.bedGraph \\\n        > ${name}.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.rcc.bedGraph\n        \n    python ${params.rcc} \\\n        ${name}.pos.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.pos.rcc.bedGraph\n    sortBed -i ${name}.unsorted.pos.rcc.bedGraph > ${name}.pos.rcc.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.neg.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.neg.rcc.bedGraph\n    sortBed -i ${name}.unsorted.neg.rcc.bedGraph > ${name}.neg.rcc.bedGraph\n    \"\"\"\n    } else {\n    \"\"\"   \n    samtools view \\\n        -h -b -f 0x0040 \\\n        ${bam_file} \\\n        > ${name}.first_pair.bam\n        \n    samtools view \\\n        -h -b -f 0x0080 \\\n        ${bam_file} \\\n        > ${name}.second_pair.bam\n        \n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand - \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.first_pair.bam \\\n        | sortBed \\\n        > ${name}.first_pair.pos.bedGraph\n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand + \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.first_pair.bam \\\n        | sortBed \\\n        | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' \\\n        > ${name}.first_pair.neg.bedGraph\n                     \n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand + \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.second_pair.bam \\\n        | sortBed \\\n        > ${name}.second_pair.pos.bedGraph\n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand - \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.second_pair.bam \\\n        | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' \\\n        | sortBed \\\n        > ${name}.second_pair.neg.bedGraph\n                     \n    unionBedGraphs \\\n        -i ${name}.first_pair.pos.bedGraph ${name}.second_pair.pos.bedGraph \\\n        | awk -F '\\t' {'print \\$1\"\\t\"\\$2\"\\t\"\\$3\"\\t\"(\\$4+\\$5)'} \\\n        > ${name}.pos.bedGraph \n        \n    unionBedGraphs \\\n        -i ${name}.first_pair.neg.bedGraph ${name}.second_pair.neg.bedGraph \\\n        | awk -F '\\t' {'print \\$1\"\\t\"\\$2\"\\t\"\\$3\"\\t\"(\\$4+\\$5)'} \\\n        > ${name}.neg.bedGraph \n    \n    cat ${name}.pos.bedGraph \\\n        ${name}.neg.bedGraph \\\n        > ${name}.unsorted.bedGraph\n        \n    sortBed \\\n        -i ${name}.unsorted.bedGraph \\\n        > ${name}.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.rcc.bedGraph\n        \n    python ${params.rcc} \\\n        ${name}.pos.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.pos.rcc.bedGraph\n    sortBed -i ${name}.unsorted.pos.rcc.bedGraph > ${name}.pos.rcc.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.neg.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.neg.rcc.bedGraph\n    sortBed -i ${name}.unsorted.neg.rcc.bedGraph > ${name}.neg.rcc.bedGraph     \n    \"\"\"\n    }\n }",
        "nb_lignes_process": 146,
        "string_script": "    if (params.singleEnd) {\n    \"\"\"    \n    genomeCoverageBed \\\n        -bg \\\n        -strand + \\\n        -g ${chrom_sizes} \\\n        -ibam ${bam_file} \\\n        > ${name}.pos.bedGraph\n    genomeCoverageBed \\\n        -bg \\\n        -strand - \\\n        -g ${chrom_sizes} \\\n        -ibam ${bam_file} \\\n        | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' \\\n        > ${name}.neg.bedGraph\n\n    cat ${name}.pos.bedGraph \\\n        ${name}.neg.bedGraph \\\n        > ${name}.unsorted.bedGraph\n        \n    sortBed \\\n        -i ${name}.unsorted.bedGraph \\\n        > ${name}.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.rcc.bedGraph\n        \n    python ${params.rcc} \\\n        ${name}.pos.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.pos.rcc.bedGraph\n    sortBed -i ${name}.unsorted.pos.rcc.bedGraph > ${name}.pos.rcc.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.neg.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.neg.rcc.bedGraph\n    sortBed -i ${name}.unsorted.neg.rcc.bedGraph > ${name}.neg.rcc.bedGraph\n    \"\"\"\n    } else {\n    \"\"\"   \n    samtools view \\\n        -h -b -f 0x0040 \\\n        ${bam_file} \\\n        > ${name}.first_pair.bam\n        \n    samtools view \\\n        -h -b -f 0x0080 \\\n        ${bam_file} \\\n        > ${name}.second_pair.bam\n        \n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand - \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.first_pair.bam \\\n        | sortBed \\\n        > ${name}.first_pair.pos.bedGraph\n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand + \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.first_pair.bam \\\n        | sortBed \\\n        | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' \\\n        > ${name}.first_pair.neg.bedGraph\n                     \n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand + \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.second_pair.bam \\\n        | sortBed \\\n        > ${name}.second_pair.pos.bedGraph\n    genomeCoverageBed \\\n        -bg \\\n        -split \\\n        -strand - \\\n        -g ${chrom_sizes} \\\n        -ibam ${name}.second_pair.bam \\\n        | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' \\\n        | sortBed \\\n        > ${name}.second_pair.neg.bedGraph\n                     \n    unionBedGraphs \\\n        -i ${name}.first_pair.pos.bedGraph ${name}.second_pair.pos.bedGraph \\\n        | awk -F '\\t' {'print \\$1\"\\t\"\\$2\"\\t\"\\$3\"\\t\"(\\$4+\\$5)'} \\\n        > ${name}.pos.bedGraph \n        \n    unionBedGraphs \\\n        -i ${name}.first_pair.neg.bedGraph ${name}.second_pair.neg.bedGraph \\\n        | awk -F '\\t' {'print \\$1\"\\t\"\\$2\"\\t\"\\$3\"\\t\"(\\$4+\\$5)'} \\\n        > ${name}.neg.bedGraph \n    \n    cat ${name}.pos.bedGraph \\\n        ${name}.neg.bedGraph \\\n        > ${name}.unsorted.bedGraph\n        \n    sortBed \\\n        -i ${name}.unsorted.bedGraph \\\n        > ${name}.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.rcc.bedGraph\n        \n    python ${params.rcc} \\\n        ${name}.pos.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.pos.rcc.bedGraph\n    sortBed -i ${name}.unsorted.pos.rcc.bedGraph > ${name}.pos.rcc.bedGraph\n\n    python ${params.rcc} \\\n        ${name}.neg.bedGraph \\\n        ${millions_mapped} \\\n        ${name}.unsorted.neg.rcc.bedGraph\n    sortBed -i ${name}.unsorted.neg.rcc.bedGraph > ${name}.neg.rcc.bedGraph     \n    \"\"\"\n    }",
        "nb_lignes_script": 124,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sorted_bam_for_bedgraph",
            "sorted_bam_index_for_bedgraph",
            "bam_milmapped_bedgraph"
        ],
        "nb_inputs": 3,
        "outputs": [
            "pos_non_normalized_bedgraphs",
            "pos_fstitch_bg",
            "neg_non_normalized_bedgraphs",
            "neg_fstitch_bg",
            "non_normalized_bedgraphs",
            "fstitch_bg",
            "tfit_bg",
            "prelimtfit_bg",
            "nqc_bg",
            "bedgraph_tdf",
            "bedgraph_bigwig_pos",
            "bedgraph_bigwig_neg"
        ],
        "nb_outputs": 12,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0,143",
            "tag \"$name\"",
            "memory '40 GB'",
            "time '4h'",
            "publishDir \"${params.outdir}/mapped/bedgraphs\", mode: 'copy', pattern: \"${name}.bedGraph\""
        ],
        "when": "",
        "stub": ""
    },
    "dreg_prep": {
        "name_process": "dreg_prep",
        "string_process": "\nprocess dreg_prep {\n    validExitStatus 0,143\n    errorStrategy 'ignore'\n    tag \"$name\"\n    memory '150 GB'\n    publishDir \"${params.outdir}/mapped/dreg_input\", mode: 'copy', pattern: \"*.bw\"\n    \n    when:\n    params.dreg\n\n    input:\n    set val(name), file(cram_file) from cram_dreg_prep\n    set val(name), file(cram_index) from cram_index_dreg_prep\n    file(chrom_sizes) from chrom_sizes\n\n    output:\n    set val(name), file(\"*.bw\") into dreg_bigwig\n\n    script:\n    \"\"\"\n    echo \"Creating BigWigs suitable as inputs to dREG\"\n    \n    export CRAM_REFERENCE=${genome}    \n    \n    bamToBed -i ${cram_file} | awk 'BEGIN{OFS=\"\\t\"} (\\$5 > 0){print \\$0}' | \\\n    awk 'BEGIN{OFS=\"\\t\"} (\\$6 == \"+\") {print \\$1,\\$2,\\$2+1,\\$4,\\$5,\\$6}; (\\$6 == \"-\") {print \\$1, \\$3-1,\\$3,\\$4,\\$5,\\$6}' \\\n    > ${name}.dreg.bed\n    sortBed -i ${name}.dreg.bed > ${name}.dreg.sort.bed\n    \n    echo positive strand processed to bedGraph\n    \n    bedtools genomecov \\\n            -bg \\\n            -i ${name}.dreg.sort.bed \\\n            -g ${chrom_sizes} \\\n            -strand + \\\n            > ${name}.pos.bedGraph\n    sortBed \\\n            -i ${name}.pos.bedGraph \\\n            > ${name}.pos.sort.bedGraph\n            \n    bedtools genomecov \\\n            -bg \\\n            -i ${name}.dreg.sort.bed \\\n            -g ${chrom_sizes} \\\n            -strand - \\\n            | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' > ${name}.neg.bedGraph\n    sortBed \\\n            -i ${name}.neg.bedGraph \\\n            > ${name}.neg.sort.bedGraph\n            \n    echo negative strand processed to bedGraph\n    \n    ${params.bedGraphToBigWig} ${name}.pos.sort.bedGraph ${chrom_sizes} ${name}.pos.bw\n    ${params.bedGraphToBigWig} ${name}.neg.sort.bedGraph ${chrom_sizes} ${name}.neg.bw\n    \n    echo bedGraph to bigwig done\n    \"\"\"\n }",
        "nb_lignes_process": 58,
        "string_script": "    \"\"\"\n    echo \"Creating BigWigs suitable as inputs to dREG\"\n    \n    export CRAM_REFERENCE=${genome}    \n    \n    bamToBed -i ${cram_file} | awk 'BEGIN{OFS=\"\\t\"} (\\$5 > 0){print \\$0}' | \\\n    awk 'BEGIN{OFS=\"\\t\"} (\\$6 == \"+\") {print \\$1,\\$2,\\$2+1,\\$4,\\$5,\\$6}; (\\$6 == \"-\") {print \\$1, \\$3-1,\\$3,\\$4,\\$5,\\$6}' \\\n    > ${name}.dreg.bed\n    sortBed -i ${name}.dreg.bed > ${name}.dreg.sort.bed\n    \n    echo positive strand processed to bedGraph\n    \n    bedtools genomecov \\\n            -bg \\\n            -i ${name}.dreg.sort.bed \\\n            -g ${chrom_sizes} \\\n            -strand + \\\n            > ${name}.pos.bedGraph\n    sortBed \\\n            -i ${name}.pos.bedGraph \\\n            > ${name}.pos.sort.bedGraph\n            \n    bedtools genomecov \\\n            -bg \\\n            -i ${name}.dreg.sort.bed \\\n            -g ${chrom_sizes} \\\n            -strand - \\\n            | awk 'BEGIN{FS=OFS=\"\\t\"} {\\$4=-\\$4}1' > ${name}.neg.bedGraph\n    sortBed \\\n            -i ${name}.neg.bedGraph \\\n            > ${name}.neg.sort.bedGraph\n            \n    echo negative strand processed to bedGraph\n    \n    ${params.bedGraphToBigWig} ${name}.pos.sort.bedGraph ${chrom_sizes} ${name}.pos.bw\n    ${params.bedGraphToBigWig} ${name}.neg.sort.bedGraph ${chrom_sizes} ${name}.neg.bw\n    \n    echo bedGraph to bigwig done\n    \"\"\"",
        "nb_lignes_script": 38,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "cram_dreg_prep",
            "cram_index_dreg_prep",
            "chrom_sizes"
        ],
        "nb_inputs": 3,
        "outputs": [
            "dreg_bigwig"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0,143",
            "errorStrategy 'ignore'",
            "tag \"$name\"",
            "memory '150 GB'",
            "publishDir \"${params.outdir}/mapped/dreg_input\", mode: 'copy', pattern: \"*.bw\""
        ],
        "when": "params.dreg",
        "stub": ""
    },
    "normalized_bigwigs": {
        "name_process": "normalized_bigwigs",
        "string_process": "\nprocess normalized_bigwigs {\n    validExitStatus 0\n    tag \"$name\"\n    memory '10 GB'\n    publishDir \"${params.outdir}/mapped/rcc_bigwig\", mode: 'copy'\n\n    input:\n    set val(name), file(neg_bedgraph) from bedgraph_bigwig_neg\n    set val(name), file(pos_bedgraph) from bedgraph_bigwig_pos\n    file(chrom_sizes) from chrom_sizes\n\n    output:\n    set val(name), file(\"*.rcc.bw\") into normalized_bigwig\n\n    script:\n    \"\"\"\n    ${params.bedGraphToBigWig} ${pos_bedgraph} ${chrom_sizes} ${name}.pos.rcc.bw\n    ${params.bedGraphToBigWig} ${neg_bedgraph} ${chrom_sizes} ${name}.neg.rcc.bw\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    ${params.bedGraphToBigWig} ${pos_bedgraph} ${chrom_sizes} ${name}.pos.rcc.bw\n    ${params.bedGraphToBigWig} ${neg_bedgraph} ${chrom_sizes} ${name}.neg.rcc.bw\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bedgraph_bigwig_neg",
            "bedgraph_bigwig_pos",
            "chrom_sizes"
        ],
        "nb_inputs": 3,
        "outputs": [
            "normalized_bigwig"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0",
            "tag \"$name\"",
            "memory '10 GB'",
            "publishDir \"${params.outdir}/mapped/rcc_bigwig\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "igvtools": {
        "name_process": "igvtools",
        "string_process": "\nprocess igvtools {\n    tag \"$name\"\n    memory '30 GB'\n    time '1h'\n                                                                             \n                                              \n    errorStrategy 'ignore'\n    publishDir \"${params.outdir}/mapped/tdfs\", mode: 'copy', pattern: \"*.tdf\"\n\n    input:\n    set val(name), file(normalized_bg) from bedgraph_tdf\n    file(chrom_sizes) from chrom_sizes\n\n    output:\n    set val(name), file(\"*.tdf\") into tiled_data_ch\n\n    script:\n    \"\"\"\n    igvtools toTDF ${normalized_bg} ${name}.rcc.tdf ${chrom_sizes}\n    \"\"\"\n }",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    igvtools toTDF ${normalized_bg} ${name}.rcc.tdf ${chrom_sizes}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "IGVtools"
        ],
        "tools_url": [
            "https://bio.tools/igvtools"
        ],
        "tools_dico": [
            {
                "name": "IGVtools",
                "uri": "https://bio.tools/igvtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0256",
                                    "term": "Sequence feature comparison"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0256",
                                    "term": "Feature comparison"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0256",
                                    "term": "Feature table comparison"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The igvtools utility provides a set of tools for pre-processing data files.",
                "homepage": "https://software.broadinstitute.org/software/igv/igvtools"
            }
        ],
        "inputs": [
            "bedgraph_tdf",
            "chrom_sizes"
        ],
        "nb_inputs": 2,
        "outputs": [
            "tiled_data_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '30 GB'",
            "time '1h'",
            "errorStrategy 'ignore'",
            "publishDir \"${params.outdir}/mapped/tdfs\", mode: 'copy', pattern: \"*.tdf\""
        ],
        "when": "",
        "stub": ""
    },
    "multiQC": {
        "name_process": "multiQC",
        "string_process": "\nprocess multiQC {\n    validExitStatus 0,1,143\n    errorStrategy 'ignore'\n    publishDir \"${params.outdir}/multiqc/\", mode: 'copy', pattern: \"multiqc_report.html\"\n    publishDir \"${params.outdir}/multiqc/\", mode: 'copy', pattern: \"*_data\"\n\n    when:\n    !params.skipMultiQC && !params.skipAllQC\n\n    input:\n    file multiqc_config\n    file (fastqc:'qc/fastqc/*') from fastqc_results.collect()\n    file ('qc/fastqc/*') from trimmed_fastqc_results.collect()\n    file ('qc/trimstats/*') from trim_stats.collect()\n    file ('qc/mapstats/*') from bam_flagstat.collect()\n    file ('qc/rseqc/*') from rseqc_results.collect()\n    file ('qc/preseq/*') from preseq_results.collect()\n    file ('qc/hisat2_mapstats/*') from hisat2_mapstats.collect()\n    file ('qc/picard/*') from picard_stats_multiqc.collect()    \n\n    output:\n    file \"*multiqc_report.html\" into multiqc_report\n    file \"*_data\" into multiqc_report_files\n\n    script:\n    rtitle = custom_runName ? \"--title \\\"$custom_runName\\\"\" : ''\n    rfilename = custom_runName ? \"--filename \" + custom_runName.replaceAll('\\\\W','_').replaceAll('_+','_') + \"_multiqc_report\" : ''\n\n    \"\"\"\n    multiqc \"${params.outdir}\"/qc/ -f $rtitle $rfilename --config $multiqc_config\n    \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "    rtitle = custom_runName ? \"--title \\\"$custom_runName\\\"\" : ''\n    rfilename = custom_runName ? \"--filename \" + custom_runName.replaceAll('\\\\W','_').replaceAll('_+','_') + \"_multiqc_report\" : ''\n\n    \"\"\"\n    multiqc \"${params.outdir}\"/qc/ -f $rtitle $rfilename --config $multiqc_config\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "multiqc_config",
            "fastqc_results",
            "trimmed_fastqc_results",
            "trim_stats",
            "bam_flagstat",
            "rseqc_results",
            "preseq_results",
            "hisat2_mapstats",
            "picard_stats_multiqc"
        ],
        "nb_inputs": 9,
        "outputs": [
            "multiqc_report",
            "multiqc_report_files"
        ],
        "nb_outputs": 2,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "validExitStatus 0,1,143",
            "errorStrategy 'ignore'",
            "publishDir \"${params.outdir}/multiqc/\", mode: 'copy', pattern: \"multiqc_report.html\"",
            "publishDir \"${params.outdir}/multiqc/\", mode: 'copy', pattern: \"*_data\""
        ],
        "when": "!params.skipMultiQC && !params.skipAllQC",
        "stub": ""
    },
    "FStitch": {
        "name_process": "FStitch",
        "string_process": "\nprocess FStitch {\n    tag \"$name\"\n    memory '50 GB'\n    time '1h'\n    validExitStatus 0\n    publishDir \"${params.outdir}/fstitch/\", mode: 'copy', pattern: \"*.hmminfo\"\n    publishDir \"${params.outdir}/fstitch/segment/\", mode: 'copy', pattern: \"*.fstitch_seg.bed\"\n    publishDir \"${params.outdir}/fstitch/bidirs/\", mode: 'copy', pattern: \"${name}.fstitch_bidir.bed\"\n    publishDir \"${params.outdir}/fstitch/bidirs/\", mode: 'copy', pattern: \"*fstitch_bidir.{short,long}.bed\"\n    publishDir \"${params.outdir}/fstitch/bidirs/stats/\", mode: 'copy', pattern: \"*.txt\"\n    \n    when:\n    params.fstitch\n    \n    input:\n    set val(name), file(bg) from fstitch_bg\n    set val(name), file(pos_bg) from pos_fstitch_bg\n    set val(name), file(neg_bg) from neg_fstitch_bg\n        \n    output:\n    file (\"*.hmminfo\") into fs_train_out\n    file (\"*.fstitch_seg.bed\") into fs_seg_out\n    set val(name), file (\"*.fstitch_bidir.bed\") into fs_bidir_out\n    file (\"*fstitch_bidir.{short,long}.bed\") into fs_bidir_short_long_out\n    file (\"*.txt\") into fs_bidir_stats_out\n    \n    script:\n    \"\"\"\n    ${fstitch_path} train \\\n        -s + \\\n        -b ${bg} \\\n        -t ${fstitch_train} \\\n        -o ${name}.fstitch.hmminfo\n        \n     ${fstitch_path} segment \\\n        -s + \\\n        -b ${pos_bg} \\\n        -p ${name}.fstitch.hmminfo \\\n        -o ${name}.pos.fstitch_seg.bed\n     ${fstitch_path} segment \\\n        -s - \\\n        -b ${neg_bg} \\\n        -p ${name}.fstitch.hmminfo \\\n        -o ${name}.neg.fstitch_seg.bed\n    cat ${name}.pos.fstitch_seg.bed \\\n        ${name}.neg.fstitch_seg.bed \\\n        | sortBed > ${name}.fstitch_seg.bed\n    bidir \\\n        -b ${name}.fstitch_seg.bed \\\n        -g ${genome_refseq} \\\n        -o ${name}.fstitch_bidir.bed \\\n        -s    \n    \"\"\"\n}",
        "nb_lignes_process": 53,
        "string_script": "    \"\"\"\n    ${fstitch_path} train \\\n        -s + \\\n        -b ${bg} \\\n        -t ${fstitch_train} \\\n        -o ${name}.fstitch.hmminfo\n        \n     ${fstitch_path} segment \\\n        -s + \\\n        -b ${pos_bg} \\\n        -p ${name}.fstitch.hmminfo \\\n        -o ${name}.pos.fstitch_seg.bed\n     ${fstitch_path} segment \\\n        -s - \\\n        -b ${neg_bg} \\\n        -p ${name}.fstitch.hmminfo \\\n        -o ${name}.neg.fstitch_seg.bed\n    cat ${name}.pos.fstitch_seg.bed \\\n        ${name}.neg.fstitch_seg.bed \\\n        | sortBed > ${name}.fstitch_seg.bed\n    bidir \\\n        -b ${name}.fstitch_seg.bed \\\n        -g ${genome_refseq} \\\n        -o ${name}.fstitch_bidir.bed \\\n        -s    \n    \"\"\"",
        "nb_lignes_script": 25,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fstitch_bg",
            "pos_fstitch_bg",
            "neg_fstitch_bg"
        ],
        "nb_inputs": 3,
        "outputs": [
            "fs_train_out",
            "fs_seg_out",
            "fs_bidir_out",
            "fs_bidir_short_long_out",
            "fs_bidir_stats_out"
        ],
        "nb_outputs": 5,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '50 GB'",
            "time '1h'",
            "validExitStatus 0",
            "publishDir \"${params.outdir}/fstitch/\", mode: 'copy', pattern: \"*.hmminfo\"",
            "publishDir \"${params.outdir}/fstitch/segment/\", mode: 'copy', pattern: \"*.fstitch_seg.bed\"",
            "publishDir \"${params.outdir}/fstitch/bidirs/\", mode: 'copy', pattern: \"${name}.fstitch_bidir.bed\"",
            "publishDir \"${params.outdir}/fstitch/bidirs/\", mode: 'copy', pattern: \"*fstitch_bidir.{short,long}.bed\"",
            "publishDir \"${params.outdir}/fstitch/bidirs/stats/\", mode: 'copy', pattern: \"*.txt\""
        ],
        "when": "params.fstitch",
        "stub": ""
    },
    "tfit": {
        "name_process": "tfit",
        "string_process": "\nprocess tfit {\n    tag \"$name\"\n    memory '25 GB'\n    time '20h'\n    cpus 16\n    queue 'short'\n    validExitStatus 0\n    publishDir \"${params.outdir}/tfit\", mode: 'copy', pattern: \"*tfit_bidirs.bed\"\n    publishDir \"${params.outdir}/tfit/logs\", mode: 'copy', pattern: \"*{tsv,log}\"\n    \n    when:\n    params.tfit\n    \n    input:\n    set val(name), file (bidirs) from fs_bidir_out\n    set val(name), file(bg) from tfit_bg\n        \n    output:\n    set val(name), file (\"${name}.tfit_bidirs.bed\") into tfit_bed_out\n    file (\"*.tsv\") into tfit_full_model_out\n    file (\"*.log\") into tfit_logs_out\n        \n    script:\n        \"\"\"\n        export OMP_NUM_THREADS=16\n        \n        ${tfit_path} model \\\n            -bg ${bg} \\\n            -s ${bidirs} \\\n            -N $name \\\n            -l \\\n            -o ${name}.tfit_bidirs.bed \\\n            --threads 16 \\\n        \"\"\"\n}",
        "nb_lignes_process": 34,
        "string_script": "        \"\"\"\n        export OMP_NUM_THREADS=16\n        \n        ${tfit_path} model \\\n            -bg ${bg} \\\n            -s ${bidirs} \\\n            -N $name \\\n            -l \\\n            -o ${name}.tfit_bidirs.bed \\\n            --threads 16 \\\n        \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fs_bidir_out",
            "tfit_bg"
        ],
        "nb_inputs": 2,
        "outputs": [
            "tfit_bed_out",
            "tfit_full_model_out",
            "tfit_logs_out"
        ],
        "nb_outputs": 3,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '25 GB'",
            "time '20h'",
            "cpus 16",
            "queue 'short'",
            "validExitStatus 0",
            "publishDir \"${params.outdir}/tfit\", mode: 'copy', pattern: \"*tfit_bidirs.bed\"",
            "publishDir \"${params.outdir}/tfit/logs\", mode: 'copy', pattern: \"*{tsv,log}\""
        ],
        "when": "params.tfit",
        "stub": ""
    },
    "prelimtfit": {
        "name_process": "prelimtfit",
        "string_process": "\nprocess prelimtfit {\n    tag \"$name\"\n    memory '100 GB'\n    time '48h'\n    cpus 16\n    queue 'long'\n    validExitStatus 0\n    publishDir \"${params.outdir}/prelimtfit\", mode: 'copy', pattern: \"*tfit_bidirs.bed\"\n    publishDir \"${params.outdir}/prelimtfit/logs\", mode: 'copy', pattern: \"*{tsv,log}\"\n    publishDir \"${params.outdir}/prelimtfit/prelim\", mode: 'copy', pattern: \"*tfit_prelim.bed\"\n    \n    when:\n    params.prelimtfit\n    \n    input:\n    set val(name), file(bg) from prelimtfit_bg\n        \n    output:\n    file (\"*tfit_prelim.bed\") into tfit_prelim_out\n    file (\"*tfit_bidirs.bed\") into prelimtfit_bed_out\n    file (\"*.tsv\") into prelimtfit_full_model_out\n    file (\"*.log\") into prelimtfit_logs_out\n        \n    script:\n        \"\"\"\n        export OMP_NUM_THREADS=16\n        \n        ${tfit_path} prelim \\\n            -bg ${bg} \\\n            -N $name \\\n            -l \\\n            -o ${name}.tfit_prelim.bed \\\n            --threads 16\n        \n        ${tfit_path} model \\\n            -bg ${bg} \\\n            -s ${name}.tfit_prelim.bed \\\n            -N $name \\\n            -l \\\n            -o ${name}.tfit_bidirs.bed \\\n            --threads 16\n        \"\"\"\n}",
        "nb_lignes_process": 42,
        "string_script": "        \"\"\"\n        export OMP_NUM_THREADS=16\n        \n        ${tfit_path} prelim \\\n            -bg ${bg} \\\n            -N $name \\\n            -l \\\n            -o ${name}.tfit_prelim.bed \\\n            --threads 16\n        \n        ${tfit_path} model \\\n            -bg ${bg} \\\n            -s ${name}.tfit_prelim.bed \\\n            -N $name \\\n            -l \\\n            -o ${name}.tfit_bidirs.bed \\\n            --threads 16\n        \"\"\"",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "prelimtfit_bg"
        ],
        "nb_inputs": 1,
        "outputs": [
            "tfit_prelim_out",
            "prelimtfit_bed_out",
            "prelimtfit_full_model_out",
            "prelimtfit_logs_out"
        ],
        "nb_outputs": 4,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '100 GB'",
            "time '48h'",
            "cpus 16",
            "queue 'long'",
            "validExitStatus 0",
            "publishDir \"${params.outdir}/prelimtfit\", mode: 'copy', pattern: \"*tfit_bidirs.bed\"",
            "publishDir \"${params.outdir}/prelimtfit/logs\", mode: 'copy', pattern: \"*{tsv,log}\"",
            "publishDir \"${params.outdir}/prelimtfit/prelim\", mode: 'copy', pattern: \"*tfit_prelim.bed\""
        ],
        "when": "params.prelimtfit",
        "stub": ""
    },
    "multicov": {
        "name_process": "multicov",
        "string_process": "\nprocess multicov {\n    tag \"$name\"\n    memory '10 GB'\n    time '6h'\n    validExitStatus 0\n    publishDir \"${params.outdir}/counts\", mode: 'copy', pattern: \"*.bed\"\n    \n    when:\n    params.counts\n    \n    input:\n    set val(name), file (cram_count) from cram_for_counts\n    set val(name), file (cram_index) from cram_index_for_counts\n       \n    output:\n    file (\"*.bed\") into counts_bed_out\n        \n    script:\n        \"\"\"\n        export CRAM_REFERENCE=${genome}\n        \n        bedtools multicov \\\\\n            -bams ${cram_count} \\\\\n            -s \\\\\n            -bed ${genome_refseq} \\\\\n            > ${name}_counts.bed\n        \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "        \"\"\"\n        export CRAM_REFERENCE=${genome}\n        \n        bedtools multicov \\\\\n            -bams ${cram_count} \\\\\n            -s \\\\\n            -bed ${genome_refseq} \\\\\n            > ${name}_counts.bed\n        \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "cram_for_counts",
            "cram_index_for_counts"
        ],
        "nb_inputs": 2,
        "outputs": [
            "counts_bed_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "tag \"$name\"",
            "memory '10 GB'",
            "time '6h'",
            "validExitStatus 0",
            "publishDir \"${params.outdir}/counts\", mode: 'copy', pattern: \"*.bed\""
        ],
        "when": "params.counts",
        "stub": ""
    },
    "merge_multicov": {
        "name_process": "merge_multicov",
        "string_process": "\nprocess merge_multicov {\n    memory '10 GB'\n    time '1h'\n    validExitStatus 0\n    publishDir \"${params.outdir}/counts\", mode: 'copy', pattern: \"merged_gene_counts.bed\"\n    \n    when:\n    params.counts\n    \n    input:\n    file (multicov:'counts/*') from counts_bed_out.collect()\n       \n    output:\n    file (\"merged_gene_counts.bed\") into merged_counts_bed_out\n        \n    script:\n        \"\"\"\n        python3 ${params.merge_counts} \\\\\n            -b './counts/' \\\\\n            -o merged_gene_counts.bed\n        \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "        \"\"\"\n        python3 ${params.merge_counts} \\\\\n            -b './counts/' \\\\\n            -o merged_gene_counts.bed\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "counts_bed_out"
        ],
        "nb_inputs": 1,
        "outputs": [
            "merged_counts_bed_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "memory '10 GB'",
            "time '1h'",
            "validExitStatus 0",
            "publishDir \"${params.outdir}/counts\", mode: 'copy', pattern: \"merged_gene_counts.bed\""
        ],
        "when": "params.counts",
        "stub": ""
    },
    "nqc": {
        "name_process": "nqc",
        "string_process": "\nprocess nqc {\n    memory '20 GB'\n    time '2h'\n    cpus 16    \n    validExitStatus 0\n    publishDir \"${params.outdir}/qc/nqc\", mode: 'copy', pattern: \"*.{txt,html,png}\"\n    \n    when:\n    params.nqc\n    \n    input:\n    file (bedgraphs:'mapped/bedgraphs/*') from nqc_bg.collect()\n    file (duplication_files:'qc/picard/dups/*') from picard_stats_nqc.collect()\n    file (fastqc_files:'qc/fastqc_stats/*') from fastqc_stats.collect()\n       \n    output:\n    file (\"*.{txt,html,png}\") into nqc_out\n        \n    script:\n        \"\"\"\n        python3 ${params.nqc_py} \\\\\n            -b './mapped/bedgraphs/' \\\\\n            -d './qc/picard/dups/' \\\\\n            -r './qc/fastqc_stats/' \\\\\n            -g ${chrom_sizes} \\\\\n            -t 16\n        \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "        \"\"\"\n        python3 ${params.nqc_py} \\\\\n            -b './mapped/bedgraphs/' \\\\\n            -d './qc/picard/dups/' \\\\\n            -r './qc/fastqc_stats/' \\\\\n            -g ${chrom_sizes} \\\\\n            -t 16\n        \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "nqc_bg",
            "picard_stats_nqc",
            "fastqc_stats"
        ],
        "nb_inputs": 3,
        "outputs": [
            "nqc_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "Dowell-Lab__Nascent-Flow",
        "directive": [
            "memory '20 GB'",
            "time '2h'",
            "cpus 16",
            "validExitStatus 0",
            "publishDir \"${params.outdir}/qc/nqc\", mode: 'copy', pattern: \"*.{txt,html,png}\""
        ],
        "when": "params.nqc",
        "stub": ""
    }
}