{
    "INDEX_REFERENCE": {
        "name_process": "INDEX_REFERENCE",
        "string_process": "\nprocess INDEX_REFERENCE { \n\n\tinput:\n\t\tpath reference_genome\n\t\tpath bed_file\n\n\toutput:\n\t\ttuple path(\"*.fa\"), path(\"*.fa.fai\"), path(\"*.dict\"), emit: reference_genome\n\t\ttuple path(\"*.bed_sorted.gz\"), path(\"*.bed_sorted.gz.tbi\"), emit: bed_file\n\n\tshell:\n\t'''\n\treference_name=!{reference_genome}\n\treference_name=${reference_name%.*}  # removes last file extension .gz\n\n\tgunzip -c !{reference_genome} > $reference_name \n\tsamtools faidx $reference_name -o $reference_name.fai\n\tsamtools dict $reference_name -o ${reference_name%.*}.dict  # remove .fa so name is only .dict\n\n\tbedtools sort -i !{bed_file} | bgzip -c > !{bed_file}_sorted.gz\n\ttabix --zero-based -b 2 -e 3 !{bed_file}_sorted.gz\n\t'''\n}",
        "nb_lignes_process": 22,
        "string_script": "\t'''\n\treference_name=!{reference_genome}\n\treference_name=${reference_name%.*}  # removes last file extension .gz\n\n\tgunzip -c !{reference_genome} > $reference_name \n\tsamtools faidx $reference_name -o $reference_name.fai\n\tsamtools dict $reference_name -o ${reference_name%.*}.dict  # remove .fa so name is only .dict\n\n\tbedtools sort -i !{bed_file} | bgzip -c > !{bed_file}_sorted.gz\n\ttabix --zero-based -b 2 -e 3 !{bed_file}_sorted.gz\n\t'''",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "reference_genome",
            "bed_file"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "SOMVC_LOFREQ": {
        "name_process": "SOMVC_LOFREQ",
        "string_process": "\nprocess SOMVC_LOFREQ { \n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/vc_caller/lofreq\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(normal_file), path(tumor_file), path(normal_file_index), path(tumor_file_index) \n\t\tpath reference_genome\n\t\tpath bed_file\n\t\tval num_threads\n\n\toutput:\n\t\ttuple val(\"$sample_id\"), path(\"lofreq_somatic_final.snvs.vcf.gz\"), path(\"lofreq_somatic_final.snvs.vcf.gz.tbi\"), path(\"lofreq_somatic_final.indels_vt.vcf.gz\"), path(\"lofreq_somatic_final.indels_vt.vcf.gz.tbi\"), emit: lofreq_output\n\t\ttuple path(\"lofreq_somatic_raw.snvs.vcf.gz\"), path(\"lofreq_somatic_raw.snvs.vcf.gz.tbi\")\n\t\ttuple path(\"lofreq_somatic_raw.indels.vcf.gz\"), path(\"lofreq_somatic_raw.indels.vcf.gz.tbi\")\n\n\tshell:\n\t'''\n\t### https://csb5.github.io/lofreq/commands/#somatic\n\tgunzip -c !{bed_file[0]} > bed_file_unzipped.bed   # vardict need unzipped\n\n\tlofreq viterbi -f !{reference_genome[0]} !{normal_file} | samtools sort -@ !{num_threads} -o normal_file_viterbi.bam -\n\tlofreq indelqual --dindel -f !{reference_genome[0]} -o normal_file_indelqual.bam normal_file_viterbi.bam\n\tsamtools index -b -@ !{num_threads} normal_file_viterbi.bam\n\n\tlofreq viterbi -f !{reference_genome[0]} !{tumor_file} | samtools sort -@ !{num_threads} -o tumor_file_viterbi.bam -\n\tlofreq indelqual --dindel -f !{reference_genome[0]} -o tumor_file_indelqual.bam tumor_file_viterbi.bam\n\tsamtools index -b -@ !{num_threads} tumor_file_viterbi.bam\n\n\tlofreq somatic -n normal_file_viterbi.bam -t tumor_file_viterbi.bam -f !{reference_genome[0]} --threads !{num_threads} -o lofreq_ -l bed_file_unzipped.bed --call-indels\n\t\n\t### vt normalization for indels\n\tvt normalize lofreq_somatic_final.indels.vcf.gz -r !{reference_genome[0]} -o lofreq_somatic_final.indels_vt.vcf.gz\n\ttabix -p vcf lofreq_somatic_final.indels_vt.vcf.gz\n\n\t'''\n}",
        "nb_lignes_process": 35,
        "string_script": "\t'''\n\t### https://csb5.github.io/lofreq/commands/#somatic\n\tgunzip -c !{bed_file[0]} > bed_file_unzipped.bed   # vardict need unzipped\n\n\tlofreq viterbi -f !{reference_genome[0]} !{normal_file} | samtools sort -@ !{num_threads} -o normal_file_viterbi.bam -\n\tlofreq indelqual --dindel -f !{reference_genome[0]} -o normal_file_indelqual.bam normal_file_viterbi.bam\n\tsamtools index -b -@ !{num_threads} normal_file_viterbi.bam\n\n\tlofreq viterbi -f !{reference_genome[0]} !{tumor_file} | samtools sort -@ !{num_threads} -o tumor_file_viterbi.bam -\n\tlofreq indelqual --dindel -f !{reference_genome[0]} -o tumor_file_indelqual.bam tumor_file_viterbi.bam\n\tsamtools index -b -@ !{num_threads} tumor_file_viterbi.bam\n\n\tlofreq somatic -n normal_file_viterbi.bam -t tumor_file_viterbi.bam -f !{reference_genome[0]} --threads !{num_threads} -o lofreq_ -l bed_file_unzipped.bed --call-indels\n\t\n\t### vt normalization for indels\n\tvt normalize lofreq_somatic_final.indels.vcf.gz -r !{reference_genome[0]} -o lofreq_somatic_final.indels_vt.vcf.gz\n\ttabix -p vcf lofreq_somatic_final.indels_vt.vcf.gz\n\n\t'''",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "vt"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/vt"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "vt",
                "uri": "https://bio.tools/vt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Variant tool set that discovers short variants from Next Generation Sequencing data.",
                "homepage": "http://genome.sph.umich.edu/wiki/Vt"
            }
        ],
        "inputs": [
            "sample_id",
            "normal_file",
            "tumor_file",
            "normal_file_index",
            "tumor_file_index",
            "reference_genome",
            "bed_file",
            "num_threads"
        ],
        "nb_inputs": 8,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/vc_caller/lofreq\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "SOMVC_MUTECT2": {
        "name_process": "SOMVC_MUTECT2",
        "string_process": "\nprocess SOMVC_MUTECT2 { \n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/vc_caller/mutect2\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(normal_file), path(tumor_file), path(normal_file_index), path(tumor_file_index) \n\t\tpath reference_genome\n\t\tpath bed_file\n\t\tval num_threads\n\n\toutput:\n\t\ttuple val(\"$sample_id\"), path(\"mutect2_filtered_vt.vcf.gz\"), path(\"mutect2_filtered_vt.vcf.gz.tbi\"), emit: mutect2_output\n\t\tpath \"mutect2_filtered.vcf.filteringStats.tsv\"\n\n\tshell:\n\t'''\n\tgunzip -c !{bed_file[0]} > bed_file_unzipped.bed   # mutect2 need unzipped\n\t\n\tgatk GetSampleName -I !{normal_file} -O sample_normal.txt\n\tnormal_sample_name=$(cat sample_normal.txt)\n\tgatk GetSampleName -I !{tumor_file} -O sample_tumor.txt\n\ttumor_sample_name=$(cat sample_tumor.txt)\n\t\n\tgatk Mutect2 -R !{reference_genome[0]} -I !{normal_file} -normal $normal_sample_name -I !{tumor_file} -tumor $tumor_sample_name --native-pair-hmm-threads !{num_threads} --germline-resource /usr/src/mutect2_genome/af-only-gnomad_ensembl.hg38.vcf.gz --panel-of-normals /usr/src/mutect2_genome/1000g_pon_ensembl.hg38.vcf.gz --intervals bed_file_unzipped.bed -O mutect2_unfiltered.vcf\n\tgatk FilterMutectCalls -R !{reference_genome[0]} -V mutect2_unfiltered.vcf -O mutect2_filtered.vcf\n\n\t### rename for somatic-combiner\n\tprintf '%s\\n' !{sample_id}_normal !{sample_id}_tumor > sample_names.txt  \n\tbcftools reheader --samples sample_names.txt -o mutect2_filtered_name.vcf mutect2_filtered.vcf\n\n\tbgzip -c mutect2_filtered_name.vcf > mutect2_filtered.vcf.gz\n\tvt normalize mutect2_filtered.vcf.gz -r !{reference_genome[0]} -o mutect2_filtered_vt.vcf.gz\n\ttabix -p vcf mutect2_filtered_vt.vcf.gz\n\t'''\n}",
        "nb_lignes_process": 34,
        "string_script": "\t'''\n\tgunzip -c !{bed_file[0]} > bed_file_unzipped.bed   # mutect2 need unzipped\n\t\n\tgatk GetSampleName -I !{normal_file} -O sample_normal.txt\n\tnormal_sample_name=$(cat sample_normal.txt)\n\tgatk GetSampleName -I !{tumor_file} -O sample_tumor.txt\n\ttumor_sample_name=$(cat sample_tumor.txt)\n\t\n\tgatk Mutect2 -R !{reference_genome[0]} -I !{normal_file} -normal $normal_sample_name -I !{tumor_file} -tumor $tumor_sample_name --native-pair-hmm-threads !{num_threads} --germline-resource /usr/src/mutect2_genome/af-only-gnomad_ensembl.hg38.vcf.gz --panel-of-normals /usr/src/mutect2_genome/1000g_pon_ensembl.hg38.vcf.gz --intervals bed_file_unzipped.bed -O mutect2_unfiltered.vcf\n\tgatk FilterMutectCalls -R !{reference_genome[0]} -V mutect2_unfiltered.vcf -O mutect2_filtered.vcf\n\n\t### rename for somatic-combiner\n\tprintf '%s\\n' !{sample_id}_normal !{sample_id}_tumor > sample_names.txt  \n\tbcftools reheader --samples sample_names.txt -o mutect2_filtered_name.vcf mutect2_filtered.vcf\n\n\tbgzip -c mutect2_filtered_name.vcf > mutect2_filtered.vcf.gz\n\tvt normalize mutect2_filtered.vcf.gz -r !{reference_genome[0]} -o mutect2_filtered_vt.vcf.gz\n\ttabix -p vcf mutect2_filtered_vt.vcf.gz\n\t'''",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "GATK",
            "BCFtools",
            "vt"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/bcftools",
            "https://bio.tools/vt"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "vt",
                "uri": "https://bio.tools/vt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Variant tool set that discovers short variants from Next Generation Sequencing data.",
                "homepage": "http://genome.sph.umich.edu/wiki/Vt"
            }
        ],
        "inputs": [
            "sample_id",
            "normal_file",
            "tumor_file",
            "normal_file_index",
            "tumor_file_index",
            "reference_genome",
            "bed_file",
            "num_threads"
        ],
        "nb_inputs": 8,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/vc_caller/mutect2\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "SOMVC_STRELKA": {
        "name_process": "SOMVC_STRELKA",
        "string_process": "\nprocess SOMVC_STRELKA { \n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/vc_caller/strelka\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(normal_file), path(tumor_file), path(normal_file_index), path(tumor_file_index) \n\t\tpath reference_genome\n\t\tpath bed_file\n\t\tval num_threads\n\n\toutput:\n\t\ttuple val(\"$sample_id\"), path(\"somatic.snvs.vcf.gz\"), path(\"somatic.snvs.vcf.gz.tbi\"), path(\"somatic.indels_vt.vcf.gz\"), path(\"somatic.indels_vt.vcf.gz.tbi\"), emit: strelka_output\n\t\tpath manta_sv\n\n\tshell:\n\t'''\n\tconfigManta.py --tumorBam !{tumor_file} --normalBam !{normal_file} --referenceFasta !{reference_genome[0]} --runDir manta_dir\n\tmanta_dir/runWorkflow.py -m local -j !{num_threads}\t\n\n\tconfigureStrelkaSomaticWorkflow.py --tumorBam !{tumor_file} --normalBam !{normal_file} --referenceFasta !{reference_genome[0]} --exome --runDir strelka_dir --indelCandidates manta_dir/results/variants/candidateSmallIndels.vcf.gz --callRegions !{bed_file[0]}\n\tstrelka_dir/runWorkflow.py -m local -j !{num_threads}\n\n\tprintf '%s\\n' !{sample_id}_normal !{sample_id}_tumor > sample_names.txt \n\tbcftools reheader --samples sample_names.txt -o somatic.snvs.vcf.gz strelka_dir/results/variants/somatic.snvs.vcf.gz\n\tbcftools reheader --samples sample_names.txt -o somatic.indels.vcf.gz strelka_dir/results/variants/somatic.indels.vcf.gz\n\ttabix -p vcf somatic.snvs.vcf.gz\n\n\t### vt normalization for indels\n\tvt normalize somatic.indels.vcf.gz -r !{reference_genome[0]} -o somatic.indels_vt.vcf.gz\n\ttabix -p vcf somatic.indels_vt.vcf.gz\n\t\n\tmv manta_dir/results/variants manta_sv\n\t'''\n}",
        "nb_lignes_process": 33,
        "string_script": "\t'''\n\tconfigManta.py --tumorBam !{tumor_file} --normalBam !{normal_file} --referenceFasta !{reference_genome[0]} --runDir manta_dir\n\tmanta_dir/runWorkflow.py -m local -j !{num_threads}\t\n\n\tconfigureStrelkaSomaticWorkflow.py --tumorBam !{tumor_file} --normalBam !{normal_file} --referenceFasta !{reference_genome[0]} --exome --runDir strelka_dir --indelCandidates manta_dir/results/variants/candidateSmallIndels.vcf.gz --callRegions !{bed_file[0]}\n\tstrelka_dir/runWorkflow.py -m local -j !{num_threads}\n\n\tprintf '%s\\n' !{sample_id}_normal !{sample_id}_tumor > sample_names.txt \n\tbcftools reheader --samples sample_names.txt -o somatic.snvs.vcf.gz strelka_dir/results/variants/somatic.snvs.vcf.gz\n\tbcftools reheader --samples sample_names.txt -o somatic.indels.vcf.gz strelka_dir/results/variants/somatic.indels.vcf.gz\n\ttabix -p vcf somatic.snvs.vcf.gz\n\n\t### vt normalization for indels\n\tvt normalize somatic.indels.vcf.gz -r !{reference_genome[0]} -o somatic.indels_vt.vcf.gz\n\ttabix -p vcf somatic.indels_vt.vcf.gz\n\t\n\tmv manta_dir/results/variants manta_sv\n\t'''",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "vt"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/vt"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "vt",
                "uri": "https://bio.tools/vt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Variant tool set that discovers short variants from Next Generation Sequencing data.",
                "homepage": "http://genome.sph.umich.edu/wiki/Vt"
            }
        ],
        "inputs": [
            "sample_id",
            "normal_file",
            "tumor_file",
            "normal_file_index",
            "tumor_file_index",
            "reference_genome",
            "bed_file",
            "num_threads"
        ],
        "nb_inputs": 8,
        "outputs": [
            "manta_sv"
        ],
        "nb_outputs": 1,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/vc_caller/strelka\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "SOMVC_VARDICT": {
        "name_process": "SOMVC_VARDICT",
        "string_process": "\nprocess SOMVC_VARDICT { \n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/vc_caller/vardict\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(normal_file), path(tumor_file), path(normal_file_index), path(tumor_file_index) \n\t\tpath reference_genome\n\t\tpath bed_file\n\t\tval num_threads\n\n\toutput:\n\t\ttuple val(\"$sample_id\"), path(\"vardict_output_filtered.vcf.gz\"), path(\"vardict_output_filtered.vcf.gz.tbi\"), emit: vardict_output\n\n\tshell: \n\t'''\n\tgunzip -c !{bed_file[0]} > bed_file_unzipped.bed   # vardict need unzipped\n\n\t/usr/src/VarDict-1.8.2/bin/VarDict -G !{reference_genome[0]} -k 1 -b \"!{tumor_file}|!{normal_file}\" -Q 5 -z 1 -c 1 -S 2 -E 3 -g 4 -th !{num_threads} bed_file_unzipped.bed | /usr/src/VarDict-1.8.2/bin/testsomatic.R | /usr/src/VarDict-1.8.2/bin/var2vcf_paired.pl -P 0.9 -m 4.25 -f 0.01 -M -N \"!{sample_id}_tumor|!{sample_id}_normal\" > vardict_output.vcf\n\n\t### https://github.com/bcbio/bcbio-nextgen/blob/5cfc02b5974d19908702fa21e6d2f7a50455b44c/bcbio/variation/vardict.py#L248\n\tgatk VariantFiltration -R !{reference_genome[0]} -V vardict_output.vcf -O vardict_output_filtered.vcf --filter-name bcbio_advised --filter-expression \"((AF*DP<6)&&((MQ<55.0&&NM>1.0)||(MQ<60.0&&NM>2.0)||(DP<10)||(QUAL<45)))\" \n\n\tbgzip -c vardict_output_filtered.vcf > vardict_output_filtered.vcf.gz\n\ttabix -p vcf vardict_output_filtered.vcf.gz\n\t'''\n}",
        "nb_lignes_process": 25,
        "string_script": "\t'''\n\tgunzip -c !{bed_file[0]} > bed_file_unzipped.bed   # vardict need unzipped\n\n\t/usr/src/VarDict-1.8.2/bin/VarDict -G !{reference_genome[0]} -k 1 -b \"!{tumor_file}|!{normal_file}\" -Q 5 -z 1 -c 1 -S 2 -E 3 -g 4 -th !{num_threads} bed_file_unzipped.bed | /usr/src/VarDict-1.8.2/bin/testsomatic.R | /usr/src/VarDict-1.8.2/bin/var2vcf_paired.pl -P 0.9 -m 4.25 -f 0.01 -M -N \"!{sample_id}_tumor|!{sample_id}_normal\" > vardict_output.vcf\n\n\t### https://github.com/bcbio/bcbio-nextgen/blob/5cfc02b5974d19908702fa21e6d2f7a50455b44c/bcbio/variation/vardict.py#L248\n\tgatk VariantFiltration -R !{reference_genome[0]} -V vardict_output.vcf -O vardict_output_filtered.vcf --filter-name bcbio_advised --filter-expression \"((AF*DP<6)&&((MQ<55.0&&NM>1.0)||(MQ<60.0&&NM>2.0)||(DP<10)||(QUAL<45)))\" \n\n\tbgzip -c vardict_output_filtered.vcf > vardict_output_filtered.vcf.gz\n\ttabix -p vcf vardict_output_filtered.vcf.gz\n\t'''",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "sample_id",
            "normal_file",
            "tumor_file",
            "normal_file_index",
            "tumor_file_index",
            "reference_genome",
            "bed_file",
            "num_threads"
        ],
        "nb_inputs": 8,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/vc_caller/vardict\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "SOMATIC_COMBINER": {
        "name_process": "SOMATIC_COMBINER",
        "string_process": "\nprocess SOMATIC_COMBINER { \n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/vc_caller/somatic_combiner\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(lofreq_snv_vcf), path(lofreq_snv_vcf_index), path(lofreq_indel_vcf), path(lofreq_indel_vcf_index), path(mutect2_vcf), path(mutect2_vcf_index), path(strelka_snv_vcf), path(strelka_snv_vcf_index), path(strelka_indel_vcf), path(strelka_indel_vcf_index), path(vardict_vcf), path(vardict_vcf_index)\n\n\toutput:\n\t\ttuple val(\"${sample_id}\"), path(\"*_somatic_combiner_all.vcf.gz\"), path(\"*_somatic_combiner_all.vcf.gz.tbi\"), emit: somatic_combiner_vcf\n\n\n\tshell:\n\t'''\n\tjava -jar /usr/src/somaticCombiner.jar -L !{lofreq_indel_vcf} -l !{lofreq_snv_vcf} -M !{mutect2_vcf} -s !{strelka_snv_vcf} -S !{strelka_indel_vcf} -D !{vardict_vcf} -o somatic_combiner_raw.vcf\n\n\tprintf '%s\\n' !{sample_id}_tumor !{sample_id}_normal > sample_names.txt \n\tbcftools reheader --samples sample_names.txt -o somatic_combiner_sample.vcf somatic_combiner_raw.vcf\n\t\n\t### somatic combiner defined but not added to vcf\n\tsed -i '7 i ##FORMAT=<ID=AD,Number=R,Type=Integer,Description=\"Allelic depths for the ref and alt alleles in the order listed, according to somatic-combiner\">' somatic_combiner_sample.vcf\n\t\n\tbgzip -c somatic_combiner_sample.vcf > !{sample_id}_somatic_combiner_all.vcf.gz\n\ttabix -p vcf !{sample_id}_somatic_combiner_all.vcf.gz\n\t'''\n}",
        "nb_lignes_process": 24,
        "string_script": "\t'''\n\tjava -jar /usr/src/somaticCombiner.jar -L !{lofreq_indel_vcf} -l !{lofreq_snv_vcf} -M !{mutect2_vcf} -s !{strelka_snv_vcf} -S !{strelka_indel_vcf} -D !{vardict_vcf} -o somatic_combiner_raw.vcf\n\n\tprintf '%s\\n' !{sample_id}_tumor !{sample_id}_normal > sample_names.txt \n\tbcftools reheader --samples sample_names.txt -o somatic_combiner_sample.vcf somatic_combiner_raw.vcf\n\t\n\t### somatic combiner defined but not added to vcf\n\tsed -i '7 i ##FORMAT=<ID=AD,Number=R,Type=Integer,Description=\"Allelic depths for the ref and alt alleles in the order listed, according to somatic-combiner\">' somatic_combiner_sample.vcf\n\t\n\tbgzip -c somatic_combiner_sample.vcf > !{sample_id}_somatic_combiner_all.vcf.gz\n\ttabix -p vcf !{sample_id}_somatic_combiner_all.vcf.gz\n\t'''",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample_id",
            "lofreq_snv_vcf",
            "lofreq_snv_vcf_index",
            "lofreq_indel_vcf",
            "lofreq_indel_vcf_index",
            "mutect2_vcf",
            "mutect2_vcf_index",
            "strelka_snv_vcf",
            "strelka_snv_vcf_index",
            "strelka_indel_vcf",
            "strelka_indel_vcf_index",
            "vardict_vcf",
            "vardict_vcf_index"
        ],
        "nb_inputs": 13,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/vc_caller/somatic_combiner\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "CONPAIR_CONTAMINATION": {
        "name_process": "CONPAIR_CONTAMINATION",
        "string_process": "\nprocess CONPAIR_CONTAMINATION { \n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/conpair\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(normal_file), path(tumor_file), path(normal_file_index), path(tumor_file_index) \n\t\tpath reference_genome\n\n\toutput:\n\t\tpath \"*_stats.txt\", emit: conpair_info\n\n\tshell:\n\t'''\n\tMARKER_FILE_BED=\"/usr/src/conpair/conpair/markers/GRCh38.autosomes.phase3_shapeit2_mvncall_integrated.20130502.SNV.genotype.sselect_v4_MAF_0.4_LD_0.8.liftover.bed\"\n\tsed -e 's/chr//g' $MARKER_FILE_BED > markers_GRCh38_snv_formatted.bed  ### rename chromosomes\n\n\tMARKER_FILE_TXT=\"/usr/src/conpair/conpair/markers/GRCh38.autosomes.phase3_shapeit2_mvncall_integrated.20130502.SNV.genotype.sselect_v4_MAF_0.4_LD_0.8.liftover.txt\"\n\tsed -e 's/chr//g' $MARKER_FILE_TXT > markers_GRCh38_snv_formatted.txt  ### rename chromosomes\n\n\trun_gatk_pileup_for_sample.py -B !{tumor_file} -O tumor_pileup --reference !{reference_genome[0]} --conpair_dir /usr/src/conpair/ --markers markers_GRCh38_snv_formatted.bed\n\trun_gatk_pileup_for_sample.py -B !{normal_file} -O normal_pileup --reference !{reference_genome[0]} --conpair_dir /usr/src/conpair/ --markers markers_GRCh38_snv_formatted.bed\n\n\tverify_concordance.py -T tumor_pileup -N normal_pileup --markers markers_GRCh38_snv_formatted.txt --outfile !{sample_id}_concordance_stats.txt\n\n\testimate_tumor_normal_contamination.py -T tumor_pileup -N normal_pileup --markers markers_GRCh38_snv_formatted.txt --outfile !{sample_id}_contamination_stats.txt\n\t'''\n}",
        "nb_lignes_process": 26,
        "string_script": "\t'''\n\tMARKER_FILE_BED=\"/usr/src/conpair/conpair/markers/GRCh38.autosomes.phase3_shapeit2_mvncall_integrated.20130502.SNV.genotype.sselect_v4_MAF_0.4_LD_0.8.liftover.bed\"\n\tsed -e 's/chr//g' $MARKER_FILE_BED > markers_GRCh38_snv_formatted.bed  ### rename chromosomes\n\n\tMARKER_FILE_TXT=\"/usr/src/conpair/conpair/markers/GRCh38.autosomes.phase3_shapeit2_mvncall_integrated.20130502.SNV.genotype.sselect_v4_MAF_0.4_LD_0.8.liftover.txt\"\n\tsed -e 's/chr//g' $MARKER_FILE_TXT > markers_GRCh38_snv_formatted.txt  ### rename chromosomes\n\n\trun_gatk_pileup_for_sample.py -B !{tumor_file} -O tumor_pileup --reference !{reference_genome[0]} --conpair_dir /usr/src/conpair/ --markers markers_GRCh38_snv_formatted.bed\n\trun_gatk_pileup_for_sample.py -B !{normal_file} -O normal_pileup --reference !{reference_genome[0]} --conpair_dir /usr/src/conpair/ --markers markers_GRCh38_snv_formatted.bed\n\n\tverify_concordance.py -T tumor_pileup -N normal_pileup --markers markers_GRCh38_snv_formatted.txt --outfile !{sample_id}_concordance_stats.txt\n\n\testimate_tumor_normal_contamination.py -T tumor_pileup -N normal_pileup --markers markers_GRCh38_snv_formatted.txt --outfile !{sample_id}_contamination_stats.txt\n\t'''",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sample_id",
            "normal_file",
            "tumor_file",
            "normal_file_index",
            "tumor_file_index",
            "reference_genome"
        ],
        "nb_inputs": 6,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/conpair\", mode: 'copy', saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "VARIANT_CALLING_STATS": {
        "name_process": "VARIANT_CALLING_STATS",
        "string_process": "\nprocess VARIANT_CALLING_STATS { \n\tcontainer \"dnavc-pipeline:latest\"\n\ttag \"$sample_id\"\n\tpublishDir \"$params.data_dir/variants_vcf\", mode: \"copy\", overwrite: false, saveAs: { filename -> \"${sample_id}/$filename\" }\n\n\tinput:\n\t\ttuple val(sample_id), path(vcf_file), path(vcf_file_index)\n\t\tval num_threads\n\n\toutput:\n\t\tpath \"*_ADJ_PASS_vcfstats.txt\", emit: vcf_stats\n\n\tshell:\n\t'''\n\tbcftools stats -f ADJ_PASS -s !{sample_id}_normal --threads !{num_threads} !{vcf_file} > !{sample_id}_normal_ADJ_PASS_vcfstats.txt\n\tbcftools stats -f ADJ_PASS -s !{sample_id}_tumor --threads !{num_threads} !{vcf_file} > !{sample_id}_tumor_ADJ_PASS_vcfstats.txt\n\t'''\n}",
        "nb_lignes_process": 17,
        "string_script": "\t'''\n\tbcftools stats -f ADJ_PASS -s !{sample_id}_normal --threads !{num_threads} !{vcf_file} > !{sample_id}_normal_ADJ_PASS_vcfstats.txt\n\tbcftools stats -f ADJ_PASS -s !{sample_id}_tumor --threads !{num_threads} !{vcf_file} > !{sample_id}_tumor_ADJ_PASS_vcfstats.txt\n\t'''",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample_id",
            "vcf_file",
            "vcf_file_index",
            "num_threads"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "container \"dnavc-pipeline:latest\"",
            "tag \"$sample_id\"",
            "publishDir \"$params.data_dir/variants_vcf\", mode: \"copy\", overwrite: false, saveAs: { filename -> \"${sample_id}/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "MERGE_VCF": {
        "name_process": "MERGE_VCF",
        "string_process": "\nprocess MERGE_VCF { \n\tcontainer \"dnavc-pipeline:latest\"\n\tpublishDir \"$params.data_dir/variants_vcf/_all\", mode: \"copy\", overwrite: false\n\n\tinput:\n\t\tpath vcf_files\n\t\tval num_threads\n\n\toutput:\n\t\tpath \"all_samples_vcf_merged.vcf.gz\", emit: vcf_all\n\n\tshell:\n\t'''\n\tbcftools merge -Oz -o all_samples_vcf_merged.vcf.gz --threads !{num_threads} *_somatic_combiner_all.vcf.gz\n\t'''\n}",
        "nb_lignes_process": 15,
        "string_script": "\t'''\n\tbcftools merge -Oz -o all_samples_vcf_merged.vcf.gz --threads !{num_threads} *_somatic_combiner_all.vcf.gz\n\t'''",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf_files",
            "num_threads"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "container \"dnavc-pipeline:latest\"",
            "publishDir \"$params.data_dir/variants_vcf/_all\", mode: \"copy\", overwrite: false"
        ],
        "when": "",
        "stub": ""
    },
    "VARIANT_ANNOTATION": {
        "name_process": "VARIANT_ANNOTATION",
        "string_process": "\nprocess VARIANT_ANNOTATION { \n\tcontainer \"dnavc-pipeline:latest\"\n\tpublishDir \"$params.data_dir/variants_vcf/_all\", mode: \"copy\", overwrite: false\n\n\tinput:\n\t\tpath vcf_all\n\t\tval num_threads\n\n\toutput:\n\t\tpath \"*\"\n\n\tshell:\n\t'''\n\toc module ls -t annotator > oc_databases_version.txt  ### output OpenCRAVAT database versions\n\t\n\toc run -l hg38 -t csv -x --mp !{num_threads} !{vcf_all}\n\t'''\n}",
        "nb_lignes_process": 17,
        "string_script": "\t'''\n\toc module ls -t annotator > oc_databases_version.txt  ### output OpenCRAVAT database versions\n\t\n\toc run -l hg38 -t csv -x --mp !{num_threads} !{vcf_all}\n\t'''",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "ROC"
        ],
        "tools_url": [
            "https://bio.tools/roc"
        ],
        "tools_dico": [
            {
                "name": "ROC",
                "uri": "https://bio.tools/roc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Various functionals of receiver operating characteristic curves.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/ROC.html"
            }
        ],
        "inputs": [
            "vcf_all",
            "num_threads"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "container \"dnavc-pipeline:latest\"",
            "publishDir \"$params.data_dir/variants_vcf/_all\", mode: \"copy\", overwrite: false"
        ],
        "when": "",
        "stub": ""
    },
    "MULTIQC_VCF": {
        "name_process": "MULTIQC_VCF",
        "string_process": "\nprocess MULTIQC_VCF { \n\tcontainer \"dnavc-pipeline:latest\"\n\tpublishDir \"$params.data_dir/quality_reports\", mode: \"copy\"\n\n\tinput:\n\t\tpath stat_files\n\t\tpath conpair_files\n\n\toutput:\n\t\tpath \"*\"\n\n\tshell:\n\t'''\n\tmultiqc -f -o variants_vcf .\n\t'''\n}",
        "nb_lignes_process": 15,
        "string_script": "\t'''\n\tmultiqc -f -o variants_vcf .\n\t'''",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "stat_files",
            "conpair_files"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "loipf__SOMvc-pipeline",
        "directive": [
            "container \"dnavc-pipeline:latest\"",
            "publishDir \"$params.data_dir/quality_reports\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    }
}