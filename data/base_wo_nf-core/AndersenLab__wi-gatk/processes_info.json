{
    "summary": {
        "name_process": "summary",
        "string_process": "\nprocess summary {\n                                                                \n    \n    executor 'local'\n\n    publishDir \"${params.output}\", mode: 'copy'\n    \n    input:\n        tuple val(run), path(\"sample_sheet\")\n\n    output:\n        path(\"sample_sheet.tsv\")\n        path(\"summary.txt\")\n\n    \"\"\"\n        echo '''${log_summary()}''' > summary.txt\n        cat ${sample_sheet} > sample_sheet.tsv\n    \"\"\"\n\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n        echo '''${log_summary()}''' > summary.txt\n        cat ${sample_sheet} > sample_sheet.tsv\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "run"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "executor 'local'",
            "publishDir \"${params.output}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "get_contigs": {
        "name_process": "get_contigs",
        "string_process": "\nprocess get_contigs {\n\n    label 'sm'\n\n    input:\n        tuple strain, path(bam), path(bai)\n\n    output:\n        path(\"contigs.txt\")\n\n    \"\"\"\n        samtools idxstats ${bam} | cut -f 1 | grep -v '*' > contigs.txt\n    \"\"\"\n\n}",
        "nb_lignes_process": 14,
        "string_script": "\"\"\"\n        samtools idxstats ${bam} | cut -f 1 | grep -v '*' > contigs.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam",
            "bai",
            "strain"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "label 'sm'"
        ],
        "when": "",
        "stub": ""
    },
    "call_variants_individual": {
        "name_process": "call_variants_individual",
        "string_process": "\nprocess call_variants_individual {\n\n    label 'md'\n\n    tag { \"${strain}:${region}\" }\n\n    input:\n        tuple strain, path(bam), path(bai), val(region), file(\"ref.fa.gz\"), file(\"ref.fa.gz.fai\"), file(\"ref.dict\"), file(\"ref.fa.ga.gzi\")\n\n    output:\n        tuple strain, path(\"${region}.g.vcf.gz\")\n\n    \"\"\"\n        gatk HaplotypeCaller --java-options \"-Xmx${task.memory.toGiga()}g -Xms1g -XX:ConcGCThreads=${task.cpus}\" \\\\\n            --emit-ref-confidence GVCF \\\\\n            --annotation DepthPerAlleleBySample \\\\\n            --annotation Coverage \\\\\n            --annotation GenotypeSummaries \\\\\n            --annotation TandemRepeat \\\\\n            --annotation StrandBiasBySample \\\\\n            --annotation ChromosomeCounts \\\\\n            --annotation ReadPosRankSumTest \\\\\n            --annotation AS_ReadPosRankSumTest \\\\\n            --annotation AS_QualByDepth \\\\\n            --annotation AS_StrandOddsRatio \\\\\n            --annotation AS_MappingQualityRankSumTest \\\\\n            --annotation DepthPerSampleHC \\\\\n            --annotation-group StandardAnnotation \\\\\n            --annotation-group AS_StandardAnnotation \\\\\n            --annotation-group StandardHCAnnotation \\\\\n            --do-not-run-physical-phasing \\\\\n            -R ref.fa.gz \\\\\n            -I ${bam} \\\\\n            -L ${region} \\\\\n            -O ${region}.g.vcf   \n        bcftools view -O z ${region}.g.vcf > ${region}.g.vcf.gz\n        rm ${region}.g.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 38,
        "string_script": "\"\"\"\n        gatk HaplotypeCaller --java-options \"-Xmx${task.memory.toGiga()}g -Xms1g -XX:ConcGCThreads=${task.cpus}\" \\\\\n            --emit-ref-confidence GVCF \\\\\n            --annotation DepthPerAlleleBySample \\\\\n            --annotation Coverage \\\\\n            --annotation GenotypeSummaries \\\\\n            --annotation TandemRepeat \\\\\n            --annotation StrandBiasBySample \\\\\n            --annotation ChromosomeCounts \\\\\n            --annotation ReadPosRankSumTest \\\\\n            --annotation AS_ReadPosRankSumTest \\\\\n            --annotation AS_QualByDepth \\\\\n            --annotation AS_StrandOddsRatio \\\\\n            --annotation AS_MappingQualityRankSumTest \\\\\n            --annotation DepthPerSampleHC \\\\\n            --annotation-group StandardAnnotation \\\\\n            --annotation-group AS_StandardAnnotation \\\\\n            --annotation-group StandardHCAnnotation \\\\\n            --do-not-run-physical-phasing \\\\\n            -R ref.fa.gz \\\\\n            -I ${bam} \\\\\n            -L ${region} \\\\\n            -O ${region}.g.vcf   \n        bcftools view -O z ${region}.g.vcf > ${region}.g.vcf.gz\n        rm ${region}.g.vcf\n    \"\"\"",
        "nb_lignes_script": 25,
        "language_script": "bash",
        "tools": [
            "GATK",
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "region",
            "bam",
            "bai",
            "strain"
        ],
        "nb_inputs": 4,
        "outputs": [
            "strain"
        ],
        "nb_outputs": 1,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "label 'md'",
            "tag { \"${strain}:${region}\" }"
        ],
        "when": "",
        "stub": ""
    },
    "concat_strain_gvcfs": {
        "name_process": "concat_strain_gvcfs",
        "string_process": "\nprocess concat_strain_gvcfs {\n\n    label 'sm'\n    tag { \"${strain}\" }\n\n    input:\n        tuple strain, path(\"*\"), path(contigs)\n\n    output:\n        tuple path(\"${strain}.g.vcf.gz\"), path(\"${strain}.g.vcf.gz.tbi\")\n\n    \"\"\"\n        awk '{ print \\$0 \".g.vcf.gz\" }' ${contigs} > contig_set.tsv\n        bcftools concat  -O z --file-list contig_set.tsv > ${strain}.g.vcf.gz\n        bcftools index --tbi ${strain}.g.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "\"\"\"\n        awk '{ print \\$0 \".g.vcf.gz\" }' ${contigs} > contig_set.tsv\n        bcftools concat  -O z --file-list contig_set.tsv > ${strain}.g.vcf.gz\n        bcftools index --tbi ${strain}.g.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "contigs",
            "strain"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "label 'sm'",
            "tag { \"${strain}\" }"
        ],
        "when": "",
        "stub": ""
    },
    "import_genomics_db": {
        "name_process": "import_genomics_db",
        "string_process": " process import_genomics_db {\n\n    tag { \"${contig}\" }\n    label 'xl'\n\n    input:\n        tuple path(vcfs), contig, path(sample_map)\n\n    output:\n        tuple val(contig), file(\"${contig}.db\")\n\n    \"\"\"\n        gatk  --java-options \"-Xmx${task.memory.toGiga()-3}g -Xms${task.memory.toGiga()-4}g -XX:ConcGCThreads=${task.cpus}\" \\\\\n            GenomicsDBImport \\\\\n            --genomicsdb-workspace-path ${contig}.db \\\\\n            --batch-size 16 \\\\\n            -L ${contig} \\\\\n            --sample-name-map ${sample_map} \\\\\n            --reader-threads ${task.cpus}\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n        gatk  --java-options \"-Xmx${task.memory.toGiga()-3}g -Xms${task.memory.toGiga()-4}g -XX:ConcGCThreads=${task.cpus}\" \\\\\n            GenomicsDBImport \\\\\n            --genomicsdb-workspace-path ${contig}.db \\\\\n            --batch-size 16 \\\\\n            -L ${contig} \\\\\n            --sample-name-map ${sample_map} \\\\\n            --reader-threads ${task.cpus}\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "vcfs",
            "sample_map"
        ],
        "nb_inputs": 2,
        "outputs": [
            "contig"
        ],
        "nb_outputs": 1,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "tag { \"${contig}\" }",
            "label 'xl'"
        ],
        "when": "",
        "stub": ""
    },
    "genotype_cohort_gvcf_db": {
        "name_process": "genotype_cohort_gvcf_db",
        "string_process": "\nprocess genotype_cohort_gvcf_db {\n                                                        \n\n    tag { \"${contig}\" }\n    label 'xl'\n\n    input:\n        tuple val(contig), file(\"${contig}.db\"), file(\"ref_file\"), file(\"ref_index\"), file(\"ref_dict\"), file(\"ref_gzi\")\n\n    output:\n        tuple file(\"${contig}_cohort_pol.vcf.gz\"), file(\"${contig}_cohort_pol.vcf.gz.csi\")\n\n\n      \n                                                                                       \n      \n\n    \"\"\"\n    cp ${ref_file} ./ref.fa.gz\n    cp ${ref_index} ./ref.fa.gz.fai\n    cp ${ref_dict} ./ref.dict\n    cp ${ref_gzi} ./ref.fa.gz.gzi\n\n        gatk  --java-options \"-Xmx${task.memory.toGiga()}g -Xms1g\" \\\\\n            GenotypeGVCFs \\\\\n            -R ref.fa.gz \\\\\n            -V gendb://${contig}.db \\\\\n            -G StandardAnnotation \\\\\n            -G AS_StandardAnnotation \\\\\n            -G StandardHCAnnotation \\\\\n            -L ${contig} \\\\\n            -O ${contig}_cohort.vcf\n\n        if [ \"${contig}\" == \"${params.mito_name}\" ]\n        then\n            bcftools view -O b ${contig}_cohort.vcf > ${contig}_cohort.bcf\n            bcftools index ${contig}_cohort.bcf\n\n        else\n        \n            bcftools view -O z ${contig}_cohort.vcf | \\\\\n            het_polarization > ${contig}_cohort.bcf\n            bcftools index ${contig}_cohort.bcf\n        \n        fi\n\n        bcftools view -O v --min-af 0.000001 --threads=${task.cpus-1} ${contig}_cohort.bcf | \\\\\n        vcffixup - | \\\\\n        bcftools view -O z > ${contig}_cohort_pol.vcf.gz\n        bcftools index ${contig}_cohort_pol.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 51,
        "string_script": "\"\"\"\n    cp ${ref_file} ./ref.fa.gz\n    cp ${ref_index} ./ref.fa.gz.fai\n    cp ${ref_dict} ./ref.dict\n    cp ${ref_gzi} ./ref.fa.gz.gzi\n\n        gatk  --java-options \"-Xmx${task.memory.toGiga()}g -Xms1g\" \\\\\n            GenotypeGVCFs \\\\\n            -R ref.fa.gz \\\\\n            -V gendb://${contig}.db \\\\\n            -G StandardAnnotation \\\\\n            -G AS_StandardAnnotation \\\\\n            -G StandardHCAnnotation \\\\\n            -L ${contig} \\\\\n            -O ${contig}_cohort.vcf\n\n        if [ \"${contig}\" == \"${params.mito_name}\" ]\n        then\n            bcftools view -O b ${contig}_cohort.vcf > ${contig}_cohort.bcf\n            bcftools index ${contig}_cohort.bcf\n\n        else\n        \n            bcftools view -O z ${contig}_cohort.vcf | \\\\\n            het_polarization > ${contig}_cohort.bcf\n            bcftools index ${contig}_cohort.bcf\n        \n        fi\n\n        bcftools view -O v --min-af 0.000001 --threads=${task.cpus-1} ${contig}_cohort.bcf | \\\\\n        vcffixup - | \\\\\n        bcftools view -O z > ${contig}_cohort_pol.vcf.gz\n        bcftools index ${contig}_cohort_pol.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 33,
        "language_script": "bash",
        "tools": [
            "GATK",
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "contig"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "tag { \"${contig}\" }",
            "label 'xl'"
        ],
        "when": "",
        "stub": ""
    },
    "concatenate_vcf": {
        "name_process": "concatenate_vcf",
        "string_process": "\nprocess concatenate_vcf {\n\n    label 'lg'\n\n    input: \n      path(\"*\")\n\n    output:\n        tuple path(\"WI.raw.vcf.gz\"), path(\"WI.raw.vcf.gz.tbi\"), emit: 'vcf'\n\n    \"\"\"\n        ls *_cohort_pol.vcf.gz > contig_set.tsv\n        bcftools concat  -O z --file-list contig_set.tsv > WI.raw.vcf.gz\n        bcftools index --tbi WI.raw.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "\"\"\"\n        ls *_cohort_pol.vcf.gz > contig_set.tsv\n        bcftools concat  -O z --file-list contig_set.tsv > WI.raw.vcf.gz\n        bcftools index --tbi WI.raw.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "label 'lg'"
        ],
        "when": "",
        "stub": ""
    },
    "soft_filter": {
        "name_process": "soft_filter",
        "string_process": "\nprocess soft_filter {\n\n    publishDir \"${params.output}/variation\", mode: 'copy'\n\n    label 'lg'\n\n    input:\n        tuple path(vcf), path(vcf_index), file(\"ref_file\"), file(\"ref_index\"), file(\"ref_dict\"), file(\"ref_gzi\")\n\n    output:\n        tuple path(\"WI.${date}.soft-filter.vcf.gz\"), path(\"WI.${date}.soft-filter.vcf.gz.csi\"), emit: soft_filter_vcf\n        path \"WI.${date}.soft-filter.vcf.gz.tbi\"\n        path \"WI.${date}.soft-filter.stats.txt\", emit: 'soft_vcf_stats'\n        tuple path(\"WI.${date}.soft-filter.filter_stats.txt\"), path(\"WI.${date}.soft-filter.stats.txt\"), emit: 'soft_report'\n    \n\n    \"\"\"\n    cp ${ref_file} ./ref.fa.gz\n    cp ${ref_index} ./ref.fa.gz.fai\n    cp ${ref_dict} ./ref.dict\n    cp ${ref_gzi} ./ref.fa.gz.gzi\n\n        function cleanup {\n            rm out.vcf.gz\n        }\n        trap cleanup EXIT\n\n        gatk --java-options \"-Xmx${task.memory.toGiga()}g -Xms1g\" \\\\\n            VariantFiltration \\\\\n            -R ref.fa.gz \\\\\n            --variant ${vcf} \\\\\n            --genotype-filter-expression \"DP < ${params.min_depth}\"    --genotype-filter-name \"DP_min_depth\" \\\\\n            --filter-expression \"QUAL < ${params.qual}\"                --filter-name \"QUAL_quality\" \\\\\n            --filter-expression \"FS > ${params.fisherstrand}\"          --filter-name \"FS_fisherstrand\" \\\\\n            --filter-expression \"QD < ${params.quality_by_depth}\"      --filter-name \"QD_quality_by_depth\" \\\\\n            --filter-expression \"SOR > ${params.strand_odds_ratio}\"    --filter-name \"SOR_strand_odds_ratio\" \\\\\n            --genotype-filter-expression \"isHet == 1\"                  --genotype-filter-name \"is_het\" \\\\\n            -O out.vcf\n        \n        bgzip out.vcf\n        bcftools index --tbi out.vcf.gz\n        \n        # Apply high missing and high heterozygosity filters\n        bcftools filter --threads ${task.cpus} --soft-filter='high_missing' --mode + --include 'F_MISSING  <= ${params.high_missing}' out.vcf.gz |\\\\\n        bcftools filter --threads ${task.cpus} --soft-filter='high_heterozygosity' --mode + --include '( COUNT(GT=\"het\") / N_SAMPLES ) <= ${params.high_heterozygosity}' -O z > WI.${date}.soft-filter.vcf.gz\n\n        bcftools index WI.${date}.soft-filter.vcf.gz\n        bcftools index --tbi WI.${date}.soft-filter.vcf.gz\n        bcftools stats --threads ${task.cpus} \\\\\n                       -s- --verbose WI.${date}.soft-filter.vcf.gz > WI.${date}.soft-filter.stats.txt\n\n        {\n            echo -e 'QUAL\\\\tQD\\\\tSOR\\\\tFS\\\\tFILTER';\n            bcftools query -f '%QUAL\\t%INFO/QD\\t%INFO/SOR\\t%INFO/FS\\t%FILTER\\n' WI.${date}.soft-filter.vcf.gz;\n        }     > WI.${date}.soft-filter.filter_stats.txt\n\n    \"\"\"\n}",
        "nb_lignes_process": 57,
        "string_script": "\"\"\"\n    cp ${ref_file} ./ref.fa.gz\n    cp ${ref_index} ./ref.fa.gz.fai\n    cp ${ref_dict} ./ref.dict\n    cp ${ref_gzi} ./ref.fa.gz.gzi\n\n        function cleanup {\n            rm out.vcf.gz\n        }\n        trap cleanup EXIT\n\n        gatk --java-options \"-Xmx${task.memory.toGiga()}g -Xms1g\" \\\\\n            VariantFiltration \\\\\n            -R ref.fa.gz \\\\\n            --variant ${vcf} \\\\\n            --genotype-filter-expression \"DP < ${params.min_depth}\"    --genotype-filter-name \"DP_min_depth\" \\\\\n            --filter-expression \"QUAL < ${params.qual}\"                --filter-name \"QUAL_quality\" \\\\\n            --filter-expression \"FS > ${params.fisherstrand}\"          --filter-name \"FS_fisherstrand\" \\\\\n            --filter-expression \"QD < ${params.quality_by_depth}\"      --filter-name \"QD_quality_by_depth\" \\\\\n            --filter-expression \"SOR > ${params.strand_odds_ratio}\"    --filter-name \"SOR_strand_odds_ratio\" \\\\\n            --genotype-filter-expression \"isHet == 1\"                  --genotype-filter-name \"is_het\" \\\\\n            -O out.vcf\n        \n        bgzip out.vcf\n        bcftools index --tbi out.vcf.gz\n        \n        # Apply high missing and high heterozygosity filters\n        bcftools filter --threads ${task.cpus} --soft-filter='high_missing' --mode + --include 'F_MISSING  <= ${params.high_missing}' out.vcf.gz |\\\\\n        bcftools filter --threads ${task.cpus} --soft-filter='high_heterozygosity' --mode + --include '( COUNT(GT=\"het\") / N_SAMPLES ) <= ${params.high_heterozygosity}' -O z > WI.${date}.soft-filter.vcf.gz\n\n        bcftools index WI.${date}.soft-filter.vcf.gz\n        bcftools index --tbi WI.${date}.soft-filter.vcf.gz\n        bcftools stats --threads ${task.cpus} \\\\\n                       -s- --verbose WI.${date}.soft-filter.vcf.gz > WI.${date}.soft-filter.stats.txt\n\n        {\n            echo -e 'QUAL\\\\tQD\\\\tSOR\\\\tFS\\\\tFILTER';\n            bcftools query -f '%QUAL\\t%INFO/QD\\t%INFO/SOR\\t%INFO/FS\\t%FILTER\\n' WI.${date}.soft-filter.vcf.gz;\n        }     > WI.${date}.soft-filter.filter_stats.txt\n\n    \"\"\"",
        "nb_lignes_script": 40,
        "language_script": "bash",
        "tools": [
            "GOFunction",
            "TRAP",
            "GATK",
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/gofunction",
            "https://bio.tools/trap",
            "https://bio.tools/gatk",
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "GOFunction",
                "uri": "https://bio.tools/gofunction",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3658",
                                    "term": "Statistical inference"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The GO-function package provides a tool to address the redundancy that result from the GO structure or multiple annotation genes and derive biologically relevant functions from the statistically significant functions based on some intuitive assumption and statistical testing.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/GOFunction.html"
            },
            {
                "name": "TRAP",
                "uri": "https://bio.tools/trap",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0157",
                            "term": "Sequence composition, complexity and repeats"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0379",
                                    "term": "Repeat sequence detection"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Program that provides a unified set of analyses for the selection, classification, quantification and automated annotation of tandemly repeated sequences.",
                "homepage": "http://www.coccidia.icb.usp.br/trap/index.html"
            },
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf",
            "vcf_index"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "publishDir \"${params.output}/variation\", mode: 'copy'",
            "label 'lg'"
        ],
        "when": "",
        "stub": ""
    },
    "hard_filter": {
        "name_process": "hard_filter",
        "string_process": "\nprocess hard_filter {\n\n\n    label 'lg'\n\n    publishDir \"${params.output}/variation\", mode: 'copy'\n\n    input:\n        tuple path(vcf), path(vcf_index), path(contigs)\n\n    output:\n        tuple path(\"WI.${date}.hard-filter.vcf.gz\"), path(\"WI.${date}.hard-filter.vcf.gz.csi\"), emit: 'vcf'\n        path \"WI.${date}.hard-filter.vcf.gz.tbi\"\n        path \"WI.${date}.hard-filter.stats.txt\", emit: 'hard_vcf_stats'\n\n\n    \"\"\"\n        function cleanup {\n            # cleanup files on completion\n            rm I.vcf.gz II.vcf.gz III.vcf.gz IV.vcf.gz V.vcf.gz X.vcf.gz MtDNA.vcf.gz\n        }\n        trap cleanup EXIT\n\n        # Generate hard-filtered VCF\n        function generate_hard_filter {\n\n        if [ \\${1} == \"${params.mito_name}\" ]\n\n        then\n            bcftools view -m2 -M2 --trim-alt-alleles -O u --regions \\${1} ${vcf} |\\\\\n            bcftools filter -O u --set-GTs . --exclude 'FORMAT/FT ~ \"DP_min_depth\"' |\\\\\n            bcftools filter -O u --exclude 'FILTER != \"PASS\"' |\\\\\n            bcftools view -O v --min-af 0.000001 --max-af 0.999999 |\\\\\n            vcffixup - | \\\\\n            bcftools view -O z --trim-alt-alleles > \\${1}.vcf.gz\n\n        else\n            bcftools view -m2 -M2 --trim-alt-alleles -O u --regions \\${1} ${vcf} |\\\\\n            bcftools filter -O u --set-GTs . --exclude 'FORMAT/FT ~ \"DP_min_depth\" | FORMAT/FT ~\"is_het\"' |\\\\\n            bcftools filter -O u --exclude 'FILTER != \"PASS\"' |\\\\\n            bcftools view -O v --min-af 0.000001 --max-af 0.999999 |\\\\\n            vcffixup - | \\\\\n            bcftools view -O z --trim-alt-alleles > \\${1}.vcf.gz\n        fi\n\n        }\n\n        export -f generate_hard_filter\n\n        parallel --verbose generate_hard_filter :::: ${contigs}\n\n\n        awk '{ print \\$0 \".vcf.gz\" }' ${contigs} > contig_set.tsv\n        bcftools concat  -O z --file-list contig_set.tsv > WI.${date}.hard-filter.vcf.gz\n\n        bcftools index WI.${date}.hard-filter.vcf.gz\n        bcftools index --tbi WI.${date}.hard-filter.vcf.gz\n        bcftools stats -s- --verbose WI.${date}.hard-filter.vcf.gz > WI.${date}.hard-filter.stats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 59,
        "string_script": "\"\"\"\n        function cleanup {\n            # cleanup files on completion\n            rm I.vcf.gz II.vcf.gz III.vcf.gz IV.vcf.gz V.vcf.gz X.vcf.gz MtDNA.vcf.gz\n        }\n        trap cleanup EXIT\n\n        # Generate hard-filtered VCF\n        function generate_hard_filter {\n\n        if [ \\${1} == \"${params.mito_name}\" ]\n\n        then\n            bcftools view -m2 -M2 --trim-alt-alleles -O u --regions \\${1} ${vcf} |\\\\\n            bcftools filter -O u --set-GTs . --exclude 'FORMAT/FT ~ \"DP_min_depth\"' |\\\\\n            bcftools filter -O u --exclude 'FILTER != \"PASS\"' |\\\\\n            bcftools view -O v --min-af 0.000001 --max-af 0.999999 |\\\\\n            vcffixup - | \\\\\n            bcftools view -O z --trim-alt-alleles > \\${1}.vcf.gz\n\n        else\n            bcftools view -m2 -M2 --trim-alt-alleles -O u --regions \\${1} ${vcf} |\\\\\n            bcftools filter -O u --set-GTs . --exclude 'FORMAT/FT ~ \"DP_min_depth\" | FORMAT/FT ~\"is_het\"' |\\\\\n            bcftools filter -O u --exclude 'FILTER != \"PASS\"' |\\\\\n            bcftools view -O v --min-af 0.000001 --max-af 0.999999 |\\\\\n            vcffixup - | \\\\\n            bcftools view -O z --trim-alt-alleles > \\${1}.vcf.gz\n        fi\n\n        }\n\n        export -f generate_hard_filter\n\n        parallel --verbose generate_hard_filter :::: ${contigs}\n\n\n        awk '{ print \\$0 \".vcf.gz\" }' ${contigs} > contig_set.tsv\n        bcftools concat  -O z --file-list contig_set.tsv > WI.${date}.hard-filter.vcf.gz\n\n        bcftools index WI.${date}.hard-filter.vcf.gz\n        bcftools index --tbi WI.${date}.hard-filter.vcf.gz\n        bcftools stats -s- --verbose WI.${date}.hard-filter.vcf.gz > WI.${date}.hard-filter.stats.txt\n    \"\"\"",
        "nb_lignes_script": 42,
        "language_script": "bash",
        "tools": [
            "GOFunction",
            "TRAP",
            "BCFtools",
            "FTG",
            "parallelGWAS"
        ],
        "tools_url": [
            "https://bio.tools/gofunction",
            "https://bio.tools/trap",
            "https://bio.tools/bcftools",
            "https://bio.tools/ftg",
            "https://bio.tools/parallelgwas"
        ],
        "tools_dico": [
            {
                "name": "GOFunction",
                "uri": "https://bio.tools/gofunction",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3658",
                                    "term": "Statistical inference"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The GO-function package provides a tool to address the redundancy that result from the GO structure or multiple annotation genes and derive biologically relevant functions from the statistically significant functions based on some intuitive assumption and statistical testing.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/GOFunction.html"
            },
            {
                "name": "TRAP",
                "uri": "https://bio.tools/trap",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0157",
                            "term": "Sequence composition, complexity and repeats"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0379",
                                    "term": "Repeat sequence detection"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Program that provides a unified set of analyses for the selection, classification, quantification and automated annotation of tandemly repeated sequences.",
                "homepage": "http://www.coccidia.icb.usp.br/trap/index.html"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "FTG",
                "uri": "https://bio.tools/ftg",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2454",
                                    "term": "Gene prediction"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2454",
                                    "term": "Gene finding"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2454",
                                    "term": "Gene calling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Web server for locating probable protein coding region in nucleotide sequence using fourier tranform approach.",
                "homepage": "http://www.imtech.res.in/raghava/ftg/"
            },
            {
                "name": "parallelGWAS",
                "uri": "https://bio.tools/parallelgwas",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype reconstruction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype map generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype inference"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Developing parallel computing tools for genome-wide association studies.",
                "homepage": "https://en.osdn.jp/projects/parallelgwas/"
            }
        ],
        "inputs": [
            "vcf",
            "vcf_index",
            "contigs"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "label 'lg'",
            "publishDir \"${params.output}/variation\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc_report": {
        "name_process": "multiqc_report",
        "string_process": "\nprocess multiqc_report {\n\n    publishDir \"${params.output}/report\", mode: 'copy'\n\n    input:\n        path(\"*\")\n\n    output:\n        file(\"multiqc_data/*.json\")\n        path \"multiqc.html\", emit: \"for_report\"\n\n    \"\"\"\n        multiqc -k json --filename multiqc.html .\n    \"\"\"\n\n}",
        "nb_lignes_process": 15,
        "string_script": "\"\"\"\n        multiqc -k json --filename multiqc.html .\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "publishDir \"${params.output}/report\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "html_report": {
        "name_process": "html_report",
        "string_process": "\nprocess html_report {\n\n    container 'andersenlab/r_packages:latest'\n\n    publishDir \"${params.output}\", mode: 'copy'\n\n    input:\n        tuple path(\"multiqc.html\"), path(\"soft_filter_filter\"), path(\"soft_filter_stats\"), path(\"hard_filter_stats\")\n\n    output:\n        file(\"*.html\")\n\n    \"\"\"\n    cat \"${workflow.projectDir}/bin/gatk_report.Rmd\" | \\\\\n        sed -e 's/RELEASE_DATE/${date}/g' |\n        sed -e 's+variation/WI.{vcf_date}.soft-filter.stats.txt+${soft_filter_stats}+g' |\n        sed -e 's+variation/WI.{vcf_date}.hard-filter.stats.txt+${hard_filter_stats}+g' |\n        sed -e 's+variation/WI.{vcf_date}.soft-filter.filter_stats.txt+${soft_filter_filter}+g' > gatk_report_${date}.Rmd\n    Rscript -e \"rmarkdown::render('gatk_report_${date}.Rmd')\"\n        \n    \"\"\"\n\n}",
        "nb_lignes_process": 22,
        "string_script": "\"\"\"\n    cat \"${workflow.projectDir}/bin/gatk_report.Rmd\" | \\\\\n        sed -e 's/RELEASE_DATE/${date}/g' |\n        sed -e 's+variation/WI.{vcf_date}.soft-filter.stats.txt+${soft_filter_stats}+g' |\n        sed -e 's+variation/WI.{vcf_date}.hard-filter.stats.txt+${hard_filter_stats}+g' |\n        sed -e 's+variation/WI.{vcf_date}.soft-filter.filter_stats.txt+${soft_filter_filter}+g' > gatk_report_${date}.Rmd\n    Rscript -e \"rmarkdown::render('gatk_report_${date}.Rmd')\"\n        \n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "AndersenLab__wi-gatk",
        "directive": [
            "container 'andersenlab/r_packages:latest'",
            "publishDir \"${params.output}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}