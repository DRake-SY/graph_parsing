{
    "trim_reads": {
        "name_process": "trim_reads",
        "string_process": "\nprocess trim_reads {\n\n   cpus large_core\n   tag { id }\n   publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.html'\n   publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.json'\n\n   input:\n       tuple val(id), file(reads) from fqs\n\n   output:\n       tuple id_out, file(\"${id_out}.fq.gz\") into trimmed_fqs\n       tuple file(\"*.html\"), file(\"*.json\")  into trim_log\n\n  script:\n      id_out = id.replace('.fastq.gz', '')\n\n   \"\"\"\n       fastp -i $reads -o ${id_out}.fq.gz -y -l 15 -h ${id_out}.html -j ${id_out}.json\n   \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "      id_out = id.replace('.fastq.gz', '')\n\n   \"\"\"\n       fastp -i $reads -o ${id_out}.fq.gz -y -l 15 -h ${id_out}.html -j ${id_out}.json\n   \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "fastPHASE"
        ],
        "tools_url": [
            "https://bio.tools/fastphase"
        ],
        "tools_dico": [
            {
                "name": "fastPHASE",
                "uri": "https://bio.tools/fastphase",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3454",
                                    "term": "Phasing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "fastPHASE is a program to estimate missing genotypes and unobserved haplotypes. It is an implementation of the model described in Scheet & Stephens (2006). This is a cluster-based model for haplotype variation, and gains its utility from implicitly modeling the genealogy of chromosomes in a random sample from a population as a tree but summarizing all haplotype variation in the \"tips\" of the trees.",
                "homepage": "http://scheet.org/software.html"
            }
        ],
        "inputs": [
            "fqs"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trimmed_fqs",
            "trim_log"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus large_core",
            "tag { id }",
            "publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.html'",
            "publishDir \"${output}/trim_stats/\", mode: 'copy', pattern: '*.json'"
        ],
        "when": "",
        "stub": ""
    },
    "fetch_ref": {
        "name_process": "fetch_ref",
        "string_process": "\nprocess fetch_ref {\n\n    publishDir \"${genome}/reference/\", mode: 'copy'\n\n    output:\n        file(\"reference.fa\") into reference_fa\n\n    \"\"\"\n        echo '${genome_url}'\n        wget ${genome_url} -O reference.fa\n        echo '${annot_url}'\n        wget ${annot_url} -O geneset.gff\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        echo '${genome_url}'\n        wget ${genome_url} -O reference.fa\n        echo '${annot_url}'\n        wget ${annot_url} -O geneset.gff\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "reference_fa"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${genome}/reference/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "build_bwa_index": {
        "name_process": "build_bwa_index",
        "string_process": "\nprocess build_bwa_index {\n\n    cpus huge\n\n    input:\n        file(\"reference.fa\") from bwa_index\n\n    output:\n        file \"reference.*\" into bwa_indices\n\n    \"\"\"\n        bwa index reference.fa\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        bwa index reference.fa\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "bwa_index"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bwa_indices"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus huge"
        ],
        "when": "",
        "stub": ""
    },
    "bwa_align": {
        "name_process": "bwa_align",
        "string_process": "\nprocess bwa_align {\n    publishDir \"${output}/bwa_stats/\", mode: 'copy', pattern: '*align_.txt'\n    publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam'\n    publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam.bai'\n\n    cpus large_core\n    tag { id }\n\n    input:\n        tuple val(id), file(reads) from trimmed_reads_bwa\n        file bwa_indices from bwa_indices.first()\n\n    output:\n        file(\"${id}_align.txt\") into bwa_stats\n        file(\"${id}.bam\") into bam_files\n        file(\"${id}.bam.bai\") into bam_indexes\n\n    script:\n        fa_prefix = reads[0].toString() - ~/(_trim)(\\.fq\\.gz)$/\n        index_base = bwa_indices[0].toString() - ~/.fa[.a-z]*/\n\n        \"\"\"\n        bwa aln -o 0 -n 0 -t ${large_core} ${index_base}.fa ${reads} > ${id}.sai\n        bwa samse ${index_base}.fa ${id}.sai ${reads} > ${id}.sam\n        samtools view -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${large_core} -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -b ${id}.bam\n        samtools flagstat ${id}.bam > ${id}_align.txt\n        \"\"\"\n}",
        "nb_lignes_process": 32,
        "string_script": "        fa_prefix = reads[0].toString() - ~/(_trim)(\\.fq\\.gz)$/\n        index_base = bwa_indices[0].toString() - ~/.fa[.a-z]*/\n\n        \"\"\"\n        bwa aln -o 0 -n 0 -t ${large_core} ${index_base}.fa ${reads} > ${id}.sai\n        bwa samse ${index_base}.fa ${id}.sai ${reads} > ${id}.sam\n        samtools view -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${large_core} -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -b ${id}.bam\n        samtools flagstat ${id}.bam > ${id}_align.txt\n        \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "trimmed_reads_bwa",
            "bwa_indices"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bwa_stats",
            "bam_files",
            "bam_indexes"
        ],
        "nb_outputs": 3,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/bwa_stats/\", mode: 'copy', pattern: '*align_.txt'",
            "publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam'",
            "publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam.bai'",
            "cpus large_core",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "fetch_ref_virus": {
        "name_process": "fetch_ref_virus",
        "string_process": "\nprocess fetch_ref_virus {\n\n    publishDir \"${genome}/viral/\", mode: 'copy'\n\n    output:\n        tuple file(\"Ae_flavivirus_mo.fa\"),file(\"Ae_flavivirus_bangkok.fa\") into reference_fa_virus\n\n    \"\"\"\n        wget ${flavi_mo_url} -O Ae_flavivirus_mo.fa\n        wget ${flavi_bangkok_url} -O Ae_flavivirus_bangkok.fa\n    \"\"\"\n}",
        "nb_lignes_process": 11,
        "string_script": "\"\"\"\n        wget ${flavi_mo_url} -O Ae_flavivirus_mo.fa\n        wget ${flavi_bangkok_url} -O Ae_flavivirus_bangkok.fa\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "reference_fa_virus"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${genome}/viral/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "build_bwa_index_virus": {
        "name_process": "build_bwa_index_virus",
        "string_process": "\nprocess build_bwa_index_virus {\n\n    cpus huge\n\n    input:\n        tuple file(\"Ae_flavivirus_mo.fa\"),file(\"Ae_flavivirus_bangkok.fa\") from bwa_index_virus\n\n    output:\n        file \"Ae_flavivirus_mo.*\" into bwa_indices_mo\n        file \"Ae_flavivirus_bangkok.*\" into bwa_indices_bangkok\n\n    \"\"\"\n        bwa index Ae_flavivirus_mo.fa\n        bwa index Ae_flavivirus_bangkok.fa\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "\"\"\"\n        bwa index Ae_flavivirus_mo.fa\n        bwa index Ae_flavivirus_bangkok.fa\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "bwa_index_virus"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bwa_indices_mo",
            "bwa_indices_bangkok"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus huge"
        ],
        "when": "",
        "stub": ""
    },
    "bwa_align_mo": {
        "name_process": "bwa_align_mo",
        "string_process": "\nprocess bwa_align_mo {\n    publishDir \"${output}/${params.dir}/bwa_stats_mo/\", mode: 'copy', pattern: '*.flagstat.txt'\n    publishDir \"${output}/${params.dir}/bams_mo\", mode: 'copy', pattern: '*.bam'\n    publishDir \"${output}/${params.dir}/bams_mo\", mode: 'copy', pattern: '*.bam.bai'\n\n    cpus big\n    tag { id }\n\n    input:\n        tuple val(id), file(reads) from trimmed_reads_bwa_mo\n        file bwa_indices from bwa_indices_mo.first()\n\n    output:\n        file(\"${id}.flagstat.txt\") into bwa_stats_mo\n        file(\"${id}.bam\") into bam_files_mo\n        file(\"${id}.bam.bai\") into bam_indexes_mo\n\n    script:\n        index_base = bwa_indices[0].toString() - ~/.fa[.a-z]*/\n\n        \"\"\"\n        bwa aln -o 0 -n 0 -t ${task.cpus} ${index_base}.fa ${reads} > ${id}.sai\n        bwa samse ${index_base}.fa ${id}.sai ${reads} > ${id}.sam\n        samtools view -@ ${task.cpus} -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${task.cpus} -m 8G -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -@ ${task.cpus} -b ${id}.bam\n        samtools flagstat ${id}.bam > ${id}.flagstat.txt\n        \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "        index_base = bwa_indices[0].toString() - ~/.fa[.a-z]*/\n\n        \"\"\"\n        bwa aln -o 0 -n 0 -t ${task.cpus} ${index_base}.fa ${reads} > ${id}.sai\n        bwa samse ${index_base}.fa ${id}.sai ${reads} > ${id}.sam\n        samtools view -@ ${task.cpus} -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${task.cpus} -m 8G -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -@ ${task.cpus} -b ${id}.bam\n        samtools flagstat ${id}.bam > ${id}.flagstat.txt\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "trimmed_reads_bwa_mo",
            "bwa_indices_mo"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bwa_stats_mo",
            "bam_files_mo",
            "bam_indexes_mo"
        ],
        "nb_outputs": 3,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/bwa_stats_mo/\", mode: 'copy', pattern: '*.flagstat.txt'",
            "publishDir \"${output}/${params.dir}/bams_mo\", mode: 'copy', pattern: '*.bam'",
            "publishDir \"${output}/${params.dir}/bams_mo\", mode: 'copy', pattern: '*.bam.bai'",
            "cpus big",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "bwa_align_bangkok": {
        "name_process": "bwa_align_bangkok",
        "string_process": "\nprocess bwa_align_bangkok {\n    publishDir \"${output}/${params.dir}/bwa_stats_bangkok/\", mode: 'copy', pattern: '*.flagstat.txt'\n    publishDir \"${output}/${params.dir}/bams_bangkok\", mode: 'copy', pattern: '*.bam'\n    publishDir \"${output}/${params.dir}/bams_bangkok\", mode: 'copy', pattern: '*.bam.bai'\n\n    cpus big\n    tag { id }\n\n    input:\n        tuple val(id), file(reads) from trimmed_reads_bwa_bangkok\n        file bwa_indices from bwa_indices_bangkok.first()\n\n    output:\n        file(\"${id}.flagstat.txt\") into bwa_stats_bangkok\n        file(\"${id}.bam\") into bam_files_bangkok\n        file(\"${id}.bam.bai\") into bam_indexes_bangkok\n\n    script:\n        index_base = bwa_indices[0].toString() - ~/.fa[.a-z]*/\n\n        \"\"\"\n        bwa aln -o 0 -n 0 -t ${task.cpus} ${index_base}.fa ${reads} > ${id}.sai\n        bwa samse ${index_base}.fa ${id}.sai ${reads} > ${id}.sam\n        samtools view -@ ${task.cpus} -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${task.cpus} -m 8G -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -@ ${task.cpus} -b ${id}.bam\n        samtools flagstat ${id}.bam > ${id}.flagstat.txt\n        \"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "        index_base = bwa_indices[0].toString() - ~/.fa[.a-z]*/\n\n        \"\"\"\n        bwa aln -o 0 -n 0 -t ${task.cpus} ${index_base}.fa ${reads} > ${id}.sai\n        bwa samse ${index_base}.fa ${id}.sai ${reads} > ${id}.sam\n        samtools view -@ ${task.cpus} -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${task.cpus} -m 8G -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -@ ${task.cpus} -b ${id}.bam\n        samtools flagstat ${id}.bam > ${id}.flagstat.txt\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "trimmed_reads_bwa_bangkok",
            "bwa_indices_bangkok"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bwa_stats_bangkok",
            "bam_files_bangkok",
            "bam_indexes_bangkok"
        ],
        "nb_outputs": 3,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/bwa_stats_bangkok/\", mode: 'copy', pattern: '*.flagstat.txt'",
            "publishDir \"${output}/${params.dir}/bams_bangkok\", mode: 'copy', pattern: '*.bam'",
            "publishDir \"${output}/${params.dir}/bams_bangkok\", mode: 'copy', pattern: '*.bam.bai'",
            "cpus big",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "mirDeep2_mapper": {
        "name_process": "mirDeep2_mapper",
        "string_process": "\nprocess mirDeep2_mapper {\n\n    cpus small_core\n    tag { id }\n\n    input:\n        tuple val(id), file(reads) from trimmed_reads_mirdeep\n        file bowtie2_indices from bowtie2_indices\n\n    output:\n        file(\"${id}_map.arf\") into reads_vs_genome_arf\n        tuple val(id), file(\"${id}_collapsed.fa\") into reads_collapsed\n\n    script:\n        index_base = bowtie2_indices[0].toString() - ~/./\n\n      \"\"\"\n        zcat ${reads} > ${id}.fa\n        mapper.pl ${id}.fa -e -h -j -l 18 -m -p ${index_base} -s ${id}_collapsed.fa -t ${id}_map.arf -v\n      \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "        index_base = bowtie2_indices[0].toString() - ~/./\n\n      \"\"\"\n        zcat ${reads} > ${id}.fa\n        mapper.pl ${id}.fa -e -h -j -l 18 -m -p ${index_base} -s ${id}_collapsed.fa -t ${id}_map.arf -v\n      \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "trimmed_reads_mirdeep",
            "bowtie2_indices"
        ],
        "nb_inputs": 2,
        "outputs": [
            "reads_vs_genome_arf",
            "reads_collapsed"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus small_core",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "mirDeep2_quantifier": {
        "name_process": "mirDeep2_quantifier",
        "string_process": "\nprocess mirDeep2_quantifier {\n\n    publishDir \"${output}/quantifier/${id}/\", mode: 'copy'\n\n    cpus large_core\n    tag { id }\n\n    input:\n        tuple val(id), file(collapsed_reads) from reads_collapsed_Q\n\n    output:\n        file \"*\" into quantifier_out\n\n    \"\"\"\n        quantifier.pl -p ${aae_prec} -m ${aae_mature} -r ${collapsed_reads} -y now\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "\"\"\"\n        quantifier.pl -p ${aae_prec} -m ${aae_mature} -r ${collapsed_reads} -y now\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "reads_collapsed_Q"
        ],
        "nb_inputs": 1,
        "outputs": [
            "quantifier_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/quantifier/${id}/\", mode: 'copy'",
            "cpus large_core",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "mirDeep2_pl": {
        "name_process": "mirDeep2_pl",
        "string_process": "\nprocess mirDeep2_pl {\n\n    cpus large_core\n    tag { id }\n\n    input:\n        tuple val(id), file(collapsed_reads) from reads_collapsed_M\n        file reads_vs_genome_arf from reads_vs_genome_arf\n        file(\"genome.fa\") from genome_fa\n\n        \"\"\"\n        cat genome.fa | awk '{print \\$1}' > genome_clean.fa\n        miRDeep2.pl ${collapsed_reads} genome_clean.fa ${reads_vs_genome_arf} ${aae_mature} none ${aae_prec} -P\n        \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "\"\"\"\n        cat genome.fa | awk '{print \\$1}' > genome_clean.fa\n        miRDeep2.pl ${collapsed_reads} genome_clean.fa ${reads_vs_genome_arf} ${aae_mature} none ${aae_prec} -P\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "reads_collapsed_M",
            "reads_vs_genome_arf",
            "genome_fa"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus large_core",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "fetch_genome": {
        "name_process": "fetch_genome",
        "string_process": "\nprocess fetch_genome {\n\n    cpus small\n\n    output:\n        file(\"geneset.gtf.gz\") into geneset_gtf\n        file(\"reference.fa.gz\") into reference_fa\n\n    script:\n\n        prefix=\"ftp://ftp.ebi.ac.uk/pub/databases/wormbase/parasite/releases/${params.release}/species/${params.species}/${params.prjn}\"\n\n    \"\"\"\n        echo '${prefix}'\n        wget -c ${prefix}/${params.species}.${params.prjn}.${params.release}.canonical_geneset.gtf.gz -O geneset.gtf.gz\n        wget -c ${prefix}/${params.species}.${params.prjn}.${params.release}.genomic.fa.gz -O reference.fa.gz\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "        prefix=\"ftp://ftp.ebi.ac.uk/pub/databases/wormbase/parasite/releases/${params.release}/species/${params.species}/${params.prjn}\"\n\n    \"\"\"\n        echo '${prefix}'\n        wget -c ${prefix}/${params.species}.${params.prjn}.${params.release}.canonical_geneset.gtf.gz -O geneset.gtf.gz\n        wget -c ${prefix}/${params.species}.${params.prjn}.${params.release}.genomic.fa.gz -O reference.fa.gz\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "geneset_gtf",
            "reference_fa"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus small"
        ],
        "when": "",
        "stub": ""
    },
    "star_index": {
        "name_process": "star_index",
        "string_process": "\nprocess star_index {\n\n    cpus big\n\n    when:\n      params.star\n\n    input:\n        file(\"geneset.gtf.gz\") from geneset_star\n        file(\"reference.fa.gz\") from reference_star\n\n    output:\n        file(\"STAR_index/*\") into star_indices\n\n    script:\n        overhang = params.rlen - 1\n\n    \"\"\"\n        zcat reference.fa.gz > reference.fa\n        zcat geneset.gtf.gz > geneset.gtf\n        mkdir STAR_index\n\n        STAR --runThreadN ${task.cpus} --runMode genomeGenerate  --genomeDir STAR_index \\\n          --genomeFastaFiles reference.fa \\\n          --sjdbGTFfile geneset.gtf \\\n          --sjdbOverhang ${overhang}\n    \"\"\"\n\n}",
        "nb_lignes_process": 28,
        "string_script": "        overhang = params.rlen - 1\n\n    \"\"\"\n        zcat reference.fa.gz > reference.fa\n        zcat geneset.gtf.gz > geneset.gtf\n        mkdir STAR_index\n\n        STAR --runThreadN ${task.cpus} --runMode genomeGenerate  --genomeDir STAR_index \\\n          --genomeFastaFiles reference.fa \\\n          --sjdbGTFfile geneset.gtf \\\n          --sjdbOverhang ${overhang}\n    \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "STAR"
        ],
        "tools_url": [
            "https://bio.tools/star"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            }
        ],
        "inputs": [
            "geneset_star",
            "reference_star"
        ],
        "nb_inputs": 2,
        "outputs": [
            "star_indices"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus big"
        ],
        "when": "params.star",
        "stub": ""
    },
    "star_align": {
        "name_process": "star_align",
        "string_process": "\nprocess star_align {\n\n    publishDir \"${output}/${params.dir}/star\", mode: 'copy', pattern: '*.Log.final.out'\n    publishDir \"${output}/${params.dir}/star\", mode: 'copy', pattern: '*.flagstat.txt'\n    publishDir \"${output}/${params.dir}/counts\", mode: 'copy', pattern: '*.ReadsPerGene.tab'\n                                                                               \n                                                                                   \n\n    cpus big\n    tag { id }\n    maxForks 6\n\n    when:\n      params.star\n\n    input:\n        file(\"STAR_index/*\") from star_indices\n        tuple val(id), file(forward), file(reverse) from trimmed_reads_star\n\n    output:\n        tuple file(\"${id}.Log.final.out\"), file(\"${id}.flagstat.txt\") into alignment_logs_star\n        tuple id, file(\"${id}.bam\"), file(\"${id}.bam.bai\") into bam_files_star\n        file(\"${id}.ReadsPerGene.tab\") into star_counts\n\n    script:\n\n        \"\"\"\n          STAR --runThreadN ${task.cpus} --runMode alignReads --genomeDir STAR_index\\\n            --outSAMtype BAM Unsorted --readFilesCommand zcat \\\n            --outFileNamePrefix ${id}. --readFilesIn ${forward} ${reverse}\\\n            --peOverlapNbasesMin 10 \\\n            --quantMode GeneCounts --outSAMattrRGline ID:${id}\n          samtools sort -@ ${task.cpus} -m 24G -o ${id}.bam ${id}.Aligned.out.bam\n          rm *.Aligned.out.bam\n          samtools index -@ ${task.cpus} -b ${id}.bam\n          samtools flagstat ${id}.bam > ${id}.flagstat.txt\n          cat ${id}.ReadsPerGene.out.tab | cut -f 1,2 > ${id}.ReadsPerGene.tab\n        \"\"\"\n                \n}",
        "nb_lignes_process": 39,
        "string_script": "        \"\"\"\n          STAR --runThreadN ${task.cpus} --runMode alignReads --genomeDir STAR_index\\\n            --outSAMtype BAM Unsorted --readFilesCommand zcat \\\n            --outFileNamePrefix ${id}. --readFilesIn ${forward} ${reverse}\\\n            --peOverlapNbasesMin 10 \\\n            --quantMode GeneCounts --outSAMattrRGline ID:${id}\n          samtools sort -@ ${task.cpus} -m 24G -o ${id}.bam ${id}.Aligned.out.bam\n          rm *.Aligned.out.bam\n          samtools index -@ ${task.cpus} -b ${id}.bam\n          samtools flagstat ${id}.bam > ${id}.flagstat.txt\n          cat ${id}.ReadsPerGene.out.tab | cut -f 1,2 > ${id}.ReadsPerGene.tab\n        \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "STAR",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/star",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "star_indices",
            "trimmed_reads_star"
        ],
        "nb_inputs": 2,
        "outputs": [
            "alignment_logs_star",
            "bam_files_star",
            "star_counts"
        ],
        "nb_outputs": 3,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/star\", mode: 'copy', pattern: '*.Log.final.out'",
            "publishDir \"${output}/${params.dir}/star\", mode: 'copy', pattern: '*.flagstat.txt'",
            "publishDir \"${output}/${params.dir}/counts\", mode: 'copy', pattern: '*.ReadsPerGene.tab'",
            "cpus big",
            "tag { id }",
            "maxForks 6"
        ],
        "when": "params.star",
        "stub": ""
    },
    "hisat_index": {
        "name_process": "hisat_index",
        "string_process": "\nprocess hisat_index {\n\n    cpus big\n\n    when:\n      params.hisat\n\n    input:\n        file(\"geneset.gtf.gz\") from geneset_hisat\n        file(\"reference.fa.gz\") from reference_hisat\n\n    output:\n        file \"*.ht2\" into hs2_indices\n\n    \"\"\"\n        zcat geneset.gtf.gz | python ${extract_splice} - > splice.ss\n        zcat geneset.gtf.gz | python ${extract_exons} - > exon.exon\n        zcat reference.fa.gz > reference.fa\n        hisat2-build -p ${task.cpus} --ss splice.ss --exon exon.exon reference.fa reference.hisat2_index\n    \"\"\"\n\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n        zcat geneset.gtf.gz | python ${extract_splice} - > splice.ss\n        zcat geneset.gtf.gz | python ${extract_exons} - > exon.exon\n        zcat reference.fa.gz > reference.fa\n        hisat2-build -p ${task.cpus} --ss splice.ss --exon exon.exon reference.fa reference.hisat2_index\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "geneset_hisat",
            "reference_hisat"
        ],
        "nb_inputs": 2,
        "outputs": [
            "hs2_indices"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus big"
        ],
        "when": "params.hisat",
        "stub": ""
    },
    "hisat_align": {
        "name_process": "hisat_align",
        "string_process": "\nprocess hisat_align {\n\n    publishDir \"${output}/${params.dir}/hisat\", mode: 'copy', pattern: '*.hisat2_log.txt'\n    publishDir \"${output}/${params.dir}/hisat\", mode: 'copy', pattern: '*.flagstat.txt'\n    publishDir \"${output}/${params.dir}/bams\", mode: 'copy', pattern: '*.bam'\n    publishDir \"${output}/${params.dir}/bams\", mode: 'copy', pattern: '*.bam.bai'\n\n    cpus big\n    tag { id }\n    maxForks 5\n\n    when:\n      params.hisat\n\n    input:\n        tuple val(id), file(forward), file(reverse) from trimmed_reads_hisat\n        file hs2_indices from hs2_indices.first()\n\n    output:\n        tuple file(\"${id}.hisat2_log.txt\"),file(\"${id}.flagstat.txt\") into alignment_logs_hisat\n        tuple id, file(\"${id}.bam\"), file(\"${id}.bam.bai\") into bam_files_hisat\n\n    script:\n        index_base = hs2_indices[0].toString() - ~/.\\d.ht2/\n\n        \"\"\"\n          hisat2 -p ${task.cpus} -x $index_base -1 ${forward} -2 ${reverse} --rg-id \"${id}\" --rg \"SM:${id}\" --rg \"PL:ILLUMINA\" --summary-file ${id}.hisat2_log.txt | \\\n             samtools view -@ ${task.cpus} -bS > ${id}.unsorted.bam\n          samtools sort -@ ${task.cpus} -m 8G -o ${id}.bam ${id}.unsorted.bam\n          rm *.unsorted.bam\n          samtools index -@ ${task.cpus} -b ${id}.bam\n          samtools flagstat ${id}.bam > ${id}.flagstat.txt\n        \"\"\"\n\n}",
        "nb_lignes_process": 34,
        "string_script": "        index_base = hs2_indices[0].toString() - ~/.\\d.ht2/\n\n        \"\"\"\n          hisat2 -p ${task.cpus} -x $index_base -1 ${forward} -2 ${reverse} --rg-id \"${id}\" --rg \"SM:${id}\" --rg \"PL:ILLUMINA\" --summary-file ${id}.hisat2_log.txt | \\\n             samtools view -@ ${task.cpus} -bS > ${id}.unsorted.bam\n          samtools sort -@ ${task.cpus} -m 8G -o ${id}.bam ${id}.unsorted.bam\n          rm *.unsorted.bam\n          samtools index -@ ${task.cpus} -b ${id}.bam\n          samtools flagstat ${id}.bam > ${id}.flagstat.txt\n        \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "HISAT2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/hisat2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "HISAT2",
                "uri": "https://bio.tools/hisat2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Alignment program for mapping next-generation sequencing reads (both DNA and RNA) to a population of human genomes (as well as to a single reference genome).",
                "homepage": "https://ccb.jhu.edu/software/hisat2/index.shtml"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "trimmed_reads_hisat",
            "hs2_indices"
        ],
        "nb_inputs": 2,
        "outputs": [
            "alignment_logs_hisat",
            "bam_files_hisat"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/hisat\", mode: 'copy', pattern: '*.hisat2_log.txt'",
            "publishDir \"${output}/${params.dir}/hisat\", mode: 'copy', pattern: '*.flagstat.txt'",
            "publishDir \"${output}/${params.dir}/bams\", mode: 'copy', pattern: '*.bam'",
            "publishDir \"${output}/${params.dir}/bams\", mode: 'copy', pattern: '*.bam.bai'",
            "cpus big",
            "tag { id }",
            "maxForks 5"
        ],
        "when": "params.hisat",
        "stub": ""
    },
    "hisat_stringtie": {
        "name_process": "hisat_stringtie",
        "string_process": "\nprocess hisat_stringtie {\n\n    publishDir \"${output}/${params.dir}/hisat\", mode: 'copy', pattern: '**/*'\n\n    cpus small\n    tag { id }\n\n    when:\n      params.hisat\n\n    input:\n        file(\"geneset.gtf.gz\") from geneset_stringtie\n        tuple val(id), (\"${id}.bam\"), file(\"${id}.bam.bai\") from bam_files_stringtie\n\n    output:\n        file(\"${id}/*\") into stringtie_exp\n\n    script:\n\n        \"\"\"\n          zcat geneset.gtf.gz > geneset.gtf\n          stringtie ${id}.bam -p ${task.cpus} -G geneset.gtf -A ${id}/${id}_abund.tab -e -B -o ${id}/${id}_expressed.gtf\n          rm *.gtf\n        \"\"\"\n\n}",
        "nb_lignes_process": 25,
        "string_script": "        \"\"\"\n          zcat geneset.gtf.gz > geneset.gtf\n          stringtie ${id}.bam -p ${task.cpus} -G geneset.gtf -A ${id}/${id}_abund.tab -e -B -o ${id}/${id}_expressed.gtf\n          rm *.gtf\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "StringTie"
        ],
        "tools_url": [
            "https://bio.tools/stringtie"
        ],
        "tools_dico": [
            {
                "name": "StringTie",
                "uri": "https://bio.tools/stringtie",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3680",
                                    "term": "RNA-Seq analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3258",
                                    "term": "Transcriptome assembly"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fast and highly efficient assembler of RNA-Seq alignments into potential transcripts. It uses a novel network flow algorithm as well as an optional de novo assembly step to assemble and quantitate full-length transcripts representing multiple splice variants for each gene locus.",
                "homepage": "https://ccb.jhu.edu/software/stringtie/"
            }
        ],
        "inputs": [
            "geneset_stringtie",
            "bam_files_stringtie"
        ],
        "nb_inputs": 2,
        "outputs": [
            "stringtie_exp"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/hisat\", mode: 'copy', pattern: '**/*'",
            "cpus small",
            "tag { id }"
        ],
        "when": "params.hisat",
        "stub": ""
    },
    "hisat_stringtie_counts": {
        "name_process": "hisat_stringtie_counts",
        "string_process": "\nprocess hisat_stringtie_counts {\n\n    publishDir \"${output}/${params.dir}/counts\", mode: 'copy', pattern: '*.csv'\n\n    cpus small\n\n    when:\n      params.hisat\n\n    input:\n      val(id) from stringtie_exp.toSortedList()\n\n    output:\n      file (\"gene_count_matrix.csv\") into gene_count_matrix\n      file (\"transcript_count_matrix.csv\") into transcript_count_matrix\n\n    \"\"\"\n      python2 ${prepDE} -i ${output}/${params.dir}/hisat -l ${params.rlen} -g gene_count_matrix.csv -t transcript_count_matrix.csv\n\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "\"\"\"\n      python2 ${prepDE} -i ${output}/${params.dir}/hisat -l ${params.rlen} -g gene_count_matrix.csv -t transcript_count_matrix.csv\n\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "stringtie_exp"
        ],
        "nb_inputs": 1,
        "outputs": [
            "gene_count_matrix",
            "transcript_count_matrix"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/counts\", mode: 'copy', pattern: '*.csv'",
            "cpus small"
        ],
        "when": "params.hisat",
        "stub": ""
    },
    "fastqc": {
        "name_process": "fastqc",
        "string_process": "\nprocess fastqc {\n\n    publishDir \"${output}/${params.dir}/fastqc\", mode: 'copy', pattern: '*_fastqc.{zip,html}'\n\n    cpus small\n    tag { id }\n\n    when:\n      params.qc\n\n    input:\n    tuple val(id), file(forward), file(reverse) from trimmed_reads_qc\n\n    output:\n    file \"*_fastqc.{zip,html}\" into fastqc_results\n\n    script:\n\n    \"\"\"\n      fastqc -q $forward $reverse -t ${task.cpus}\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n      fastqc -q $forward $reverse -t ${task.cpus}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "trimmed_reads_qc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/fastqc\", mode: 'copy', pattern: '*_fastqc.{zip,html}'",
            "cpus small",
            "tag { id }"
        ],
        "when": "params.qc",
        "stub": ""
    },
    "multiqc": {
        "name_process": "multiqc",
        "string_process": "\nprocess multiqc {\n\n    publishDir \"${output}/${params.dir}/fastqc\", mode: 'copy', pattern: 'multiqc_report.html'\n\n    cpus small\n\n    when:\n      params.qc\n\n    input:\n    file ('fastqc/*') from fastqc_results.collect().ifEmpty([])\n\n    output:\n    file \"multiqc_report.html\" into multiqc_report\n\n    script:\n\n    \"\"\"\n      multiqc .\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n      multiqc .\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "fastqc_results"
        ],
        "nb_inputs": 1,
        "outputs": [
            "multiqc_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/fastqc\", mode: 'copy', pattern: 'multiqc_report.html'",
            "cpus small"
        ],
        "when": "params.qc",
        "stub": ""
    },
    "bam_qc": {
        "name_process": "bam_qc",
        "string_process": "\nprocess bam_qc {\n\n    publishDir \"${output}/${params.dir}/align_qc\", mode: 'copy', pattern: '*_QC.txt'\n\n    cpus small\n\n    when:\n      params.qc\n\n    input:\n        file(\"geneset.gtf.gz\") from geneset_qc\n        tuple val(id), file(bam), file(bai) from bam_files_qc\n\n    output:\n        file(\"*_QC.txt\") into align_qc\n\n    script:\n\n    \"\"\"\n      zcat geneset.gtf.gz > geneset.gtf\n      awk '{ if (\\$0 ~ \"transcript_id\") print \\$0; else print \\$0\" transcript_id \"\";\"; }' geneset.gtf | gtf2bed - > geneset.gtf.bed\n      cat geneset.gtf.bed | sed '/\\tgene\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.gene.bed\n      cat geneset.gtf.bed | sed '/\\texon\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.exon.bed\n      cat geneset.gtf.bed | sed '/\\tfive_prime_utr\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.5utr.bed\n      cat geneset.gtf.bed | sed '/\\tthree_prime_utr\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.3utr.bed\n\n      echo -n \"total,\" >> ${bam}_QC.txt\n      samtools view -c ${bam} >> ${bam}_QC.txt\n      echo -n \"mapped,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -c ${bam} >> ${bam}_QC.txt\n      echo -n \"unique,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c ${bam} >> ${bam}_QC.txt\n\n      samtools view -L geneset.gene.bed -h ${bam} > tmp.sam\n      echo -n \"gene,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n      samtools view -L geneset.exon.bed -h ${bam} > tmp.sam\n      echo -n \"exon,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n      samtools view -L geneset.5utr.bed -h ${bam} > tmp.sam\n      echo -n \"5utr,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n      samtools view -L geneset.3utr.bed -h ${bam} > tmp.sam\n      echo -n \"3utr,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n    \"\"\"\n}",
        "nb_lignes_process": 50,
        "string_script": "    \"\"\"\n      zcat geneset.gtf.gz > geneset.gtf\n      awk '{ if (\\$0 ~ \"transcript_id\") print \\$0; else print \\$0\" transcript_id \"\";\"; }' geneset.gtf | gtf2bed - > geneset.gtf.bed\n      cat geneset.gtf.bed | sed '/\\tgene\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.gene.bed\n      cat geneset.gtf.bed | sed '/\\texon\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.exon.bed\n      cat geneset.gtf.bed | sed '/\\tfive_prime_utr\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.5utr.bed\n      cat geneset.gtf.bed | sed '/\\tthree_prime_utr\\t/!d' | sed '/protein_coding/!d' | awk -v OFS='\\t' '{print \\$1, \\$2, \\$3, \\$4, \\$6, \\$8}' > geneset.3utr.bed\n\n      echo -n \"total,\" >> ${bam}_QC.txt\n      samtools view -c ${bam} >> ${bam}_QC.txt\n      echo -n \"mapped,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -c ${bam} >> ${bam}_QC.txt\n      echo -n \"unique,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c ${bam} >> ${bam}_QC.txt\n\n      samtools view -L geneset.gene.bed -h ${bam} > tmp.sam\n      echo -n \"gene,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n      samtools view -L geneset.exon.bed -h ${bam} > tmp.sam\n      echo -n \"exon,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n      samtools view -L geneset.5utr.bed -h ${bam} > tmp.sam\n      echo -n \"5utr,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n      samtools view -L geneset.3utr.bed -h ${bam} > tmp.sam\n      echo -n \"3utr,\" >> ${bam}_QC.txt\n      samtools view -F 0x4 -q 60 -c tmp.sam >> ${bam}_QC.txt\n      rm tmp.sam\n    \"\"\"",
        "nb_lignes_script": 31,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "geneset_qc",
            "bam_files_qc"
        ],
        "nb_inputs": 2,
        "outputs": [
            "align_qc"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/${params.dir}/align_qc\", mode: 'copy', pattern: '*_QC.txt'",
            "cpus small"
        ],
        "when": "params.qc",
        "stub": ""
    },
    "sra_to_fastq": {
        "name_process": "sra_to_fastq",
        "string_process": "\nprocess sra_to_fastq {\n\n    cpus small_core\n\n    publishDir \"${data}/fq/\", mode: 'move'\n    \n    input:\n        file(\"SRR_Acc_List_UGA.txt\") from sra_file_convert\n\n    output:\n        file(\"*\")\n\n    script:\n\n    sra_list=\"SRR_Acc_List_UGA.txt\"\n\n    \"\"\" \n\n    while read line     \n    do           \n        fastq-dump --gzip --split-files ~/ncbi/public/sra/\\$line.sra\n    done <${sra_list} \n\n    \"\"\"\n\n}",
        "nb_lignes_process": 25,
        "string_script": "    sra_list=\"SRR_Acc_List_UGA.txt\"\n\n    \"\"\" \n\n    while read line     \n    do           \n        fastq-dump --gzip --split-files ~/ncbi/public/sra/\\$line.sra\n    done <${sra_list} \n\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sra_file_convert"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "cpus small_core",
            "publishDir \"${data}/fq/\", mode: 'move'"
        ],
        "when": "",
        "stub": ""
    },
    "hisat2_stringtie": {
        "name_process": "hisat2_stringtie",
        "string_process": "\nprocess hisat2_stringtie {\n\n    publishDir \"${output}/expression\", mode: 'copy', pattern: '**/*'\n    publishDir \"${output}/expression\", mode: 'copy', pattern: '*.hisat2_log.txt'\n    publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam'\n    publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam.bai'\n\n    cpus large_core\n    tag { id }\n\n    input:\n        tuple  val(id), file(forward), file(reverse) from trimmed_reads_hisat\n        file(\"geneset.gtf.gz\") from geneset_stringtie\n        file hs2_indices from hs2_indices.first()\n\n    output:\n        file \"${id}.hisat2_log.txt\" into alignment_logs\n        file(\"${id}/*\") into stringtie_exp\n        file(\"${id}.bam\") into bam_files\n        file(\"${id}.bam.bai\") into bam_indexes\n\n    script:\n        index_base = hs2_indices[0].toString() - ~/.\\d.ht2/\n\n    \"\"\"\n        hisat2 -p ${large_core} -x $index_base -1 ${forward} -2 ${reverse} -S ${id}.sam --rg-id \"${id}\" --rg \"SM:${id}\" --rg \"PL:ILLUMINA\" 2> ${id}.hisat2_log.txt\n        samtools view -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${large_core} -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -b ${id}.bam\n        zcat geneset.gtf.gz > geneset.gtf\n        stringtie ${id}.bam -p ${large_core} -G geneset.gtf -A ${id}/${id}_abund.tab -e -B -o ${id}/${id}_expressed.gtf\n        rm *.gtf\n    \"\"\"\n}",
        "nb_lignes_process": 36,
        "string_script": "        index_base = hs2_indices[0].toString() - ~/.\\d.ht2/\n\n    \"\"\"\n        hisat2 -p ${large_core} -x $index_base -1 ${forward} -2 ${reverse} -S ${id}.sam --rg-id \"${id}\" --rg \"SM:${id}\" --rg \"PL:ILLUMINA\" 2> ${id}.hisat2_log.txt\n        samtools view -bS ${id}.sam > ${id}.unsorted.bam\n        rm *.sam\n        samtools flagstat ${id}.unsorted.bam\n        samtools sort -@ ${large_core} -o ${id}.bam ${id}.unsorted.bam\n        rm *.unsorted.bam\n        samtools index -b ${id}.bam\n        zcat geneset.gtf.gz > geneset.gtf\n        stringtie ${id}.bam -p ${large_core} -G geneset.gtf -A ${id}/${id}_abund.tab -e -B -o ${id}/${id}_expressed.gtf\n        rm *.gtf\n    \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "HISAT2",
            "SAMtools",
            "StringTie"
        ],
        "tools_url": [
            "https://bio.tools/hisat2",
            "https://bio.tools/samtools",
            "https://bio.tools/stringtie"
        ],
        "tools_dico": [
            {
                "name": "HISAT2",
                "uri": "https://bio.tools/hisat2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Alignment program for mapping next-generation sequencing reads (both DNA and RNA) to a population of human genomes (as well as to a single reference genome).",
                "homepage": "https://ccb.jhu.edu/software/hisat2/index.shtml"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "StringTie",
                "uri": "https://bio.tools/stringtie",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3680",
                                    "term": "RNA-Seq analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3258",
                                    "term": "Transcriptome assembly"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fast and highly efficient assembler of RNA-Seq alignments into potential transcripts. It uses a novel network flow algorithm as well as an optional de novo assembly step to assemble and quantitate full-length transcripts representing multiple splice variants for each gene locus.",
                "homepage": "https://ccb.jhu.edu/software/stringtie/"
            }
        ],
        "inputs": [
            "trimmed_reads_hisat",
            "geneset_stringtie",
            "hs2_indices"
        ],
        "nb_inputs": 3,
        "outputs": [
            "alignment_logs",
            "stringtie_exp",
            "bam_files",
            "bam_indexes"
        ],
        "nb_outputs": 4,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/expression\", mode: 'copy', pattern: '**/*'",
            "publishDir \"${output}/expression\", mode: 'copy', pattern: '*.hisat2_log.txt'",
            "publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam'",
            "publishDir \"${output}/bams\", mode: 'copy', pattern: '*.bam.bai'",
            "cpus large_core",
            "tag { id }"
        ],
        "when": "",
        "stub": ""
    },
    "stringtie_counts_final": {
        "name_process": "stringtie_counts_final",
        "string_process": "\nprocess stringtie_counts_final {\n\n    echo true\n\n    publishDir \"${output}/counts\", mode: 'copy', pattern: '*.csv'\n\n    cpus small_core\n\n    when:\n      params.stc\n\n    output:\n        file (\"gene_count_matrix.csv\") into gene_count_matrix\n        file (\"transcript_count_matrix.csv\") into transcript_count_matrix\n\n    \"\"\"\n        python ${prepDE} -i ${output}/expression -l ${rlen} -g gene_count_matrix.csv -t transcript_count_matrix.csv\n\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n        python ${prepDE} -i ${output}/expression -l ${rlen} -g gene_count_matrix.csv -t transcript_count_matrix.csv\n\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "gene_count_matrix",
            "transcript_count_matrix"
        ],
        "nb_outputs": 2,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "echo true",
            "publishDir \"${output}/counts\", mode: 'copy', pattern: '*.csv'",
            "cpus small_core"
        ],
        "when": "params.stc",
        "stub": ""
    },
    "fetch_parasite_ref": {
        "name_process": "fetch_parasite_ref",
        "string_process": "\nprocess fetch_parasite_ref {\n\n    publishDir \"${output}/reference/\", mode: 'copy'\n\n    output:\n        file(\"parasite.fa.gz\") into parasite_ref\n\n    \"\"\"\n        echo '${prefix}'\n        curl ${prefix}/${species}.${prjn}.${release}.genomic.fa.gz > parasite.fa.gz\n    \"\"\"\n}",
        "nb_lignes_process": 11,
        "string_script": "\"\"\"\n        echo '${prefix}'\n        curl ${prefix}/${species}.${prjn}.${release}.genomic.fa.gz > parasite.fa.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "CURLS"
        ],
        "tools_url": [
            "https://bio.tools/CURLS"
        ],
        "tools_dico": [
            {
                "name": "CURLS",
                "uri": "https://bio.tools/CURLS",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3335",
                            "term": "Cardiology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3305",
                            "term": "Public health and epidemiology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3421",
                            "term": "Surgery"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "Pathology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3335",
                            "term": "Cardiovascular medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3305",
                            "term": "https://en.wikipedia.org/wiki/Public_health"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3305",
                            "term": "https://en.wikipedia.org/wiki/Epidemiology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3421",
                            "term": "https://en.wikipedia.org/wiki/Surgery"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "Disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "https://en.wikipedia.org/wiki/Pathology"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "towards a wider use of basic echo applications in Africa.\n\nBACKGROUND:Point-of-care ultrasound is increasingly being used as a diagnostic tool in resource-limited settings. The majority of existing ultrasound protocols have been developed and implemented in high-resource settings. In sub-Saharan Africa (SSA), patients with heart failure of various etiologies commonly present late in the disease process, with a similar syndrome of dyspnea, edema and cardiomegaly on chest X-ray. The causes of heart failure in SSA differ from those in high-resource settings. Point-of-care ultrasound has the potential to identify the underlying etiology of heart failure, and lead to targeted therapy.\n\n||| HOMEPAGE MISSING!.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'ultrasound', 'Cardiac ultrasound resource-limited settings', 'high-resource', 'cardiomegaly SSA'",
                "homepage": "https://www.ncbi.nlm.nih.gov/pubmed/?term=31883027"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "parasite_ref"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/reference/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "fetch_host_ref": {
        "name_process": "fetch_host_ref",
        "string_process": "\nprocess fetch_host_ref {\n\n    publishDir \"${output}/reference/\", mode: 'copy'\n\n    output:\n        file(\"host.fa.gz\") into host_ref\n\n    \"\"\"\n        echo '${hosturl}'\n        wget ${hosturl} -O host.fa.gz\n    \"\"\"\n}",
        "nb_lignes_process": 11,
        "string_script": "\"\"\"\n        echo '${hosturl}'\n        wget ${hosturl} -O host.fa.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "host_ref"
        ],
        "nb_outputs": 1,
        "name_workflow": "zamanianlab__Core_RNAseq-nf",
        "directive": [
            "publishDir \"${output}/reference/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}