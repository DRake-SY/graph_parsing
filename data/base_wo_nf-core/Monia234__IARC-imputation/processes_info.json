{
    "UpdateHG38": {
        "name_process": "UpdateHG38",
        "string_process": " process UpdateHG38{\n    input:\n    file data from Channel.fromPath(params.targetDir+'*').collect()\n\n    output:\n    file ('*-updated.{bed,bim,fam}') into TargetUpdate\n    file ('*-updated.bim') into TargetQC2\n\n    shell:\n    '''\n    ############################################################################################\n    ## -- 0 : Update version of the tergat dataset : hg18/19 --> hg38\n    if [ !{params.conversion} != \"hg38\" ] ; then\n      awk '{print \"chr\" $1, $4 -1, $4, $2 }' !{params.target}.bim | sed 's/chr23/chrX/' | sed 's/chr24/chrY/' > dataset.tolift\n\n      if [ !{params.conversion} == \"hg18\" ] ; then\n        liftOver dataset.tolift !{params.chain}hg18ToHg38.over.chain dataset1 dataset_NCBI36.unMapped\n      fi\n\n      if [ !{params.conversion} == \"hg19\" ] ; then\n        liftOver dataset.tolift !{params.chain}hg19ToHg38.over.chain dataset1 dataset_NCBI36.unMapped\n      fi\n\n      awk '{print $4}' dataset1 > dataset1.snps\n      plink --bfile !{params.target} --extract dataset1.snps --make-bed --out dataset1\n\n      mkdir old\n      mv !{params.target}* old/\n\n      awk '{print $4, $3}' dataset1  > dataset1.pos\n      plink --bfile dataset1 --update-map dataset1.pos --make-bed --out !{params.target}\n    fi\n\n    plink --freq --bfile !{params.target} --allow-no-sex --make-bed --out dataset3\n    perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b !{params.target}.bim -f dataset3.frq -r !{params.legend} -h\n    grep -v \"real-ref-alleles\" Run-plink.sh> Run-plink-update.sh\n    bash Run-plink-update.sh\n    '''}",
        "nb_lignes_process": 36,
        "string_script": "    '''\n    ############################################################################################\n    ## -- 0 : Update version of the tergat dataset : hg18/19 --> hg38\n    if [ !{params.conversion} != \"hg38\" ] ; then\n      awk '{print \"chr\" $1, $4 -1, $4, $2 }' !{params.target}.bim | sed 's/chr23/chrX/' | sed 's/chr24/chrY/' > dataset.tolift\n\n      if [ !{params.conversion} == \"hg18\" ] ; then\n        liftOver dataset.tolift !{params.chain}hg18ToHg38.over.chain dataset1 dataset_NCBI36.unMapped\n      fi\n\n      if [ !{params.conversion} == \"hg19\" ] ; then\n        liftOver dataset.tolift !{params.chain}hg19ToHg38.over.chain dataset1 dataset_NCBI36.unMapped\n      fi\n\n      awk '{print $4}' dataset1 > dataset1.snps\n      plink --bfile !{params.target} --extract dataset1.snps --make-bed --out dataset1\n\n      mkdir old\n      mv !{params.target}* old/\n\n      awk '{print $4, $3}' dataset1  > dataset1.pos\n      plink --bfile dataset1 --update-map dataset1.pos --make-bed --out !{params.target}\n    fi\n\n    plink --freq --bfile !{params.target} --allow-no-sex --make-bed --out dataset3\n    perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b !{params.target}.bim -f dataset3.frq -r !{params.legend} -h\n    grep -v \"real-ref-alleles\" Run-plink.sh> Run-plink-update.sh\n    bash Run-plink-update.sh\n    '''",
        "nb_lignes_script": 28,
        "language_script": "bash",
        "tools": [
            "LiftOver",
            "pLink"
        ],
        "tools_url": [
            "https://bio.tools/liftover",
            "https://bio.tools/pLink-2"
        ],
        "tools_dico": [
            {
                "name": "LiftOver",
                "uri": "https://bio.tools/liftover",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This service converts genome coordinates and genome annotation files between assemblies.",
                "homepage": "http://api.bioinfo.no/wsdl/LiftOverService.wsdl"
            },
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "TargetUpdate",
            "TargetQC2"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "Admixture": {
        "name_process": "Admixture",
        "string_process": " process Admixture{\n    publishDir params.output+params.target+'/admixture/', mode: 'copy',\n       saveAs: {filename ->\n           if (filename == \"target4.bim\") null\n           else if (filename == \"target4.bed\") null\n           else if (filename == \"target4.fam\") null\n           else filename\n       }\n\n    input:\n    file data from Channel.fromPath(params.folder+'relationships_w_pops_121708.txt').collect()\n    file data from Channel.fromPath(params.originDir+\"*\").collect()\n    file data from TargetUpdate.collect()\n\n    output:\n    file ('target4.{bed,bim,fam}') into Merge\n    file ('target4.{bed,bim,fam}') into Merge2\n    file ('out_pop_admixture/') into Admixture\n    file ('out_pop_admixture/') into Admixture2\n    file ('admixture_results_withGroups.txt') into Target\n\n    shell:\n    '''\n    ## -- 1 : Retrieve common SNPs between SNPs in the reference list and the target data.\n    awk '{print $2}' !{params.origin}.bim | sort > ref_SNPs.txt\n    grep -Fwf <(cat ref_SNPs.txt) <(awk '{print $2}' !{params.target}-updated.bim)  > target_common_SNPs.txt\n\n    ## -- 2 : Extract the genotypes associated to these common SNPs + merge of the dataset\n    plink --bfile !{params.origin} --extract target_common_SNPs.txt --make-bed --out ref1\n    plink --bfile !{params.target}-updated --extract target_common_SNPs.txt --make-bed --out target1\n    plink --bfile target1 --bmerge ref1 --allow-no-sex --make-bed --out merge1\n\n\n    if [ -e merge1-merge.missnp ]\n    then\n      plink --bfile ref1 --exclude merge1-merge.missnp --make-bed --out ref2\n      plink --bfile target1 --exclude merge1-merge.missnp --make-bed --out target2\n      plink --bfile ref2 --bmerge target2 --allow-no-sex --make-bed --out merge\n    else\n      mv merge1.fam merge.fam\n      mv merge1.bed merge.bed\n      mv merge1.bim merge.bim\n    fi\n\n    # perform ld pruning here!!! look at ELN command\n    #plink --noweb --bfile merge --r2 --out merge_pruned --ld-window-kb 10000 --ld-window 10000 --ld-window-r2 0.1\n    plink --bfile merge --out merge_pruned --indep-pairwise 50 5 0.2\n    plink --bfile merge --extract merge_pruned.prune.in --make-bed --out merge_pruned\n    awk '{print $2}' merge_pruned.fam  >  all_samples.txt\n\n    ## -- 3 : Associate each reference sample to the correct origin + run admixure\n    sort -k2 relationships_w_pops_121708.txt > relationships_w_pops_121708_2.txt\n    awk '{print $2}' !{params.origin}.fam | sort -k1,1 > ref_ind.txt\n    join -11 -22 ref_ind.txt relationships_w_pops_121708_2.txt | awk '{print $1, $7}' | awk '{if( $2 == \"CEU\") print $0,1,1; else { if($2 == \"YRI\") print $0,2,1; else {print $0,3,1}}}' > ind_pop.txt\n    Rscript !{baseDir}/bin/create_pop_file.r merge_pruned.fam ind_pop.txt merge_pruned.pop\n    K=3\n    admixture --cv merge_pruned.bed $K --supervised -j4 | tee log${K}.out\n    Rscript !{baseDir}/bin/process_admixture.r !{params.target}-updated\n\n    ############################################################################################\n    ## -- 4 : First filtering step\n    plink --bfile !{params.target}-updated --geno !{params.geno1} --make-bed --out target3\n    plink --bfile target3 --maf !{params.maf} --make-bed --out target4\n    '''\n  }",
        "nb_lignes_process": 63,
        "string_script": "    '''\n    ## -- 1 : Retrieve common SNPs between SNPs in the reference list and the target data.\n    awk '{print $2}' !{params.origin}.bim | sort > ref_SNPs.txt\n    grep -Fwf <(cat ref_SNPs.txt) <(awk '{print $2}' !{params.target}-updated.bim)  > target_common_SNPs.txt\n\n    ## -- 2 : Extract the genotypes associated to these common SNPs + merge of the dataset\n    plink --bfile !{params.origin} --extract target_common_SNPs.txt --make-bed --out ref1\n    plink --bfile !{params.target}-updated --extract target_common_SNPs.txt --make-bed --out target1\n    plink --bfile target1 --bmerge ref1 --allow-no-sex --make-bed --out merge1\n\n\n    if [ -e merge1-merge.missnp ]\n    then\n      plink --bfile ref1 --exclude merge1-merge.missnp --make-bed --out ref2\n      plink --bfile target1 --exclude merge1-merge.missnp --make-bed --out target2\n      plink --bfile ref2 --bmerge target2 --allow-no-sex --make-bed --out merge\n    else\n      mv merge1.fam merge.fam\n      mv merge1.bed merge.bed\n      mv merge1.bim merge.bim\n    fi\n\n    # perform ld pruning here!!! look at ELN command\n    #plink --noweb --bfile merge --r2 --out merge_pruned --ld-window-kb 10000 --ld-window 10000 --ld-window-r2 0.1\n    plink --bfile merge --out merge_pruned --indep-pairwise 50 5 0.2\n    plink --bfile merge --extract merge_pruned.prune.in --make-bed --out merge_pruned\n    awk '{print $2}' merge_pruned.fam  >  all_samples.txt\n\n    ## -- 3 : Associate each reference sample to the correct origin + run admixure\n    sort -k2 relationships_w_pops_121708.txt > relationships_w_pops_121708_2.txt\n    awk '{print $2}' !{params.origin}.fam | sort -k1,1 > ref_ind.txt\n    join -11 -22 ref_ind.txt relationships_w_pops_121708_2.txt | awk '{print $1, $7}' | awk '{if( $2 == \"CEU\") print $0,1,1; else { if($2 == \"YRI\") print $0,2,1; else {print $0,3,1}}}' > ind_pop.txt\n    Rscript !{baseDir}/bin/create_pop_file.r merge_pruned.fam ind_pop.txt merge_pruned.pop\n    K=3\n    admixture --cv merge_pruned.bed $K --supervised -j4 | tee log${K}.out\n    Rscript !{baseDir}/bin/process_admixture.r !{params.target}-updated\n\n    ############################################################################################\n    ## -- 4 : First filtering step\n    plink --bfile !{params.target}-updated --geno !{params.geno1} --make-bed --out target3\n    plink --bfile target3 --maf !{params.maf} --make-bed --out target4\n    '''",
        "nb_lignes_script": 41,
        "language_script": "bash",
        "tools": [
            "pLink",
            "joineRML",
            "Admixture"
        ],
        "tools_url": [
            "https://bio.tools/pLink-2",
            "https://bio.tools/joinerml",
            "https://bio.tools/admixture"
        ],
        "tools_dico": [
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            },
            {
                "name": "joineRML",
                "uri": "https://bio.tools/joinerml",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3474",
                            "term": "Machine learning"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3569",
                            "term": "Applied mathematics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2269",
                            "term": "Statistics and probability"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Joint Modelling of Multivariate Longitudinal Data and Time-to-Event Outcomes.",
                "homepage": "https://cran.r-project.org/web/packages/joineRML/"
            },
            {
                "name": "Admixture",
                "uri": "https://bio.tools/admixture",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Maximum likelihood estimation of individual ancestries from multilocus SNP genotype datasets. It uses the same statistical model as STRUCTURE but calculates estimates using a fast numerical optimization algorithm.",
                "homepage": "http://software.genetics.ucla.edu/admixture/"
            }
        ],
        "inputs": [
            "TargetUpdate"
        ],
        "nb_inputs": 1,
        "outputs": [
            "Merge",
            "Merge2",
            "Admixture",
            "Admixture2",
            "Target"
        ],
        "nb_outputs": 5,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/admixture/', mode: 'copy' , saveAs: {filename -> if (filename == \"target4.bim\") null else if (filename == \"target4.bed\") null else if (filename == \"target4.fam\") null else filename }"
        ],
        "when": "",
        "stub": ""
    },
    "Filtering1": {
        "name_process": "Filtering1",
        "string_process": " process Filtering1{\n    input:\n    file data from Merge.collect()\n    file data from Admixture.collect()\n    val rspop from Channel.from(\"ALL\")\n\n    output:\n    file ('*.{het,imiss.txt,genome,sexcheck}') into QC\n    file ('target_*.bim') into Bim\n    file ('target_*.{bed,bim,fam}') into TargetFilter\n\n    shell:\n    '''\n    pop=!{rspop}\n    subpop=out_pop_admixture/1000G_checking_$pop/samples_$pop.txt\n\n    ## -- 5 : Keep only the samples in the ancerstry $pop\n    plink --bfile target4 --keep ${subpop} --make-bed --out target5_${pop}\n\n    ## -- 6 : Perform sex checking\n    plink --bfile target5_${pop} --make-bed --merge-x no-fail --out target6_${pop}\n    plink --bfile target6_${pop} --make-bed --split-x b37 no-fail --out target_${pop}\n    plink --bfile target_${pop} --indep-pairwise 50 5 0.2 --out target_Independent_SNPs_${pop} # keep independent SNPs\n    plink --bfile target_${pop} --extract target_Independent_SNPs_${pop}.prune.in --check-sex --out target_sexCheck_${pop}\n\n    ## -- 7 : Test relatedness between samples\n    plink --bfile target_${pop} --extract target_Independent_SNPs_${pop}.prune.in  --genome --out target_rel_${pop} --min !{params.pihat}\n\n    ## -- 8 : Test heterozygocity and missing rates\n    plink --bfile target_${pop} --het --chr 1-22  --out het_${pop}\n    echo \"FID IID obs_HOM N_SNPs prop_HET\" > het_${pop}.txt\n    awk 'NR>1 {print $1,$2,$3,$5,($5-$3)/$5}' het_${pop}.het >> het_${pop}.txt\n    plink --bfile target_${pop} --missing  --out miss_${pop}\n    awk 'NR==FNR {a[$1,$2]=$5;next}($1,$2) in a{print $1,$2,$6,a[$1,$2]}' het_${pop}.txt miss_${pop}.imiss > het_${pop}.imiss.txt\n    '''\n  }",
        "nb_lignes_process": 34,
        "string_script": "    '''\n    pop=!{rspop}\n    subpop=out_pop_admixture/1000G_checking_$pop/samples_$pop.txt\n\n    ## -- 5 : Keep only the samples in the ancerstry $pop\n    plink --bfile target4 --keep ${subpop} --make-bed --out target5_${pop}\n\n    ## -- 6 : Perform sex checking\n    plink --bfile target5_${pop} --make-bed --merge-x no-fail --out target6_${pop}\n    plink --bfile target6_${pop} --make-bed --split-x b37 no-fail --out target_${pop}\n    plink --bfile target_${pop} --indep-pairwise 50 5 0.2 --out target_Independent_SNPs_${pop} # keep independent SNPs\n    plink --bfile target_${pop} --extract target_Independent_SNPs_${pop}.prune.in --check-sex --out target_sexCheck_${pop}\n\n    ## -- 7 : Test relatedness between samples\n    plink --bfile target_${pop} --extract target_Independent_SNPs_${pop}.prune.in  --genome --out target_rel_${pop} --min !{params.pihat}\n\n    ## -- 8 : Test heterozygocity and missing rates\n    plink --bfile target_${pop} --het --chr 1-22  --out het_${pop}\n    echo \"FID IID obs_HOM N_SNPs prop_HET\" > het_${pop}.txt\n    awk 'NR>1 {print $1,$2,$3,$5,($5-$3)/$5}' het_${pop}.het >> het_${pop}.txt\n    plink --bfile target_${pop} --missing  --out miss_${pop}\n    awk 'NR==FNR {a[$1,$2]=$5;next}($1,$2) in a{print $1,$2,$6,a[$1,$2]}' het_${pop}.txt miss_${pop}.imiss > het_${pop}.imiss.txt\n    '''",
        "nb_lignes_script": 22,
        "language_script": "bash",
        "tools": [
            "pLink"
        ],
        "tools_url": [
            "https://bio.tools/pLink-2"
        ],
        "tools_dico": [
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            }
        ],
        "inputs": [
            "Merge",
            "Admixture"
        ],
        "nb_inputs": 2,
        "outputs": [
            "QC",
            "Bim",
            "TargetFilter"
        ],
        "nb_outputs": 3,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "QC1": {
        "name_process": "QC1",
        "string_process": " process QC1{\n    publishDir params.output+params.target+'/QC1/', mode: 'copy'\n\n    input:\n    file data from QC.collect()\n    file target from Target.collect()\n\n    output:\n    file ('postGenotyping_samples_QCs.pdf') into FigureQC1\n    file ('selected_samples_afterSamplesQCsChecking.txt') into TableQC1\n\n    shell:\n    '''\n    ## -- 9 : Figure QC1\n    Rscript !{baseDir}/bin/after_genotyping_qc.r\n    '''\n  }",
        "nb_lignes_process": 15,
        "string_script": "    '''\n    ## -- 9 : Figure QC1\n    Rscript !{baseDir}/bin/after_genotyping_qc.r\n    '''",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "QC",
            "Target"
        ],
        "nb_inputs": 2,
        "outputs": [
            "FigureQC1",
            "TableQC1"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/QC1/', mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Filtering2": {
        "name_process": "Filtering2",
        "string_process": " process Filtering2{\n    input:\n    file data from TargetFilter.collect()\n    val rspop from Channel.from(\"ALL\")\n    file data from Channel.fromPath(params.legend).collect()\n\n    output:\n    file ('withFreqFiltering_*') into DirFiltering\n    file ('target_hwe_*.bim') into HWresult\n    file ('target_freq_*.frq') into FreqResult\n    file ('ID-target_*-HRC.txt') into FreqResultId\n\n    shell:\n    '''\n    pop=!{rspop}\n    leg=!{params.legend}\n\n    ## -- 10 : AF based filter\n    plink --freq --bfile target_${pop} --output-chr chr26 --out target_freq_${pop}\n    perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b target_${pop}.bim -f target_freq_${pop}.frq -r ${leg##*/} -h \n    mkdir withFreqFiltering_${pop}\n    cp *-HRC* Run-plink.sh withFreqFiltering_${pop}\n\n    ## -- 11 :  HWE filtering\n    plink --bfile target_${pop} --geno !{params.geno2} --make-bed --out target_geno_${pop}\n    plink --bfile target_geno_${pop} --hwe !{params.hwe} --make-bed --out target_hwe_${pop}\n    '''\n  }",
        "nb_lignes_process": 26,
        "string_script": "    '''\n    pop=!{rspop}\n    leg=!{params.legend}\n\n    ## -- 10 : AF based filter\n    plink --freq --bfile target_${pop} --output-chr chr26 --out target_freq_${pop}\n    perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b target_${pop}.bim -f target_freq_${pop}.frq -r ${leg##*/} -h \n    mkdir withFreqFiltering_${pop}\n    cp *-HRC* Run-plink.sh withFreqFiltering_${pop}\n\n    ## -- 11 :  HWE filtering\n    plink --bfile target_${pop} --geno !{params.geno2} --make-bed --out target_geno_${pop}\n    plink --bfile target_geno_${pop} --hwe !{params.hwe} --make-bed --out target_hwe_${pop}\n    '''",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "pLink"
        ],
        "tools_url": [
            "https://bio.tools/pLink-2"
        ],
        "tools_dico": [
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            }
        ],
        "inputs": [
            "TargetFilter"
        ],
        "nb_inputs": 1,
        "outputs": [
            "DirFiltering",
            "HWresult",
            "FreqResult",
            "FreqResultId"
        ],
        "nb_outputs": 4,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "Make_SNP_Filtering": {
        "name_process": "Make_SNP_Filtering",
        "string_process": " process Make_SNP_Filtering{\n    publishDir params.output+params.target+'/SNP_filtering/', mode: 'copy'\n    input:\n    file data from DirFiltering.collect()\n    file data from HWresult.collect()\n    file data from Bim.collect()\n\n    output:\n    file ('filtered_snps.txt') into SNPsFilter\n    file ('filtered_snps.txt') into SNPsFilter2\n\n    shell:\n    '''\n    ## -- 12 : Create list of SNPs to filter\n    Rscript !{baseDir}/bin/afterGenotyping_SNPs_filtering.r\n    '''\n  }",
        "nb_lignes_process": 15,
        "string_script": "    '''\n    ## -- 12 : Create list of SNPs to filter\n    Rscript !{baseDir}/bin/afterGenotyping_SNPs_filtering.r\n    '''",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "DirFiltering",
            "HWresult",
            "Bim"
        ],
        "nb_inputs": 3,
        "outputs": [
            "SNPsFilter",
            "SNPsFilter2"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/SNP_filtering/', mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Filtering3": {
        "name_process": "Filtering3",
        "string_process": " process Filtering3{\n    input:\n    file data from Merge2.collect()\n    file data from SNPsFilter.collect()\n\n    output:\n    file ('target5-updated-chr*') into TargetChr\n\n    shell:\n    '''\n    ## -- 13 : Removing SNPs\n    plink --bfile target4 --exclude filtered_snps.txt  --make-bed --out target5\n\n    ## -- 14 : filter\n    plink --freq --bfile target5  --out target6\n    perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b target5.bim -f target6.frq -r !{params.legend} -h\n    bash Run-plink.sh\n    '''\n  }",
        "nb_lignes_process": 17,
        "string_script": "    '''\n    ## -- 13 : Removing SNPs\n    plink --bfile target4 --exclude filtered_snps.txt  --make-bed --out target5\n\n    ## -- 14 : filter\n    plink --freq --bfile target5  --out target6\n    perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b target5.bim -f target6.frq -r !{params.legend} -h\n    bash Run-plink.sh\n    '''",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "pLink"
        ],
        "tools_url": [
            "https://bio.tools/pLink-2"
        ],
        "tools_dico": [
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            }
        ],
        "inputs": [
            "Merge2",
            "SNPsFilter"
        ],
        "nb_inputs": 2,
        "outputs": [
            "TargetChr"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "QC2": {
        "name_process": "QC2",
        "string_process": " process QC2{\n    publishDir params.output+params.target+'/QC2/', mode: 'copy'\n\n    input:\n    file data from SNPsFilter2.collect()\n    file data from FreqResult.collect()\n    file data from FreqResultId.collect()\n    val rspop from Channel.from(\"ALL\")\n    file data from TargetQC2.collect()\n\n    output:\n    file ('*.pdf') into FigureQC2\n\n    shell:\n    '''\n    zmore !{legend_file} | head -n1 > ref_freq_withHeader.txt\n    grep -Fwf <(awk '{print $2}' !{params.target}-updated.bim) <(zcat !{legend_file}) > ref_freq.txt\n    cat ref_freq.txt >> ref_freq_withHeader.txt\n\n    pop=!{rspop}\n\n    pop2=\"AF\"\n\n\n    ## -- 15 : Figure QC2\n    Rscript !{baseDir}/bin/preImputation_QC_plots.r ${pop} ${pop2}\n    '''\n  }",
        "nb_lignes_process": 26,
        "string_script": "    '''\n    zmore !{legend_file} | head -n1 > ref_freq_withHeader.txt\n    grep -Fwf <(awk '{print $2}' !{params.target}-updated.bim) <(zcat !{legend_file}) > ref_freq.txt\n    cat ref_freq.txt >> ref_freq_withHeader.txt\n\n    pop=!{rspop}\n\n    pop2=\"AF\"\n\n\n    ## -- 15 : Figure QC2\n    Rscript !{baseDir}/bin/preImputation_QC_plots.r ${pop} ${pop2}\n    '''",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "SNPsFilter2",
            "FreqResult",
            "FreqResultId",
            "TargetQC2"
        ],
        "nb_inputs": 4,
        "outputs": [
            "FigureQC2"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/QC2/', mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Filtering4": {
        "name_process": "Filtering4",
        "string_process": " process Filtering4{\n    input:\n    file data from TargetChr.collect()\n    file data from Channel.fromPath(params.folder+'checkVCF.py').collect()\n    file data from Channel.fromPath(params.fasta+'*').collect()\n    val chromosome from 21..22\n\n    output:\n    file ('*-REFfixed.vcf.gz') into FilterFinal\n    file ('*-REFfixed.vcf.gz') into FilterFinal2\n    file ('*-REFfixed.vcf.gz') into FilterFinal3\n\n    shell:\n    '''\n    chr=!{chromosome}\n    export TMPDIR=/tmp/\n\n    ## -- 16 : Remove ambiguous strand/unknown SNPs\n    awk '{ if (($5==\"T\" && $6==\"A\")||($5==\"A\" && $6==\"T\")||($5==\"C\" && $6==\"G\")||($5==\"G\" && $6==\"C\")) print $2, \"ambig\" ; else print $2 ;}' target5-updated-chr${chr}.bim | grep -v ambig | grep -v -e --- | sort -u > NonAmbiguous${chr}.snplist.txt\n    plink --bfile target5-updated-chr${chr} --extract NonAmbiguous${chr}.snplist.txt --output-chr chr26 --make-bed --out target6_chr${chr}\n\n    ## -- 17 : Create VCF\n    plink --bfile target6_chr${chr} --output-chr chr26 --recode vcf --out target6_chr${chr}_vcf\n    bcftools sort target6_chr${chr}_vcf.vcf | bgzip -c  > chr${chr}.vcf.gz\n\n    ## -- 18 : Check SNPs\n    python2 checkVCF.py -r !{params.fasta} -o after_check_${chr} chr${chr}.vcf.gz\n    bcftools norm --check-ref ws -f !{params.fasta} chr${chr}.vcf.gz | bcftools view -m 2 -M 2  | bgzip -c > chr${chr}-REFfixed.vcf.gz\n    python2 checkVCF.py -r !{params.fasta} -o after_check2_${chr} chr${chr}-REFfixed.vcf.gz\n    '''\n  }",
        "nb_lignes_process": 29,
        "string_script": "    '''\n    chr=!{chromosome}\n    export TMPDIR=/tmp/\n\n    ## -- 16 : Remove ambiguous strand/unknown SNPs\n    awk '{ if (($5==\"T\" && $6==\"A\")||($5==\"A\" && $6==\"T\")||($5==\"C\" && $6==\"G\")||($5==\"G\" && $6==\"C\")) print $2, \"ambig\" ; else print $2 ;}' target5-updated-chr${chr}.bim | grep -v ambig | grep -v -e --- | sort -u > NonAmbiguous${chr}.snplist.txt\n    plink --bfile target5-updated-chr${chr} --extract NonAmbiguous${chr}.snplist.txt --output-chr chr26 --make-bed --out target6_chr${chr}\n\n    ## -- 17 : Create VCF\n    plink --bfile target6_chr${chr} --output-chr chr26 --recode vcf --out target6_chr${chr}_vcf\n    bcftools sort target6_chr${chr}_vcf.vcf | bgzip -c  > chr${chr}.vcf.gz\n\n    ## -- 18 : Check SNPs\n    python2 checkVCF.py -r !{params.fasta} -o after_check_${chr} chr${chr}.vcf.gz\n    bcftools norm --check-ref ws -f !{params.fasta} chr${chr}.vcf.gz | bcftools view -m 2 -M 2  | bgzip -c > chr${chr}-REFfixed.vcf.gz\n    python2 checkVCF.py -r !{params.fasta} -o after_check2_${chr} chr${chr}-REFfixed.vcf.gz\n    '''",
        "nb_lignes_script": 16,
        "language_script": "bash",
        "tools": [
            "pLink",
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/pLink-2",
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "TargetChr",
            "21"
        ],
        "nb_inputs": 2,
        "outputs": [
            "FilterFinal",
            "FilterFinal2",
            "FilterFinal3"
        ],
        "nb_outputs": 3,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "Make_Chunks": {
        "name_process": "Make_Chunks",
        "string_process": " process Make_Chunks{\n      input:\n      val chromosome from 1..22\n      file data from FilterFinal.collect()\n      file data from Channel.fromPath(params.folder+'HRC-1000G-check-bim-NoReadKey.pl').collect()\n\n      output:\n      env chunks into NbChunk\n      env chunks into NbChunk2\n      tuple env(chunks), val(chromosome) into InfoChrChunk\n      file ('*.txt') into ChunkSplit\n\n      shell:\n      '''\n      ## -- 19 : Create Chunks\n      chr=!{chromosome}\n      bcftools index -f chr${chr}-REFfixed.vcf.gz\n      bcftools isec -n +2 chr${chr}-REFfixed.vcf.gz !{params.BCFref}ALL.chr${chr}_GRCh38.genotypes.20170504.bcf | bgzip -c > isec_chr_${chr}.vcf.gz\n      Rscript !{baseDir}/bin/create_chunks.r ${chr}\n      chunks=$(wc -l chunk_split_chr${chr}.txt | awk '{print $1}')\n      '''}",
        "nb_lignes_process": 19,
        "string_script": "      '''\n      ## -- 19 : Create Chunks\n      chr=!{chromosome}\n      bcftools index -f chr${chr}-REFfixed.vcf.gz\n      bcftools isec -n +2 chr${chr}-REFfixed.vcf.gz !{params.BCFref}ALL.chr${chr}_GRCh38.genotypes.20170504.bcf | bgzip -c > isec_chr_${chr}.vcf.gz\n      Rscript !{baseDir}/bin/create_chunks.r ${chr}\n      chunks=$(wc -l chunk_split_chr${chr}.txt | awk '{print $1}')\n      '''",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "1",
            "FilterFinal"
        ],
        "nb_inputs": 2,
        "outputs": [
            "NbChunk",
            "NbChunk2",
            "InfoChrChunk",
            "ChunkSplit"
        ],
        "nb_outputs": 4,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "Make_Multiprocessing": {
        "name_process": "Make_Multiprocessing",
        "string_process": " process Make_Multiprocessing{\n      input:\n      val merge from InfoChrChunk.toList()\n\n      output:\n      file 'multiprocess.txt' into NbChr\n      file 'multiprocess.txt' into NbChr2\n\n      shell:\n      '''\n      #!/usr/bin/env python3\n      ## -- 20 : Preparation of multiprocessing for imputation\n\n      file=open('multiprocess.txt','w')\n      liste=!{merge}\n      for tuples in liste:\n        for i in range(0,tuples[0]):\n            file.write(str(tuples[1]) + '\\\\n')\n\n      file.close()\n      '''}",
        "nb_lignes_process": 19,
        "string_script": "      '''\n      #!/usr/bin/env python3\n      ## -- 20 : Preparation of multiprocessing for imputation\n\n      file=open('multiprocess.txt','w')\n      liste=!{merge}\n      for tuples in liste:\n        for i in range(0,tuples[0]):\n            file.write(str(tuples[1]) + '\\\\n')\n\n      file.close()\n      '''",
        "nb_lignes_script": 11,
        "language_script": "python3",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "InfoChrChunk"
        ],
        "nb_inputs": 1,
        "outputs": [
            "NbChr",
            "NbChr2"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "Local_Imputation": {
        "name_process": "Local_Imputation",
        "string_process": " process Local_Imputation{\n      input:\n      val chunks from NbChunk.map{1..\"$it\".toInteger()}.flatten()\n      val chromosomes from NbChr.splitText()\n\n      file data from Channel.fromPath(params.folder+'HRC-1000G-check-bim-NoReadKey.pl').collect()\n      file data from FilterFinal2.collect()\n      file data from ChunkSplit.collect()\n\n      output:\n      file '*imputed.dose.vcf.gz*' into FileVCF\n\n      shell:\n      '''\n      chr=!{chromosomes}\n      chunk=!{chunks}\n      echo \"chr: ${chr} n_chunks: ${chunk}\"\n      cpu=1\n      start=$(awk '{print $1}' <(awk 'NR == c' c=\"${chunk}\" chunk_split_chr${chr}.txt))\n      end=$(awk '{print $2}' <(awk 'NR == c' c=\"${chunk}\" chunk_split_chr${chr}.txt))\n\n      ## -- 21 : Phasing\n      bcftools index -f chr${chr}-REFfixed.vcf.gz\n      eagle --vcfRef !{params.BCFref}ALL.chr${chr}_GRCh38.genotypes.20170504.bcf --vcfTarget chr${chr}-REFfixed.vcf.gz --vcfOutFormat v --geneticMapFile /Eagle_v2.4.1/tables/genetic_map_hg38_withX.txt.gz --outPrefix chr_${chr}_chunk${chunk}.phased --bpStart ${start} --bpEnd ${end} --bpFlanking 5000000 --chrom chr${chr} --numThreads ${cpu}  > chr_${chr}_chunk${chunk}_phasing.logphase\n\n      ## -- 22 : Imputation\n      minimac4 --refHaps !{params.M3VCFref}ALL.chr${chr}.m3vcf.gz --haps chr_${chr}_chunk${chunk}.phased.vcf --prefix chr_${chr}_chunk${chunk}.imputed --allTypedSites --format GT,DS,GP --cpus ${cpu} --chr chr${chr} --start $start --end $end --window 500000 > chr_${chr}_chunk${chunk}.logimpute\n      bcftools index -f chr_${chr}_chunk${chunk}.imputed.dose.vcf.gz\n      '''}",
        "nb_lignes_process": 27,
        "string_script": "      '''\n      chr=!{chromosomes}\n      chunk=!{chunks}\n      echo \"chr: ${chr} n_chunks: ${chunk}\"\n      cpu=1\n      start=$(awk '{print $1}' <(awk 'NR == c' c=\"${chunk}\" chunk_split_chr${chr}.txt))\n      end=$(awk '{print $2}' <(awk 'NR == c' c=\"${chunk}\" chunk_split_chr${chr}.txt))\n\n      ## -- 21 : Phasing\n      bcftools index -f chr${chr}-REFfixed.vcf.gz\n      eagle --vcfRef !{params.BCFref}ALL.chr${chr}_GRCh38.genotypes.20170504.bcf --vcfTarget chr${chr}-REFfixed.vcf.gz --vcfOutFormat v --geneticMapFile /Eagle_v2.4.1/tables/genetic_map_hg38_withX.txt.gz --outPrefix chr_${chr}_chunk${chunk}.phased --bpStart ${start} --bpEnd ${end} --bpFlanking 5000000 --chrom chr${chr} --numThreads ${cpu}  > chr_${chr}_chunk${chunk}_phasing.logphase\n\n      ## -- 22 : Imputation\n      minimac4 --refHaps !{params.M3VCFref}ALL.chr${chr}.m3vcf.gz --haps chr_${chr}_chunk${chunk}.phased.vcf --prefix chr_${chr}_chunk${chunk}.imputed --allTypedSites --format GT,DS,GP --cpus ${cpu} --chr chr${chr} --start $start --end $end --window 500000 > chr_${chr}_chunk${chunk}.logimpute\n      bcftools index -f chr_${chr}_chunk${chunk}.imputed.dose.vcf.gz\n      '''",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "EAGLE"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/eagle_gxe"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "EAGLE",
                "uri": "https://bio.tools/eagle_gxe",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0602",
                            "term": "Molecular interactions, pathways and networks"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2497",
                                    "term": "Pathway or network analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3672",
                                    "term": "Gene functional annotation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3672",
                                    "term": "Sequence functional annotation"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2093",
                                "term": "Data reference"
                            },
                            {
                                "uri": "http://edamontology.org/data_2603",
                                "term": "Expression data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "An R package for detecting Gene-by-Environment (GxE) interaction effects on the transcriptome using Allele Specific Expression (ASE) quantified from RNA-seq",
                "homepage": "https://github.com/davidaknowles/eagle"
            }
        ],
        "inputs": [
            "NbChunk",
            "NbChr",
            "FilterFinal2",
            "ChunkSplit"
        ],
        "nb_inputs": 4,
        "outputs": [
            "FileVCF"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "Concatenation": {
        "name_process": "Concatenation",
        "string_process": " process Concatenation{\n      publishDir params.output+params.target+'/Result_Imputation/', mode: 'copy'\n      cpus=16\n\n      input:\n      val chromosomes from 1..22\n      file data from FileVCF.collect()\n\n      output:\n      file '*dose.vcf.gz' into Imputation\n\n      shell:\n      '''\n      chr=!{chromosomes}\n      mkdir chr_${chr}\n      ls chr_${chr}_chunk*.imputed.dose.vcf.gz> chr_${chr}_imp_res.txt\n\n      ## -- 23 : Concatenation\n      #bcftools concat --threads 16 -f chr_${chr}_imp_res.txt -Ou | bcftools sort --temp-dir chr_${chr} -Ou | bgzip -c > chr${chr}.dose.vcf.gz\n      bcftools concat --threads 16 -f chr_${chr}_imp_res.txt -Ou  | bgzip -c > chr${chr}.dose.vcf.gz\n      '''}",
        "nb_lignes_process": 19,
        "string_script": "      '''\n      chr=!{chromosomes}\n      mkdir chr_${chr}\n      ls chr_${chr}_chunk*.imputed.dose.vcf.gz> chr_${chr}_imp_res.txt\n\n      ## -- 23 : Concatenation\n      #bcftools concat --threads 16 -f chr_${chr}_imp_res.txt -Ou | bcftools sort --temp-dir chr_${chr} -Ou | bgzip -c > chr${chr}.dose.vcf.gz\n      bcftools concat --threads 16 -f chr_${chr}_imp_res.txt -Ou  | bgzip -c > chr${chr}.dose.vcf.gz\n      '''",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "1",
            "FileVCF"
        ],
        "nb_inputs": 2,
        "outputs": [
            "Imputation"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/Result_Imputation/', mode: 'copy'",
            "cpus=16"
        ],
        "when": "",
        "stub": ""
    },
    "Michighan_Imputation": {
        "name_process": "Michighan_Imputation",
        "string_process": " process Michighan_Imputation{\n      publishDir params.output+params.target+'/Result_Imputation/', mode: 'move'\n      input:\n      file data from Channel.fromPath(params.imputationbot_password).collect()\n      file data from FilterFinal2.collect()\n\n      output:\n      file 'job-*/local/*dose.vcf.gz' into Imputation_dose\n                                             \n                                          \n                                        \n\n      when:\n      !params.token_Michighan!=null\n\n      shell:\n      '''\n      pw=$(cat !{params.imputationbot_password})\n      token=$(cat !{params.token_Michighan})\n      imputationbot add-instance https://imputationserver.sph.umich.edu ${token}\n      imputationbot impute --files chr*-REFfixed.vcf.gz --refpanel hrc-r1.1 --build hg38 --autoDownload --password ${pw} --population mixed\n      '''\n    }",
        "nb_lignes_process": 21,
        "string_script": "      '''\n      pw=$(cat !{params.imputationbot_password})\n      token=$(cat !{params.token_Michighan})\n      imputationbot add-instance https://imputationserver.sph.umich.edu ${token}\n      imputationbot impute --files chr*-REFfixed.vcf.gz --refpanel hrc-r1.1 --build hg38 --autoDownload --password ${pw} --population mixed\n      '''",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "FilterFinal2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "Imputation_dose"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/Result_Imputation/', mode: 'move'"
        ],
        "when": "!params.token_Michighan!=null",
        "stub": ""
    },
    "TOPMed_Imputation": {
        "name_process": "TOPMed_Imputation",
        "string_process": " process TOPMed_Imputation{\n      publishDir params.output+params.target+'/Result_Imputation/', mode: 'move'\n      input:\n      file data from Channel.fromPath(params.imputationbot_password).collect()\n      file data from FilterFinal2.collect()\n\n      when:\n      !params.token_TOPMed!=null\n\n      output:\n      file ('*.{dose.vcf,info}.gz') into Imputation_res\n\n      shell:\n      '''\n      pw=$(cat !{params.imputationbot_password})\n      token=$(cat !{params.token_TOPMed})\n      imputationbot add-instance https://imputation.biodatacatalyst.nhlbi.nih.gov ${token}\n      imputationbot impute --files chr*-REFfixed.vcf.gz --refpanel topmed-r2 --build hg38 --autoDownload --password ${pw} --population mixed\n      mv job-*/local/*.gz .\n      mv job-*/logfile/* .\n      '''\n    }",
        "nb_lignes_process": 20,
        "string_script": "      '''\n      pw=$(cat !{params.imputationbot_password})\n      token=$(cat !{params.token_TOPMed})\n      imputationbot add-instance https://imputation.biodatacatalyst.nhlbi.nih.gov ${token}\n      imputationbot impute --files chr*-REFfixed.vcf.gz --refpanel topmed-r2 --build hg38 --autoDownload --password ${pw} --population mixed\n      mv job-*/local/*.gz .\n      mv job-*/logfile/* .\n      '''",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "FilterFinal2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "Imputation_res"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.output+params.target+'/Result_Imputation/', mode: 'move'"
        ],
        "when": "!params.token_TOPMed!=null",
        "stub": ""
    },
    "QC3_sh": {
        "name_process": "QC3_sh",
        "string_process": " process QC3_sh{\n    input:\n    val population from('ALL')\n    each chromosome from 21..22\n    file data from Channel.fromPath(params.output+params.target+'/Result_Imputation/*dose.vcf.gz').collect()\n    file data from Channel.fromPath(params.folder+'bravo-dbsnp-all.vcf.gz').collect()\n    file data from Channel.fromPath(params.folder+'bravo-dbsnp-all.vcf.gz.csi').collect()\n    file data from Admixture2.collect()\n\n    output:\n    file '*.{txt,frq}' into PostImputation_QC_sh_result\n\n    shell:\n    '''\n    pop=!{population}\n    chr=!{chromosome}\n\n    ## -- 24 : QC3\n    bash !{baseDir}/bin/postImputation_QC.sh ${chr} ${pop}\n    '''\n  }",
        "nb_lignes_process": 19,
        "string_script": "    '''\n    pop=!{population}\n    chr=!{chromosome}\n\n    ## -- 24 : QC3\n    bash !{baseDir}/bin/postImputation_QC.sh ${chr} ${pop}\n    '''",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "population",
            "21",
            "Admixture2"
        ],
        "nb_inputs": 3,
        "outputs": [
            "PostImputation_QC_sh_result"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "QC3_R": {
        "name_process": "QC3_R",
        "string_process": " process QC3_R{\n    if(params.QC_cloud==null){publishDir params.output+params.target+'/QC3/', mode: 'copy'}\n    else{publishDir params.output+params.target+'/QC3_cloud/', mode: 'copy'}\n    cpus 4\n\n    input:\n    val population from('ALL')\n    file data from PostImputation_QC_sh_result.collect()\n\n    output:\n    file '*v2.{txt,pdf}' into PostImputation_QC_R_result\n    file '*CHR.pdf' into PostImputation_QC_R_result2\n\n    shell:\n    '''\n    pop=!{population}\n    Rscript !{baseDir}/bin/postImputation_QC_plots.r ${pop} 0.3\n    '''\n  }",
        "nb_lignes_process": 17,
        "string_script": "    '''\n    pop=!{population}\n    Rscript !{baseDir}/bin/postImputation_QC_plots.r ${pop} 0.3\n    '''",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "population",
            "PostImputation_QC_sh_result"
        ],
        "nb_inputs": 2,
        "outputs": [
            "PostImputation_QC_R_result",
            "PostImputation_QC_R_result2"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "topmed_prep": {
        "name_process": "topmed_prep",
        "string_process": "\nprocess topmed_prep{\n  publishDir params.out+'files/', mode: 'copy'\n\n  output:\n  file 'PASS.Variants.TOPMed_freeze5_hg38_dbSNP.tab.gz' into legend_file\n  file 'bravo-dbsnp-all.vcf.gz*' into vcf_file\n\n  shell:\n  '''\n  curl 'https://bravo.sph.umich.edu/freeze5/hg38/download/all' -H 'Accept-Encoding: gzip, deflate, br' -H 'Cookie: _ga=GA1.2.1477458196.1624480500; _gid=GA1.2.800547376.1624480500; remember_token=\"gabriel.ag.aurelie@gmail.com|460bee66c4d92d96634bd5c507a5929490124b4d13c958db91aaabf91f91720372c8fbef1e59a85f865655f8df7008dc92c0376db6372d6b6d657aa086534fee\"; _gat_gtag_UA_73910830_2=1' --compressed > bravo-dbsnp-all.vcf.gz\n  curl -O https://www.well.ox.ac.uk/~wrayner/tools/CreateTOPMed.zip\n  unzip CreateTOPMed.zip\n  ./CreateTOPMed.pl -i bravo-dbsnp-all.vcf.gz -o PASS.Variants.TOPMed_freeze5_hg38_dbSNP.tab.gz\n  bcftools index bravo-dbsnp-all.vcf.gz\n  '''\n}",
        "nb_lignes_process": 15,
        "string_script": "  '''\n  curl 'https://bravo.sph.umich.edu/freeze5/hg38/download/all' -H 'Accept-Encoding: gzip, deflate, br' -H 'Cookie: _ga=GA1.2.1477458196.1624480500; _gid=GA1.2.800547376.1624480500; remember_token=\"gabriel.ag.aurelie@gmail.com|460bee66c4d92d96634bd5c507a5929490124b4d13c958db91aaabf91f91720372c8fbef1e59a85f865655f8df7008dc92c0376db6372d6b6d657aa086534fee\"; _gat_gtag_UA_73910830_2=1' --compressed > bravo-dbsnp-all.vcf.gz\n  curl -O https://www.well.ox.ac.uk/~wrayner/tools/CreateTOPMed.zip\n  unzip CreateTOPMed.zip\n  ./CreateTOPMed.pl -i bravo-dbsnp-all.vcf.gz -o PASS.Variants.TOPMed_freeze5_hg38_dbSNP.tab.gz\n  bcftools index bravo-dbsnp-all.vcf.gz\n  '''",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "CURLS",
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/CURLS",
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "CURLS",
                "uri": "https://bio.tools/CURLS",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3335",
                            "term": "Cardiology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3305",
                            "term": "Public health and epidemiology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3421",
                            "term": "Surgery"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "Pathology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3335",
                            "term": "Cardiovascular medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3305",
                            "term": "https://en.wikipedia.org/wiki/Public_health"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3305",
                            "term": "https://en.wikipedia.org/wiki/Epidemiology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3421",
                            "term": "https://en.wikipedia.org/wiki/Surgery"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "Disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "https://en.wikipedia.org/wiki/Pathology"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "towards a wider use of basic echo applications in Africa.\n\nBACKGROUND:Point-of-care ultrasound is increasingly being used as a diagnostic tool in resource-limited settings. The majority of existing ultrasound protocols have been developed and implemented in high-resource settings. In sub-Saharan Africa (SSA), patients with heart failure of various etiologies commonly present late in the disease process, with a similar syndrome of dyspnea, edema and cardiomegaly on chest X-ray. The causes of heart failure in SSA differ from those in high-resource settings. Point-of-care ultrasound has the potential to identify the underlying etiology of heart failure, and lead to targeted therapy.\n\n||| HOMEPAGE MISSING!.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'ultrasound', 'Cardiac ultrasound resource-limited settings', 'high-resource', 'cardiomegaly SSA'",
                "homepage": "https://www.ncbi.nlm.nih.gov/pubmed/?term=31883027"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "legend_file",
            "vcf_file"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.out+'files/', mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Download_files": {
        "name_process": "Download_files",
        "string_process": "\nprocess Download_files{\n  publishDir params.out+'files/', mode: 'copy'\n\n  output:\n  file \"{relationships_w_pops_121708.txt,checkVCF.py,GRCh38_full_analysis_set_plus_decoy_hla.fa,GRCh38_full_analysis_set_plus_decoy_hla.fa.fai}\" into File_donwload\n\n  shell:\n  \"\"\"\n  wget ftp://ftp.ncbi.nlm.nih.gov/hapmap/genotypes/2009-01_phaseIII/plink_format/relationships_w_pops_121708.txt\n  wget https://raw.githubusercontent.com/zhanxw/checkVCF/master/checkVCF.py\n  wget http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/GRCh38_reference_genome/GRCh38_full_analysis_set_plus_decoy_hla.fa\n  wget http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/GRCh38_reference_genome/GRCh38_full_analysis_set_plus_decoy_hla.fa.fai\n\n  \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  wget ftp://ftp.ncbi.nlm.nih.gov/hapmap/genotypes/2009-01_phaseIII/plink_format/relationships_w_pops_121708.txt\n  wget https://raw.githubusercontent.com/zhanxw/checkVCF/master/checkVCF.py\n  wget http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/GRCh38_reference_genome/GRCh38_full_analysis_set_plus_decoy_hla.fa\n  wget http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/reference/GRCh38_reference_genome/GRCh38_full_analysis_set_plus_decoy_hla.fa.fai\n\n  \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [
            "File_donwload"
        ],
        "nb_outputs": 1,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.out+'files/', mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "hapmap_peparation": {
        "name_process": "hapmap_peparation",
        "string_process": "\nprocess hapmap_peparation{\n  publishDir params.out+'files/', mode: 'copy'\n\n  input:\n  file data from legend_file.collect()\n\n  output:\n  file \"hapmap_r23a/\" into Hapmap_file\n  file \"*.chain\" into Chain_file\n\n  shell:\n  '''\n  wget http://zzz.bwh.harvard.edu/plink/dist/hapmap_r23a.zip\n  wget http://hgdownload.cse.ucsc.edu/goldenpath/hg18/liftOver/hg18ToHg38.over.chain.gz\n  wget http://hgdownload.cse.ucsc.edu/goldenpath/hg19/liftOver/hg19ToHg38.over.chain.gz\n  wget https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2432498/bin/pone.0002551.s003.xls\n\n  in2csv pone.0002551.s003.xls > pone.0002551.s003.csv\n\n  unzip hapmap_r23a.zip\n  gunzip *chain.gz\n\n  awk '{print \"chr\" \\$1, \\$4 -1, \\$4, \\$2 }' hapmap_r23a.bim | sed 's/chr23/chrX/' | sed 's/chr24/chrY/' > dataset.tolift\n  liftOver dataset.tolift hg18ToHg38.over.chain dataset1 dataset_NCBI36.unMapped\n\n  awk '{print \\$4}' dataset1 > dataset1.snps\n  plink --bfile hapmap_r23a --extract dataset1.snps --make-bed --out dataset1\n\n  awk '{print \\$4, \\$3}' dataset1  > dataset1.pos\n  plink --bfile dataset1 --update-map dataset1.pos --make-bed --out dataset2\n\n  #awk -F',' '{print \\$1}' pone.0002551.s003.csv | grep -v SNPID > AIM_list.txt\n  #plink --bfile dataset2 --extract AIM_list.txt --make-bed --out dataset3\n\n  plink --freq --bfile dataset2 --make-bed --out dataset3\n  perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b dataset3.bim -f dataset3.frq -r PASS.Variants.TOPMed_freeze5_hg38_dbSNP.tab.gz -h\n\n  bash Run-plink.sh\n\n  awk '{print \\$2}' dataset3-updated.fam > ref_samples.txt\n\n  mkdir hapmap_r23a/\n  mv ref_samples.txt hapmap_r23a/ref_samples.txt\n  #mv AIM_list.txt hapmap_r23a/AIM_list.txt\n  mv dataset3-updated.bed hapmap_r23a/hapmap_r23a.bed\n  mv dataset3-updated.bim hapmap_r23a/hapmap_r23a.bim\n  mv dataset3-updated.fam hapmap_r23a/hapmap_r23a.fam\n  '''\n}",
        "nb_lignes_process": 48,
        "string_script": "  '''\n  wget http://zzz.bwh.harvard.edu/plink/dist/hapmap_r23a.zip\n  wget http://hgdownload.cse.ucsc.edu/goldenpath/hg18/liftOver/hg18ToHg38.over.chain.gz\n  wget http://hgdownload.cse.ucsc.edu/goldenpath/hg19/liftOver/hg19ToHg38.over.chain.gz\n  wget https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2432498/bin/pone.0002551.s003.xls\n\n  in2csv pone.0002551.s003.xls > pone.0002551.s003.csv\n\n  unzip hapmap_r23a.zip\n  gunzip *chain.gz\n\n  awk '{print \"chr\" \\$1, \\$4 -1, \\$4, \\$2 }' hapmap_r23a.bim | sed 's/chr23/chrX/' | sed 's/chr24/chrY/' > dataset.tolift\n  liftOver dataset.tolift hg18ToHg38.over.chain dataset1 dataset_NCBI36.unMapped\n\n  awk '{print \\$4}' dataset1 > dataset1.snps\n  plink --bfile hapmap_r23a --extract dataset1.snps --make-bed --out dataset1\n\n  awk '{print \\$4, \\$3}' dataset1  > dataset1.pos\n  plink --bfile dataset1 --update-map dataset1.pos --make-bed --out dataset2\n\n  #awk -F',' '{print \\$1}' pone.0002551.s003.csv | grep -v SNPID > AIM_list.txt\n  #plink --bfile dataset2 --extract AIM_list.txt --make-bed --out dataset3\n\n  plink --freq --bfile dataset2 --make-bed --out dataset3\n  perl !{baseDir}/bin/HRC-1000G-check-bim.pl -b dataset3.bim -f dataset3.frq -r PASS.Variants.TOPMed_freeze5_hg38_dbSNP.tab.gz -h\n\n  bash Run-plink.sh\n\n  awk '{print \\$2}' dataset3-updated.fam > ref_samples.txt\n\n  mkdir hapmap_r23a/\n  mv ref_samples.txt hapmap_r23a/ref_samples.txt\n  #mv AIM_list.txt hapmap_r23a/AIM_list.txt\n  mv dataset3-updated.bed hapmap_r23a/hapmap_r23a.bed\n  mv dataset3-updated.bim hapmap_r23a/hapmap_r23a.bim\n  mv dataset3-updated.fam hapmap_r23a/hapmap_r23a.fam\n  '''",
        "nb_lignes_script": 36,
        "language_script": "bash",
        "tools": [
            "LiftOver",
            "pLink"
        ],
        "tools_url": [
            "https://bio.tools/liftover",
            "https://bio.tools/pLink-2"
        ],
        "tools_dico": [
            {
                "name": "LiftOver",
                "uri": "https://bio.tools/liftover",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This service converts genome coordinates and genome annotation files between assemblies.",
                "homepage": "http://api.bioinfo.no/wsdl/LiftOverService.wsdl"
            },
            {
                "name": "pLink",
                "uri": "https://bio.tools/pLink-2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3520",
                            "term": "Proteomics experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3649",
                                    "term": "Target-Decoy"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fragment weight comparison"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "PMF"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Peptide mass fingerprinting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2929",
                                    "term": "Protein fingerprinting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A high-speed search engine pLink 2 with systematic evaluation for proteome-scale identification of cross-linked peptides.",
                "homepage": "http://pfind.ict.ac.cn/software/pLink/index.html"
            }
        ],
        "inputs": [
            "legend_file"
        ],
        "nb_inputs": 1,
        "outputs": [
            "Hapmap_file",
            "Chain_file"
        ],
        "nb_outputs": 2,
        "name_workflow": "Monia234__IARC-imputation",
        "directive": [
            "publishDir params.out+'files/', mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}