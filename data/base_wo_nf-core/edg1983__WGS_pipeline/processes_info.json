{
    "SAMBLASTER": {
        "name_process": "SAMBLASTER",
        "string_process": "\nprocess SAMBLASTER {\n    label 'lowcores'\n\n    publishDir \"${params.outdir}\", mode: 'copy', pattern: \"*.log\"\n\n    input:\n    tuple val(sample), path('merged.bam')\n\n    output:\n    tuple val(sample), path('dedup.bam'), path('disc.sam'), path('split.sam'), emit: bam_files\n    path \"${sample}.dedup.log\" , emit: logfiles\n\n    script:\n    \"\"\"\n    samtools view -h merged.bam \\\n    | samblaster --excludeDups --addMateTags -d disc.sam -s split.sam 2> ${sample}.dedup.log \\\n    | samtools view -Sb - > dedup.bam\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    samtools view -h merged.bam \\\n    | samblaster --excludeDups --addMateTags -d disc.sam -s split.sam 2> ${sample}.dedup.log \\\n    | samtools view -Sb - > dedup.bam\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "SAMBLASTER"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/samblaster"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "SAMBLASTER",
                "uri": "https://bio.tools/samblaster",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3199",
                                    "term": "Split read mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3199",
                                    "term": "Split-read mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool to mark duplicates and extract discordant and split reads from SAM files.",
                "homepage": "https://github.com/GregoryFaust/samblaster"
            }
        ],
        "inputs": [
            "sample"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"${params.outdir}\", mode: 'copy', pattern: \"*.log\""
        ],
        "when": "",
        "stub": ""
    },
    "SVTOOLS_CLASSIFY_LARGESAMPLE": {
        "name_process": "SVTOOLS_CLASSIFY_LARGESAMPLE",
        "string_process": "\nprocess SVTOOLS_CLASSIFY_LARGESAMPLE {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: '*.classify.vcf.gz'\n\n    input:\n        file(pruned_vcf)\n        file(sex_file)                                                       \n        tuple file(mei_regions), file(mei_index)\n    \n    output:\n        file \"*.classify.vcf.gz\"\n\n    script:\n\n    \"\"\"\n    zcat $pruned_vcf \\\n    | svtools classify \\\n    -g $sex_file \\\n    -a $mei_regions \\\n    -m large_sample \\\n    | bgzip -c > ${params.outprefix}.classify.vcf.gz\n    \"\"\"     \n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    zcat $pruned_vcf \\\n    | svtools classify \\\n    -g $sex_file \\\n    -a $mei_regions \\\n    -m large_sample \\\n    | bgzip -c > ${params.outprefix}.classify.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "pruned_vcf",
            "sex_file",
            "mei_regions",
            "mei_index"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: '*.classify.vcf.gz'"
        ],
        "when": "",
        "stub": ""
    },
    "SVTOOLS_CLASSIFY_SMALLSAMPLE": {
        "name_process": "SVTOOLS_CLASSIFY_SMALLSAMPLE",
        "string_process": "\nprocess SVTOOLS_CLASSIFY_SMALLSAMPLE {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: '*.classify.vcf.gz'\n\n    input:\n        file(pruned_vcf)\n        file(sex_file)\n        file(training_bedpe)\n        tuple file(mei_regions), file(mei_index)\n    \n    output:\n        file \"*.classify.vcf.gz\"\n\n    script:\n    def outprefix = pruned_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    zcat $pruned_vcf \\\n    | svtools vcftobedpe  \\\n    | svtools varlookup -a stdin -b $training_bedpe -c HQ -d 50 \\\n    | svtools bedpetovcf \\\n    | svtools vcfsort \\\n    | bcftools view -i \"INFO/HQ_AF > 0\" \\\n    | bgzip -c > training.vars.vcf.gz\n\n    zcat $pruned_vcf \\\n    | svtools classify \\\n    -g $sex_file \\\n    -a $mei_regions \\\n    -m naive_bayes \\\n    -t training.vars.vcf.gz \\\n    | bgzip -c > ${outprefix}.classify.vcf.gz\n    \"\"\"     \n}",
        "nb_lignes_process": 32,
        "string_script": "    def outprefix = pruned_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    zcat $pruned_vcf \\\n    | svtools vcftobedpe  \\\n    | svtools varlookup -a stdin -b $training_bedpe -c HQ -d 50 \\\n    | svtools bedpetovcf \\\n    | svtools vcfsort \\\n    | bcftools view -i \"INFO/HQ_AF > 0\" \\\n    | bgzip -c > training.vars.vcf.gz\n\n    zcat $pruned_vcf \\\n    | svtools classify \\\n    -g $sex_file \\\n    -a $mei_regions \\\n    -m naive_bayes \\\n    -t training.vars.vcf.gz \\\n    | bgzip -c > ${outprefix}.classify.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "pruned_vcf",
            "sex_file",
            "training_bedpe",
            "mei_regions",
            "mei_index"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: '*.classify.vcf.gz'"
        ],
        "when": "",
        "stub": ""
    },
    "make_cohort_vcf": {
        "name_process": "make_cohort_vcf",
        "string_process": "\nprocess make_cohort_vcf {\n    label 'singlecore'\n\n    input: \n        file(cn_vcf)\n        tuple file(merged_vcf), file(coordinates)\n    \n    output:\n        file 'merged.sv.gt.cn.vcf'\n\n    script:\n\n    \"\"\"\n    ls *.cn.vcf > cnlist.txt\n    svtools vcfpaste -m ${merged_vcf} -f cnlist.txt -q > merged.sv.gt.cn.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    ls *.cn.vcf > cnlist.txt\n    svtools vcfpaste -m ${merged_vcf} -f cnlist.txt -q > merged.sv.gt.cn.vcf\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "cn_vcf",
            "merged_vcf",
            "coordinates"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "prune_cohort_vcf": {
        "name_process": "prune_cohort_vcf",
        "string_process": "\nprocess prune_cohort_vcf {\n    label 'singlecore'\n\n    input:\n        file(family_vcf)\n    \n    output:\n        file '*.pruned.vcf.gz'\n\n    script:\n\n    \"\"\"\n    cat $family_vcf | svtools afreq | svtools vcftobedpe | svtools bedpesort \\\n    | svtools prune -s -d 100 -e \\\"AF\\\" | svtools bedpetovcf \\\n    | bgzip -c > ${params.cohort_id}.sv.pruned.vcf.gz\n    \"\"\"  \n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    cat $family_vcf | svtools afreq | svtools vcftobedpe | svtools bedpesort \\\n    | svtools prune -s -d 100 -e \\\"AF\\\" | svtools bedpetovcf \\\n    | bgzip -c > ${params.cohort_id}.sv.pruned.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "family_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "DEEPVARIANT": {
        "name_process": "DEEPVARIANT",
        "string_process": "\nprocess DEEPVARIANT {\n    label 'highcores_AVX'\n    publishDir \"$output_vcfs\", mode: 'copy', pattern: \"*.vcf.gz*\"\n    publishDir \"$output_htmls\", mode: 'copy', pattern: \"*.html\"\n\n    input:\n        tuple file(genome), file(genome_fai)\n        tuple val(sampleID), file(bam_file), file(bai_file)\n\n    output:\n        path \"*.g.vcf.gz\", emit: gvcf\n        path \"*.g.vcf.gz.tbi\", emit: gvcf_tbi\n        tuple val(\"${sampleID}\"), file(\"${sampleID}.vcf.gz\"), file(\"${sampleID}.vcf.gz.tbi\"), emit: vcf\n        path \"*.html\", emit: html\n\n    script:\n    if (params.build == \"GRCh38\") {\n        STDCHRS = (1..22).collect { \"chr$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS chrX chrY chrM\"\n    }\n    if (params.build == \"GRCh37\") {\n        STDCHRS = (1..22).collect { \"$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS X Y MT\"\n    }\n\n    \"\"\"\n    mkdir temp_dir && \\\n    /opt/deepvariant/bin/run_deepvariant \\\n    --model_type=${params.mode} --ref=\"$genome\" \\\n    --reads=\"$bam_file\" \\\n    --output_vcf=\"${sampleID}.vcf.gz\" \\\n    --output_gvcf=\"${sampleID}.g.vcf.gz\" \\\n    --intermediate_results_dir=\"temp_dir\" \\\n    --num_shards=10 \\\n    --regions=\"$STDCHRS\"\n    \"\"\"\n}",
        "nb_lignes_process": 36,
        "string_script": "    if (params.build == \"GRCh38\") {\n        STDCHRS = (1..22).collect { \"chr$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS chrX chrY chrM\"\n    }\n    if (params.build == \"GRCh37\") {\n        STDCHRS = (1..22).collect { \"$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS X Y MT\"\n    }\n\n    \"\"\"\n    mkdir temp_dir && \\\n    /opt/deepvariant/bin/run_deepvariant \\\n    --model_type=${params.mode} --ref=\"$genome\" \\\n    --reads=\"$bam_file\" \\\n    --output_vcf=\"${sampleID}.vcf.gz\" \\\n    --output_gvcf=\"${sampleID}.g.vcf.gz\" \\\n    --intermediate_results_dir=\"temp_dir\" \\\n    --num_shards=10 \\\n    --regions=\"$STDCHRS\"\n    \"\"\"",
        "nb_lignes_script": 19,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "genome",
            "genome_fai",
            "sampleID",
            "bam_file",
            "bai_file"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'highcores_AVX'",
            "publishDir \"$output_vcfs\", mode: 'copy', pattern: \"*.vcf.gz*\"",
            "publishDir \"$output_htmls\", mode: 'copy', pattern: \"*.html\""
        ],
        "when": "",
        "stub": ""
    },
    "fastqc": {
        "name_process": "fastqc",
        "string_process": "\nprocess fastqc {\n    label 'singlecore'\n    publishDir \"$output_fastqc\", mode: 'copy'\n\n    input:\n    tuple val(sample), file(bam_file), file(bai_file)\n\n    output:\n    file(\"*_fastqc.zip\")\n\n    script:\n    \"\"\"\n    fastqc --noextract $bam_file\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    fastqc --noextract $bam_file\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "sample",
            "bam_file",
            "bai_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$output_fastqc\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "coverage": {
        "name_process": "coverage",
        "string_process": "\nprocess coverage {\n    label 'lowcores'\n    publishDir \"$output_coverage\", mode: 'copy'\n\n    input:\n    tuple val(sample), file(bam_file), file(bai_file)\n    file(regions)\n\n    output:\n    file(\"*.{dist.txt,bed.gz}\")\n\n    script:\n    \"\"\"\n    export MOSDEPTH_Q0=NO_COVERAGE   # 0 -- defined by the arguments to --quantize\n    export MOSDEPTH_Q1=LOW_COVERAGE  # 1..5\n    export MOSDEPTH_Q2=CALLABLE_10X  # 6..10\n    export MOSDEPTH_Q3=CALLABLE_20X  # 11..20\n    export MOSDEPTH_Q4=CALLABLE_100X # 21..100\n    export MOSDEPTH_Q5=HIGH_COV # >100\n\n    if [ -f \"$regions\" ]\n    then\n        MOSDEPTH_PRECISION=4 mosdepth -n -t 5 --quantize 0:1:6:11:21:101: --by $regions --thresholds 1,5,10,20 ${sample} $bam_file\n    else\n        MOSDEPTH_PRECISION=4 mosdepth -n -t 5 --quantize 0:1:6:11:21:101: ${sample} $bam_file\n    fi\n    \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "    \"\"\"\n    export MOSDEPTH_Q0=NO_COVERAGE   # 0 -- defined by the arguments to --quantize\n    export MOSDEPTH_Q1=LOW_COVERAGE  # 1..5\n    export MOSDEPTH_Q2=CALLABLE_10X  # 6..10\n    export MOSDEPTH_Q3=CALLABLE_20X  # 11..20\n    export MOSDEPTH_Q4=CALLABLE_100X # 21..100\n    export MOSDEPTH_Q5=HIGH_COV # >100\n\n    if [ -f \"$regions\" ]\n    then\n        MOSDEPTH_PRECISION=4 mosdepth -n -t 5 --quantize 0:1:6:11:21:101: --by $regions --thresholds 1,5,10,20 ${sample} $bam_file\n    else\n        MOSDEPTH_PRECISION=4 mosdepth -n -t 5 --quantize 0:1:6:11:21:101: ${sample} $bam_file\n    fi\n    \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sample",
            "bam_file",
            "bai_file",
            "regions"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$output_coverage\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "map_flag_stat": {
        "name_process": "map_flag_stat",
        "string_process": "\nprocess map_flag_stat {\n    label 'lowcores'\n    publishDir \"$output_mapflagstats\", mode: 'copy'\n\n    input:\n    tuple val(sample), file(bam_file), file(bai_file)\n\n    output:\n    file(\"*.{flagstat,mapstat}\")\n    \n    script:\n    \"\"\"\n    samtools flagstat -@ 5 $bam_file > ${sample}.flagstat\n    samtools idxstats $bam_file > ${sample}.mapstat\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    samtools flagstat -@ 5 $bam_file > ${sample}.flagstat\n    samtools idxstats $bam_file > ${sample}.mapstat\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "bam_file",
            "bai_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$output_mapflagstats\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "somalier": {
        "name_process": "somalier",
        "string_process": "\nprocess somalier {\n    label 'singlecore'\n    publishDir \"$output_somalier\", mode: 'copy', pattern: \"*.somalier\"\n\n    input:\n    tuple val(sample), file(bam_file), file(bai_file)\n    path(somalier_data)\n    tuple file(genome_fasta), file(genome_index)\n\n    output:\n    file(\"${sample}.somalier\")\n\n    script:\n    \"\"\"  \n    somalier extract -d ./ -f $genome_fasta -s ${somalier_data}/somalier_varsets/sites.${params.build}.vcf.gz $bam_file\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"  \n    somalier extract -d ./ -f $genome_fasta -s ${somalier_data}/somalier_varsets/sites.${params.build}.vcf.gz $bam_file\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "somalier"
        ],
        "tools_url": [
            "https://bio.tools/somalier"
        ],
        "tools_dico": [
            {
                "name": "somalier",
                "uri": "https://bio.tools/somalier",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Oncology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Targeted exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "WES"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Whole exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Cancer biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "https://en.wikipedia.org/wiki/Oncology"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "rapid relatedness estimation for cancer and germline studies using efficient genome sketches.\n\nfast sample-swap and relatedness checks on BAMs/CRAMs/VCFs/GVCFs.\n\nsomalier: extract informative sites, evaluate relatedness, and perform quality-control on BAM/CRAM/BCF/VCF/GVCF.\n\nNote that the somalier relate command runs extremely quickly (< 2 seconds for 600 samples and ~1 minute for 4,500 samples) so it's possible to add/remove samples or adjust a pedigree file and re-run iteratively",
                "homepage": "http://github.com/brentp/somalier"
            }
        ],
        "inputs": [
            "sample",
            "bam_file",
            "bai_file",
            "somalier_data",
            "genome_fasta",
            "genome_index"
        ],
        "nb_inputs": 6,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$output_somalier\", mode: 'copy', pattern: \"*.somalier\""
        ],
        "when": "",
        "stub": ""
    },
    "sex_and_relatedness": {
        "name_process": "sex_and_relatedness",
        "string_process": "\nprocess sex_and_relatedness {\n    label 'singlecore'\n    publishDir \"$output_reports\", mode: 'copy'\n    \n    input:\n    file(\"*\")\n    file(\"ped_file.ped\")\n\n    output:\n    file 'cohort_relate.*'\n\n    script:\n    \"\"\"\n    somalier relate -p ped_file.ped -o cohort_relate *.somalier\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    somalier relate -p ped_file.ped -o cohort_relate *.somalier\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "somalier"
        ],
        "tools_url": [
            "https://bio.tools/somalier"
        ],
        "tools_dico": [
            {
                "name": "somalier",
                "uri": "https://bio.tools/somalier",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Oncology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Targeted exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "WES"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Whole exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Cancer biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "https://en.wikipedia.org/wiki/Oncology"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "rapid relatedness estimation for cancer and germline studies using efficient genome sketches.\n\nfast sample-swap and relatedness checks on BAMs/CRAMs/VCFs/GVCFs.\n\nsomalier: extract informative sites, evaluate relatedness, and perform quality-control on BAM/CRAM/BCF/VCF/GVCF.\n\nNote that the somalier relate command runs extremely quickly (< 2 seconds for 600 samples and ~1 minute for 4,500 samples) so it's possible to add/remove samples or adjust a pedigree file and re-run iteratively",
                "homepage": "http://github.com/brentp/somalier"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$output_reports\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "ancestry": {
        "name_process": "ancestry",
        "string_process": "\nprocess ancestry {\n    label 'singlecore'\n    publishDir \"$output_reports\", mode: 'copy'\n    \n    input:\n    file(\"*\")\n    path(somalier_data)\n\n    output:\n    file 'cohort.*'\n\n    script:\n    \"\"\"\n    somalier ancestry --labels ${somalier_data}/ancestry-labels-1kg.tsv -o cohort.somalier-ancestry ${somalier_data}/1kg-somalier/*.somalier ++ *.somalier\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    somalier ancestry --labels ${somalier_data}/ancestry-labels-1kg.tsv -o cohort.somalier-ancestry ${somalier_data}/1kg-somalier/*.somalier ++ *.somalier\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "somalier"
        ],
        "tools_url": [
            "https://bio.tools/somalier"
        ],
        "tools_dico": [
            {
                "name": "somalier",
                "uri": "https://bio.tools/somalier",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Oncology"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Targeted exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "WES"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Whole exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Cancer biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "https://en.wikipedia.org/wiki/Oncology"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3435",
                                    "term": "Standardisation and normalisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "rapid relatedness estimation for cancer and germline studies using efficient genome sketches.\n\nfast sample-swap and relatedness checks on BAMs/CRAMs/VCFs/GVCFs.\n\nsomalier: extract informative sites, evaluate relatedness, and perform quality-control on BAM/CRAM/BCF/VCF/GVCF.\n\nNote that the somalier relate command runs extremely quickly (< 2 seconds for 600 samples and ~1 minute for 4,500 samples) so it's possible to add/remove samples or adjust a pedigree file and re-run iteratively",
                "homepage": "http://github.com/brentp/somalier"
            }
        ],
        "inputs": [
            "somalier_data"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$output_reports\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "MULTIQC": {
        "name_process": "MULTIQC",
        "string_process": "\nprocess MULTIQC {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy'\n\n    input:\n    file('*')\n\n    output:\n    file 'multiqc_report.html'\n\n    script:\n    \"\"\"\n    multiqc .\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    multiqc .\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "BCFTOOLS_STATS": {
        "name_process": "BCFTOOLS_STATS",
        "string_process": "\nprocess BCFTOOLS_STATS {\n    label 'singlecore'\n    \n    publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.stats\"\n\n    input:\n        tuple file(vcf_file), file(vcf_index)\n\n    output:\n        path \"*.stats\", emit: stats\n\n    script:\n    \"\"\"\n    bcftools stats -s- $vcf_file > ${vcf_file}.stats\n    bcftools index --stats $vcf_file > ${vcf_file}_varsPerChrom.stats\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    bcftools stats -s- $vcf_file > ${vcf_file}.stats\n    bcftools index --stats $vcf_file > ${vcf_file}_varsPerChrom.stats\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf_file",
            "vcf_index"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.stats\""
        ],
        "when": "",
        "stub": ""
    },
    "expansion_hunter": {
        "name_process": "expansion_hunter",
        "string_process": "\nprocess expansion_hunter {\n    label 'lowcores'\n    publishDir \"$params.outdir\", mode: 'copy'\n\n    input:\n    tuple val(sample), val(sex), file(bam_file), file(bai_file)\n    tuple file(genome_fasta), file(genome_index)\n    file(variant_catalog)\n\n    output:\n    path \"${sample}.json\", emit: json_files\n    path \"${sample}.vcf\", emit: vcf_files\n    path \"${sample}_realigned.bam\", emit: bam_files\n\n    script:\n    \"\"\"\n    ExpansionHunter --reads $bam_file \\\n    --reference $genome_fasta \\\n    --variant-catalog $variant_catalog \\\n    --sex $sex \\\n    --threads 5 \\\n    --output-prefix $sample 2> ${sample}.log\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    \"\"\"\n    ExpansionHunter --reads $bam_file \\\n    --reference $genome_fasta \\\n    --variant-catalog $variant_catalog \\\n    --sex $sex \\\n    --threads 5 \\\n    --output-prefix $sample 2> ${sample}.log\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "ExpansionHunter"
        ],
        "tools_url": [
            "https://bio.tools/ExpansionHunter"
        ],
        "tools_dico": [
            {
                "name": "ExpansionHunter",
                "uri": "https://bio.tools/ExpansionHunter",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "Whole genome sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "Genome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "WGS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Sequence-graph-based tool to analyze variation in short tandem repeat regions.",
                "homepage": "https://github.com/Illumina/ExpansionHunter/"
            }
        ],
        "inputs": [
            "sample",
            "sex",
            "bam_file",
            "bai_file",
            "genome_fasta",
            "genome_index",
            "variant_catalog"
        ],
        "nb_inputs": 7,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$params.outdir\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "compress_exphunter_vcf": {
        "name_process": "compress_exphunter_vcf",
        "string_process": "\nprocess compress_exphunter_vcf {\n    label 'singlecore'\n\n    input:\n    file(vcf_file)\n\n    output:\n    tuple file(\"${vcf_file}.gz\"), file(\"${vcf_file}.gz.tbi\" )\n\n    script:\n    \"\"\"\n    bgzip $vcf_file\n    tabix -p vcf ${vcf_file}.gz\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    bgzip $vcf_file\n    tabix -p vcf ${vcf_file}.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf_file"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "estimate_readlength": {
        "name_process": "estimate_readlength",
        "string_process": "\nprocess estimate_readlength {\n    label 'singlecore'\n\n    input:\n        tuple val(sampleID), file(bam_file), file(bai_file), file(split_bam), file(disc_bam)\n\n    output:\n        tuple val(sampleID), file(bam_file), file(bai_file), file(split_bam), file(disc_bam), stdout\n\n    script:\n    \"\"\"\n    samtools view $bam_file | tail -n+500000 | head -n200000 \\\n    | awk -F\"\\\\t\" '{sum += length(\\$10)}; END {print sum / NR}' \\\n    | xargs printf '%.*f' 0\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    samtools view $bam_file | tail -n+500000 | head -n200000 \\\n    | awk -F\"\\\\t\" '{sum += length(\\$10)}; END {print sum / NR}' \\\n    | xargs printf '%.*f' 0\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "ENdb"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/ENdb"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "ENdb",
                "uri": "https://bio.tools/ENdb",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0219",
                            "term": "Data submission, annotation and curation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0749",
                            "term": "Transcription factors and regulatory sites"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0440",
                                    "term": "Promoter prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0224",
                                    "term": "Query and retrieval"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0224",
                                    "term": "Database retrieval"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A manually curated database of experimentally supported enhancers for human and mouse. Enhancers are a class of cis-regulatory elements that can increase gene transcription by forming loops in intergenic regions, introns and exons",
                "homepage": "http://www.licpathway.net/ENdb"
            }
        ],
        "inputs": [
            "sampleID",
            "bam_file",
            "bai_file",
            "split_bam",
            "disc_bam"
        ],
        "nb_inputs": 5,
        "outputs": [
            "sampleID"
        ],
        "nb_outputs": 1,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "estimate_libvalues": {
        "name_process": "estimate_libvalues",
        "string_process": "\nprocess estimate_libvalues {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.histo\"\n\n    input:\n        tuple val(sampleID), file(bam_file), file(bai_file), file(split_bam), file(disc_bam), val(read_length)\n\n    output:\n        tuple val(sampleID), file(bam_file), file(bai_file), file(split_bam), file(disc_bam), file(\"${sampleID}.histo\"), val(read_length), stdout\n\n    script:\n    \"\"\"\n    samtools view $bam_file | tail -n+100000 \\\n    | pairend_distro.py -r $read_length -X 4 -N 10000 -o ${sampleID}.histo \\\n    | tr \"\\t\" \",\" | xargs printf '%s'\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    samtools view $bam_file | tail -n+100000 \\\n    | pairend_distro.py -r $read_length -X 4 -N 10000 -o ${sampleID}.histo \\\n    | tr \"\\t\" \",\" | xargs printf '%s'\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sampleID",
            "read_length",
            "bam_file",
            "bai_file",
            "split_bam",
            "disc_bam"
        ],
        "nb_inputs": 6,
        "outputs": [
            "read_length"
        ],
        "nb_outputs": 1,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.histo\""
        ],
        "when": "",
        "stub": ""
    },
    "LUMPY": {
        "name_process": "LUMPY",
        "string_process": "\nprocess LUMPY {\n    label 'lowcores'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.vcf\"\n\n    input:\n        tuple val(sampleID), file(bam_file), file(bai_file), file(split_bam), file(disc_bam), file(histo_file), val(read_length), val(lib_values)\n        file(exclude_regions)\n\n    output:\n        tuple val(sampleID), file(\"${sampleID}_lumpy.vcf\"), file(bam_file), file(bai_file), emit: vcf_files\n        tuple val(sampleID), file(bam_file), file(bai_file), emit: bam_files\n\n    script:\n    \"\"\"\n    mkdir tmp_folder && \\\n    lumpy -t tmp_folder/lumpy_tmp -P -mw 4 -tt 0 \\\n    -x $exclude_regions \\\n    -pe id:${sampleID},bam_file:${disc_bam},histo_file:${histo_file},${lib_values},read_length:${read_length},min_non_overlap:${read_length},discordant_z:5,back_distance:10,weight:1,min_mapping_threshold:20 \\\n    -sr id:${sampleID},bam_file:${split_bam},back_distance:10,weight:1,min_mapping_threshold:20 \\\n    > ${sampleID}_lumpy.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    mkdir tmp_folder && \\\n    lumpy -t tmp_folder/lumpy_tmp -P -mw 4 -tt 0 \\\n    -x $exclude_regions \\\n    -pe id:${sampleID},bam_file:${disc_bam},histo_file:${histo_file},${lib_values},read_length:${read_length},min_non_overlap:${read_length},discordant_z:5,back_distance:10,weight:1,min_mapping_threshold:20 \\\n    -sr id:${sampleID},bam_file:${split_bam},back_distance:10,weight:1,min_mapping_threshold:20 \\\n    > ${sampleID}_lumpy.vcf\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sampleID",
            "read_length",
            "lib_values",
            "bam_file",
            "bai_file",
            "split_bam",
            "disc_bam",
            "histo_file",
            "exclude_regions"
        ],
        "nb_inputs": 9,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.vcf\""
        ],
        "when": "",
        "stub": ""
    },
    "SORT_BAM": {
        "name_process": "SORT_BAM",
        "string_process": "\nprocess SORT_BAM {\n    label 'highcores'\n    publishDir \"${params.outdir}\", mode: 'copy', pattern: \"*.bam*\"\n\n    input:\n    tuple val(sample), path(bamfile), path(discbam), path(splitbam)\n    \n    output:\n    tuple val(sample), file(\"${sample}.sorted.bam\"), file(\"${sample}.disc.bam\"), file(\"${sample}.split.bam\"), emit: all_bams\n    tuple val(sample), file(\"${sample}.sorted.bam\"), file(\"${sample}.sorted.bam.bai\"), emit: main_bam\n    path(\"*.sorted.bam.bai\"), emit: idx_files\n\n    script:\n    \"\"\"\n    samtools sort -@ 10 -m12G -T bam_tmp -o ${sample}.sorted.bam $bamfile\n    samtools sort -@ 10 -m12G -T disc_tmp -o ${sample}.disc.bam $discbam\n    samtools sort -@ 10 -m12G -T split_tmp -o ${sample}.split.bam $splitbam\n    samtools index ${sample}.sorted.bam\n    samtools index ${sample}.disc.bam\n    samtools index ${sample}.split.bam\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    samtools sort -@ 10 -m12G -T bam_tmp -o ${sample}.sorted.bam $bamfile\n    samtools sort -@ 10 -m12G -T disc_tmp -o ${sample}.disc.bam $discbam\n    samtools sort -@ 10 -m12G -T split_tmp -o ${sample}.split.bam $splitbam\n    samtools index ${sample}.sorted.bam\n    samtools index ${sample}.disc.bam\n    samtools index ${sample}.split.bam\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "bamfile",
            "discbam",
            "splitbam"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'highcores'",
            "publishDir \"${params.outdir}\", mode: 'copy', pattern: \"*.bam*\""
        ],
        "when": "",
        "stub": ""
    },
    "concat_lumpy_calls": {
        "name_process": "concat_lumpy_calls",
        "string_process": "\nprocess concat_lumpy_calls {\n    label 'singlecore'\n\n    input:\n        file(lumpy_vcf)\n    \n    output:\n        file('sorted.vcf')\n\n    script:\n    def lumpy_files = lumpy_vcf.collect{ \"$it\" }.join(\" \")\n    \"\"\"\n    svtools lsort $lumpy_files > sorted.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    def lumpy_files = lumpy_vcf.collect{ \"$it\" }.join(\" \")\n    \"\"\"\n    svtools lsort $lumpy_files > sorted.vcf\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "lumpy_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "merge_lumpy_calls": {
        "name_process": "merge_lumpy_calls",
        "string_process": "\nprocess merge_lumpy_calls {\n    label 'singlecore'\n\n    input:\n        file(sorted_vcf)\n    \n    output:\n        tuple file('merged.vcf'), file('coordinates')\n\n    script:\n    \"\"\"\n    svtools lmerge -i $sorted_vcf -f 20 | grep -v \"KN\\\\|JTFH\\\\|HLA\" > merged.vcf\n    create_coordinates -i merged.vcf -o coordinates\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    svtools lmerge -i $sorted_vcf -f 20 | grep -v \"KN\\\\|JTFH\\\\|HLA\" > merged.vcf\n    create_coordinates -i merged.vcf -o coordinates\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "HLA"
        ],
        "tools_url": [
            "https://bio.tools/HLA"
        ],
        "tools_dico": [
            {
                "name": "HLA",
                "uri": "https://bio.tools/HLA",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3630",
                                    "term": "Protein quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3630",
                                    "term": "Protein quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Using RNA Sequencing to Characterize the Tumor Microenvironment | Using k-mers to call HLA alleles in RNA sequencing data | HLAProfiler uses the k-mer content of next generation sequencing reads to call HLA types in a sample. Based on the k-mer content each each read pair is assigned to an HLA gene and the aggregate k-mer profile for the gene is compared to reference k-mer profiles to determin the HLA type. Currently HLAProfiler only supports paired-end RNA-seq data",
                "homepage": "https://github.com/ExpressionAnalysis/HLAProfiler"
            }
        ],
        "inputs": [
            "sorted_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "getSampleIDs": {
        "name_process": "getSampleIDs",
        "string_process": "\nprocess getSampleIDs {\n    executor 'local'\n\n    input:\n    tuple file(vcf_file), file(vcf_index)\n\n    output:\n    file(\"samples.txt\")\n\n    script:\n    \"\"\"\n    zgrep -m1 \"#CHROM\" $vcf_file | cut -f10- | tr \"\\\\t\" \"\\\\n\" > samples.txt\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    zgrep -m1 \"#CHROM\" $vcf_file | cut -f10- | tr \"\\\\t\" \"\\\\n\" > samples.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf_file",
            "vcf_index"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "executor 'local'"
        ],
        "when": "",
        "stub": ""
    },
    "BCFTOOLS_FILTER": {
        "name_process": "BCFTOOLS_FILTER",
        "string_process": "\nprocess BCFTOOLS_FILTER {\n    label 'singlecore'\n    publishDir \"${params.outdir}\", mode: 'copy'\n\n    input:\n        tuple val(prefix), file(vcf_file), file(vcf_index)\n        val(filter_string) \n                                                             \n\n    output:\n        tuple file(\"${prefix}.PASS.vcf.gz\"), file(\"${prefix}.PASS.vcf.gz.csi\"), emit: pass_vcf\n        tuple file(\"${prefix}.processed.vcf.gz\"), file(\"${prefix}.processed.vcf.gz.csi\"), emit: processed_vcf\n\n    script:\n    \"\"\"\n    bcftools filter -m + -s LowQual \\\n    -e '$filter_string' \\\n    -Oz -o ${prefix}.processed.vcf.gz \\\n    $vcf_file\n    tabix -p vcf -m 12 --csi ${prefix}.processed.vcf.gz\n\n    zgrep \"#\\\\|PASS\" ${prefix}.processed.vcf.gz \\\n    | bgzip -c > ${prefix}.PASS.vcf.gz\n    tabix -p vcf -m 12 --csi ${prefix}.PASS.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "    \"\"\"\n    bcftools filter -m + -s LowQual \\\n    -e '$filter_string' \\\n    -Oz -o ${prefix}.processed.vcf.gz \\\n    $vcf_file\n    tabix -p vcf -m 12 --csi ${prefix}.processed.vcf.gz\n\n    zgrep \"#\\\\|PASS\" ${prefix}.processed.vcf.gz \\\n    | bgzip -c > ${prefix}.PASS.vcf.gz\n    tabix -p vcf -m 12 --csi ${prefix}.PASS.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "PASS"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/pass"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "PASS",
                "uri": "https://bio.tools/pass",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "PASS: a program to align short sequences",
                "homepage": "http://pass.cribi.unipd.it/cgi-bin/pass.pl"
            }
        ],
        "inputs": [
            "prefix",
            "vcf_file",
            "vcf_index",
            "filter_string"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"${params.outdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "CNVNATOR": {
        "name_process": "CNVNATOR",
        "string_process": "\nprocess CNVNATOR {\n    label 'lowcores'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.root\"\n\n    input:\n        tuple val(sampleID), file(bam_file), file(bai_file)\n        path chrs_folder\n\n    output:\n        tuple val(sampleID), file(\"${sampleID}.root\")\n\n    script:\n    if (params.build == \"GRCh38\") {\n        STDCHRS = (1..22).collect { \"chr$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS chrX chrY chrM\"\n    }\n    if (params.build == \"GRCh37\") {\n        STDCHRS = (1..22).collect { \"$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS X Y MT\"\n    }\n    \n    \"\"\"\n    cnvnator -root ${sampleID}.root -chrom $STDCHRS -tree $bam_file\n    \n    cnvnator -root ${sampleID}.root -d $chrs_folder -his 100 \n\tcnvnator -root ${sampleID}.root -d $chrs_folder -his 1000 \n\n\tcnvnator -root ${sampleID}.root -stat 100\n\tcnvnator -root ${sampleID}.root -stat 1000\n\n\tcnvnator -root ${sampleID}.root -partition 100\n\tcnvnator -root ${sampleID}.root -partition 1000\n    \"\"\"\n}",
        "nb_lignes_process": 33,
        "string_script": "    if (params.build == \"GRCh38\") {\n        STDCHRS = (1..22).collect { \"chr$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS chrX chrY chrM\"\n    }\n    if (params.build == \"GRCh37\") {\n        STDCHRS = (1..22).collect { \"$it\"}.join(' ')\n        STDCHRS = \"$STDCHRS X Y MT\"\n    }\n    \n    \"\"\"\n    cnvnator -root ${sampleID}.root -chrom $STDCHRS -tree $bam_file\n    \n    cnvnator -root ${sampleID}.root -d $chrs_folder -his 100 \n\tcnvnator -root ${sampleID}.root -d $chrs_folder -his 1000 \n\n\tcnvnator -root ${sampleID}.root -stat 100\n\tcnvnator -root ${sampleID}.root -stat 1000\n\n\tcnvnator -root ${sampleID}.root -partition 100\n\tcnvnator -root ${sampleID}.root -partition 1000\n    \"\"\"",
        "nb_lignes_script": 20,
        "language_script": "bash",
        "tools": [
            "CNVnator"
        ],
        "tools_url": [
            "https://bio.tools/cnvnator"
        ],
        "tools_dico": [
            {
                "name": "CNVnator",
                "uri": "https://bio.tools/cnvnator",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2815",
                            "term": "Human biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_2815",
                            "term": "Humans"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "CNV discovery and genotyping from read-depth analysis of personal genome sequencing.",
                "homepage": "https://github.com/abyzovlab/CNVnator"
            }
        ],
        "inputs": [
            "sampleID",
            "bam_file",
            "bai_file",
            "chrs_folder"
        ],
        "nb_inputs": 4,
        "outputs": [
            "sampleID"
        ],
        "nb_outputs": 1,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.root\""
        ],
        "when": "",
        "stub": ""
    },
    "FIX_SVTOOLS_VCF": {
        "name_process": "FIX_SVTOOLS_VCF",
        "string_process": "\nprocess FIX_SVTOOLS_VCF {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy'\n\n    input:\n        file(input_vcf)\n    \n    output:\n        file \"*.raw.vcf.gz\"\n\n    script:\n    def outprefix = input_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    Fix_svtools_VCF.py -v $input_vcf -o ${outprefix}.raw.vcf\n    bgzip ${outprefix}.raw.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    def outprefix = input_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    Fix_svtools_VCF.py -v $input_vcf -o ${outprefix}.raw.vcf\n    bgzip ${outprefix}.raw.vcf\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "input_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "convert_to_bed": {
        "name_process": "convert_to_bed",
        "string_process": "\nprocess convert_to_bed {\n    label 'singlecore'\n\n    input:\n        file(temp_vcf)\n    \n    output:\n        file 'temp_5.noBND.forOverlap.bed'\n\n    script:\n    \"\"\"\n    svtools vcftobedpe -i $temp_vcf -o temp_5.bedpe\n    svtools bedpetobed12 -i temp_5.bedpe -o temp_5.bed\n    grep -v \"BND\" temp_5.bed | tail -n+2 | cut -f1-4 | tr \";\" \"\\t\" \\\n    | cut -f1-5 | sed 's/ID=//g' > temp_5.noBND.forOverlap.bed\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    svtools vcftobedpe -i $temp_vcf -o temp_5.bedpe\n    svtools bedpetobed12 -i temp_5.bedpe -o temp_5.bed\n    grep -v \"BND\" temp_5.bed | tail -n+2 | cut -f1-4 | tr \";\" \"\\t\" \\\n    | cut -f1-5 | sed 's/ID=//g' > temp_5.noBND.forOverlap.bed\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "temp_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "lowcomplexity_filter": {
        "name_process": "lowcomplexity_filter",
        "string_process": "\nprocess lowcomplexity_filter {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy'\n\n    input:\n        file(vcf_file)\n        file(bed_file)\n        tuple file(lowcomplexity_regions), file(lowcomplexity_index)\n    \n    output:\n        file \"*.LCR.vcf.gz\"\n\n    script:\n    def outprefix = vcf_file.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    bedtools coverage -wa \\\n    -a $bed_file \\\n    -b $lowcomplexity_regions \\\n    > overlapExcludeRegions.txt\n    \n    FilterSVByValue.py \\\n    -v $vcf_file \\\n    -b overlapExcludeRegions.txt \\\n    -c 9 -i 5 -t LowComplexity -x 0.7 -l 1000 -o temp_LCR.vcf\n    sed 's/:\\\\./:0/g' temp_LCR.vcf | bgzip -c > ${outprefix}.LCR.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "    def outprefix = vcf_file.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    bedtools coverage -wa \\\n    -a $bed_file \\\n    -b $lowcomplexity_regions \\\n    > overlapExcludeRegions.txt\n    \n    FilterSVByValue.py \\\n    -v $vcf_file \\\n    -b overlapExcludeRegions.txt \\\n    -c 9 -i 5 -t LowComplexity -x 0.7 -l 1000 -o temp_LCR.vcf\n    sed 's/:\\\\./:0/g' temp_LCR.vcf | bgzip -c > ${outprefix}.LCR.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "vcf_file",
            "bed_file",
            "lowcomplexity_regions",
            "lowcomplexity_index"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "MERGE_BAMS": {
        "name_process": "MERGE_BAMS",
        "string_process": "\nprocess MERGE_BAMS {\n    label 'lowcores'\n\n    input:\n                                                \n                                                    \n    tuple val(sample), file(myfiles)\n\n    output:\n    tuple val(sample), file('merged.bam'), emit: merged_bam\n\n    script:\n    def input_args = myfiles.collect{ \"$it\" }.join(\" \")\n    \n    \"\"\"\n    samtools merge -n -f -@ 5 merged.bam $input_args\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    def input_args = myfiles.collect{ \"$it\" }.join(\" \")\n    \n    \"\"\"\n    samtools merge -n -f -@ 5 merged.bam $input_args\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "myfiles"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'"
        ],
        "when": "",
        "stub": ""
    },
    "BCFTOOLS_NORM": {
        "name_process": "BCFTOOLS_NORM",
        "string_process": "\nprocess BCFTOOLS_NORM {\n    label 'singlecore'\n\n    input:\n        tuple val(prefix), file(vcf_file), file(vcf_index)\n        tuple file(genome), file(genome_fai)\n\n    output:\n        tuple val(prefix), file(\"${prefix}.norm.vcf.gz\"), file(\"${prefix}.norm.vcf.gz.csi\"), emit: norm_vcf\n    \n    script:\n    \"\"\"\n    VCF_toolbox annotate_multiallele -v $vcf_file -o temp.vcf.gz\n\n    bcftools norm -m- -f $genome \\\n    -Oz -o ${prefix}.norm.vcf.gz temp.vcf.gz\n\n    tabix -p vcf -m 12 --csi ${prefix}.norm.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    VCF_toolbox annotate_multiallele -v $vcf_file -o temp.vcf.gz\n\n    bcftools norm -m- -f $genome \\\n    -Oz -o ${prefix}.norm.vcf.gz temp.vcf.gz\n\n    tabix -p vcf -m 12 --csi ${prefix}.norm.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "prefix",
            "vcf_file",
            "vcf_index",
            "genome",
            "genome_fai"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "FIX_DEEPVAR_VCF": {
        "name_process": "FIX_DEEPVAR_VCF",
        "string_process": "\nprocess FIX_DEEPVAR_VCF {\n    label 'singlecore'\n\n    input:\n        tuple val(prefix), file(vcf_file), file(vcf_index)\n\n    output:\n        tuple val(prefix), file(\"${prefix}.fix.vcf.gz\"), file(\"${prefix}.fix.vcf.gz.csi\"), emit: fixed_vcf\n\n    script:\n    \"\"\"\n    VCF_toolbox deepvar_fix \\\n    -v $vcf_file -o ${prefix}.fix.vcf.gz \\\n    --fixGQ --setMissing --fixhalfGT --computeAB\n    tabix -p vcf -m 12 --csi ${prefix}.fix.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    VCF_toolbox deepvar_fix \\\n    -v $vcf_file -o ${prefix}.fix.vcf.gz \\\n    --fixGQ --setMissing --fixhalfGT --computeAB\n    tabix -p vcf -m 12 --csi ${prefix}.fix.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "prefix",
            "vcf_file",
            "vcf_index"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "SVTYPER": {
        "name_process": "SVTYPER",
        "string_process": "\nprocess SVTYPER {\n    label 'lowcores'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.gt.vcf.gz\"\n\n    input:\n        tuple val(sampleID), file(lumpy_vcf), file(bam_file), file(bai_file)\n        tuple file(genome_fasta), file(genome_fai)\n\n    output:\n        tuple val(sampleID), path(\"*.gt.vcf.gz\")\n\n    script:\n    \"\"\"\n    svtyper-sso --cores 5 --batch_size 1000 --max_reads 2500 -B $bam_file -T $genome_fasta -i $lumpy_vcf | bgzip -c > ${sampleID}_lumpy.gt.vcf.gz\n    \"\"\"   \n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    svtyper-sso --cores 5 --batch_size 1000 --max_reads 2500 -B $bam_file -T $genome_fasta -i $lumpy_vcf | bgzip -c > ${sampleID}_lumpy.gt.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sampleID",
            "lumpy_vcf",
            "bam_file",
            "bai_file",
            "genome_fasta",
            "genome_fai"
        ],
        "nb_inputs": 6,
        "outputs": [
            "sampleID"
        ],
        "nb_outputs": 1,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: \"*.gt.vcf.gz\""
        ],
        "when": "",
        "stub": ""
    },
    "BWA_GRCh37": {
        "name_process": "BWA_GRCh37",
        "string_process": "\nprocess BWA_GRCh37 {\n    label 'highcores'\n    \n    input:\n    tuple val(sample), path(reads_R1), path(reads_R2)\n    tuple val(genome_fasta), file(genome_files)\n\n    output:\n    tuple val(sample), file(\"*.part.bam\"), emit: bam_file   \n\n    script:\n    def prefix = reads_R1.getSimpleName()\n    \"\"\"\n    bwa mem -t10 -R\\\"@RG\\\\tID:${sample}\\\\tSM:${sample}\\\\tPL:Illumina\\\" ${genome_fasta} $reads_R1 $reads_R2 2> ${prefix}.log.bwamem \\\n    | samtools view -1 - > ${prefix}.part.bam\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    def prefix = reads_R1.getSimpleName()\n    \"\"\"\n    bwa mem -t10 -R\\\"@RG\\\\tID:${sample}\\\\tSM:${sample}\\\\tPL:Illumina\\\" ${genome_fasta} $reads_R1 $reads_R2 2> ${prefix}.log.bwamem \\\n    | samtools view -1 - > ${prefix}.part.bam\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "reads_R1",
            "reads_R2",
            "genome_fasta",
            "genome_files"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'highcores'"
        ],
        "when": "",
        "stub": ""
    },
    "BWA_GRCh38": {
        "name_process": "BWA_GRCh38",
        "string_process": "\nprocess BWA_GRCh38 {\n    label 'highcores'\n    \n    input:\n    tuple val(sample), path(reads_R1), path(reads_R2)\n    tuple val(genome_fasta), file(genome_files)\n\n    output:\n    tuple val(sample), file(\"*.part.bam\"), emit: bam_file   \n\n    script:\n    def prefix = reads_R1.getSimpleName()\n    \"\"\"\n    bwa mem -t10 -R\\\"@RG\\\\tID:${sample}\\\\tSM:${sample}\\\\tPL:Illumina\\\" ${genome_fasta} $reads_R1 $reads_R2 2> ${prefix}.log.bwamem \\\n    | k8 /opt/bwa.kit/bwa-postalt.js -p ${prefix}.hla ${genome_fasta}.alt \\\n    | samtools view -1 - > ${prefix}.part.bam\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    def prefix = reads_R1.getSimpleName()\n    \"\"\"\n    bwa mem -t10 -R\\\"@RG\\\\tID:${sample}\\\\tSM:${sample}\\\\tPL:Illumina\\\" ${genome_fasta} $reads_R1 $reads_R2 2> ${prefix}.log.bwamem \\\n    | k8 /opt/bwa.kit/bwa-postalt.js -p ${prefix}.hla ${genome_fasta}.alt \\\n    | samtools view -1 - > ${prefix}.part.bam\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sample",
            "reads_R1",
            "reads_R2",
            "genome_fasta",
            "genome_files"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'highcores'"
        ],
        "when": "",
        "stub": ""
    },
    "SVTOOLS_REGENOTYPE": {
        "name_process": "SVTOOLS_REGENOTYPE",
        "string_process": "\nprocess SVTOOLS_REGENOTYPE {\n    label 'lowcores'\n\n    input:\n        tuple val(sampleID), file(bam_file), file(bai_file)\n        tuple file(merged_vcf), file(coordinates)\n\n    output:\n        tuple val(sampleID), file(\"${params.cohort_id}_${sampleID}.gt.vcf\")\n        \n    script:\n    \"\"\"\n    (grep \"^#\" $merged_vcf && grep -v \"^#\" $merged_vcf | awk '{OFS=\"\\\\t\"};{ \\$6=\".\"; print }') \\\n    | svtools genotype -B $bam_file -l ${sampleID}.bam.json \\\n    | sed 's/PR...=[0-9\\\\.e,-]*\\\\(;\\\\)\\\\{0,1\\\\}\\\\(\\\\t\\\\)\\\\{0,1\\\\}/\\\\2/g' - \\\n    > ${params.cohort_id}_${sampleID}.gt.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    (grep \"^#\" $merged_vcf && grep -v \"^#\" $merged_vcf | awk '{OFS=\"\\\\t\"};{ \\$6=\".\"; print }') \\\n    | svtools genotype -B $bam_file -l ${sampleID}.bam.json \\\n    | sed 's/PR...=[0-9\\\\.e,-]*\\\\(;\\\\)\\\\{0,1\\\\}\\\\(\\\\t\\\\)\\\\{0,1\\\\}/\\\\2/g' - \\\n    > ${params.cohort_id}_${sampleID}.gt.vcf\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sampleID",
            "bam_file",
            "bai_file",
            "merged_vcf",
            "coordinates"
        ],
        "nb_inputs": 5,
        "outputs": [
            "sampleID"
        ],
        "nb_outputs": 1,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'"
        ],
        "when": "",
        "stub": ""
    },
    "SVTOOLS_CN_COHORT": {
        "name_process": "SVTOOLS_CN_COHORT",
        "string_process": "\nprocess SVTOOLS_CN_COHORT {\n    label 'lowcores'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: '*.cn.vcf'\n\n    input:\n        tuple val(sampleID), file(lumpy_gt_file), file(root_file)\n        tuple file(merged_vcf), file(coordinates)\n\n    output:\n        file(\"${params.cohort_id}_${sampleID}.cn.vcf\")\n\n    script:\n    \"\"\"\n    svtools copynumber --cnvnator cnvnator -w 100 \\\n    -s $sampleID \\\n    -r $root_file \\\n    -c $coordinates \\\n    -i $lumpy_gt_file \\\n    > ${params.cohort_id}_${sampleID}.cn.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    svtools copynumber --cnvnator cnvnator -w 100 \\\n    -s $sampleID \\\n    -r $root_file \\\n    -c $coordinates \\\n    -i $lumpy_gt_file \\\n    > ${params.cohort_id}_${sampleID}.cn.vcf\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "sampleID",
            "lumpy_gt_file",
            "root_file",
            "merged_vcf",
            "coordinates"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: '*.cn.vcf'"
        ],
        "when": "",
        "stub": ""
    },
    "SVTOOLS_CN_SINGLE": {
        "name_process": "SVTOOLS_CN_SINGLE",
        "string_process": "\nprocess SVTOOLS_CN_SINGLE {\n    label 'lowcores'\n    publishDir \"$params.outdir\", mode: 'copy', pattern: '*.cn.vcf'\n\n    input:\n        tuple val(sampleID), file(lumpy_gt_file), file(root_file)\n                                              \n\n    output:\n        file(\"${sampleID}.cn.vcf.gz\")\n\n    script:\n    \"\"\"\n    zgrep -v \"KN\\\\|JTFH\\\\|HLA\" $lumpy_gt_file > clean.vcf\n    create_coordinates -i clean.vcf -o coordinates\n    \n    svtools copynumber --cnvnator cnvnator -w 100 \\\n    -s $sampleID \\\n    -r $root_file \\\n    -c coordinates \\\n    -i $lumpy_gt_file \\\n    > ${sampleID}.cn.vcf\n    bgzip ${sampleID}.cn.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    zgrep -v \"KN\\\\|JTFH\\\\|HLA\" $lumpy_gt_file > clean.vcf\n    create_coordinates -i clean.vcf -o coordinates\n    \n    svtools copynumber --cnvnator cnvnator -w 100 \\\n    -s $sampleID \\\n    -r $root_file \\\n    -c coordinates \\\n    -i $lumpy_gt_file \\\n    > ${sampleID}.cn.vcf\n    bgzip ${sampleID}.cn.vcf\n    \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "HLA"
        ],
        "tools_url": [
            "https://bio.tools/HLA"
        ],
        "tools_dico": [
            {
                "name": "HLA",
                "uri": "https://bio.tools/HLA",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3630",
                                    "term": "Protein quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3630",
                                    "term": "Protein quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Using RNA Sequencing to Characterize the Tumor Microenvironment | Using k-mers to call HLA alleles in RNA sequencing data | HLAProfiler uses the k-mer content of next generation sequencing reads to call HLA types in a sample. Based on the k-mer content each each read pair is assigned to an HLA gene and the aggregate k-mer profile for the gene is compared to reference k-mer profiles to determin the HLA type. Currently HLAProfiler only supports paired-end RNA-seq data",
                "homepage": "https://github.com/ExpressionAnalysis/HLAProfiler"
            }
        ],
        "inputs": [
            "sampleID",
            "lumpy_gt_file",
            "root_file"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'lowcores'",
            "publishDir \"$params.outdir\", mode: 'copy', pattern: '*.cn.vcf'"
        ],
        "when": "",
        "stub": ""
    },
    "QUALITY_FILTER_LARGESAMPLE": {
        "name_process": "QUALITY_FILTER_LARGESAMPLE",
        "string_process": "process QUALITY_FILTER_LARGESAMPLE {\n    label 'singlecore'\n\n    input:\n        file(pruned_vcf)\n    \n    output:\n        file \"*.filters.vcf.gz\" \n\n    script:\n    def outprefix = pruned_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\").replaceFirst(/\\.raw/, \"\")\n    \"\"\"\n    zcat $pruned_vcf > temp_0.vcf\n    \n    bcftools filter -m + -s LowConfSmallDEL \\\n    -e 'INFO/SVTYPE == \"DEL\" && INFO/SVLEN >= -1000 && N_PASS(AS > 0) == 0' \\\n    temp_0.vcf > temp_1.vcf\n\n    bcftools filter -m + -s INV_LowMSQ \\\n    -e 'INFO/SVTYPE == \"INV\" && INFO/MSQ < 150' \\\n    temp_1.vcf > temp_2.vcf\n\n    bcftools filter -m + -s INV_LowLumpyEvidence \\\n    -e 'INFO/SVTYPE == \"INV\" && ((INFO/SR / INFO/SU) < 0.1 || (INFO/PE / INFO/SU) < 0.1)' \\\n    temp_2.vcf > temp_3.vcf\n\n    bcftools filter -m + -s BND_LowMSQ \\\n    -e 'INFO/SVTYPE == \"BND\" && INFO/MSQ < 250' \\\n    temp_3.vcf > temp_4.vcf\n\n    bcftools filter -m + -s DELDUP_LowMSQ \\\n    -e '(INFO/SVTYPE == \"DEL\" || INFO/SVTYPE == \"DUP\") && INFO/MSQ < 40' \\\n    temp_4.vcf > temp_4b.vcf\n\n    bcftools filter -m + -s VerySmallSV \\\n    -e '(INFO/SVTYPE == \"DEL\" && INFO/SVLEN > -50) || (INFO/SVTYPE == \"DUP\" && INFO/SVLEN < 50)' \\\n    temp_4b.vcf > ${outprefix}.filters.vcf\n\n    bgzip ${outprefix}.filters.vcf\n    \"\"\"    \n}",
        "nb_lignes_process": 39,
        "string_script": "    def outprefix = pruned_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\").replaceFirst(/\\.raw/, \"\")\n    \"\"\"\n    zcat $pruned_vcf > temp_0.vcf\n    \n    bcftools filter -m + -s LowConfSmallDEL \\\n    -e 'INFO/SVTYPE == \"DEL\" && INFO/SVLEN >= -1000 && N_PASS(AS > 0) == 0' \\\n    temp_0.vcf > temp_1.vcf\n\n    bcftools filter -m + -s INV_LowMSQ \\\n    -e 'INFO/SVTYPE == \"INV\" && INFO/MSQ < 150' \\\n    temp_1.vcf > temp_2.vcf\n\n    bcftools filter -m + -s INV_LowLumpyEvidence \\\n    -e 'INFO/SVTYPE == \"INV\" && ((INFO/SR / INFO/SU) < 0.1 || (INFO/PE / INFO/SU) < 0.1)' \\\n    temp_2.vcf > temp_3.vcf\n\n    bcftools filter -m + -s BND_LowMSQ \\\n    -e 'INFO/SVTYPE == \"BND\" && INFO/MSQ < 250' \\\n    temp_3.vcf > temp_4.vcf\n\n    bcftools filter -m + -s DELDUP_LowMSQ \\\n    -e '(INFO/SVTYPE == \"DEL\" || INFO/SVTYPE == \"DUP\") && INFO/MSQ < 40' \\\n    temp_4.vcf > temp_4b.vcf\n\n    bcftools filter -m + -s VerySmallSV \\\n    -e '(INFO/SVTYPE == \"DEL\" && INFO/SVLEN > -50) || (INFO/SVTYPE == \"DUP\" && INFO/SVLEN < 50)' \\\n    temp_4b.vcf > ${outprefix}.filters.vcf\n\n    bgzip ${outprefix}.filters.vcf\n    \"\"\"",
        "nb_lignes_script": 29,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "PEC"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/PEC"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "PEC",
                "uri": "https://bio.tools/PEC",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0749",
                            "term": "Transcription factors and regulatory sites"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3384",
                            "term": "Medical imaging"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Medicine"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Experimental medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Clinical medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Biomedical research"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A novel approach to the program evaluation committee.\n\nBACKGROUND:The Accreditation Council for Graduate Medical Education requires each residency program to have a Program Evaluation Committee (PEC) but does not specify how the PEC should be designed. We sought to develop a PEC that promotes resident leadership and provides actionable feedback. METHODS:Participants were residents and faculty in the Traditional Internal Medicine residency program at Yale School of Medicine (YSM). One resident and one faculty member facilitated a 1-h structured group discussion to obtain resident feedback on each rotation. PEC co-facilitators summarized the feedback in written form, then met with faculty Firm Chiefs overseeing each rotation and with residency program leadership to discuss feedback and generate action plans. This PEC process was implemented in all inpatient and outpatient rotations over a 4-year period.\n\n||| HOMEPAGE MISSING!",
                "homepage": "https://www.ncbi.nlm.nih.gov/pubmed/?term=31842868"
            }
        ],
        "inputs": [
            "pruned_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "QUALITY_FILTER_SINGLESAMPLE": {
        "name_process": "QUALITY_FILTER_SINGLESAMPLE",
        "string_process": "\nprocess QUALITY_FILTER_SINGLESAMPLE {\n    label 'singlecore'\n\n    input:\n        file(pruned_vcf)\n    \n    output:\n        file \"${outprefix}.filters.vcf.gz\" \n\n    script:\n    def outprefix = pruned_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    zcat $pruned_vcf > temp_0.vcf\n    \n    bcftools filter -m + -s LowConfSmallDEL \\\n    -e 'INFO/SVTYPE == \"DEL\" && INFO/SVLEN >= -1000 && N_PASS(AS > 0) == 0' \\\n    temp_0.vcf > temp_1.vcf\n\n    bcftools filter -m + -s INV_LowSQ \\\n    -e 'INFO/SVTYPE == \"INV\" && N_PASS(SQ >= 30) == 0' \\\n    temp_1.vcf > temp_2.vcf\n\n    bcftools filter -m + -s INV_LowLumpyEvidence \\\n    -e 'INFO/SVTYPE == \"INV\" && ((INFO/SR / INFO/SU) < 0.1 || (INFO/PE / INFO/SU) < 0.1)' \\\n    temp_2.vcf > temp_3.vcf\n\n    bcftools filter -m + -s BND_LowSQ \\\n    -e 'INFO/SVTYPE == \"BND\" && N_PASS(SQ >= 50) == 0' \\\n    temp_3.vcf > temp_4.vcf\n\n    bcftools filter -m + -s DELDUP_LowSQ \\\n    -e '(INFO/SVTYPE == \"DEL\" || INFO/SVTYPE == \"DUP\") && N_PASS(SQ >= 10) == 0' \\\n    temp_4.vcf > temp_4b.vcf\n\n    bcftools filter -m + -s VerySmallSV \\\n    -e '(INFO/SVTYPE == \"DEL\" && INFO/SVLEN > -50) || (INFO/SVTYPE == \"DUP\" && INFO/SVLEN < 50)' \\\n    temp_4b.vcf > ${outprefix}.filters.vcf\n\n    bgzip ${outprefix}.filters.vcf\n    \"\"\"    \n}",
        "nb_lignes_process": 40,
        "string_script": "    def outprefix = pruned_vcf.getName().replaceFirst(/\\.vcf\\.gz/, \"\")\n    \"\"\"\n    zcat $pruned_vcf > temp_0.vcf\n    \n    bcftools filter -m + -s LowConfSmallDEL \\\n    -e 'INFO/SVTYPE == \"DEL\" && INFO/SVLEN >= -1000 && N_PASS(AS > 0) == 0' \\\n    temp_0.vcf > temp_1.vcf\n\n    bcftools filter -m + -s INV_LowSQ \\\n    -e 'INFO/SVTYPE == \"INV\" && N_PASS(SQ >= 30) == 0' \\\n    temp_1.vcf > temp_2.vcf\n\n    bcftools filter -m + -s INV_LowLumpyEvidence \\\n    -e 'INFO/SVTYPE == \"INV\" && ((INFO/SR / INFO/SU) < 0.1 || (INFO/PE / INFO/SU) < 0.1)' \\\n    temp_2.vcf > temp_3.vcf\n\n    bcftools filter -m + -s BND_LowSQ \\\n    -e 'INFO/SVTYPE == \"BND\" && N_PASS(SQ >= 50) == 0' \\\n    temp_3.vcf > temp_4.vcf\n\n    bcftools filter -m + -s DELDUP_LowSQ \\\n    -e '(INFO/SVTYPE == \"DEL\" || INFO/SVTYPE == \"DUP\") && N_PASS(SQ >= 10) == 0' \\\n    temp_4.vcf > temp_4b.vcf\n\n    bcftools filter -m + -s VerySmallSV \\\n    -e '(INFO/SVTYPE == \"DEL\" && INFO/SVLEN > -50) || (INFO/SVTYPE == \"DUP\" && INFO/SVLEN < 50)' \\\n    temp_4b.vcf > ${outprefix}.filters.vcf\n\n    bgzip ${outprefix}.filters.vcf\n    \"\"\"",
        "nb_lignes_script": 29,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "PEC"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/PEC"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "PEC",
                "uri": "https://bio.tools/PEC",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0749",
                            "term": "Transcription factors and regulatory sites"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3384",
                            "term": "Medical imaging"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Medicine"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Experimental medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Clinical medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Biomedical research"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A novel approach to the program evaluation committee.\n\nBACKGROUND:The Accreditation Council for Graduate Medical Education requires each residency program to have a Program Evaluation Committee (PEC) but does not specify how the PEC should be designed. We sought to develop a PEC that promotes resident leadership and provides actionable feedback. METHODS:Participants were residents and faculty in the Traditional Internal Medicine residency program at Yale School of Medicine (YSM). One resident and one faculty member facilitated a 1-h structured group discussion to obtain resident feedback on each rotation. PEC co-facilitators summarized the feedback in written form, then met with faculty Firm Chiefs overseeing each rotation and with residency program leadership to discuss feedback and generate action plans. This PEC process was implemented in all inpatient and outpatient rotations over a 4-year period.\n\n||| HOMEPAGE MISSING!",
                "homepage": "https://www.ncbi.nlm.nih.gov/pubmed/?term=31842868"
            }
        ],
        "inputs": [
            "pruned_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'"
        ],
        "when": "",
        "stub": ""
    },
    "BCFTOOLS_MERGE": {
        "name_process": "BCFTOOLS_MERGE",
        "string_process": "\nprocess BCFTOOLS_MERGE {\n    label 'singlecore'\n    publishDir \"$params.outdir\", mode: 'copy'\n\n    input:\n    file(vcf_files)\n\n    output:\n    file(\"Merged_vcf.vcf.gz\")\n\n    script:\n    def input_vcfs = vcf_files.collect{ \"$it\" }.findAll{ !it.contains('tbi') }.join(\" \")\n    \"\"\"\n    bcftools merge -m all -Oz -o Merged_vcf.vcf.gz $input_vcfs\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    def input_vcfs = vcf_files.collect{ \"$it\" }.findAll{ !it.contains('tbi') }.join(\" \")\n    \"\"\"\n    bcftools merge -m all -Oz -o Merged_vcf.vcf.gz $input_vcfs\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf_files"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"$params.outdir\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "BCFTOOLS_ROH": {
        "name_process": "BCFTOOLS_ROH",
        "string_process": "\nprocess BCFTOOLS_ROH {\n    label 'singlecore'\n    publishDir \"${params.outdir}\", mode: 'copy'\n\n    input:\n    tuple file(vcf_file), file(vcf_index)\n    tuple file(AF_file), file(AF_index)\n    file genetic_maps\n    val sampleID\n\n    output:\n    file(\"${sampleID}_ROH.txt\")\n\n    script:\n    \"\"\"\n    bcftools roh -s $sampleID --AF-file $AF_file -m {CHROM}.genetic_map.txt -Or -o ${sampleID}_ROH.txt $vcf_file\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    bcftools roh -s $sampleID --AF-file $AF_file -m {CHROM}.genetic_map.txt -Or -o ${sampleID}_ROH.txt $vcf_file\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf_file",
            "vcf_index",
            "AF_file",
            "AF_index",
            "genetic_maps",
            "sampleID"
        ],
        "nb_inputs": 6,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'singlecore'",
            "publishDir \"${params.outdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "GLNEXUS_MERGE_GVCF": {
        "name_process": "GLNEXUS_MERGE_GVCF",
        "string_process": "\nprocess GLNEXUS_MERGE_GVCF {\n    label 'highcores'\n    publishDir \"$output_vcf\", mode: 'copy', pattern: \"${params.cohort_id}.vcf.gz*\"\n\n    input:\n        file(gvcf_files)\n\n    output:\n        tuple val(\"${params.cohort_id}\"), file(\"${params.cohort_id}.vcf.gz\"), file(\"${params.cohort_id}.vcf.gz.csi\")\n\n    script:\n    def input_vcfs = gvcf_files.collect{ \"$it\" }.join(\" \")\n\n    \"\"\"\n    glnexus_cli -m 64 -t 10 \\\n    -c DeepVariant${params.mode} \\\n    --dir GLnexusDB \\\n    $input_vcfs \\\n    | bcftools view - \\\n    | bgzip -@ 10 -c > ${params.cohort_id}.vcf.gz\n\n    tabix -p vcf -m 12 --csi ${params.cohort_id}.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    def input_vcfs = gvcf_files.collect{ \"$it\" }.join(\" \")\n\n    \"\"\"\n    glnexus_cli -m 64 -t 10 \\\n    -c DeepVariant${params.mode} \\\n    --dir GLnexusDB \\\n    $input_vcfs \\\n    | bcftools view - \\\n    | bgzip -@ 10 -c > ${params.cohort_id}.vcf.gz\n\n    tabix -p vcf -m 12 --csi ${params.cohort_id}.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "gvcf_files"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "edg1983__WGS_pipeline",
        "directive": [
            "label 'highcores'",
            "publishDir \"$output_vcf\", mode: 'copy', pattern: \"${params.cohort_id}.vcf.gz*\""
        ],
        "when": "",
        "stub": ""
    }
}