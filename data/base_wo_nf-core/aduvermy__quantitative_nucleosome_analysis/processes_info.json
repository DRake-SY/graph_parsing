{
    "adaptor_removal": {
        "name_process": "adaptor_removal",
        "string_process": "\nprocess adaptor_removal {\n  tag \"$pair_id\"\n  publishDir \"results/fastq/adaptor_removal/\", mode: 'copy'\n\n  input:\n  set pair_id, file(reads) from fastq_files\n\n  output:\n  set pair_id, \"*_cut_R{1,2}.fastq.gz\" into fastq_files_cut\n\n  script:\n  \"\"\"\n\n  cutadapt -a AGATCGGAAGAG -g CTCTTCCGATCT -A AGATCGGAAGAG -G CTCTTCCGATCT \\\n  -o ${pair_id}_cut_R1.fastq.gz -p ${pair_id}_cut_R2.fastq.gz \\\n  ${reads[0]} ${reads[1]} > ${pair_id}_report.txt\n  \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "  \"\"\"\n\n  cutadapt -a AGATCGGAAGAG -g CTCTTCCGATCT -A AGATCGGAAGAG -G CTCTTCCGATCT \\\n  -o ${pair_id}_cut_R1.fastq.gz -p ${pair_id}_cut_R2.fastq.gz \\\n  ${reads[0]} ${reads[1]} > ${pair_id}_report.txt\n  \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "Cutadapt"
        ],
        "tools_url": [
            "https://bio.tools/cutadapt"
        ],
        "tools_dico": [
            {
                "name": "Cutadapt",
                "uri": "https://bio.tools/cutadapt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0632",
                            "term": "Probes and primers"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ]
                    }
                ],
                "description": "Find and remove adapter sequences, primers, poly-A tails and other types of unwanted sequence from your high-throughput sequencing reads.",
                "homepage": "https://pypi.python.org/pypi/cutadapt"
            }
        ],
        "inputs": [
            "fastq_files"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_files_cut"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$pair_id\"",
            "publishDir \"results/fastq/adaptor_removal/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "trimming": {
        "name_process": "trimming",
        "string_process": "\nprocess trimming {\n  tag \"${reads}\"\n  publishDir \"results/fastq/trimming/\", mode: 'copy'\n\n  input:\n  set pair_id, file(reads) from fastq_files_cut\n\n  output:\n  set pair_id, \"*_trim_R{1,2}.fastq.gz\" into fastq_files_trim\n\n  script:\n\"\"\"\nUrQt --t 20 --m ${task.cpus} --gz \\\n--in ${reads[0]} --inpair ${reads[1]} \\\n--out ${pair_id}_trim_R1.fastq.gz --outpair ${pair_id}_trim_R2.fastq.gz \\\n> ${pair_id}_trimming_report.txt\n\"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\nUrQt --t 20 --m ${task.cpus} --gz \\\n--in ${reads[0]} --inpair ${reads[1]} \\\n--out ${pair_id}_trim_R1.fastq.gz --outpair ${pair_id}_trim_R2.fastq.gz \\\n> ${pair_id}_trimming_report.txt\n\"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "UrQt"
        ],
        "tools_url": [
            "https://bio.tools/urqt"
        ],
        "tools_dico": [
            {
                "name": "UrQt",
                "uri": "https://bio.tools/urqt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "New quality control method for Unsupervised Quality trimming of Next Generation Sequencing reads.",
                "homepage": "https://lbbe.univ-lyon1.fr/-UrQt-.html"
            }
        ],
        "inputs": [
            "fastq_files_cut"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_files_trim"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"${reads}\"",
            "publishDir \"results/fastq/trimming/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "fasta_from_bed": {
        "name_process": "fasta_from_bed",
        "string_process": "\nprocess fasta_from_bed {\n  tag \"${fasta.baseName}\"\n  cpus 4\n  publishDir \"results/training/fasta/\", mode: 'copy'\n\n  input:\n  file fasta from fasta_file\n  file bed from bed_files\n  val chromosome from params.chromosome\n\n  output:\n  file \"*.fasta\" into fasta_files_extracted\n\n  script:\n\"\"\"\nbedtools getfasta \\\n-fi ${fasta} -bed ${bed} -fo s${fasta.baseName}.fasta\n\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\nbedtools getfasta \\\n-fi ${fasta} -bed ${bed} -fo s${fasta.baseName}.fasta\n\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "fasta_file",
            "bed_files",
            "params"
        ],
        "nb_inputs": 3,
        "outputs": [
            "fasta_files_extracted"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"${fasta.baseName}\"",
            "cpus 4",
            "publishDir \"results/training/fasta/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "index_fasta": {
        "name_process": "index_fasta",
        "string_process": "\nprocess index_fasta {\n  tag \"$fasta.baseName\"\n  cpus 4\n  publishDir \"results/training/mapping/index/\", mode: 'copy'\n\n  input:\n    file fasta from fasta_files_extracted\n\n  output:\n    file \"*.index*\" into index_files\n    file \"*_report.txt\" into indexing_report\n\n  script:\n\"\"\"\nbowtie2-build --threads ${task.cpus} ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie2_report.txt\n\nif grep -q \"Error\" ${fasta.baseName}_bowtie2_report.txt; then\n  exit 1\nfi\n\"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "\"\"\"\nbowtie2-build --threads ${task.cpus} ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie2_report.txt\n\nif grep -q \"Error\" ${fasta.baseName}_bowtie2_report.txt; then\n  exit 1\nfi\n\"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fasta_files_extracted"
        ],
        "nb_inputs": 1,
        "outputs": [
            "index_files",
            "indexing_report"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta.baseName\"",
            "cpus 4",
            "publishDir \"results/training/mapping/index/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "mapping_fastq": {
        "name_process": "mapping_fastq",
        "string_process": "\nprocess mapping_fastq {\n  tag \"$reads\"\n  publishDir \"results/mapping/quantification/\", mode: 'copy'\n\n  input:\n  set pair_id, file(reads) from fastq_files_trim\n  file index from index_files.collect()\n\n  output:\n  file \"*\" into counts_files\n\n  script:\n\"\"\"\nmkdir ${pair_id}\n\nkallisto quant -i ${index} -t ${task.cpus} \\\n--bias --bootstrap-samples 100 -o ${pair_id} \\\n${reads[0]} ${reads[1]} &> ${pair_id}/kallisto_report.txt\n\"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\nmkdir ${pair_id}\n\nkallisto quant -i ${index} -t ${task.cpus} \\\n--bias --bootstrap-samples 100 -o ${pair_id} \\\n${reads[0]} ${reads[1]} &> ${pair_id}/kallisto_report.txt\n\"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "kallisto"
        ],
        "tools_url": [
            "https://bio.tools/kallisto"
        ],
        "tools_dico": [
            {
                "name": "kallisto",
                "uri": "https://bio.tools/kallisto",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Gene expression profiling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Functional profiling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Gene expression profile construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Feature expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Gene transcription profiling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Gene expression quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0314",
                                    "term": "Gene expression profile generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A program for quantifying abundances of transcripts from RNA-Seq data, or more generally of target sequences using high-throughput sequencing reads. It is based on the novel idea of pseudoalignment for rapidly determining the compatibility of reads with targets, without the need for alignment.",
                "homepage": "https://pachterlab.github.io/kallisto/about.html"
            }
        ],
        "inputs": [
            "fastq_files_trim",
            "index_files"
        ],
        "nb_inputs": 2,
        "outputs": [
            "counts_files"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$reads\"",
            "publishDir \"results/mapping/quantification/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Trimming": {
        "name_process": "Trimming",
        "string_process": " process Trimming {\n      label \"cutadapt\"\n      tag \"$file_id\"\n      publishDir \"${params.outdir}/fastq/trim/\", mode: 'copy'\n\n      input:\n      set file_id, file(reads) from fastq_raw_2trim\n\n      output:\n      set file_id, \"${file_id}*_trim.fastq.gz\" into fastq_trim_2QC, fastq_trim_2cutAdapt\n      set file_id, \"${file_id}*_report.txt\" into trimming_report\n\n      script:\n      def single = reads instanceof Path\n\n      if (single){\n      \"\"\"\n        cutadapt -q 20,20 \\\n        -o ${file_id}_trim.fastq.gz \\\n        ${reads} > ${file_id}_report.txt\n      \"\"\"\n      }\n      else{\n      \"\"\"\n      cutadapt -q 20,20 \\\n      -o ${file_id}_R1_trim.fastq.gz -p ${file_id}_R2_trim.fastq.gz \\\n      !{reads[0]} ${reads[1]} > ${file_id}_report.txt\n      \"\"\"\n      }\n    }",
        "nb_lignes_process": 28,
        "string_script": "      def single = reads instanceof Path\n\n      if (single){\n      \"\"\"\n        cutadapt -q 20,20 \\\n        -o ${file_id}_trim.fastq.gz \\\n        ${reads} > ${file_id}_report.txt\n      \"\"\"\n      }\n      else{\n      \"\"\"\n      cutadapt -q 20,20 \\\n      -o ${file_id}_R1_trim.fastq.gz -p ${file_id}_R2_trim.fastq.gz \\\n      !{reads[0]} ${reads[1]} > ${file_id}_report.txt\n      \"\"\"\n      }",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "Cutadapt"
        ],
        "tools_url": [
            "https://bio.tools/cutadapt"
        ],
        "tools_dico": [
            {
                "name": "Cutadapt",
                "uri": "https://bio.tools/cutadapt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0632",
                            "term": "Probes and primers"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ]
                    }
                ],
                "description": "Find and remove adapter sequences, primers, poly-A tails and other types of unwanted sequence from your high-throughput sequencing reads.",
                "homepage": "https://pypi.python.org/pypi/cutadapt"
            }
        ],
        "inputs": [
            "fastq_raw_2trim"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_trim_2QC",
            "fastq_trim_2cutAdapt",
            "trimming_report"
        ],
        "nb_outputs": 3,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"cutadapt\"",
            "tag \"$file_id\"",
            "publishDir \"${params.outdir}/fastq/trim/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Adapter_removal": {
        "name_process": "Adapter_removal",
        "string_process": " process Adapter_removal {\n     label \"cutadapt\"\n     tag \"$file_id\"\n     publishDir \"${params.outdir}/fastq/cut/\", mode: 'copy'\n\n     input:\n     set file_id, file(reads) from fastq_trim_2cutAdapt\n\n     output:\n     set file_id, \"${file_id}*_cut.fastq.gz\" into fastq_2mapping, fastq_cutAdapt_2QC\n     set file_id, \"${file_id}_report.txt\" into adapter_removal_report\n\n     script:\n     def single = reads instanceof Path\n\n     if (single){\n     \"\"\"\n     cutadapt -a AGATCGGAAGAG -g CTCTTCCGATCT\\\n     -o ${file_id}_cut.fastq.gz \\\n     ${reads} > ${file_id}_report.txt\n     \"\"\"\n     }\n     else{\n     \"\"\"\n     cutadapt -a AGATCGGAAGAG -g CTCTTCCGATCT -A AGATCGGAAGAG -G CTCTTCCGATCT \\\n     -o ${file_id}_R1_cut.fastq.gz -p ${file_id}_R2_cut.fastq.gz \\\n     ${reads[0]} ${reads[1]} > ${file_id}_report.txt\n     \"\"\"\n     }\n}",
        "nb_lignes_process": 28,
        "string_script": "     def single = reads instanceof Path\n\n     if (single){\n     \"\"\"\n     cutadapt -a AGATCGGAAGAG -g CTCTTCCGATCT\\\n     -o ${file_id}_cut.fastq.gz \\\n     ${reads} > ${file_id}_report.txt\n     \"\"\"\n     }\n     else{\n     \"\"\"\n     cutadapt -a AGATCGGAAGAG -g CTCTTCCGATCT -A AGATCGGAAGAG -G CTCTTCCGATCT \\\n     -o ${file_id}_R1_cut.fastq.gz -p ${file_id}_R2_cut.fastq.gz \\\n     ${reads[0]} ${reads[1]} > ${file_id}_report.txt\n     \"\"\"\n     }",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "Cutadapt"
        ],
        "tools_url": [
            "https://bio.tools/cutadapt"
        ],
        "tools_dico": [
            {
                "name": "Cutadapt",
                "uri": "https://bio.tools/cutadapt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0632",
                            "term": "Probes and primers"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ]
                    }
                ],
                "description": "Find and remove adapter sequences, primers, poly-A tails and other types of unwanted sequence from your high-throughput sequencing reads.",
                "homepage": "https://pypi.python.org/pypi/cutadapt"
            }
        ],
        "inputs": [
            "fastq_trim_2cutAdapt"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_2mapping",
            "fastq_cutAdapt_2QC",
            "adapter_removal_report"
        ],
        "nb_outputs": 3,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"cutadapt\"",
            "tag \"$file_id\"",
            "publishDir \"${params.outdir}/fastq/cut/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Fastqc": {
        "name_process": "Fastqc",
        "string_process": "\nprocess Fastqc {\n    label \"fastqc\"\n    tag \"$file_id\"\n    publishDir \"${params.outdir}/fastq/QC/\", mode: 'copy'\n\n    input:\n    set file_id, file(reads) from fastq_2QC\n\n    output:\n    file \"*.{zip,html}\" into fastqc_report\n\n    script:\n    def single = reads instanceof Path\n\n    if (single){\n       \"\"\"\n       fastqc --quiet --threads ${task.cpus} --format fastq --outdir ./ \\\n       ${reads}\n       \"\"\"\n     }\n   else{\n       \"\"\"\n       fastqc --quiet --threads ${task.cpus} --format fastq --outdir ./ \\\n       ${reads[0]} ${reads[1]}\n       \"\"\"\n     }\n}",
        "nb_lignes_process": 26,
        "string_script": "    def single = reads instanceof Path\n\n    if (single){\n       \"\"\"\n       fastqc --quiet --threads ${task.cpus} --format fastq --outdir ./ \\\n       ${reads}\n       \"\"\"\n     }\n   else{\n       \"\"\"\n       fastqc --quiet --threads ${task.cpus} --format fastq --outdir ./ \\\n       ${reads[0]} ${reads[1]}\n       \"\"\"\n     }",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "fastq_2QC"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"fastqc\"",
            "tag \"$file_id\"",
            "publishDir \"${params.outdir}/fastq/QC/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Unzip_fasta": {
        "name_process": "Unzip_fasta",
        "string_process": " process Unzip_fasta {\n      tag \"$fasta.simpleName\"\n\n      input:\n        file fasta from fasta_file_zip\n\n      output:\n        file \"${fasta.simpleName}.fasta\" into fasta_2indexing, fasta_2sizeChr\n\n      script:\n      \"\"\"\n      zcat ${fasta} > ${fasta.simpleName}.fasta\n      \"\"\"\n     }",
        "nb_lignes_process": 12,
        "string_script": "      \"\"\"\n      zcat ${fasta} > ${fasta.simpleName}.fasta\n      \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fasta_file_zip"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fasta_2indexing",
            "fasta_2sizeChr"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta.simpleName\""
        ],
        "when": "",
        "stub": ""
    },
    "Unzip_fasta_calib": {
        "name_process": "Unzip_fasta_calib",
        "string_process": " process Unzip_fasta_calib {\n      tag \"$fasta.simpleName\"\n\n      input:\n        file fasta from fasta_calib_file_zip\n\n      output:\n        file \"${fasta.simpleName}.fasta\" into fasta_calib_2indexing\n\n      script:\n      \"\"\"\n      zcat ${fasta} > ${fasta.simpleName}.fasta\n      \"\"\"\n     }",
        "nb_lignes_process": 12,
        "string_script": "      \"\"\"\n      zcat ${fasta} > ${fasta.simpleName}.fasta\n      \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fasta_calib_file_zip"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fasta_calib_2indexing"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta.simpleName\""
        ],
        "when": "",
        "stub": ""
    },
    "Fasta_indexing": {
        "name_process": "Fasta_indexing",
        "string_process": "\nprocess Fasta_indexing {\n   if (!params.shortReads){\n         label \"bowtie2\"\n   }\n   else {\n         label \"bowtie\"\n   }\n   tag \"$fasta_id\"\n\n   input:\n   set fasta_id , file (fasta) from fasta_2indexing\n\n   output:\n   set fasta_id, \"*.index*\" into index_2joinfasta, index_2joinfastaCalib\n   file \"*_report.txt\" into indexing_report\n\n   script:\n   if (params.shortReads){\n   \"\"\"\n   bowtie-build --threads ${task.cpus} -f ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie_report.txt\n\n   if grep -q \"Error\" ${fasta.baseName}_bowtie_report.txt; then\n     exit 1\n   fi\n   \"\"\"\n   }\n   else{\n   \"\"\"\n   bowtie2-build --threads ${task.cpus} ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie2_report.txt\n\n   if grep -q \"Error\" ${fasta.baseName}_bowtie2_report.txt; then\n     exit 1\n   fi\n   \"\"\"\n   }\n}",
        "nb_lignes_process": 35,
        "string_script": "   if (params.shortReads){\n   \"\"\"\n   bowtie-build --threads ${task.cpus} -f ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie_report.txt\n\n   if grep -q \"Error\" ${fasta.baseName}_bowtie_report.txt; then\n     exit 1\n   fi\n   \"\"\"\n   }\n   else{\n   \"\"\"\n   bowtie2-build --threads ${task.cpus} ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie2_report.txt\n\n   if grep -q \"Error\" ${fasta.baseName}_bowtie2_report.txt; then\n     exit 1\n   fi\n   \"\"\"\n   }",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [
            "Bowtie"
        ],
        "tools_url": [
            "https://bio.tools/bowtie"
        ],
        "tools_dico": [
            {
                "name": "Bowtie",
                "uri": "https://bio.tools/bowtie",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            },
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "Bowtie is an ultrafast, memory-efficient short read aligner.",
                "homepage": "http://bowtie-bio.sourceforge.net/index.shtml"
            }
        ],
        "inputs": [
            "fasta_2indexing"
        ],
        "nb_inputs": 1,
        "outputs": [
            "index_2joinfasta",
            "index_2joinfastaCalib",
            "indexing_report"
        ],
        "nb_outputs": 3,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta_id\""
        ],
        "when": "",
        "stub": ""
    },
    "Fasta_calib_indexing": {
        "name_process": "Fasta_calib_indexing",
        "string_process": " process Fasta_calib_indexing {\n     if (!params.shortReads){\n           label \"bowtie2\"\n     }\n     else {\n           label \"bowtie\"\n     }\n     tag \"$fasta.simpleName\"\n\n     input:\n     file fasta from fasta_calib_2indexing\n\n     output:\n     file \"*.index*\" into index_calib_files\n     file \"*_report.txt\" into indexing_calib_report\n\n     script:\n     if (params.shortReads){\n     \"\"\"\n     bowtie-build --threads ${task.cpus} -f ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie_report.txt\n\n     if grep -q \"Error\" ${fasta.baseName}_bowtie_report.txt; then\n       exit 1\n     fi\n     \"\"\"\n     }\n     else{\n     \"\"\"\n     bowtie2-build --threads ${task.cpus} ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie2_report.txt\n\n     if grep -q \"Error\" ${fasta.baseName}_bowtie2_report.txt; then\n       exit 1\n     fi\n     \"\"\"\n     }\n }",
        "nb_lignes_process": 34,
        "string_script": "     if (params.shortReads){\n     \"\"\"\n     bowtie-build --threads ${task.cpus} -f ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie_report.txt\n\n     if grep -q \"Error\" ${fasta.baseName}_bowtie_report.txt; then\n       exit 1\n     fi\n     \"\"\"\n     }\n     else{\n     \"\"\"\n     bowtie2-build --threads ${task.cpus} ${fasta} ${fasta.baseName}.index &> ${fasta.baseName}_bowtie2_report.txt\n\n     if grep -q \"Error\" ${fasta.baseName}_bowtie2_report.txt; then\n       exit 1\n     fi\n     \"\"\"\n     }",
        "nb_lignes_script": 17,
        "language_script": "bash",
        "tools": [
            "Bowtie"
        ],
        "tools_url": [
            "https://bio.tools/bowtie"
        ],
        "tools_dico": [
            {
                "name": "Bowtie",
                "uri": "https://bio.tools/bowtie",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            },
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "Bowtie is an ultrafast, memory-efficient short read aligner.",
                "homepage": "http://bowtie-bio.sourceforge.net/index.shtml"
            }
        ],
        "inputs": [
            "fasta_calib_2indexing"
        ],
        "nb_inputs": 1,
        "outputs": [
            "index_calib_files",
            "indexing_calib_report"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta.simpleName\""
        ],
        "when": "",
        "stub": ""
    },
    "Mapping": {
        "name_process": "Mapping",
        "string_process": "\nprocess Mapping {\n\n   publishDir \"${params.outdir}/mapping/${file_id}\", mode: 'copy', pattern:\"*.bam\"\n   publishDir \"${params.outdir}/fastq/${file_id}\", mode: 'copy', pattern:\"*.fastq\"\n\n   tag \"$file_id\"\n\n   if (!params.shortReads){\n     label \"bowtie2\"\n   }\n   else {\n     label \"bowtie\"\n   }\n\n   input:\n   set file_id, file(reads) from fastq_2mapping\n   file index_calib from index_calib_files.collect()\n   file index from index_fasta_files.collect()\n\n\n   output:\n   set file_id, val(data_type) ,\"*.bam\" into bam_files\n   set file_id, \"*.fastq\" into reads\n   set file_id, \"*_bowtie_report_exclusiv2fasta.txt\", \"*_bowtie_report_both.txt\", \"*_bowtie_report_exclusiv2fastaCalib.txt\" into mapping_reports2stats, mapping_reports2normalization\n\n   script:\n   def single = reads instanceof Path\n\n   if (params.shortReads){\n     index_id = index[0]\n     for (index_file in index) {\n       if (index_file =~ /.*\\.1\\.ebwt/ && !(index_file =~ /.*\\.rev\\.1\\.ebwt/)) {\n           index_id = ( index_file =~ /(.*)\\.1\\.ebwt/)[0][1]\n         }\n     }\n     index_c_id = index_calib[0]\n     for (index_file in index_calib) {\n       if (index_file =~ /.*\\.1\\.ebwt/ && !(index_file =~ /.*\\.rev\\.1\\.ebwt/)) {\n           index_c_id = ( index_file =~ /(.*)\\.1\\.ebwt/)[0][1]\n         }\n     }\n     if (single){\n       data_type=\"SE\"\n       \"\"\"\n       ##ALIGNED RAW TO FASTA\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --un ${file_id}_unaligned_2fasta.fastq --al ${file_id}_aligned_2fasta.fastq \\\n       -q ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report.txt\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --un ${file_id}_unaligned_2fastaCalib.fastq --al ${file_id}_aligned_2fastaCalib.fastq \\\n       -q ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_aligned_2Both.fastq \\\n       -q ${file_id}_aligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -q ${file_id}_unaligned_2fastaCalib.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -q ${file_id}_unaligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n     }\n     else{\n       data_type=\"PE\"\n       \"\"\"\n       ##ALIGNED RAW TO FASTA\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --un ${file_id}_unaligned_2fasta.fastq --al ${file_id}_aligned_2fasta.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report.txt\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --un ${file_id}_unaligned_2fastaCalib.fastq --al ${file_id}_aligned_2fastaCalib.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_aligned_2Both.fastq \\\n       -1 ${file_id}_aligned_2fasta_1.fastq -2 ${file_id}_aligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -1 ${file_id}_unaligned_2fastaCalib_1.fastq -2 ${file_id}_unaligned_2fastaCalib_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -1 ${file_id}_unaligned_2fasta_1.fastq -2 ${file_id}_unaligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n\n   }\n }\n   else {\n     index_id = index[0]\n     for (index_file in index) {\n       if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n           index_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n       }\n     }\n\n       index_c_id = index_calib[0]\n       for (index_file in index_calib) {\n         if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n             index_c_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n         }\n     }\n     if (single){\n       data_type=\"SE\"\n       \"\"\"\n       ##ALIGNED RAW TO FASTA\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --un ${file_id}_unaligned_2fasta.fastq --al ${file_id}_aligned_2fasta.fastq \\\n       -U ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report.txt\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --un ${file_id}_unaligned_2fastaCalib.fastq --al ${file_id}_aligned_2fastaCalib.fastq \\\n       -U ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al ${file_id}_aligned_2Both.fastq \\\n       -U ${file_id}_aligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -U ${file_id}_unaligned_2fastaCalib.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al ${file_id}_exclusiv_aligned_2fastaCalib.fastq \\\n       -U ${file_id}_unaligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n     }\n     else{\n       data_type=\"PE\"\n       \"\"\"\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --un-conc ${file_id}_unaligned_2fasta_%.fastq --al-conc ${file_id}_aligned_2fasta_%.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie2_report_tmp.txt | \\\n       samtools view -Sbh -@ ${task.cpus} - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie2_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie2_report_tmp.txt > ${file_id}_bowtie2_raw2fasta.txt\n\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --un-conc ${file_id}_unaligned_2fastaCalib_%.fastq --al-conc ${file_id}_aligned_2fastaCalib_%.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_raw2calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al-conc ${file_id}_aligned_2Both_%.fastq \\\n       -1 ${file_id}_aligned_2fasta_1.fastq -2 ${file_id}_aligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --al-conc ${file_id}_exclusiv_aligned_2fasta_%.fastq \\\n       -1 ${file_id}_unaligned_2fastaCalib_1.fastq -2 ${file_id}_unaligned_2fastaCalib_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al-conc ${file_id}_exclusiv_aligned_2fastaCalib_%.fastq \\\n       -1 ${file_id}_unaligned_2fasta_1.fastq -2 ${file_id}_unaligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n\n   }\n}\n}",
        "nb_lignes_process": 347,
        "string_script": "   def single = reads instanceof Path\n\n   if (params.shortReads){\n     index_id = index[0]\n     for (index_file in index) {\n       if (index_file =~ /.*\\.1\\.ebwt/ && !(index_file =~ /.*\\.rev\\.1\\.ebwt/)) {\n           index_id = ( index_file =~ /(.*)\\.1\\.ebwt/)[0][1]\n         }\n     }\n     index_c_id = index_calib[0]\n     for (index_file in index_calib) {\n       if (index_file =~ /.*\\.1\\.ebwt/ && !(index_file =~ /.*\\.rev\\.1\\.ebwt/)) {\n           index_c_id = ( index_file =~ /(.*)\\.1\\.ebwt/)[0][1]\n         }\n     }\n     if (single){\n       data_type=\"SE\"\n       \"\"\"\n       ##ALIGNED RAW TO FASTA\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --un ${file_id}_unaligned_2fasta.fastq --al ${file_id}_aligned_2fasta.fastq \\\n       -q ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report.txt\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --un ${file_id}_unaligned_2fastaCalib.fastq --al ${file_id}_aligned_2fastaCalib.fastq \\\n       -q ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_aligned_2Both.fastq \\\n       -q ${file_id}_aligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -q ${file_id}_unaligned_2fastaCalib.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -q ${file_id}_unaligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n     }\n     else{\n       data_type=\"PE\"\n       \"\"\"\n       ##ALIGNED RAW TO FASTA\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --un ${file_id}_unaligned_2fasta.fastq --al ${file_id}_aligned_2fasta.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report.txt\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --un ${file_id}_unaligned_2fastaCalib.fastq --al ${file_id}_aligned_2fastaCalib.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_aligned_2Both.fastq \\\n       -1 ${file_id}_aligned_2fasta_1.fastq -2 ${file_id}_aligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -1 ${file_id}_unaligned_2fastaCalib_1.fastq -2 ${file_id}_unaligned_2fastaCalib_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie --best -v 3 -k 1 --sam -p ${task.cpus} ${index_c_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -1 ${file_id}_unaligned_2fasta_1.fastq -2 ${file_id}_unaligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n\n   }\n }\n   else {\n     index_id = index[0]\n     for (index_file in index) {\n       if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n           index_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n       }\n     }\n\n       index_c_id = index_calib[0]\n       for (index_file in index_calib) {\n         if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n             index_c_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n         }\n     }\n     if (single){\n       data_type=\"SE\"\n       \"\"\"\n       ##ALIGNED RAW TO FASTA\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --un ${file_id}_unaligned_2fasta.fastq --al ${file_id}_aligned_2fasta.fastq \\\n       -U ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report.txt\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --un ${file_id}_unaligned_2fastaCalib.fastq --al ${file_id}_aligned_2fastaCalib.fastq \\\n       -U ${reads} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al ${file_id}_aligned_2Both.fastq \\\n       -U ${file_id}_aligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --al ${file_id}_exclusiv_aligned_2fasta.fastq \\\n       -U ${file_id}_unaligned_2fastaCalib.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al ${file_id}_exclusiv_aligned_2fastaCalib.fastq \\\n       -U ${file_id}_unaligned_2fasta.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n     }\n     else{\n       data_type=\"PE\"\n       \"\"\"\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --un-conc ${file_id}_unaligned_2fasta_%.fastq --al-conc ${file_id}_aligned_2fasta_%.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie2_report_tmp.txt | \\\n       samtools view -Sbh -@ ${task.cpus} - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie2_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie2_report_tmp.txt > ${file_id}_bowtie2_raw2fasta.txt\n\n\n       ##ALIGNED RAW TO FASTA CALIB\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --un-conc ${file_id}_unaligned_2fastaCalib_%.fastq --al-conc ${file_id}_aligned_2fastaCalib_%.fastq \\\n       -1 ${reads[0]} -2 ${reads[1]} 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_raw2calib.txt\n\n       ##ALIGNED READS, ALREADY MAPPED TO FASTA, TO FASTA CALIB NOW -> get multiMap\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al-conc ${file_id}_aligned_2Both_%.fastq \\\n       -1 ${file_id}_aligned_2fasta_1.fastq -2 ${file_id}_aligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_2both.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_both.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA CALIB, TO FASTA  NOW -> get fasta exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n       --al-conc ${file_id}_exclusiv_aligned_2fasta_%.fastq \\\n       -1 ${file_id}_unaligned_2fastaCalib_1.fastq -2 ${file_id}_unaligned_2fastaCalib_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fasta.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fasta.txt\n\n       ##ALIGNED READS, ALREADY UNMAPPED TO FASTA, TO FASTA CALIB  NOW -> get fasta calib exclusif map\n       bowtie2 --very-sensitive -p ${task.cpus} -x ${index_c_id} \\\n       --al-conc ${file_id}_exclusiv_aligned_2fastaCalib_%.fastq \\\n       -1 ${file_id}_unaligned_2fasta_1.fastq -2 ${file_id}_unaligned_2fasta_2.fastq 2> \\\n       ${file_id}_bowtie_report_tmp.txt | \\\n       samtools view -@ ${task.cpus} -Sbh - | \\\n       samtools sort -@ ${task.cpus} -o ${file_id}_exclusiv2fastaCalib.bam\n\n       if grep -q \"Error\" ${file_id}_bowtie_report_tmp.txt; then\n       exit 1\n       fi\n       tail -n 19 ${file_id}_bowtie_report_tmp.txt > ${file_id}_bowtie_report_exclusiv2fastaCalib.txt\n\n       ##rm useless files\n       rm ${file_id}_2fasta.bam ${file_id}_2fastaCalib.bam ${file_id}_unaligned_2fasta*.fastq ${file_id}_aligned_2fasta*.fastq\n       \"\"\"\n\n   }\n}",
        "nb_lignes_script": 320,
        "language_script": "bash",
        "tools": [
            "Bowtie",
            "SAMtools",
            "WeGet",
            "Rbowtie2"
        ],
        "tools_url": [
            "https://bio.tools/bowtie",
            "https://bio.tools/samtools",
            "https://bio.tools/weget",
            "https://bio.tools/rbowtie2"
        ],
        "tools_dico": [
            {
                "name": "Bowtie",
                "uri": "https://bio.tools/bowtie",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            },
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "Bowtie is an ultrafast, memory-efficient short read aligner.",
                "homepage": "http://bowtie-bio.sourceforge.net/index.shtml"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "WeGet",
                "uri": "https://bio.tools/weget",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0224",
                                    "term": "Query and retrieval"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0224",
                                    "term": "Database retrieval"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "WeGET is a computational tool to find mammalian genes that strongly co-express with a human query gene set of interest.",
                "homepage": "http://weget.cmbi.umcn.nl/"
            },
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            }
        ],
        "inputs": [
            "fastq_2mapping",
            "index_calib_files",
            "index_fasta_files"
        ],
        "nb_inputs": 3,
        "outputs": [
            "bam_files",
            "reads",
            "mapping_reports2stats",
            "mapping_reports2normalization"
        ],
        "nb_outputs": 4,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "publishDir \"${params.outdir}/mapping/${file_id}\", mode: 'copy', pattern:\"*.bam\"",
            "publishDir \"${params.outdir}/fastq/${file_id}\", mode: 'copy', pattern:\"*.fastq\"",
            "tag \"$file_id\" if (!params.shortReads){ label \"bowtie2\" } else { label \"bowtie\" }"
        ],
        "when": "",
        "stub": ""
    },
    "build_synthetic_bed": {
        "name_process": "build_synthetic_bed",
        "string_process": "\nprocess build_synthetic_bed {\n  tag \"${chromosome}:${start}-${stop}\"\n  cpus 4\n\n  input:\n  val chromosome from params.chromosome\n  val start from params.start\n  val stop from params.stop\n\n  output:\n  file \"*.bed\" into bed_files\n\n  script:\n\"\"\"\necho \"${chromosome}\\t${start}\\t${stop}\" > synthetic.bed\n\"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "\"\"\"\necho \"${chromosome}\\t${start}\\t${stop}\" > synthetic.bed\n\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "params",
            "params",
            "params"
        ],
        "nb_inputs": 3,
        "outputs": [
            "bed_files"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"${chromosome}:${start}-${stop}\"",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "mapping_fastq_paired": {
        "name_process": "mapping_fastq_paired",
        "string_process": " process mapping_fastq_paired {\n    tag \"$pair_id\"\n    cpus 4\n\n    input:\n    set pair_id, file(reads) from fastq_files_paired\n    file index from index_files.collect()\n\n    output:\n    set pair_id, \"*.bam\" into bam_files_paired\n    file \"*_report.txt\" into mapping_report\n\n    script:\n    index_id = index[0]\n    for (index_file in index) {\n      if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n          index_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n      }\n    }\n  \"\"\"\n  bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n  -1 ${reads[0]} -2 ${reads[1]} 2> \\\n  ${pair_id}_bowtie2_report.txt | \\\n  samtools view -Sb - > ${pair_id}.bam\n\n  if grep -q \"Error\" ${pair_id}_bowtie2_report.txt; then\n    exit 1\n  fi\n  \"\"\"\n  }",
        "nb_lignes_process": 28,
        "string_script": "    index_id = index[0]\n    for (index_file in index) {\n      if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n          index_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n      }\n    }\n  \"\"\"\n  bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n  -1 ${reads[0]} -2 ${reads[1]} 2> \\\n  ${pair_id}_bowtie2_report.txt | \\\n  samtools view -Sb - > ${pair_id}.bam\n\n  if grep -q \"Error\" ${pair_id}_bowtie2_report.txt; then\n    exit 1\n  fi\n  \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "fastq_files_paired",
            "index_files"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bam_files_paired",
            "mapping_report"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$pair_id\"",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "bam_2_fastq_paired": {
        "name_process": "bam_2_fastq_paired",
        "string_process": " process bam_2_fastq_paired {\n    tag \"$file_id\"\n    publishDir \"results/training/fastq/\", mode: 'copy'\n\n    input:\n      set file_id, file(bam) from bam_files_paired_fa\n\n    output:\n      set file_id, \"*.fastq\" into fastq_files_extracted\n    script:\n  \"\"\"\n  samtools fastq -1 s${file_id}_R1.fastq -2 s${file_id}_R2.fastq -F 0x4 ${bam}\n  \"\"\"\n  }",
        "nb_lignes_process": 12,
        "string_script": "  \"\"\"\n  samtools fastq -1 s${file_id}_R1.fastq -2 s${file_id}_R2.fastq -F 0x4 ${bam}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_files_paired_fa"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_files_extracted"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "publishDir \"results/training/fastq/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "filter_bam_paired": {
        "name_process": "filter_bam_paired",
        "string_process": " process filter_bam_paired {\n    tag \"$file_id\"\n    cpus 4\n\n    input:\n      set file_id, file(bam) from bam_files_paired_ba\n      file bed from bed_files\n\n    output:\n      set file_id, \"*.bam\" into filtered_bam_files_paired\n    script:\n  \"\"\"\n  samtools view -@ ${task.cpus} -hb ${bam} -F 0x4 > f${file_id}.bam\n  \"\"\"\n  }",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  samtools view -@ ${task.cpus} -hb ${bam} -F 0x4 > f${file_id}.bam\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_files_paired_ba",
            "bed_files"
        ],
        "nb_inputs": 2,
        "outputs": [
            "filtered_bam_files_paired"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "sort_bam_paired": {
        "name_process": "sort_bam_paired",
        "string_process": " process sort_bam_paired {\n    tag \"$file_id\"\n    publishDir \"results/training/bams/\", mode: 'copy'\n    cpus 4\n\n    input:\n      set file_id, file(bam) from filtered_bam_files_paired\n\n    output:\n      set file_id, \"*.bam\" into sorted_bam_files_paired\n\n    script:\n  \"\"\"\n  samtools sort -@ ${task.cpus} -O BAM -o s${file_id}.bam ${bam}\n  \"\"\"\n  }",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  samtools sort -@ ${task.cpus} -O BAM -o s${file_id}.bam ${bam}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "filtered_bam_files_paired"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sorted_bam_files_paired"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "publishDir \"results/training/bams/\", mode: 'copy'",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "index_bam_paired": {
        "name_process": "index_bam_paired",
        "string_process": " process index_bam_paired {\n    tag \"$file_id\"\n    publishDir \"results/training/bams/\", mode: 'copy'\n\n    input:\n      set file_id, file(bam) from sorted_bam_files_paired\n\n    output:\n      set file_id, \"*.bam*\" into indexed_bam_file_paired\n\n    script:\n  \"\"\"\n  samtools index ${bam}\n  \"\"\"\n  }",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  samtools index ${bam}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sorted_bam_files_paired"
        ],
        "nb_inputs": 1,
        "outputs": [
            "indexed_bam_file_paired"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "publishDir \"results/training/bams/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "mapping_fastq_single": {
        "name_process": "mapping_fastq_single",
        "string_process": " process mapping_fastq_single {\n    tag \"$file_id\"\n    cpus 4\n\n    input:\n    set file_id, file(reads) from fastq_files_single\n    file index from index_files.collect()\n\n    output:\n    set file_id, \"*.bam\" into bam_files_single\n    file \"*_report.txt\" into mapping_report\n\n    script:\n    index_id = index[0]\n    for (index_file in index) {\n      if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n          index_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n      }\n    }\n  \"\"\"\n  bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n  -U ${reads} 2> \\\n  ${file_id}_bowtie2_report.txt | \\\n  samtools view -Sb - > ${file_id}.bam\n\n  if grep -q \"Error\" ${file_id}_bowtie2_report.txt; then\n    exit 1\n  fi\n  \"\"\"\n  }",
        "nb_lignes_process": 28,
        "string_script": "    index_id = index[0]\n    for (index_file in index) {\n      if (index_file =~ /.*\\.1\\.bt2/ && !(index_file =~ /.*\\.rev\\.1\\.bt2/)) {\n          index_id = ( index_file =~ /(.*)\\.1\\.bt2/)[0][1]\n      }\n    }\n  \"\"\"\n  bowtie2 --very-sensitive -p ${task.cpus} -x ${index_id} \\\n  -U ${reads} 2> \\\n  ${file_id}_bowtie2_report.txt | \\\n  samtools view -Sb - > ${file_id}.bam\n\n  if grep -q \"Error\" ${file_id}_bowtie2_report.txt; then\n    exit 1\n  fi\n  \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "fastq_files_single",
            "index_files"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bam_files_single",
            "mapping_report"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "bam_2_fastq_single": {
        "name_process": "bam_2_fastq_single",
        "string_process": " process bam_2_fastq_single {\n    tag \"$file_id\"\n\n    input:\n      set file_id, file(bam) from bam_files_single_fa\n\n    output:\n      set file_id, \"*.fastq\" into fastq_files_extracted\n    script:\n  \"\"\"\n  samtools fastq -0 s${file_id}.fastq -F 0x4 ${bam}\n  \"\"\"\n  }",
        "nb_lignes_process": 11,
        "string_script": "  \"\"\"\n  samtools fastq -0 s${file_id}.fastq -F 0x4 ${bam}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_files_single_fa"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastq_files_extracted"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\""
        ],
        "when": "",
        "stub": ""
    },
    "filter_bam_single": {
        "name_process": "filter_bam_single",
        "string_process": " process filter_bam_single {\n    tag \"$file_id\"\n    cpus 4\n\n    input:\n      set file_id, file(bam) from bam_files_single_ba\n      file bed from bed_files\n\n    output:\n      set file_id, \"*.bam\" into filtered_bam_files_single\n    script:\n  \"\"\"\n  samtools view -@ ${task.cpus} -hb ${bam} -F 0x4 > f${file_id}.bam\n  \"\"\"\n  }",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  samtools view -@ ${task.cpus} -hb ${bam} -F 0x4 > f${file_id}.bam\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_files_single_ba",
            "bed_files"
        ],
        "nb_inputs": 2,
        "outputs": [
            "filtered_bam_files_single"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "sort_bam_single": {
        "name_process": "sort_bam_single",
        "string_process": " process sort_bam_single {\n    tag \"$file_id\"\n    publishDir \"results/training/bams/\", mode: 'copy'\n    cpus 4\n\n    input:\n      set file_id, file(bam) from filtered_bam_files_single\n\n    output:\n      set file_id, \"*.bam\" into sorted_bam_files_single\n\n    script:\n  \"\"\"\n  samtools sort -@ ${task.cpus} -O BAM -o s${file_id}.bam ${bam}\n  \"\"\"\n  }",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  samtools sort -@ ${task.cpus} -O BAM -o s${file_id}.bam ${bam}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "filtered_bam_files_single"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sorted_bam_files_single"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "publishDir \"results/training/bams/\", mode: 'copy'",
            "cpus 4"
        ],
        "when": "",
        "stub": ""
    },
    "index_bam_single": {
        "name_process": "index_bam_single",
        "string_process": " process index_bam_single {\n    tag \"$file_id\"\n    publishDir \"results/training/bams/\", mode: 'copy'\n\n    input:\n      set file_id, file(bam) from sorted_bam_files_single\n\n    output:\n      set file_id, \"*.bam*\" into indexed_bam_file_single\n\n    script:\n  \"\"\"\n  samtools index ${bam}\n  \"\"\"\n  }",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  samtools index ${bam}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "sorted_bam_files_single"
        ],
        "nb_inputs": 1,
        "outputs": [
            "indexed_bam_file_single"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "publishDir \"results/training/bams/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "CheckInput_Design": {
        "name_process": "CheckInput_Design",
        "string_process": "\nprocess CheckInput_Design {\n  tag \"$csv.simpleName\"\n  label \"check_input\"\n\n  input:\n  file csv from input_csv\n\n  output:\n  file \"*_checked.csv\" into design_FromPATH_checked, design_FromSRA_checked\n                                                                                                                            \n  script:\n\"\"\"\ncheck_design_chip_quant.py $csv ${csv.baseName}_checked.csv\n\"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "\"\"\"\ncheck_design_chip_quant.py $csv ${csv.baseName}_checked.csv\n\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "input_csv"
        ],
        "nb_inputs": 1,
        "outputs": [
            "design_FromPATH_checked",
            "design_FromSRA_checked"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$csv.simpleName\"",
            "label \"check_input\""
        ],
        "when": "",
        "stub": ""
    },
    "Duplicate_removal": {
        "name_process": "Duplicate_removal",
        "string_process": " process Duplicate_removal {\n      label 'picardtools'\n      tag \"$file_id\"\n      publishDir \"${params.outdir}/mapping/${file_id}/ddup/\", mode: 'copy'\n\n      input:\n        set file_id, data_type, file(bams) from bam_files\n      output:\n        set file_id , data_type , \"*.bam\" into dedup_bam_files\n        set file_id, \"${bams[1].baseName}_metrics.txt\", \"${bams[0].baseName}_metrics.txt\", \"${bams[2].baseName}_metrics.txt\" into dDup_bam_report, dedup_reports2normalization\n\n\n      script:\n      \"\"\"\n      PicardCommandLine MarkDuplicates \\\n      VALIDATION_STRINGENCY=LENIENT \\\n      REMOVE_DUPLICATES=true \\\n      INPUT=${bams[0]} \\\n      OUTPUT=${bams[0].baseName}_dedup.bam \\\n      METRICS_FILE=${bams[0].baseName}_metrics.txt\n\n      PicardCommandLine MarkDuplicates \\\n      VALIDATION_STRINGENCY=LENIENT \\\n      REMOVE_DUPLICATES=true \\\n      INPUT=${bams[1]} \\\n      OUTPUT=${bams[1].baseName}_dedup.bam \\\n      METRICS_FILE=${bams[1].baseName}_metrics.txt\n\n      PicardCommandLine MarkDuplicates \\\n      VALIDATION_STRINGENCY=LENIENT \\\n      REMOVE_DUPLICATES=true \\\n      INPUT=${bams[2]} \\\n      OUTPUT=${bams[2].baseName}_dedup.bam \\\n      METRICS_FILE=${bams[2].baseName}_metrics.txt\n      \"\"\"\n      }",
        "nb_lignes_process": 34,
        "string_script": "      \"\"\"\n      PicardCommandLine MarkDuplicates \\\n      VALIDATION_STRINGENCY=LENIENT \\\n      REMOVE_DUPLICATES=true \\\n      INPUT=${bams[0]} \\\n      OUTPUT=${bams[0].baseName}_dedup.bam \\\n      METRICS_FILE=${bams[0].baseName}_metrics.txt\n\n      PicardCommandLine MarkDuplicates \\\n      VALIDATION_STRINGENCY=LENIENT \\\n      REMOVE_DUPLICATES=true \\\n      INPUT=${bams[1]} \\\n      OUTPUT=${bams[1].baseName}_dedup.bam \\\n      METRICS_FILE=${bams[1].baseName}_metrics.txt\n\n      PicardCommandLine MarkDuplicates \\\n      VALIDATION_STRINGENCY=LENIENT \\\n      REMOVE_DUPLICATES=true \\\n      INPUT=${bams[2]} \\\n      OUTPUT=${bams[2].baseName}_dedup.bam \\\n      METRICS_FILE=${bams[2].baseName}_metrics.txt\n      \"\"\"",
        "nb_lignes_script": 21,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bam_files"
        ],
        "nb_inputs": 1,
        "outputs": [
            "dedup_bam_files",
            "dDup_bam_report",
            "dedup_reports2normalization"
        ],
        "nb_outputs": 3,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label 'picardtools'",
            "tag \"$file_id\"",
            "publishDir \"${params.outdir}/mapping/${file_id}/ddup/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Peak_calling": {
        "name_process": "Peak_calling",
        "string_process": "\nprocess Peak_calling {\n  tag \"${ip_ID} vs ${input_ID}\"\n  label \"macs2\"\n  publishDir \"${params.outdir}/peakCalling/${ip_ID}\", mode: 'copy'\n\n  input:\n    set ip_ID, input_ID, file(bam_ip), file(bam_input), data_type from bam_IP_vs_INPUT_merged\n\n  output:\n    file \"*\" into peak_output\n    file \"*_peaks.xls\" into peak_calling_report\n\n\n  when:\n  params.macs_gsize\n\n  script:\n  format = data_type==\"SE\" ? \"BAM\" : \"BAMPE\"\n  \"\"\"\n  macs2 callpeak \\\n    --fix-bimodal \\\n    -f ${format} \\\n    --treatment ${bam_ip} \\\n    --control ${bam_input} \\\n    --name ${ip_ID} \\\n    --gsize ${params.macs_gsize} 2> \\\n    ${ip_ID}_macs2_report.txt\n\n  if grep -q \"ERROR\" ${ip_ID}_macs2_report.txt; then\n    echo \"MACS2 error\"\n    exit 1\n  fi\n  \"\"\"\n}",
        "nb_lignes_process": 33,
        "string_script": "  format = data_type==\"SE\" ? \"BAM\" : \"BAMPE\"\n  \"\"\"\n  macs2 callpeak \\\n    --fix-bimodal \\\n    -f ${format} \\\n    --treatment ${bam_ip} \\\n    --control ${bam_input} \\\n    --name ${ip_ID} \\\n    --gsize ${params.macs_gsize} 2> \\\n    ${ip_ID}_macs2_report.txt\n\n  if grep -q \"ERROR\" ${ip_ID}_macs2_report.txt; then\n    echo \"MACS2 error\"\n    exit 1\n  fi\n  \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "DEFormats"
        ],
        "tools_url": [
            "https://bio.tools/deformats"
        ],
        "tools_dico": [
            {
                "name": "DEFormats",
                "uri": "https://bio.tools/deformats",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Covert between different data formats used by differential gene expression analysis tools.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/DEFormats.html"
            }
        ],
        "inputs": [
            "bam_IP_vs_INPUT_merged"
        ],
        "nb_inputs": 1,
        "outputs": [
            "peak_output",
            "peak_calling_report"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"${ip_ID} vs ${input_ID}\"",
            "label \"macs2\"",
            "publishDir \"${params.outdir}/peakCalling/${ip_ID}\", mode: 'copy'"
        ],
        "when": "params.macs_gsize",
        "stub": ""
    },
    "MultiQC": {
        "name_process": "MultiQC",
        "string_process": " process MultiQC {\n     label \"multiQC\"\n     publishDir \"${params.outdir}/multiQC\", mode: 'copy'\n\n     input:\n     file report_fastqc from fastqc_report.collect().ifEmpty([])\n     file report_trim from trimming_report.collect().ifEmpty([])\n     file report_adptoRemoval from adapter_removal_report.collect().ifEmpty([])\n     file report_ddup from dDup_bam_report.collect().ifEmpty([])\n     file report_peakC from peak_calling_report.collect().ifEmpty([])\n\n     output:\n     file \"*multiqc_*\" into multiqc_report\n\n\n     when:\n     !params.skipMultiqc\n\n     script:\n     \"\"\"\n     multiqc -f . \\\\\n     -m fastqc -m cutadapt -m picard -m macs2\n     \"\"\"\n  }",
        "nb_lignes_process": 22,
        "string_script": "     \"\"\"\n     multiqc -f . \\\\\n     -m fastqc -m cutadapt -m picard -m macs2\n     \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "fastqc_report",
            "trimming_report",
            "adapter_removal_report",
            "dDup_bam_report",
            "peak_calling_report"
        ],
        "nb_inputs": 5,
        "outputs": [
            "multiqc_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"multiQC\"",
            "publishDir \"${params.outdir}/multiQC\", mode: 'copy'"
        ],
        "when": "!params.skipMultiqc",
        "stub": ""
    },
    "Get_size_chromosome": {
        "name_process": "Get_size_chromosome",
        "string_process": "\nprocess Get_size_chromosome {\n     tag \"$fasta.baseName\"\n     publishDir \"${params.outdir}/genome/\", mode: 'copy'\n     label \"samtools\"\n     input:\n       file fasta from fasta_2sizeChr\n\n     output:\n       file \"sizes.genome\" into chr_size_file2norm, chr_size_file2bw\n\n     script:\n       \"\"\"\n           samtools faidx ${fasta}\n           cut -f1,2 ${fasta}.fai > sizes.genome\n       \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "       \"\"\"\n           samtools faidx ${fasta}\n           cut -f1,2 ${fasta}.fai > sizes.genome\n       \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "fasta_2sizeChr"
        ],
        "nb_inputs": 1,
        "outputs": [
            "chr_size_file2norm",
            "chr_size_file2bw"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta.baseName\"",
            "publishDir \"${params.outdir}/genome/\", mode: 'copy'",
            "label \"samtools\""
        ],
        "when": "",
        "stub": ""
    },
    "Wig_normalization": {
        "name_process": "Wig_normalization",
        "string_process": "\nprocess Wig_normalization {\n  if (! params.quantile_norm){\n    label \"wig_manipulation\"\n  }\n  else {\n    label \"danpos\"\n  }\n\n  publishDir \"${params.outdir}/peakCalling/${file_id}/normalization\", mode: 'copy'\n\n  tag \"$file_id\"\n\n  input:\n  set file_id, file(wig) from wig_files\n  file(chr_size) from chr_size_file2norm.collect().ifEmpty([])\n\n  output:\n  set file_id, \"*nor.wig\" into wig_norm_files, wig_norm_files_2concat\n\n  script:\n  if (! params.quantile_norm){\n  \"\"\"\n  wig_average_normalization.py ${wig} ${file_id}.anor.wig\n  \"\"\"\n  }\n  else{\n  \"\"\"\n  danpos.py wiq --out_dir  \"./norm\" --buffer_size 50 --step 1 ${chr_size} ${wig}\n  mv ./norm/* .\n  \"\"\"\n  }\n}",
        "nb_lignes_process": 31,
        "string_script": "  if (! params.quantile_norm){\n  \"\"\"\n  wig_average_normalization.py ${wig} ${file_id}.anor.wig\n  \"\"\"\n  }\n  else{\n  \"\"\"\n  danpos.py wiq --out_dir  \"./norm\" --buffer_size 50 --step 1 ${chr_size} ${wig}\n  mv ./norm/* .\n  \"\"\"\n  }",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "wig_files",
            "chr_size_file2norm"
        ],
        "nb_inputs": 2,
        "outputs": [
            "wig_norm_files",
            "wig_norm_files_2concat"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "publishDir \"${params.outdir}/peakCalling/${file_id}/normalization\", mode: 'copy'",
            "tag \"$file_id\""
        ],
        "when": "",
        "stub": ""
    },
    "Wig_smooth": {
        "name_process": "Wig_smooth",
        "string_process": "\nprocess Wig_smooth {\n  label \"danpos\"\n  publishDir \"${params.outdir}/peakCalling/${file_id}/normalization\", mode: 'copy'\n\n  tag \"$file_id\"\n\n  input:\n  set file_id, file(wig) from wig_norm_files\n\n\n  output:\n  set file_id, \"*nor.smooth.wig\" into wig_norm_smooth_files, wig_norm_smooth_files_2concat\n  set file_id, \"*nor.smooth.positions.xls\" into xls_norm_files\n\n  script:\n  \"\"\"\n  danpos.py dpos -a 1 -n N ${wig}\n  mv result/pooled/${file_id}*.wig .\n  mv result/pooled/${file_id}*.xls .\n  rm -r ./result/\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "  \"\"\"\n  danpos.py dpos -a 1 -n N ${wig}\n  mv result/pooled/${file_id}*.wig .\n  mv result/pooled/${file_id}*.xls .\n  rm -r ./result/\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "wig_norm_files"
        ],
        "nb_inputs": 1,
        "outputs": [
            "wig_norm_smooth_files",
            "wig_norm_smooth_files_2concat",
            "xls_norm_files"
        ],
        "nb_outputs": 3,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"danpos\"",
            "publishDir \"${params.outdir}/peakCalling/${file_id}/normalization\", mode: 'copy'",
            "tag \"$file_id\""
        ],
        "when": "",
        "stub": ""
    },
    "NDRs_finder": {
        "name_process": "NDRs_finder",
        "string_process": "\nprocess NDRs_finder {\n  label \"wig_manipulation\"\n  publishDir \"${params.outdir}/NDRs/${file_id}\", mode: 'copy'\n  tag \"$file_id\"\n\n  input:\n  set file_id, file(wig_norm) from wig_norm_smooth_files\n\n  output:\n\n  set file_id, \"*.bed\" into bed_files\n\n  script:\n  if (! params.quantile_norm){\n  \"\"\"\n  wig2bed.py ${wig_norm} 150 0.4 ${file_id}.bed\n  \"\"\"\n  }\n  else{\n  \"\"\"\n  wig2bed.py ${wig_norm} 150 0.4 ${file_id}.bed\n  \"\"\"\n  }\n}",
        "nb_lignes_process": 23,
        "string_script": "  if (! params.quantile_norm){\n  \"\"\"\n  wig2bed.py ${wig_norm} 150 0.4 ${file_id}.bed\n  \"\"\"\n  }\n  else{\n  \"\"\"\n  wig2bed.py ${wig_norm} 150 0.4 ${file_id}.bed\n  \"\"\"\n  }",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "wig_norm_smooth_files"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bed_files"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"wig_manipulation\"",
            "publishDir \"${params.outdir}/NDRs/${file_id}\", mode: 'copy'",
            "tag \"$file_id\""
        ],
        "when": "",
        "stub": ""
    },
    "Wig2bigWig": {
        "name_process": "Wig2bigWig",
        "string_process": "\nprocess Wig2bigWig {\n  label \"wig2bigwig\"\n  publishDir \"${params.outdir}/BigWig/${file_id}\", mode: 'copy'\n  tag \"$file_id\"\n\n  input:\n  set file_id, file(wig) from wig_files_2bw\n  file(chr_size) from chr_size_file2bw.collect()\n\n\n  output:\n  set file_id, \"*.bw\" into bw_files\n\n  script:\n  \"\"\"\n  wigToBigWig -clip ${wig} ${chr_size} ${wig.baseName}.bw\n  \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "  \"\"\"\n  wigToBigWig -clip ${wig} ${chr_size} ${wig.baseName}.bw\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "wig_files_2bw",
            "chr_size_file2bw"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bw_files"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label \"wig2bigwig\"",
            "publishDir \"${params.outdir}/BigWig/${file_id}\", mode: 'copy'",
            "tag \"$file_id\""
        ],
        "when": "",
        "stub": ""
    },
    "CheckFasta_format": {
        "name_process": "CheckFasta_format",
        "string_process": "\nprocess CheckFasta_format {\n tag \"$fasta.simpleName\"\n\n input:\n   set fasta_id, val(extension), file(fasta)  from fasta_2unzip\n\n output:\n   set fasta_id, \"${fasta.simpleName}_unzip.fasta\" into fasta_2indexing\n\n script:\n    if (extension==\"gz\" || extension==\"bz\" || extension==\"zip\"){\n      log.info \"${fasta.simpleName} file zip, we need to unzip it for next steps\"\n      \"\"\"\n      zcat ${fasta} > ${fasta.simpleName}_unzip.fasta\n      \"\"\"\n    }\n    else{\n      \"\"\"\n      mv ${fasta} ${fasta.simpleName}_unzip.fasta\n      \"\"\"\n    }\n\n}",
        "nb_lignes_process": 22,
        "string_script": "    if (extension==\"gz\" || extension==\"bz\" || extension==\"zip\"){\n      log.info \"${fasta.simpleName} file zip, we need to unzip it for next steps\"\n      \"\"\"\n      zcat ${fasta} > ${fasta.simpleName}_unzip.fasta\n      \"\"\"\n    }\n    else{\n      \"\"\"\n      mv ${fasta} ${fasta.simpleName}_unzip.fasta\n      \"\"\"\n    }",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fasta_2unzip"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fasta_2indexing"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$fasta.simpleName\""
        ],
        "when": "",
        "stub": ""
    },
    "Statistics_mapping": {
        "name_process": "Statistics_mapping",
        "string_process": " process Statistics_mapping {\n      label 'R'\n     tag \"$file_id\"\n     publishDir \"${params.outdir}/mapping/${file_id}/stats\", mode: 'copy'\n\n     input:\n        set file_id, report2fasta, report2both, report2fastaCalib from mapping_reports2stats\n\n     output:\n       file \"${file_id}_reads_origin.svg\" into plots_mapping\n\n     script:\n     if (params.shortReads){\n       tool=1\n     }\n     else{\n       tool=2\n     }\n     \"\"\"\n     diagramm_Venn.R \\\n     ${report2fasta} \\\n     ${report2both} \\\n     ${report2fastaCalib} \\\n     ${tool} \\\n     ${file_id}_reads_origin.svg\n     \"\"\"\n    }",
        "nb_lignes_process": 25,
        "string_script": "     if (params.shortReads){\n       tool=1\n     }\n     else{\n       tool=2\n     }\n     \"\"\"\n     diagramm_Venn.R \\\n     ${report2fasta} \\\n     ${report2both} \\\n     ${report2fastaCalib} \\\n     ${tool} \\\n     ${file_id}_reads_origin.svg\n     \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "mapping_reports2stats"
        ],
        "nb_inputs": 1,
        "outputs": [
            "plots_mapping"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label 'R'",
            "tag \"$file_id\"",
            "publishDir \"${params.outdir}/mapping/${file_id}/stats\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "IP_bam_indexing": {
        "name_process": "IP_bam_indexing",
        "string_process": "\nprocess IP_bam_indexing {\n  tag \"$file_id\"\n  label \"sambamba\"\n  input:\n    set file_id, data_type , file(bams) from bam_IP_2index\n\n  output:\n    set file_id, \"*.bam*\" into bai_2join_bam_IP\n\n  script:\n  \"\"\"\n  sambamba index -t ${task.cpus} ${bams[0]}\n  sambamba index -t ${task.cpus} ${bams[1]}\n  \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  sambamba index -t ${task.cpus} ${bams[0]}\n  sambamba index -t ${task.cpus} ${bams[1]}\n  \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "Sambamba"
        ],
        "tools_url": [
            "https://bio.tools/sambamba"
        ],
        "tools_dico": [
            {
                "name": "Sambamba",
                "uri": "https://bio.tools/sambamba",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This tool is a high performance modern robust and fast tool (and library), written in the D programming language, for working with SAM, BAM and CRAM formats.",
                "homepage": "http://www.open-bio.org/wiki/Sambamba"
            }
        ],
        "inputs": [
            "bam_IP_2index"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bai_2join_bam_IP"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "label \"sambamba\""
        ],
        "when": "",
        "stub": ""
    },
    "IP_bam2BigWig": {
        "name_process": "IP_bam2BigWig",
        "string_process": "\nprocess IP_bam2BigWig {\n  tag \"$file_id\"\n  label \"deeptools\"\n\n  publishDir \"${params.outdir}/bigWig/${file_id}/\", mode: 'copy'\n\n  input:\n    set file_id , data_type , file(bams), file(idx) from bam_bai_IP_2bigwig\n\n\n  output:\n    set file_id, \"*_fasta_occupancy.bw\", '*_fastaCalib_occupancy.bw' into ip_bw_2norm, ip_bw_2stats\n\n  script:\n    \"\"\"\n    bamCoverage --binSize 1 -p ${task.cpus} --ignoreDuplicates -b ${bams[0]} -o ${file_id}_fasta_occupancy.bw\n    bamCoverage --binSize 1 -p ${task.cpus} --ignoreDuplicates -b ${bams[1]} -o ${file_id}_fastaCalib_occupancy.bw\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    bamCoverage --binSize 1 -p ${task.cpus} --ignoreDuplicates -b ${bams[0]} -o ${file_id}_fasta_occupancy.bw\n    bamCoverage --binSize 1 -p ${task.cpus} --ignoreDuplicates -b ${bams[1]} -o ${file_id}_fastaCalib_occupancy.bw\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bam_bai_IP_2bigwig"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ip_bw_2norm",
            "ip_bw_2stats"
        ],
        "nb_outputs": 2,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$file_id\"",
            "label \"deeptools\"",
            "publishDir \"${params.outdir}/bigWig/${file_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Normalized_bigWig": {
        "name_process": "Normalized_bigWig",
        "string_process": "\nprocess Normalized_bigWig {\n  label 'R'\n tag \"$file_id_IP\"\n publishDir \"${params.outdir}/bigWig/${file_id_IP}/norm\", mode: 'copy'\n\n input:\n    set file_id_IP, file(ip_fasta_occupancy_bw), file(ip_fastaCalib_occupancy_bw), file(log_IP), file_id_INPUT, file(log_INPUT) from input_norm_bw\n\n\n output:\n    set file_id_IP, \"*_fasta_occupancy_norm.bw\", \"*_fastaCalib_occupancy_norm.bw\" into norm_ip_bw_2stats\n\n script:\n if (params.shortReads){\n   tool=1\n }\n if (params.duplicate_removal){\n   tool=\"RD\"\n}\nif(!params.duplicate_removal && !params.shortReads){\n   tool=2\n }\n   \"\"\"\n   get_normalization_factor.R \\\n   ${log_IP[0]} \\\n   ${log_IP[1]} \\\n   ${log_INPUT[0]} \\\n   ${log_INPUT[1]} ${tool} > norm_factor\n\n   normalized_occupancy.R \\\n   ${ip_fasta_occupancy_bw} \\\n   ${file_id_IP}_fasta_occupancy_norm.bw \\\n   norm_factor\n\n   normalized_occupancy.R \\\n   ${ip_fastaCalib_occupancy_bw} \\\n   ${file_id_IP}_fastaCalib_occupancy_norm.bw \\\n   norm_factor\n   \"\"\"\n }",
        "nb_lignes_process": 39,
        "string_script": " if (params.shortReads){\n   tool=1\n }\n if (params.duplicate_removal){\n   tool=\"RD\"\n}\nif(!params.duplicate_removal && !params.shortReads){\n   tool=2\n }\n   \"\"\"\n   get_normalization_factor.R \\\n   ${log_IP[0]} \\\n   ${log_IP[1]} \\\n   ${log_INPUT[0]} \\\n   ${log_INPUT[1]} ${tool} > norm_factor\n\n   normalized_occupancy.R \\\n   ${ip_fasta_occupancy_bw} \\\n   ${file_id_IP}_fasta_occupancy_norm.bw \\\n   norm_factor\n\n   normalized_occupancy.R \\\n   ${ip_fastaCalib_occupancy_bw} \\\n   ${file_id_IP}_fastaCalib_occupancy_norm.bw \\\n   norm_factor\n   \"\"\"",
        "nb_lignes_script": 25,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "input_norm_bw"
        ],
        "nb_inputs": 1,
        "outputs": [
            "norm_ip_bw_2stats"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label 'R'",
            "tag \"$file_id_IP\"",
            "publishDir \"${params.outdir}/bigWig/${file_id_IP}/norm\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Statistics_normalization": {
        "name_process": "Statistics_normalization",
        "string_process": "\nprocess Statistics_normalization {\n  label 'R'\n tag \"$file_id_ip_c_wt\"\n publishDir \"${params.outdir}/bigWig/statistics/${file_id_ip_c_wt}_vs_${file_id_ip_c_mut}\", mode: 'copy'\n\n\n input:\n   set file_id_ip_c_wt, file(wt_occupancy_bw), file_id_ip_c_mut, file(mut_occupancy_bw) from ip_C_WT_MUT_bw\n\n output:\n    file \"*.svg\" into plots_occupancy\n\n script:\n   \"\"\"\n   occupancy_statistics.R \\\n   ${wt_occupancy_bw} \\\n   ${mut_occupancy_bw} \\\n   ${wt_occupancy_bw.baseName}_vs_${mut_occupancy_bw.baseName}.svg\n   \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "   \"\"\"\n   occupancy_statistics.R \\\n   ${wt_occupancy_bw} \\\n   ${mut_occupancy_bw} \\\n   ${wt_occupancy_bw.baseName}_vs_${mut_occupancy_bw.baseName}.svg\n   \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ip_C_WT_MUT_bw"
        ],
        "nb_inputs": 1,
        "outputs": [
            "plots_occupancy"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "label 'R'",
            "tag \"$file_id_ip_c_wt\"",
            "publishDir \"${params.outdir}/bigWig/statistics/${file_id_ip_c_wt}_vs_${file_id_ip_c_mut}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Merging_BAM": {
        "name_process": "Merging_BAM",
        "string_process": "\nprocess Merging_BAM {\n\n tag \"$ip_id_merged\"\n publishDir \"${params.outdir}/mapping/BAM_merged/${ip_id_merged}\", mode: 'copy'\n label \"samtools\"\n\n input:\n   set ip_wt, input_wt, ip_mut, input_mut from bam_WT_vs_MUT\n\n output:\n  set ip_id_merged , input_id_merge, file(\"${file_id_IP_wt}_${file_id_IP_mut}.bam\"), file(\"${file_id_INPUT_wt}_${file_id_INPUT_mut}.bam\"), val(data_type) into bam_IP_vs_INPUT_merged\n\n script:\n file_id_IP_wt=ip_wt[0]\n data_type=ip_wt[1]\n bam_ip_wt=ip_wt[2][0]\n\n file_id_INPUT_wt=input_wt[0]\n bam_input_wt=input_wt[2][0]\n\n file_id_IP_mut=ip_mut[0]\n bam_ip_mut=ip_mut[2][0]\n\n file_id_INPUT_mut=input_mut[0]\n bam_input_mut=input_mut[2][0]\n\n ip_id_merged = \"${file_id_IP_wt}_${file_id_IP_mut}\"\n input_id_merge = \"${file_id_INPUT_wt}_${file_id_INPUT_mut}\"\n\n   \"\"\"\n   samtools merge ${file_id_IP_wt}_${file_id_IP_mut}.bam ${bam_ip_wt} ${bam_ip_mut}\n   samtools merge ${file_id_INPUT_wt}_${file_id_INPUT_mut}.bam ${bam_input_wt} ${bam_input_mut}\n   \"\"\"\n}",
        "nb_lignes_process": 33,
        "string_script": " file_id_IP_wt=ip_wt[0]\n data_type=ip_wt[1]\n bam_ip_wt=ip_wt[2][0]\n\n file_id_INPUT_wt=input_wt[0]\n bam_input_wt=input_wt[2][0]\n\n file_id_IP_mut=ip_mut[0]\n bam_ip_mut=ip_mut[2][0]\n\n file_id_INPUT_mut=input_mut[0]\n bam_input_mut=input_mut[2][0]\n\n ip_id_merged = \"${file_id_IP_wt}_${file_id_IP_mut}\"\n input_id_merge = \"${file_id_INPUT_wt}_${file_id_INPUT_mut}\"\n\n   \"\"\"\n   samtools merge ${file_id_IP_wt}_${file_id_IP_mut}.bam ${bam_ip_wt} ${bam_ip_mut}\n   samtools merge ${file_id_INPUT_wt}_${file_id_INPUT_mut}.bam ${bam_input_wt} ${bam_input_mut}\n   \"\"\"",
        "nb_lignes_script": 19,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_WT_vs_MUT"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bam_IP_vs_INPUT_merged"
        ],
        "nb_outputs": 1,
        "name_workflow": "aduvermy__quantitative_nucleosome_analysis",
        "directive": [
            "tag \"$ip_id_merged\"",
            "publishDir \"${params.outdir}/mapping/BAM_merged/${ip_id_merged}\", mode: 'copy'",
            "label \"samtools\""
        ],
        "when": "",
        "stub": ""
    }
}