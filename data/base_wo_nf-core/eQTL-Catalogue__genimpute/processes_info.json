{
    "eagle_prephasing": {
        "name_process": "eagle_prephasing",
        "string_process": "process eagle_prephasing{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple val(chromosome), file(vcf)\n    file eagle_genetic_map\n    file phasing_reference\n\n    output:\n    tuple val(chromosome), file(\"chr${chromosome}.phased.vcf.gz\")\n\n    script:\n    \"\"\"\n    bcftools index ${vcf}\n    eagle --vcfTarget=${vcf} \\\n    --vcfRef=chr${chromosome}.bcf \\\n    --geneticMapFile=${eagle_genetic_map} \\\n    --chrom=${chromosome} \\\n    --outPrefix=chr${chromosome}.phased \\\n    --numThreads=8\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    bcftools index ${vcf}\n    eagle --vcfTarget=${vcf} \\\n    --vcfRef=chr${chromosome}.bcf \\\n    --geneticMapFile=${eagle_genetic_map} \\\n    --chrom=${chromosome} \\\n    --outPrefix=chr${chromosome}.phased \\\n    --numThreads=8\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "EAGLE"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/eagle_gxe"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "EAGLE",
                "uri": "https://bio.tools/eagle_gxe",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0602",
                            "term": "Molecular interactions, pathways and networks"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2497",
                                    "term": "Pathway or network analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3672",
                                    "term": "Gene functional annotation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3672",
                                    "term": "Sequence functional annotation"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2093",
                                "term": "Data reference"
                            },
                            {
                                "uri": "http://edamontology.org/data_2603",
                                "term": "Expression data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "An R package for detecting Gene-by-Environment (GxE) interaction effects on the transcriptome using Allele Specific Expression (ASE) quantified from RNA-seq",
                "homepage": "https://github.com/davidaknowles/eagle"
            }
        ],
        "inputs": [
            "chromosome",
            "vcf",
            "eagle_genetic_map",
            "phasing_reference"
        ],
        "nb_inputs": 4,
        "outputs": [
            "chromosome"
        ],
        "nb_outputs": 1,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "plink_to_vcf": {
        "name_process": "plink_to_vcf",
        "string_process": "process plink_to_vcf{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple file(bed), file(bim), file(fam)\n\n    output:\n    file \"harmonised.vcf.gz\"\n\n    script:\n    \"\"\"\n    plink2 --bfile ${bed.simpleName} --recode vcf-iid --out ${bed.simpleName}\n    bgzip harmonised.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    plink2 --bfile ${bed.simpleName} --recode vcf-iid --out ${bed.simpleName}\n    bgzip harmonised.vcf\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bed",
            "bim",
            "fam"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "annotate": {
        "name_process": "annotate",
        "string_process": "\nprocess annotate {\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file vcf\n    file annotation_file\n\n    output:\n    file \"X_annotated.vcf.gz\"\n\n    script:\n    \"\"\"\n    bcftools index ${vcf}\n    bcftools annotate --rename-chrs ${annotation_file} ${vcf} -Oz -o X_annotated.vcf.gz\n    \"\"\"\n\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    bcftools index ${vcf}\n    bcftools annotate --rename-chrs ${annotation_file} ${vcf} -Oz -o X_annotated.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf",
            "annotation_file"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "vcf_fixref": {
        "name_process": "vcf_fixref",
        "string_process": "\nprocess vcf_fixref{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file input_vcf\n    file fasta\n    tuple file(ref_panel_vcf), file(ref_panel_vcf_index)\n\n    output:\n    file \"fixref.vcf.gz\"\n\n    script:\n    \"\"\"\n    bcftools index ${input_vcf}\n    bcftools +fixref ${input_vcf} -- -f ${fasta} -i ${ref_panel_vcf} | \\\n     bcftools norm --check-ref x -f ${fasta} -Oz -o fixref.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    bcftools index ${input_vcf}\n    bcftools +fixref ${input_vcf} -- -f ${fasta} -i ${ref_panel_vcf} | \\\n     bcftools norm --check-ref x -f ${fasta} -Oz -o fixref.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_vcf",
            "fasta",
            "ref_panel_vcf",
            "ref_panel_vcf_index"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "filter_preimpute_vcf": {
        "name_process": "filter_preimpute_vcf",
        "string_process": "\nprocess filter_preimpute_vcf{\n    publishDir \"${params.outdir}/preimpute/\", mode: 'copy',\n        saveAs: {filename -> if (filename == \"filtered.vcf.gz\") \"${params.output_name}_preimpute.vcf.gz\" else null }\n    \n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file input_vcf\n\n    output:\n    tuple file(\"non_PAR_excluded.vcf.gz\"), file(\"non_PAR_excluded.vcf.gz.csi\")\n\n    script:\n    \"\"\"\n    #Add tags\n    bcftools +fill-tags ${input_vcf} -Oz -o tagged.vcf.gz\n\n\n    #Filter rare and non-HWE variants and those with abnormal alleles and duplicates. \n    bcftools filter -i 'INFO/HWE > 1e-6 & F_MISSING < 0.05 & MAF[0] > 0.01' tagged.vcf.gz |\\\n     bcftools filter -e 'REF=\"N\" | REF=\"I\" | REF=\"D\"' |\\\n     bcftools filter -e \"ALT='.'\" |\\\n     bcftools norm -d all |\\\n     bcftools norm -m+any |\\\n     bcftools view -m2 -M2 -Oz -o filtered.vcf.gz\n\n    #Index the output file\n    bcftools index filtered.vcf.gz\n\n\n    #Exclude non-PAR region.\n    bcftools view filtered.vcf.gz -r 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X:10001-2781479,X:155701383-156030895 -m2 -M2 -Oz -o non_PAR_excluded.vcf.gz\n    bcftools index non_PAR_excluded.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 34,
        "string_script": "    \"\"\"\n    #Add tags\n    bcftools +fill-tags ${input_vcf} -Oz -o tagged.vcf.gz\n\n\n    #Filter rare and non-HWE variants and those with abnormal alleles and duplicates. \n    bcftools filter -i 'INFO/HWE > 1e-6 & F_MISSING < 0.05 & MAF[0] > 0.01' tagged.vcf.gz |\\\n     bcftools filter -e 'REF=\"N\" | REF=\"I\" | REF=\"D\"' |\\\n     bcftools filter -e \"ALT='.'\" |\\\n     bcftools norm -d all |\\\n     bcftools norm -m+any |\\\n     bcftools view -m2 -M2 -Oz -o filtered.vcf.gz\n\n    #Index the output file\n    bcftools index filtered.vcf.gz\n\n\n    #Exclude non-PAR region.\n    bcftools view filtered.vcf.gz -r 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X:10001-2781479,X:155701383-156030895 -m2 -M2 -Oz -o non_PAR_excluded.vcf.gz\n    bcftools index non_PAR_excluded.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 20,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/preimpute/\", mode: 'copy' , saveAs: {filename -> if (filename == \"filtered.vcf.gz\") \"${params.output_name}_preimpute.vcf.gz\" else null }",
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "split_by_chr": {
        "name_process": "split_by_chr",
        "string_process": "\nprocess split_by_chr{\n    publishDir \"${params.outdir}/preimpute/split_chr\", mode: 'copy',\n        saveAs: {filename -> if (filename.indexOf(\".vcf.gz\") > 0) filename else null }\n\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple file(input_vcf), file(input_vcf_index)\n    each chr\n\n    output:\n    tuple val(chr), file(\"chr_${chr}.vcf.gz\")\n\n    script:\n    \"\"\"\n    bcftools query -l ${input_vcf} | sort > samples.txt\n    bcftools view -r ${chr} -S samples.txt ${input_vcf} -Oz -o chr_${chr}.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    bcftools query -l ${input_vcf} | sort > samples.txt\n    bcftools view -r ${chr} -S samples.txt ${input_vcf} -Oz -o chr_${chr}.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_vcf",
            "input_vcf_index",
            "chr"
        ],
        "nb_inputs": 3,
        "outputs": [
            "chr"
        ],
        "nb_outputs": 1,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/preimpute/split_chr\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\".vcf.gz\") > 0) filename else null }",
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "GenotypeHarmonizer": {
        "name_process": "GenotypeHarmonizer",
        "string_process": "process GenotypeHarmonizer{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple file(study_name_bed), file(study_name_bim), file(study_name_fam)\n    tuple file(vcf_file), file(vcf_file_index)\n\n    output:\n    tuple file(\"harmonised.bed\"), file(\"harmonised.bim\"), file(\"harmonised.fam\")\n\n    script:\n    \"\"\"\n    java -Xmx16g -jar /usr/bin/GenotypeHarmonizer.jar\\\n     --input ${study_name_bed.baseName}\\\n     --inputType PLINK_BED\\\n     --ref ${vcf_file.simpleName}\\\n     --refType VCF\\\n     --update-id\\\n     --output harmonised\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    java -Xmx16g -jar /usr/bin/GenotypeHarmonizer.jar\\\n     --input ${study_name_bed.baseName}\\\n     --inputType PLINK_BED\\\n     --ref ${vcf_file.simpleName}\\\n     --refType VCF\\\n     --update-id\\\n     --output harmonised\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "study_name_bed",
            "study_name_bim",
            "study_name_fam",
            "vcf_file",
            "vcf_file_index"
        ],
        "nb_inputs": 5,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "impute_sex": {
        "name_process": "impute_sex",
        "string_process": "process impute_sex{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple file(bed), file(bim), file(fam)\n    \n    output:\n    tuple file(\"chr23_noHET.bed\"), file(\"chr23_noHET.bim\"), file(\"chr23_noHET.fam\")\n    \n    script:\n    \"\"\"\n    plink2 --bfile ${bed.baseName} --impute-sex --make-bed --out sex_imputed\n    plink2 --bfile sex_imputed --chr 23 --make-bed --out chr23\n    plink2 --bfile chr23 --split-x b37 no-fail --make-bed --out split_x\n    plink2 --bfile split_x --chr 23 --make-bed --out chr23_nonPAR\n    plink2 --bfile chr23_nonPAR --make-bed --set-hh-missing --output-chr MT --out chr23_noHET\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    plink2 --bfile ${bed.baseName} --impute-sex --make-bed --out sex_imputed\n    plink2 --bfile sex_imputed --chr 23 --make-bed --out chr23\n    plink2 --bfile chr23 --split-x b37 no-fail --make-bed --out split_x\n    plink2 --bfile split_x --chr 23 --make-bed --out chr23_nonPAR\n    plink2 --bfile chr23_nonPAR --make-bed --set-hh-missing --output-chr MT --out chr23_noHET\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bed",
            "bim",
            "fam"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "extract_female_samples": {
        "name_process": "extract_female_samples",
        "string_process": "\nprocess extract_female_samples{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n    \n    input:\n    tuple file(bed), file(bim), file(fam)\n    \n    output:\n    file(\"female_samples.txt\")\n    file(\"male_samples.txt\")\n    \n    script:\n    \"\"\"\n    zerocount=\\$(awk 'BEGIN{count=0;} {if(\\$5==0)count+=1} END{print count}' ${bed.baseName}.fam)\n    if [ \\$zerocount -ne 0 ]; then echo \"ERROR: .fam file contains ambiguous sexes!\"; exit 1; fi\n    plink2 --bfile ${bed.baseName} --filter-females --make-bed --out females_only\n    plink2 --bfile ${bed.baseName} --filter-males --make-bed --out males_only\n    cut -f2 -d' ' females_only.fam > female_samples.txt\n    cut -f2 -d' ' males_only.fam > male_samples.txt\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    zerocount=\\$(awk 'BEGIN{count=0;} {if(\\$5==0)count+=1} END{print count}' ${bed.baseName}.fam)\n    if [ \\$zerocount -ne 0 ]; then echo \"ERROR: .fam file contains ambiguous sexes!\"; exit 1; fi\n    plink2 --bfile ${bed.baseName} --filter-females --make-bed --out females_only\n    plink2 --bfile ${bed.baseName} --filter-males --make-bed --out males_only\n    cut -f2 -d' ' females_only.fam > female_samples.txt\n    cut -f2 -d' ' males_only.fam > male_samples.txt\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bed",
            "bim",
            "fam"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "initial_filter": {
        "name_process": "initial_filter",
        "string_process": "\nprocess initial_filter{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file input_vcf\n    \n    output:\n    file(\"filtered_X.vcf.gz\")\n    \n    script:\n    \"\"\"\n    bcftools filter -e \"ALT='.'\" ${input_vcf} | bcftools filter -i 'F_MISSING < 0.05' -Oz -o filtered_X.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    bcftools filter -e \"ALT='.'\" ${input_vcf} | bcftools filter -i 'F_MISSING < 0.05' -Oz -o filtered_X.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "female_qc": {
        "name_process": "female_qc",
        "string_process": "\nprocess female_qc{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file(txt)\n    file(vcf)\n\n    output:\n    file(\"female_passed_regions.txt\")\n\n    script:\n    \"\"\"\n    bcftools view -S ${txt} ${vcf} -Oz -o females_only.vcf.gz\n    bcftools +fill-tags females_only.vcf.gz -Oz -o females_only_tagged.vcf.gz\n    bcftools filter -i 'INFO/HWE > 1e-6 & F_MISSING < 0.05 & MAF[0] > 0.01' females_only_tagged.vcf.gz |\\\n        bcftools filter -e 'REF=\"N\" | REF=\"I\" | REF=\"D\"' |\\\n        bcftools filter -e \"ALT='.'\" |\\\n        bcftools norm -d all |\\\n        bcftools norm -m+any |\\\n        bcftools view -m2 -M2 -Oz -o females_only_filtered.vcf.gz\n    bcftools query -f \"%CHROM\\t%POS\\n\" females_only_filtered.vcf.gz > female_passed_regions.txt\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    bcftools view -S ${txt} ${vcf} -Oz -o females_only.vcf.gz\n    bcftools +fill-tags females_only.vcf.gz -Oz -o females_only_tagged.vcf.gz\n    bcftools filter -i 'INFO/HWE > 1e-6 & F_MISSING < 0.05 & MAF[0] > 0.01' females_only_tagged.vcf.gz |\\\n        bcftools filter -e 'REF=\"N\" | REF=\"I\" | REF=\"D\"' |\\\n        bcftools filter -e \"ALT='.'\" |\\\n        bcftools norm -d all |\\\n        bcftools norm -m+any |\\\n        bcftools view -m2 -M2 -Oz -o females_only_filtered.vcf.gz\n    bcftools query -f \"%CHROM\\t%POS\\n\" females_only_filtered.vcf.gz > female_passed_regions.txt\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "txt",
            "vcf"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "preimpute_filter": {
        "name_process": "preimpute_filter",
        "string_process": "\nprocess preimpute_filter{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file(passed_regions)\n    file(vcf)\n\n    output:\n    tuple val(\"X\"), file(\"full_filtered.vcf.gz\")\n\n    script:\n    \"\"\"\n    bcftools view -T ${passed_regions} ${vcf} -Oz -o full_filtered.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    bcftools view -T ${passed_regions} ${vcf} -Oz -o full_filtered.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "passed_regions",
            "vcf"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "final_filter": {
        "name_process": "final_filter",
        "string_process": "\nprocess final_filter{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple val(chromosome), file(vcf)\n\n    output:\n    file('completely_filtered.vcf.gz')\n\n    script:\n    \"\"\"\n    bcftools filter -i 'INFO/R2 > ${params.r2_thresh} & MAF[0]>0.01' ${vcf} | bcftools sort -Oz -o completely_filtered.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    bcftools filter -i 'INFO/R2 > ${params.r2_thresh} & MAF[0]>0.01' ${vcf} | bcftools sort -Oz -o completely_filtered.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "chromosome",
            "vcf"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "split_male_female_dosage": {
        "name_process": "split_male_female_dosage",
        "string_process": "\nprocess split_male_female_dosage{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file(input_vcf)\n    file(vcf_index)\n    file female_samples\n    file male_samples\n\n    output:\n    file \"male_dosage_only.vcf\" \n    file \"female_dosage_only.vcf.gz\" \n\n    shell:\n    \"\"\"\n    #Keep only dosage field\n    bcftools annotate -x ^FORMAT/GT,^FORMAT/DS ${input_vcf} -Oz -o dosage_only.vcf.gz\n    #Extract male/female samples\n    bcftools view -S ${male_samples} dosage_only.vcf.gz -o male_dosage_only.vcf\n    bcftools view -S ${female_samples} dosage_only.vcf.gz -Oz -o female_dosage_only.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    #Keep only dosage field\n    bcftools annotate -x ^FORMAT/GT,^FORMAT/DS ${input_vcf} -Oz -o dosage_only.vcf.gz\n    #Extract male/female samples\n    bcftools view -S ${male_samples} dosage_only.vcf.gz -o male_dosage_only.vcf\n    bcftools view -S ${female_samples} dosage_only.vcf.gz -Oz -o female_dosage_only.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_vcf",
            "vcf_index",
            "female_samples",
            "male_samples"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "double_male_dosage": {
        "name_process": "double_male_dosage",
        "string_process": "\nprocess double_male_dosage{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file(vcf) \n\n    output:\n    file \"double_male_dosage.vcf\" \n\n    shell:\n                                                                                                                                                      \n    \"\"\"\n    awk -v OFS='\\t' '{if (substr(\\$1,1,1)!=\"#\") {for (i=10; i<=NF;i++) { n=split(\\$i,a,\":\"); a[2]=a[2]*2;\\$i=a[1];for (j=2; j<=n; j++){\\$i=\\$i \":\"a[j]}}}print \\$0}' ${vcf} > double_male_dosage.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    awk -v OFS='\\t' '{if (substr(\\$1,1,1)!=\"#\") {for (i=10; i<=NF;i++) { n=split(\\$i,a,\":\"); a[2]=a[2]*2;\\$i=a[1];for (j=2; j<=n; j++){\\$i=\\$i \":\"a[j]}}}print \\$0}' ${vcf} > double_male_dosage.vcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "merge_male_female": {
        "name_process": "merge_male_female",
        "string_process": "\nprocess merge_male_female{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file(male_vcf)\n    file(female_vcf)\n\n    output:\n    file(\"chr_X_non_PAR.vcf.gz\")\n    file(\"chr_X_non_PAR.vcf.gz.csi\")\n\n    shell:\n    \"\"\"\n    bgzip ${male_vcf}\n    bcftools index ${male_vcf}.gz\n    bcftools index ${female_vcf}\n    bcftools merge ${female_vcf} ${male_vcf}.gz -Oz -o merged.vcf.gz\n    bcftools query -l merged.vcf.gz | sort > samples.txt\n    bcftools view -S samples.txt merged.vcf.gz -Oz -o chr_X_non_PAR.vcf.gz\n    bcftools index chr_X_non_PAR.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    bgzip ${male_vcf}\n    bcftools index ${male_vcf}.gz\n    bcftools index ${female_vcf}\n    bcftools merge ${female_vcf} ${male_vcf}.gz -Oz -o merged.vcf.gz\n    bcftools query -l merged.vcf.gz | sort > samples.txt\n    bcftools view -S samples.txt merged.vcf.gz -Oz -o chr_X_non_PAR.vcf.gz\n    bcftools index chr_X_non_PAR.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "male_vcf",
            "female_vcf"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "rename_chromosomes": {
        "name_process": "rename_chromosomes",
        "string_process": "\nprocess rename_chromosomes{\n    container = 'quay.io/biocontainers/bcftools:1.12--h45bccc9_1'\n\n    input:\n    tuple val(chr), file(vcf) from vcf_file_ch\n    file(chromsome_names) from chr_names_file_ch.collect()\n\n    output:\n    tuple val(chr), file(\"${chr}.renamed.vcf.gz\") into build_minimac_ref_ch, build_beagle_ref_ch, create_eagle_bcf_ch, extract_var_info_ch\n\n    script:\n    \"\"\"\n    bcftools annotate --rename-chrs ${chromsome_names} ${vcf} -Oz -o ${chr}.renamed.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    bcftools annotate --rename-chrs ${chromsome_names} ${vcf} -Oz -o ${chr}.renamed.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf_file_ch",
            "chr_names_file_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "build_minimac_ref_ch",
            "build_beagle_ref_ch",
            "create_eagle_bcf_ch",
            "extract_var_info_ch"
        ],
        "nb_outputs": 4,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/biocontainers/bcftools:1.12--h45bccc9_1'"
        ],
        "when": "",
        "stub": ""
    },
    "create_m3vcf": {
        "name_process": "create_m3vcf",
        "string_process": "\nprocess create_m3vcf{\n    publishDir \"${params.outdir}/m3vcf/\", mode: 'copy', pattern: \"*.m3vcf.gz\"\n\n    container = \"quay.io/eqtlcatalogue/minimac3:v2.0.1\"\n\n    when:\n    params.m3vcf\n\n    input:\n    tuple val(chr), file(vcf) from build_minimac_ref_ch\n\n    output:\n    tuple val(chr), file(\"${chr}.m3vcf.gz\") into m3vcf_ch\n\n    script:\n    \"\"\"\n    minimac3 --refHaps ${vcf} --processReference --prefix ${chr}\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    minimac3 --refHaps ${vcf} --processReference --prefix ${chr}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "Minimac3"
        ],
        "tools_url": [
            "https://bio.tools/minimac3"
        ],
        "tools_dico": [
            {
                "name": "Minimac3",
                "uri": "https://bio.tools/minimac3",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "It is designed to handle very large reference panels in a more computationally efficient way with no loss of accuracy. It accomplishes this by identifying repeat haplotype patterns and using these to simplify the underlying calculations, with no loss of accuracy. It uses M3VCF files to store reference panel information in a compact form. M3VCF files can also store pre-calculated estimates of recombination fraction and error, which speeds up later rounds of imputation.",
                "homepage": "http://genome.sph.umich.edu/wiki/Minimac3"
            }
        ],
        "inputs": [
            "build_minimac_ref_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "m3vcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/m3vcf/\", mode: 'copy', pattern: \"*.m3vcf.gz\"",
            "container = \"quay.io/eqtlcatalogue/minimac3:v2.0.1\""
        ],
        "when": "params.m3vcf",
        "stub": ""
    },
    "create_bref3": {
        "name_process": "create_bref3",
        "string_process": "\nprocess create_bref3{\n    publishDir \"${params.outdir}/bref3/\", mode: 'copy', pattern: \"*.bref3\"\n\n    container = \"quay.io/eqtlcatalogue/beagle52:21Apr21.304\"\n\n    input:\n    tuple val(chr), file(vcf) from build_beagle_ref_ch\n\n    output:\n    tuple val(chr), file(\"${chr}.bref3\") into bref3_ch\n\n    script:\n    \"\"\"\n    zcat ${vcf} | java -jar /usr/bin/bref3.21Apr21.304.jar > ${chr}.bref3\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    zcat ${vcf} | java -jar /usr/bin/bref3.21Apr21.304.jar > ${chr}.bref3\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "build_beagle_ref_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bref3_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/bref3/\", mode: 'copy', pattern: \"*.bref3\"",
            "container = \"quay.io/eqtlcatalogue/beagle52:21Apr21.304\""
        ],
        "when": "",
        "stub": ""
    },
    "create_eagle_bcf": {
        "name_process": "create_eagle_bcf",
        "string_process": "\nprocess create_eagle_bcf{\n    publishDir \"${params.outdir}/eagle_ref/\", mode: 'copy', pattern: \"chr*\"\n\n    container = \"quay.io/biocontainers/bcftools:1.12--h45bccc9_1\"\n\n    input:\n    tuple val(chr), file(vcf) from create_eagle_bcf_ch\n\n    output:\n    tuple val(chr), file(\"${chr}.bcf\"), file(\"${chr}.bcf.csi\") into bcf_ch\n\n    script:\n    \"\"\"\n    bcftools view ${vcf} -Ob -o ${chr}.bcf\n    bcftools index ${chr}.bcf\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    bcftools view ${vcf} -Ob -o ${chr}.bcf\n    bcftools index ${chr}.bcf\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "create_eagle_bcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/eagle_ref/\", mode: 'copy', pattern: \"chr*\"",
            "container = \"quay.io/biocontainers/bcftools:1.12--h45bccc9_1\""
        ],
        "when": "",
        "stub": ""
    },
    "extract_variant_information": {
        "name_process": "extract_variant_information",
        "string_process": "\nprocess extract_variant_information{\n    publishDir \"${params.outdir}/variant_info/\", mode: 'copy', pattern: \"*.vcf.gz\"\n\n    container = \"quay.io/biocontainers/bcftools:1.12--h45bccc9_1\"\n\n    input:\n    tuple val(chr), file(vcf) from extract_var_info_ch\n\n    output:\n    tuple val(chr), file(\"${chr}_var_info.vcf.gz\") into var_info_ch\n\n    script:\n    \"\"\"\n    zcat ${vcf} | cut -f 1-8 | bgzip > ${chr}_var_info.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    zcat ${vcf} | cut -f 1-8 | bgzip > ${chr}_var_info.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "extract_var_info_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "var_info_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/variant_info/\", mode: 'copy', pattern: \"*.vcf.gz\"",
            "container = \"quay.io/biocontainers/bcftools:1.12--h45bccc9_1\""
        ],
        "when": "",
        "stub": ""
    },
    "CrossMap": {
        "name_process": "CrossMap",
        "string_process": "process CrossMap{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple file(bed), file(bim), file(fam)\n    file chain_file\n\n    output:\n    tuple file(\"crossmapped_plink.bed\"), file(\"crossmapped_plink.bim\"), file(\"crossmapped_plink.fam\")\n\n    shell: \n                                                                  \n                                                                         \n                                                   \n    \"\"\"\n    awk '{print \\$1,\\$4,\\$4+1,\\$2,\\$5,\\$6,\\$2 \"___\" \\$5 \"___\" \\$6}' ${bed.simpleName}.bim > crossmap_input.bed\n    CrossMap.py bed ${chain_file} crossmap_input.bed crossmap_output.bed\n    awk '{print \\$7}' crossmap_input.bed | sort > input_ids.txt\n    awk '{print \\$7}' crossmap_output.bed | sort > output_ids.txt\n    comm -23 input_ids.txt output_ids.txt | awk '{split(\\$0,a,\"___\"); print a[1]}' > excluded_ids.txt\n    plink2 --bfile ${bed.simpleName} --exclude excluded_ids.txt --make-bed --output-chr MT --out crossmapped_plink\n    awk -F'\\t' 'BEGIN {OFS=FS} {print \\$1,\\$4,0,\\$2,\\$5,\\$6}' crossmap_output.bed > crossmapped_plink.bim\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    awk '{print \\$1,\\$4,\\$4+1,\\$2,\\$5,\\$6,\\$2 \"___\" \\$5 \"___\" \\$6}' ${bed.simpleName}.bim > crossmap_input.bed\n    CrossMap.py bed ${chain_file} crossmap_input.bed crossmap_output.bed\n    awk '{print \\$7}' crossmap_input.bed | sort > input_ids.txt\n    awk '{print \\$7}' crossmap_output.bed | sort > output_ids.txt\n    comm -23 input_ids.txt output_ids.txt | awk '{split(\\$0,a,\"___\"); print a[1]}' > excluded_ids.txt\n    plink2 --bfile ${bed.simpleName} --exclude excluded_ids.txt --make-bed --output-chr MT --out crossmapped_plink\n    awk -F'\\t' 'BEGIN {OFS=FS} {print \\$1,\\$4,0,\\$2,\\$5,\\$6}' crossmap_output.bed > crossmapped_plink.bim\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "COMMA"
        ],
        "tools_url": [
            "https://bio.tools/comma"
        ],
        "tools_dico": [
            {
                "name": "COMMA",
                "uri": "https://bio.tools/comma",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2275",
                            "term": "Molecular modelling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0078",
                            "term": "Proteins"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0078",
                            "term": "Protein bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0078",
                            "term": "Protein informatics"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "COMMA (COMmunication MApping) is a method to dissect proteins dynamical architectures.",
                "homepage": "http://www.lcqb.upmc.fr/COMMA/COMMA.html"
            }
        ],
        "inputs": [
            "bed",
            "bim",
            "fam",
            "chain_file"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "CrossMap_QC": {
        "name_process": "CrossMap_QC",
        "string_process": "\nprocess CrossMap_QC{\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file vcf\n\n    output:\n    tuple file(\"${vcf.simpleName}_QCd.vcf.gz\"), file(\"${vcf.simpleName}_QCd.vcf.gz.tbi\")\n\n    shell:\n    \"\"\"\n    bcftools sort ${vcf} -Oz -o ${vcf.simpleName}_QCd.vcf.gz\n    bcftools index -t ${vcf.simpleName}_QCd.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    bcftools sort ${vcf} -Oz -o ${vcf.simpleName}_QCd.vcf.gz\n    bcftools index -t ${vcf.simpleName}_QCd.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "minimac_imputation": {
        "name_process": "minimac_imputation",
        "string_process": "process minimac_imputation{\n    publishDir \"${params.outdir}/postimpute/\", mode: 'copy', pattern: \"*.dose.vcf.gz\"\n \n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    tuple val(chromosome), file(vcf)\n    file imputation_reference\n\n    output:\n    file(\"chr_${chromosome}.dose.vcf.gz\")\n    file(\"chr_${chromosome}.dose.vcf.gz.csi\")\n\n    script:\n    \"\"\"\n    minimac4 --refHaps chr${chromosome}.m3vcf.gz \\\n    --haps ${vcf} \\\n    --prefix chr_${chromosome} \\\n    --format GT,DS,GP \\\n    --noPhoneHome \\\n    --minRatio 0.05\n    bcftools index chr_${chromosome}.dose.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    minimac4 --refHaps chr${chromosome}.m3vcf.gz \\\n    --haps ${vcf} \\\n    --prefix chr_${chromosome} \\\n    --format GT,DS,GP \\\n    --noPhoneHome \\\n    --minRatio 0.05\n    bcftools index chr_${chromosome}.dose.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "chromosome",
            "vcf",
            "imputation_reference"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/postimpute/\", mode: 'copy', pattern: \"*.dose.vcf.gz\"",
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "filter_vcf": {
        "name_process": "filter_vcf",
        "string_process": "process filter_vcf{\n  publishDir \"${params.outdir}/minimac_out/filtered\", mode: 'copy', pattern: \"*.vcf.gz*\"\n  container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file(vcf)\n    file(index)\n\n    output:\n    file(\"${params.output_name}.filtered.vcf.gz\")\n    file(\"${params.output_name}.filtered.vcf.gz.csi\")\n\n    shell:\n    \"\"\"\n    bcftools filter -i 'INFO/R2 > ${params.r2_thresh}' ${vcf} | \\\n      bcftools filter -i 'MAF[0] > 0.01' -Oz -o ${params.output_name}.filtered.vcf.gz\n    bcftools index ${params.output_name}.filtered.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    \"\"\"\n    bcftools filter -i 'INFO/R2 > ${params.r2_thresh}' ${vcf} | \\\n      bcftools filter -i 'MAF[0] > 0.01' -Oz -o ${params.output_name}.filtered.vcf.gz\n    bcftools index ${params.output_name}.filtered.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf",
            "index"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/minimac_out/filtered\", mode: 'copy', pattern: \"*.vcf.gz*\"",
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    },
    "merge_unfiltered_vcf": {
        "name_process": "merge_unfiltered_vcf",
        "string_process": "\nprocess merge_unfiltered_vcf{\n    publishDir \"${params.outdir}/minimac_out/unfiltered\", mode: 'copy', pattern: \"*.vcf.gz*\"\n    container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'\n\n    input:\n    file input_files\n    file indices\n\n    output:\n    file(\"${params.output_name}.all_variants.vcf.gz\")\n    file(\"${params.output_name}.all_variants.vcf.gz.csi\")\n\n\n    shell:\n    \"\"\"\n    bcftools concat ${input_files.join(' ')} -a -Ou | \\\n    bcftools annotate --set-id 'chr%CHROM\\\\_%POS\\\\_%REF\\\\_%FIRST_ALT' | \\\n    bcftools +fill-tags -Oz -o ${params.output_name}.all_variants.vcf.gz\n    bcftools index ${params.output_name}.all_variants.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    bcftools concat ${input_files.join(' ')} -a -Ou | \\\n    bcftools annotate --set-id 'chr%CHROM\\\\_%POS\\\\_%REF\\\\_%FIRST_ALT' | \\\n    bcftools +fill-tags -Oz -o ${params.output_name}.all_variants.vcf.gz\n    bcftools index ${params.output_name}.all_variants.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "input_files",
            "indices"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "eQTL-Catalogue__genimpute",
        "directive": [
            "publishDir \"${params.outdir}/minimac_out/unfiltered\", mode: 'copy', pattern: \"*.vcf.gz*\"",
            "container = 'quay.io/eqtlcatalogue/genimpute:v20.06.1'"
        ],
        "when": "",
        "stub": ""
    }
}