{
    "AddRG": {
        "name_process": "AddRG",
        "string_process": "\nprocess AddRG {\n\n  input:\n  file(bam) from bam_ch\n\n  output:\n  file('*') into rgbam_ch\n\n  script:\n  \"\"\"\n  bamaddrg -b $bam -s ${bam.baseName} > ${bam}_RG\n  \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "  \"\"\"\n  bamaddrg -b $bam -s ${bam.baseName} > ${bam}_RG\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "bam_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "rgbam_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "IndexBams": {
        "name_process": "IndexBams",
        "string_process": "\nprocess IndexBams {\n\n  input:\n  file(bam) from rgbam_ch\n\n  output:\n  tuple file(bam), file('*.bai') into ibam_ch\n  tuple file(bam), file('*.bai') into ibam2_ch\n\n  script:\n  \"\"\"\n  samtools index $bam\n  \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "  \"\"\"\n  samtools index $bam\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "rgbam_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ibam_ch",
            "ibam2_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "CreateChrlist": {
        "name_process": "CreateChrlist",
        "string_process": "\nprocess CreateChrlist {\n\n  input:\n  file(allf) from ibam2_ch.collect()\n  each chr from chr_list\n\n  output:\n  stdout into chrsplit_ch\n  stdout ch\n\n  script:\n  def bams = allf.findAll{it =~ /bam_RG$/}\n  \"\"\"\n  split=\\$(python ${projectDir}/bin/chr_splitter.py -c $chr -r $params.ref -p $params.split)\n\n  if [[ -z \"\\$split\" ]]\n  then\n      echo \"${chr}\"\n  else\n      for item in \\$split; do\n        mreads=\\$(for f in ${bams.join(' ')}; do samtools view -c \\$f \\$item ; done | awk '{ sum += \\$1 } END { if (NR > 0) print sum / NR }')\n        if [ \\$( echo \"\\$mreads < ${params.highcov}\" | bc ) -ne 0 ] ; then\n         echo \\$item\n        else\n         start=\\$(echo \\$item | sed 's/.*://' | sed 's/-.*//')\n         end=\\$(echo \\$item |sed 's/.*-//')\n         inc=\\$(echo \"${params.split} / ${params.div}\" | bc)\n         for i in \\$(seq \\$start \\$inc \\$end); do\n           e=\\$(echo \"(\\$i + \\$inc) - 1\" | bc)\n           if ((\\$e > \\$end)); then\n            if ((\\$end != \\$i)); then\n              echo \"${chr}:\\$i-\\$end\"\n            fi\n           else\n            echo \"${chr}:\\$i-\\$e\"\n          fi\n         done\n        fi\n       done\n  fi\n\n   \"\"\"\n}",
        "nb_lignes_process": 42,
        "string_script": "  def bams = allf.findAll{it =~ /bam_RG$/}\n  \"\"\"\n  split=\\$(python ${projectDir}/bin/chr_splitter.py -c $chr -r $params.ref -p $params.split)\n\n  if [[ -z \"\\$split\" ]]\n  then\n      echo \"${chr}\"\n  else\n      for item in \\$split; do\n        mreads=\\$(for f in ${bams.join(' ')}; do samtools view -c \\$f \\$item ; done | awk '{ sum += \\$1 } END { if (NR > 0) print sum / NR }')\n        if [ \\$( echo \"\\$mreads < ${params.highcov}\" | bc ) -ne 0 ] ; then\n         echo \\$item\n        else\n         start=\\$(echo \\$item | sed 's/.*://' | sed 's/-.*//')\n         end=\\$(echo \\$item |sed 's/.*-//')\n         inc=\\$(echo \"${params.split} / ${params.div}\" | bc)\n         for i in \\$(seq \\$start \\$inc \\$end); do\n           e=\\$(echo \"(\\$i + \\$inc) - 1\" | bc)\n           if ((\\$e > \\$end)); then\n            if ((\\$end != \\$i)); then\n              echo \"${chr}:\\$i-\\$end\"\n            fi\n           else\n            echo \"${chr}:\\$i-\\$e\"\n          fi\n         done\n        fi\n       done\n  fi\n\n   \"\"\"",
        "nb_lignes_script": 30,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ibam2_ch",
            "chr_list"
        ],
        "nb_inputs": 2,
        "outputs": [
            "chrsplit_ch",
            "ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "CallVariants": {
        "name_process": "CallVariants",
        "string_process": " process CallVariants {\n\n    label 'RAM_high'\n\n    input:\n    file(allf) from ibam_ch.collect()\n    each chr from chrsplit_lines\n\n    output:\n    file('*') into chrvcf_ch\n\n    script:\n    def bams = allf.findAll{it =~ /bam_RG$/}\n                                                       \n    \"\"\"\n    freebayes -f ${params.ref} -r ${chr.trim()} ${bams.join(' ')} > ${chr.trim()}.vcf\n    \"\"\"\n\n  }",
        "nb_lignes_process": 17,
        "string_script": "    def bams = allf.findAll{it =~ /bam_RG$/}\n                                                       \n    \"\"\"\n    freebayes -f ${params.ref} -r ${chr.trim()} ${bams.join(' ')} > ${chr.trim()}.vcf\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "ibam_ch",
            "chrsplit_lines"
        ],
        "nb_inputs": 2,
        "outputs": [
            "chrvcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [
            "label 'RAM_high'"
        ],
        "when": "",
        "stub": ""
    },
    "CallVariantsPop": {
        "name_process": "CallVariantsPop",
        "string_process": " process CallVariantsPop {\n\n    label 'RAM_high'\n\n    input:\n    file(allf) from ibam_ch.collect()\n    each chr from chrsplit_lines\n\n    output:\n    file('*') into chrvcf_ch\n\n    script:\n    def bams = allf.findAll{it =~ /bam_RG$/}\n                                                       \n    \"\"\"\n    freebayes -f ${params.ref} -r ${chr.trim()} ${bams.join(' ')} --populations ${params.poplist} > ${chr.trim()}.vcf\n    \"\"\"\n  }",
        "nb_lignes_process": 16,
        "string_script": "    def bams = allf.findAll{it =~ /bam_RG$/}\n                                                       \n    \"\"\"\n    freebayes -f ${params.ref} -r ${chr.trim()} ${bams.join(' ')} --populations ${params.poplist} > ${chr.trim()}.vcf\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "ibam_ch",
            "chrsplit_lines"
        ],
        "nb_inputs": 2,
        "outputs": [
            "chrvcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [
            "label 'RAM_high'"
        ],
        "when": "",
        "stub": ""
    },
    "CompressVCF": {
        "name_process": "CompressVCF",
        "string_process": "\nprocess CompressVCF {\n\n  input:\n  file(chr) from chrvcf_ch\n\n  output:\n  file('*') into chrvcfgz_ch\n\n  script:\n  \"\"\"\n  bgzip -c $chr > ${chr}.gz\n  \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "  \"\"\"\n  bgzip -c $chr > ${chr}.gz\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "chrvcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "chrvcfgz_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "SortSamples": {
        "name_process": "SortSamples",
        "string_process": "\nprocess SortSamples {\n\n  input:\n  file(samp_list) from samp_ch.collect()\n  each file(chr) from chrvcfgz_ch\n\n  output:\n  file('*.gz') into chrvcfgzso_ch\n\n  script:\n  samps = samp_list.baseName\n  \"\"\"\n  tabix ${chr}\n  bcftools view ${chr} -s ${samps.join(',')} -Oz > S_${chr}\n  \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "  samps = samp_list.baseName\n  \"\"\"\n  tabix ${chr}\n  bcftools view ${chr} -s ${samps.join(',')} -Oz > S_${chr}\n  \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "samp_ch",
            "chrvcfgz_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "chrvcfgzso_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "IndexVCF": {
        "name_process": "IndexVCF",
        "string_process": "\nprocess IndexVCF {\n\n  input:\n  file(chr) from chrvcfgzso_ch\n\n  output:\n  tuple file(chr), file('*') into chrvcfgzi_ch\n\n  script:\n  \"\"\"\n  bcftools index $chr\n  \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "  \"\"\"\n  bcftools index $chr\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "chrvcfgzso_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "chrvcfgzi_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "MergeVCF": {
        "name_process": "MergeVCF",
        "string_process": "\nprocess MergeVCF {\n\n  publishDir \"${params.outdir}\", mode: 'copy'\n\n  input:\n  file(all_chr) from chrvcfgzi_ch.collect()\n\n  output:\n  file('*final.vcf.gz') into vcf_ch\n\n  script:\n  def vcfs = all_chr.findAll{it =~ /gz$/}\n  \"\"\"\n  bcftools concat -a ${vcfs.join(' ')} > nfvacal_out.vcf\n  grep \"^#\" nfvacal_out.vcf > nfvacal_final.vcf\n  grep -v \"^#\" nfvacal_out.vcf| sort -T ./ -k1,1V -k2,2g >> nfvacal_final.vcf\n  bgzip nfvacal_final.vcf\n  \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "  def vcfs = all_chr.findAll{it =~ /gz$/}\n  \"\"\"\n  bcftools concat -a ${vcfs.join(' ')} > nfvacal_out.vcf\n  grep \"^#\" nfvacal_out.vcf > nfvacal_final.vcf\n  grep -v \"^#\" nfvacal_out.vcf| sort -T ./ -k1,1V -k2,2g >> nfvacal_final.vcf\n  bgzip nfvacal_final.vcf\n  \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "chrvcfgzi_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [
            "publishDir \"${params.outdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Stats": {
        "name_process": "Stats",
        "string_process": "\nprocess Stats {\n  publishDir \"${params.outdir}/stats/\", mode: 'copy'\n\n  input:\n  file(vcf) from filvcf_ch\n\n  output:\n  tuple file('*.frq'), file('*.het'), file('*.idepth'), file('*.imiss'), file('*.ldepth.mean'), file('*.lmiss'), file('*.lqual'), file('*.txt') into stats_ch\n\n  script:\n  \"\"\"\n  bcftools index -f $vcf\n  tabix $vcf\n  vcfstats $vcf > vcfstats.txt\n  vcfrandomsample -r ${params.frac}  $vcf > ${vcf.baseName}_subset.vcf\n  bgzip ${vcf.baseName}_subset.vcf\n  bcftools index -f ${vcf.baseName}_subset.vcf.gz\n  tabix ${vcf.baseName}_subset.vcf.gz\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --freq2 --max-alleles 2\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --depth\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --site-mean-depth\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --site-quality\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --missing-indv\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --missing-site\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --het\n\n  \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "  \"\"\"\n  bcftools index -f $vcf\n  tabix $vcf\n  vcfstats $vcf > vcfstats.txt\n  vcfrandomsample -r ${params.frac}  $vcf > ${vcf.baseName}_subset.vcf\n  bgzip ${vcf.baseName}_subset.vcf\n  bcftools index -f ${vcf.baseName}_subset.vcf.gz\n  tabix ${vcf.baseName}_subset.vcf.gz\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --freq2 --max-alleles 2\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --depth\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --site-mean-depth\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --site-quality\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --missing-indv\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --missing-site\n  vcftools --gzvcf ${vcf.baseName}_subset.vcf.gz --het\n\n  \"\"\"",
        "nb_lignes_script": 16,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "filvcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "stats_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [
            "publishDir \"${params.outdir}/stats/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Report": {
        "name_process": "Report",
        "string_process": "\nprocess Report {\n  publishDir \"${params.outdir}\", mode: 'copy'\n\n  input:\n  tuple file(frq), file(het), file(idepth), file(imiss), file(ldepth), file(lmiss), file(lqual), file(vcfstats) from stats_ch\n\n  output:\n  file('*.html') into report_ch\n\n  script:\n  \"\"\"\n  Rscript -e \"rmarkdown::render('${projectDir}/bin/Report.Rmd', params=list(vcfstats='\\$PWD/${vcfstats}',lqual='\\$PWD/${lqual}',idepth='\\$PWD/${idepth}',ldepth='\\$PWD/${ldepth}',imiss='\\$PWD/${imiss}',lmiss='\\$PWD/${lmiss}',het='\\$PWD/${het}',frq='\\$PWD/${frq}'), output_dir='\\$PWD')\"\n  \"\"\"\n\n}",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  Rscript -e \"rmarkdown::render('${projectDir}/bin/Report.Rmd', params=list(vcfstats='\\$PWD/${vcfstats}',lqual='\\$PWD/${lqual}',idepth='\\$PWD/${idepth}',ldepth='\\$PWD/${ldepth}',imiss='\\$PWD/${imiss}',lmiss='\\$PWD/${lmiss}',het='\\$PWD/${het}',frq='\\$PWD/${frq}'), output_dir='\\$PWD')\"\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "stats_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "report_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [
            "publishDir \"${params.outdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Filter": {
        "name_process": "Filter",
        "string_process": "\nprocess Filter {\n\n  publishDir \"${params.outdir}\", mode: 'copy'\n\n  input:\n  file(vcf) from vcf_ch\n\n  output:\n  file('*') into filvcf_ch\n\n  script:\n  \"\"\"\n  vcftools --gzvcf $vcf --remove-indels --maf ${params.min_maf} --max-missing ${params.missingness} --minQ ${params.min_qual} --min-meanDP ${params.min_depth} --max-meanDP ${params.max_depth} --minDP ${params.min_depth} --maxDP ${params.max_depth} --recode --stdout | bgzip > nfvacal_out_filtered.vcf.gz\n  \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  vcftools --gzvcf $vcf --remove-indels --maf ${params.min_maf} --max-missing ${params.missingness} --minQ ${params.min_qual} --min-meanDP ${params.min_depth} --max-meanDP ${params.max_depth} --minDP ${params.min_depth} --maxDP ${params.max_depth} --recode --stdout | bgzip > nfvacal_out_filtered.vcf.gz\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "VCFtools"
        ],
        "tools_url": [
            "https://bio.tools/vcftools"
        ],
        "tools_dico": [
            {
                "name": "VCFtools",
                "uri": "https://bio.tools/vcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Provide easily accessible methods for working with complex genetic variation data in the form of VCF files.",
                "homepage": "https://vcftools.github.io/index.html"
            }
        ],
        "inputs": [
            "vcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "filvcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "MarieGurke__nfvacal",
        "directive": [
            "publishDir \"${params.outdir}\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}