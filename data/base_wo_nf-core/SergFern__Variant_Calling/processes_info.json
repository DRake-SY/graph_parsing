{
    "fastq_Quality_Check": {
        "name_process": "fastq_Quality_Check",
        "string_process": "\nprocess fastq_Quality_Check {\n  tag \"Quality check on raw fastq files\", mode: 'copy'\n\n                                               \n\n  input:\n    set sampleId, samples from ch_samples_qc\n\n  script:\n  \n  \"\"\"\n  fastqc -t ${params.threads} ${samples[0]} ${samples[1]} -o ${params.working_dir}/${params.outdir}/quality_checks\n  \"\"\"\n\n}",
        "nb_lignes_process": 14,
        "string_script": "  \"\"\"\n  fastqc -t ${params.threads} ${samples[0]} ${samples[1]} -o ${params.working_dir}/${params.outdir}/quality_checks\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "ch_samples_qc"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Quality check on raw fastq files\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "bam_Quality_Check": {
        "name_process": "bam_Quality_Check",
        "string_process": " process bam_Quality_Check{    \n    tag \"Quality check on processed bamqc files\"\n    publishDir \"$params.outdir/quality_checks\", mode: 'copy'\n\n    input:\n      set sampleId, bam_file, bai_file from ch_bamqc\n\n    output:\n\n    file(\"*.tag\") into ch_goMultiQC\n    file \"*stats\"\n\n           \n                       \n\n    def gff = params.custom_gff != 'NO_FILE' ? \"-gff ${params.custom_gff} \":''\n\n    params.tagBam = true\n\n    script:\n\n      \"\"\"\n      bamqc -bam ${bam_file[0]} -nt ${params.threads} ${gff}-outdir ${params.working_dir}/${params.outdir}/quality_checks --java-mem-size=${params.java_mem}\n      echo multiqc_go > multiqc_go.tag\n      \"\"\"\n  }",
        "nb_lignes_process": 24,
        "string_script": "      \"\"\"\n      bamqc -bam ${bam_file[0]} -nt ${params.threads} ${gff}-outdir ${params.working_dir}/${params.outdir}/quality_checks --java-mem-size=${params.java_mem}\n      echo multiqc_go > multiqc_go.tag\n      \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_bamqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_goMultiQC"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Quality check on processed bamqc files\"",
            "publishDir \"$params.outdir/quality_checks\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Generating_integral_QC_report": {
        "name_process": "Generating_integral_QC_report",
        "string_process": "\nprocess Generating_integral_QC_report{\n\n  tag \"Make a general report integrating all QC\"\n  publishDir \"$params.outdir/quality_checks\", mode: 'copy'\n         \n                                     \n\n  input:\n   file('tag') from ch_goMultiQC\n\n  output:\n\n    file \"*report.html\"\n    file \"*data\"\n\n  script:\n    \"\"\"\n    export LC_ALL=C.UTF-8\n    export LANG=C.UTF-8\n    multiqc --force ${params.working_dir}/${params.outdir}/quality_checks\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    export LC_ALL=C.UTF-8\n    export LANG=C.UTF-8\n    multiqc --force ${params.working_dir}/${params.outdir}/quality_checks\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "ch_goMultiQC"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Make a general report integrating all QC\"",
            "publishDir \"$params.outdir/quality_checks\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "reference_switcher": {
        "name_process": "reference_switcher",
        "string_process": "\nprocess reference_switcher {\n    publishDir = \"$params.outdir/FARMA\"\n\n    input:\n        path vcf\n    output:\n        file('*Chr.vcf')\n\n    script:\n        \"\"\"\n        ~/Variant_Calling/scripts/vcf_Reference_Switcher -a $vcf\n        \"\"\"\n\n}",
        "nb_lignes_process": 13,
        "string_script": "        \"\"\"\n        ~/Variant_Calling/scripts/vcf_Reference_Switcher -a $vcf\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA\""
        ],
        "when": "",
        "stub": ""
    },
    "liftover": {
        "name_process": "liftover",
        "string_process": "\nprocess liftover {\n    publishDir = \"$params.outdir/FARMA\"\n    label 'picard'\n\n    input:\n        path vcf\n    output:\n        tuple file('*liftover.vcf'), file('.*processes.log')\n\n    when:\n        params.genome == \"GRCh37\"\n    script:\n        \"\"\"\n        java -Xmx8g -jar /usr/picard/picard.jar LiftoverVcf INPUT=$vcf OUTPUT=${vcf.baseName}.liftover.vcf CHAIN=$params.chain_path R=$params.seqRef_GRCh38 WRITE_ORIGINAL_POSITION=true REJECT=${vcf.baseName}.liftover_rejected.vcf &> .${vcf.baseName}.FARMA_processes.log\n        \"\"\"\n\n}",
        "nb_lignes_process": 16,
        "string_script": "        \"\"\"\n        java -Xmx8g -jar /usr/picard/picard.jar LiftoverVcf INPUT=$vcf OUTPUT=${vcf.baseName}.liftover.vcf CHAIN=$params.chain_path R=$params.seqRef_GRCh38 WRITE_ORIGINAL_POSITION=true REJECT=${vcf.baseName}.liftover_rejected.vcf &> .${vcf.baseName}.FARMA_processes.log\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA\"",
            "label 'picard'"
        ],
        "when": "params.genome == \"GRCh37\"",
        "stub": ""
    },
    "snpSift_filter_def_genes": {
        "name_process": "snpSift_filter_def_genes",
        "string_process": "\nprocess snpSift_filter_def_genes {\n    publishDir = \"$params.outdir/FARMA\"\n    label 'snpEffect'\n\n    input:\n        tuple file(vcf), file(processes)\n    output:\n        tuple file('*.vcf'), file(processes)\n    script:\n        \"\"\"\n        cat $vcf | snpSift filter --set $params.farmaDB/Allele_definition/available_genes.list \"ANN[*].GENE in SET[0]\" > ${vcf.baseName}.genes.vcf 2>> $processes\n        \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "        \"\"\"\n        cat $vcf | snpSift filter --set $params.farmaDB/Allele_definition/available_genes.list \"ANN[*].GENE in SET[0]\" > ${vcf.baseName}.genes.vcf 2>> $processes\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SnpSift"
        ],
        "tools_url": [
            "https://bio.tools/snpsift"
        ],
        "tools_dico": [
            {
                "name": "SnpSift",
                "uri": "https://bio.tools/snpsift",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3365",
                            "term": "Data architecture, analysis and design"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Toolbox that allows you to filter and manipulate annotated vcf files.",
                "homepage": "http://snpeff.sourceforge.net/SnpSift.html"
            }
        ],
        "inputs": [
            "vcf",
            "processes"
        ],
        "nb_inputs": 2,
        "outputs": [
            "processes"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA\"",
            "label 'snpEffect'"
        ],
        "when": "",
        "stub": ""
    },
    "extract_info": {
        "name_process": "extract_info",
        "string_process": "\nprocess extract_info {\n    publishDir = \"$params.outdir/FARMA/\"\n    label 'snpEffect'\n\n    input:\n        tuple file(vcf), file(processes)\n    output:\n        tuple file('*tsv'), file(vcf), file(processes)\n\n    script:\n        \"\"\"\n        snpSift extractFields $vcf -s ',' CHROM POS REF ALT ID ANN[*].GENE AF > ${vcf.baseName}.ID.tsv 2>> $processes\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "        \"\"\"\n        snpSift extractFields $vcf -s ',' CHROM POS REF ALT ID ANN[*].GENE AF > ${vcf.baseName}.ID.tsv 2>> $processes\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SnpSift"
        ],
        "tools_url": [
            "https://bio.tools/snpsift"
        ],
        "tools_dico": [
            {
                "name": "SnpSift",
                "uri": "https://bio.tools/snpsift",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3365",
                            "term": "Data architecture, analysis and design"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Toolbox that allows you to filter and manipulate annotated vcf files.",
                "homepage": "http://snpeff.sourceforge.net/SnpSift.html"
            }
        ],
        "inputs": [
            "vcf",
            "processes"
        ],
        "nb_inputs": 2,
        "outputs": [
            "processes"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA/\"",
            "label 'snpEffect'"
        ],
        "when": "",
        "stub": ""
    },
    "allele_def": {
        "name_process": "allele_def",
        "string_process": "\nprocess allele_def {\n    publishDir = \"$params.outdir/FARMA\"\n    label 'R'\n\n    input:\n        tuple file(tsv), file(vcf), file(processes)\n    output:\n        tuple file('*.log'), file(processes)\n    script:\n    \"\"\"\n    ~/Variant_Calling/scripts/allele_def_id.R $vcf $tsv > ${vcf.baseName}.alleleDef.log 2>> $processes\n    \"\"\"\n\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    ~/Variant_Calling/scripts/allele_def_id.R $vcf $tsv > ${vcf.baseName}.alleleDef.log 2>> $processes\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "tsv",
            "vcf",
            "processes"
        ],
        "nb_inputs": 3,
        "outputs": [
            "processes"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA\"",
            "label 'R'"
        ],
        "when": "",
        "stub": ""
    },
    "match_alleles": {
        "name_process": "match_alleles",
        "string_process": "\nprocess match_alleles {\n    publishDir = \"$params.outdir/FARMA\"\n    label 'R'\n\n    input:\n        tuple file(log_file), file(processes)\n    output:\n        tuple file('*.tsv'), file(log_file), file(processes)\n    script:\n    \"\"\"\n    ~/Variant_Calling/scripts/match_allele.R $log_file 2>> $processes\n    \"\"\"\n\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    ~/Variant_Calling/scripts/match_allele.R $log_file 2>> $processes\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "log_file",
            "processes"
        ],
        "nb_inputs": 2,
        "outputs": [
            "processes"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA\"",
            "label 'R'"
        ],
        "when": "",
        "stub": ""
    },
    "diplotype_analysis": {
        "name_process": "diplotype_analysis",
        "string_process": "\nprocess diplotype_analysis {\n    publishDir = \"$params.outdir/FARMA\"\n    label 'R'\n\n    input:\n        tuple file(tsv), file(log_file), file(processes)\n    output:\n        tuple file(tsv), file(log_file), file(processes)\n    script:\n    \"\"\"\n    ~/Variant_Calling/scripts/diplotype_analysis.R $tsv >> $log_file 2>> $processes\n    \"\"\"\n\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    ~/Variant_Calling/scripts/diplotype_analysis.R $tsv >> $log_file 2>> $processes\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "tsv",
            "log_file",
            "processes"
        ],
        "nb_inputs": 3,
        "outputs": [
            "processes"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/FARMA\"",
            "label 'R'"
        ],
        "when": "",
        "stub": ""
    },
    "Indexing_custom_genome": {
        "name_process": "Indexing_custom_genome",
        "string_process": " process Indexing_custom_genome {\n    tag \"Indexes supplied reference FASTA file (Samtools)\"\n    label 'big_mem'\n    label 'generic'\n\n    publishDir \"$params.indir/custom_reference\"\n\n\n    input:\n    file reference_file from ch_reference\n\n    output:\n    file(\"${reference_file[0]}\")\n    file '*.fai'\n    \n    \"\"\"\n    samtools faidx ${reference_file[0]}\n    \"\"\"\n    \n  }",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n    samtools faidx ${reference_file[0]}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_reference"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Indexes supplied reference FASTA file (Samtools)\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.indir/custom_reference\""
        ],
        "when": "",
        "stub": ""
    },
    "Building_genome_dictionary": {
        "name_process": "Building_genome_dictionary",
        "string_process": " process Building_genome_dictionary {\n    tag \"Creating Dictionary file (GATK)\"\n    label 'big_mem'\n    label 'generic'\n\n    publishDir \"$params.indir/custom_reference\"\n\n    input:\n    file reference_file from ch_reference\n\n    output:\n    file '*.dict'\n\n    script:\n    \n    \"\"\"\n    gatk CreateSequenceDictionary -R ${reference_file[0]}\n    \"\"\"\n    \n  }",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    gatk CreateSequenceDictionary -R ${reference_file[0]}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_reference"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Creating Dictionary file (GATK)\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.indir/custom_reference\""
        ],
        "when": "",
        "stub": ""
    },
    "Custom_genome_indexing": {
        "name_process": "Custom_genome_indexing",
        "string_process": " process Custom_genome_indexing {\n    tag \"Indexes reference file using the specified aligner\"\n    label 'big_mem'\n    label 'generic'\n\n    publishDir \"data/custom_reference\", mode: 'copy'\n\n    input:\n    file reference_file from ch_reference\n\n    output:\n    file \"*\"\n\n    script:\n\n    if(params.aln == 'bwa'){\n\n    \"\"\"\n      bwa index ${reference_file[0]}\n    \"\"\"\n\n    }else if(params.aln == 'bowtie2'){\n\n    \"\"\"\n      bowtie2-build ${reference_file[0]} ${prefixRef}.bowtie2\n    \"\"\"\n    }\n  }",
        "nb_lignes_process": 26,
        "string_script": "    if(params.aln == 'bwa'){\n\n    \"\"\"\n      bwa index ${reference_file[0]}\n    \"\"\"\n\n    }else if(params.aln == 'bowtie2'){\n\n    \"\"\"\n      bowtie2-build ${reference_file[0]} ${prefixRef}.bowtie2\n    \"\"\"\n    }",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "ch_reference"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Indexes reference file using the specified aligner\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"data/custom_reference\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "FASTQ_Trimming": {
        "name_process": "FASTQ_Trimming",
        "string_process": "\nprocess FASTQ_Trimming {\n\n  tag \"Quality checks and trimms reads using a trimmomatic\"\n  label 'big_mem'\n  label 'generic'\n\n  publishDir \"$params.outdir/trimmed_data\"\n\n  input:\n  set sampleId, file(samples) from ch_samples\n\n  output:\n  set sampleId, file('*_trimmed.fastq.gz') into ch_alignment\n\n  script:\n\n  if(params.paired){\n\n      \"\"\"\n      trimmomatic PE -threads ${params.threads} ${samples[0]} ${samples[1]} ${sampleId[0]}_R1_trimmed.fastq.gz bad_1 ${sampleId[0]}_R2_trimmed.fastq.gz bad_2 ${adapter_trimm} SLIDINGWINDOW:15:${params.minqual} MINLEN:${params.minlen}\n      \"\"\"\n  }\n  else{\n\n      \"\"\"\n      trimmomatic SE -threads ${params.threads} ${samples[0]} ${sampleId[0]}_trimmed.fastq.gz ${adapter_trimm} SLIDINGWINDOW:15:${params.minqual} MINLEN:${params.minlen}\n      \"\"\"\n  }\n  }",
        "nb_lignes_process": 28,
        "string_script": "  if(params.paired){\n\n      \"\"\"\n      trimmomatic PE -threads ${params.threads} ${samples[0]} ${samples[1]} ${sampleId[0]}_R1_trimmed.fastq.gz bad_1 ${sampleId[0]}_R2_trimmed.fastq.gz bad_2 ${adapter_trimm} SLIDINGWINDOW:15:${params.minqual} MINLEN:${params.minlen}\n      \"\"\"\n  }\n  else{\n\n      \"\"\"\n      trimmomatic SE -threads ${params.threads} ${samples[0]} ${sampleId[0]}_trimmed.fastq.gz ${adapter_trimm} SLIDINGWINDOW:15:${params.minqual} MINLEN:${params.minlen}\n      \"\"\"\n  }",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "Trimmomatic"
        ],
        "tools_url": [
            "https://bio.tools/trimmomatic"
        ],
        "tools_dico": [
            {
                "name": "Trimmomatic",
                "uri": "https://bio.tools/trimmomatic",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "A flexible read trimming tool for Illumina NGS data",
                "homepage": "http://www.usadellab.org/cms/index.php?page=trimmomatic"
            }
        ],
        "inputs": [
            "ch_samples"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_alignment"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Quality checks and trimms reads using a trimmomatic\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/trimmed_data\""
        ],
        "when": "",
        "stub": ""
    },
    "Alignment": {
        "name_process": "Alignment",
        "string_process": "\nprocess Alignment {\n\n  tag \"Aligns reads to a reference genome using bwa or bowtie2\"\n  label 'big_mem'\n  label 'generic'\n\n  publishDir \"$params.outdir/alignment\"\n\n  input:\n  set sampleId, file(fastq_file) from ch_alignment\n\n  output:\n  set sampleId, file('*.sam') into ch_sam_to_bam\n\n  script:\n\n  if(params.paired){\n\n      if(params.aln == 'bwa'){\n\n      RG = \"@RG\\\\tID:${sampleId[1]}\\\\tSM:${sampleId[0]}\\\\tPL:${params.platform}\"\n\n      \"\"\"\n      bwa mem ${params.mappingOptions}-o ${sampleId[0]}.bwa.sam -R \"${RG}\" -t ${params.threads} ${reference} ${fastq_file[0]} ${fastq_file[1]} \n      \"\"\"\n\n      }else if(params.aln == 'bowtie2'){\n\n      RG = \" --rg-id ${sampleId[1]} --rg SM:${sampleId[0]} --rg PL:${params.platform}\"\n\n      \"\"\"\n      bowtie2 -p ${params.threads} --very-sensitive -x ${bowtie2ref} -1 ${fastq_file[0]} -2 ${fastq_file[1]} -S ${sampleId[0]}.bowtie2.sam ${RG}\n      \"\"\"\n    }else if(params.aln == 'novoalign'){\n\n      \"\"\"\n      novoalign --version\n      \"\"\"\n      }\n    }else{\n\n      if(params.aln == 'bwa'){\n\n      RG = \"@RG\\\\tID:${sampleId[1]}\\\\tSM:${sampleId[0]}\\\\tPL:${params.platform}\"\n\n      \"\"\"\n      bwa mem ${params.mappingOptions} -o ${sampleId[0]}.bwa.sam -R \"${RG}\" -t ${params.threads} ${reference} ${fastq_file[0]}\n      \"\"\"\n\n      }else if(params.aln == 'bowtie2'){\n\n      RG = \" --rg-id ${sampleId[1]} --rg SM:${sampleId[0]} --rg PL:${params.platform}\"\n\n      \"\"\"\n      bowtie2 -p ${params.threads} -x ${bowtie2ref} -1 ${fastq_file[0]} -S ${sampleId[0]}.bowtie2.sam ${RG} ${params.mappingOptions}\n      \"\"\"\n      }else if(params.aln == 'novoalign'){\n\n      \"\"\"\n      novoalign --version\n      \"\"\"\n      }\n\n\n    }\n}",
        "nb_lignes_process": 65,
        "string_script": "  if(params.paired){\n\n      if(params.aln == 'bwa'){\n\n      RG = \"@RG\\\\tID:${sampleId[1]}\\\\tSM:${sampleId[0]}\\\\tPL:${params.platform}\"\n\n      \"\"\"\n      bwa mem ${params.mappingOptions}-o ${sampleId[0]}.bwa.sam -R \"${RG}\" -t ${params.threads} ${reference} ${fastq_file[0]} ${fastq_file[1]} \n      \"\"\"\n\n      }else if(params.aln == 'bowtie2'){\n\n      RG = \" --rg-id ${sampleId[1]} --rg SM:${sampleId[0]} --rg PL:${params.platform}\"\n\n      \"\"\"\n      bowtie2 -p ${params.threads} --very-sensitive -x ${bowtie2ref} -1 ${fastq_file[0]} -2 ${fastq_file[1]} -S ${sampleId[0]}.bowtie2.sam ${RG}\n      \"\"\"\n    }else if(params.aln == 'novoalign'){\n\n      \"\"\"\n      novoalign --version\n      \"\"\"\n      }\n    }else{\n\n      if(params.aln == 'bwa'){\n\n      RG = \"@RG\\\\tID:${sampleId[1]}\\\\tSM:${sampleId[0]}\\\\tPL:${params.platform}\"\n\n      \"\"\"\n      bwa mem ${params.mappingOptions} -o ${sampleId[0]}.bwa.sam -R \"${RG}\" -t ${params.threads} ${reference} ${fastq_file[0]}\n      \"\"\"\n\n      }else if(params.aln == 'bowtie2'){\n\n      RG = \" --rg-id ${sampleId[1]} --rg SM:${sampleId[0]} --rg PL:${params.platform}\"\n\n      \"\"\"\n      bowtie2 -p ${params.threads} -x ${bowtie2ref} -1 ${fastq_file[0]} -S ${sampleId[0]}.bowtie2.sam ${RG} ${params.mappingOptions}\n      \"\"\"\n      }else if(params.aln == 'novoalign'){\n\n      \"\"\"\n      novoalign --version\n      \"\"\"\n      }\n\n\n    }",
        "nb_lignes_script": 48,
        "language_script": "bash",
        "tools": [
            "org",
            "BWA",
            "Rbowtie2",
            "Novoalign"
        ],
        "tools_url": [
            "https://bio.tools/org",
            "https://bio.tools/bwa",
            "https://bio.tools/rbowtie2",
            "https://bio.tools/novoalign"
        ],
        "tools_dico": [
            {
                "name": "org",
                "uri": "https://bio.tools/org",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2229",
                            "term": "Cell biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0602",
                            "term": "Molecular interactions, pathways and networks"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3659",
                                    "term": "Regression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Expression correlation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Co-expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Genome-wide mutation profiling and related risk signature for prognosis of papillary renal cell carcinoma.\n\nBackground:The papillary renal cell carcinoma (pRCC) is a rare subtype of renal cell carcinoma with limited investigation. Our study aimed to explore a robust signature to predict the prognosis of pRCC from the perspective of mutation profiles. Methods:In this study, we downloaded the simple nucleotide variation data of 288 pRCC samples from The Cancer Genome Atlas (TCGA) database. \"GenVisR\" package was utilized to visualize gene mutation profiles in pRCC. The PPI network was conducted based on the STRING database and the modification was performed via Cytoscape software (Version 3.7.1). Top 50 mutant genes were selected and Cox regression method was conducted to identify the hub prognostic mutant signature in pRCC using \"survival\" package.\n\n||| HOMEPAGE BROKEN!.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'pRCC', 'GenVisR' (bio.tools/genvisr)",
                "homepage": "http://org.Hs.eg.db"
            },
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "Novoalign",
                "uri": "https://bio.tools/novoalign",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3674",
                            "term": "Methylated DNA immunoprecipitation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3674",
                            "term": "MeDIP-seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3674",
                            "term": "mDIP"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3674",
                            "term": "MeDIP-chip"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3680",
                                    "term": "RNA-Seq analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0258",
                                    "term": "Sequence alignment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3204",
                                    "term": "Methylation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3204",
                                    "term": "Methylation profile analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Tool designed for mapping short reads from Illumina, IonTorrent or 454 platforms onto a reference genome. This is a commercial product.",
                "homepage": "http://www.novocraft.com/products/novoalign/"
            }
        ],
        "inputs": [
            "ch_alignment"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_sam_to_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Aligns reads to a reference genome using bwa or bowtie2\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/alignment\""
        ],
        "when": "",
        "stub": ""
    },
    "SAM_to_BAM": {
        "name_process": "SAM_to_BAM",
        "string_process": "\nprocess SAM_to_BAM{\n\n  tag \"Converts SAM file to BAM file using samtools view\"\n  label 'big_mem'\n  label 'generic'\n\n  publishDir \"$params.outdir/alignment\"\n\n  input:\n  set sampleId, file(sam_file) from ch_sam_to_bam\n\n  output:\n  set sampleId, file('*') into ch_bam_sorting\n\n  script:\n\n  \"\"\"\n    samtools view --threads ${params.threads} -b -o ${sampleId[0]}.${params.aln}.bam ${sam_file[0]}\n  \"\"\"\n  }",
        "nb_lignes_process": 19,
        "string_script": "  \"\"\"\n    samtools view --threads ${params.threads} -b -o ${sampleId[0]}.${params.aln}.bam ${sam_file[0]}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_sam_to_bam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_bam_sorting"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Converts SAM file to BAM file using samtools view\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/alignment\""
        ],
        "when": "",
        "stub": ""
    },
    "BAM_sorting": {
        "name_process": "BAM_sorting",
        "string_process": "\nprocess BAM_sorting{\n\n  tag \"Sorts BAM file using Samtools\"\n  label 'big_mem'\n  label 'generic'\n                                                                                  \n  publishDir \"$params.outdir/alignment\", mode: 'copy', overwrite: true\n\n  input:\n  set sampleId, file(bam_file) from ch_bam_sorting\n\n  output:\n                                                     \n  set sampleId, file('*') into ch_bam_final\n\n  script:\n\n  \"\"\"\n  samtools sort --threads ${params.threads} -o ${sampleId[0]}.${params.aln}.sort.bam ${bam_file[0]}\n  \"\"\"\n  }",
        "nb_lignes_process": 20,
        "string_script": "  \"\"\"\n  samtools sort --threads ${params.threads} -o ${sampleId[0]}.${params.aln}.sort.bam ${bam_file[0]}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_bam_sorting"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_bam_final"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Sorts BAM file using Samtools\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/alignment\", mode: 'copy', overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "Remove_duplicates": {
        "name_process": "Remove_duplicates",
        "string_process": " process Remove_duplicates{\n    tag \"Remove duplicates if 'remove_duplicates' is true using MarkDuplicates\"\n    label 'big_mem'\n    label 'generic'\n\n    publishDir \"$params.outdir/alignment\"\n\n    input:\n    set sampleId, file(bam_file) from ch_remove_duplicates\n\n    output:\n    set sampleId, file('*.bam') into ch_index_bam\n\n    script:\n\n    \"\"\"\n    gatk MarkDuplicates -I ${bam_file[0]} -M ${sampleId[0]}.metrix.dups -O ${sampleId[0]}.${params.aln}.rmdups.sort.bam\n    \"\"\"\n\n      }",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    gatk MarkDuplicates -I ${bam_file[0]} -M ${sampleId[0]}.metrix.dups -O ${sampleId[0]}.${params.aln}.rmdups.sort.bam\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_remove_duplicates"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_index_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Remove duplicates if 'remove_duplicates' is true using MarkDuplicates\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/alignment\""
        ],
        "when": "",
        "stub": ""
    },
    "BAM_file_indexing": {
        "name_process": "BAM_file_indexing",
        "string_process": "\nprocess BAM_file_indexing{\n\n  tag \"Indexing BAM file\"\n  label 'big_mem'\n  label 'generic'\n\n  errorStrategy 'retry'\n  maxRetries 3\n\n  publishDir \"$params.outdir/alignment\", mode: 'copy', overwrite: true\n\n  input:\n  set sampleId, file(bam_file) from ch_index_bam\n\n  output:\n  set sampleId,  file(\"${bam_file[0]}\"), file('*.bai') into ch_bamFilesForBaseRecalibration\n\n  script:\n\n  \"\"\"\n  samtools index -@ ${params.threads} ${bam_file[0]}\n  \"\"\"\n\n  }",
        "nb_lignes_process": 23,
        "string_script": "  \"\"\"\n  samtools index -@ ${params.threads} ${bam_file[0]}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_index_bam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_bamFilesForBaseRecalibration"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Indexing BAM file\"",
            "label 'big_mem'",
            "label 'generic'",
            "errorStrategy 'retry'",
            "maxRetries 3",
            "publishDir \"$params.outdir/alignment\", mode: 'copy', overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "BaseRecalibrator": {
        "name_process": "BaseRecalibrator",
        "string_process": " process BaseRecalibrator {\n    tag \"Calculate Base recalibration table\"\n    label 'big_mem'\n    label 'generic'\n\n    errorStrategy 'retry'\n    maxRetries 3\n\n    publishDir \"$params.outdir/alignment\"\n    \n\n    input:\n      set sampleId, file(bam_files), file(bai_file) from ch_bamFilesForBaseRecalibration\n                                               \n    output:\n      set sampleId,  file(\"${bam_files[0]}\"), file(\"${bai_file[0]}\"), file(\"*table\") into ch_bamFilesForApplyBQSR\n\n    script:\n\n    \"\"\"\n    gatk BaseRecalibrator ${region_interval} -I ${bam_files[0]} -known-sites ${dbSNP} -output ${sampleId[0]}.BQSR.table -reference ${params.seqRef}\n    \"\"\"\n    }",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    gatk BaseRecalibrator ${region_interval} -I ${bam_files[0]} -known-sites ${dbSNP} -output ${sampleId[0]}.BQSR.table -reference ${params.seqRef}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_bamFilesForBaseRecalibration"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_bamFilesForApplyBQSR"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Calculate Base recalibration table\"",
            "label 'big_mem'",
            "label 'generic'",
            "errorStrategy 'retry'",
            "maxRetries 3",
            "publishDir \"$params.outdir/alignment\""
        ],
        "when": "",
        "stub": ""
    },
    "ApplyBQSR": {
        "name_process": "ApplyBQSR",
        "string_process": " process ApplyBQSR {\n    tag \"Apply previously recalibrated table\"\n    label 'big_mem'\n    label 'generic'\n\n    errorStrategy 'retry'\n    maxRetries 3\n\n    publishDir \"$params.outdir/alignment\", mode: 'copy', overwrite: true\n\n    input:\n      set sampleId,file(bam),file(bai),file(bqsr) from ch_bamFilesForApplyBQSR\n                                                \n\n    output:\n      set sampleId, file('*.bam'), file('*.bai') into ch_variant_calling\n\n    def rmdups = params.remove_duplicates == true ? \".rmdups\":\"\"\n    \n    script:\n      \"\"\"\n      gatk ApplyBQSR --bqsr-recal-file ${bqsr[0]} -I ${bam[0]} ${region_interval} -O ${sampleId[0]}.${params.aln}${rmdups}.sort.bqsr.bam\n\n      \"\"\"\n                                                                                                                                                                      \n    }",
        "nb_lignes_process": 24,
        "string_script": "      \"\"\"\n      gatk ApplyBQSR --bqsr-recal-file ${bqsr[0]} -I ${bam[0]} ${region_interval} -O ${sampleId[0]}.${params.aln}${rmdups}.sort.bqsr.bam\n\n      \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_bamFilesForApplyBQSR"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_variant_calling"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Apply previously recalibrated table\"",
            "label 'big_mem'",
            "label 'generic'",
            "errorStrategy 'retry'",
            "maxRetries 3",
            "publishDir \"$params.outdir/alignment\", mode: 'copy', overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "Variant_Calling_single": {
        "name_process": "Variant_Calling_single",
        "string_process": "\nprocess Variant_Calling_single {\n    tag \"Variant calling using selected Variant Caller (GATK, freebayes, varscan)\"\n    label 'big_mem'\n    label 'generic'\n    publishDir \"$params.outdir/vcf_raw\", mode: 'copy'\n\n    input:\n        tuple val(SampleId), file(bam_file)\n    output:\n        file('*vcf')\n\n    script:\n\n    if(params.vc == 'gatk'){\n        \"\"\"\n        gatk HaplotypeCaller --native-pair-hmm-threads ${params.threads} ${params.rmDups_GATK} ${region_interval} -I ${bam_file[1]} -O ${SampleId}.${params.vc}.vcf -R ${seqRef} ${params.vcOpts}\n        \"\"\"\n    }else if(params.vc == 'freebayes'){\n        \"\"\"\n        freebayes --min-alternate-fraction ${min_alt_fraction_var} -f ${seqRef} ${bam_file[1]} > ${SampleId}.${params.vc}.vcf\n        \"\"\"\n    }else if(params.vc == 'varscan'){\n        \"\"\"\n        samtools mpileup -B -f ${seqRef} ${bam_file[1]} | varscan mpileup2cns --variants --output-vcf 1 > ${SampleId}.${params.vc}.vcf\n        \"\"\"\n    }\n}",
        "nb_lignes_process": 26,
        "string_script": "    if(params.vc == 'gatk'){\n        \"\"\"\n        gatk HaplotypeCaller --native-pair-hmm-threads ${params.threads} ${params.rmDups_GATK} ${region_interval} -I ${bam_file[1]} -O ${SampleId}.${params.vc}.vcf -R ${seqRef} ${params.vcOpts}\n        \"\"\"\n    }else if(params.vc == 'freebayes'){\n        \"\"\"\n        freebayes --min-alternate-fraction ${min_alt_fraction_var} -f ${seqRef} ${bam_file[1]} > ${SampleId}.${params.vc}.vcf\n        \"\"\"\n    }else if(params.vc == 'varscan'){\n        \"\"\"\n        samtools mpileup -B -f ${seqRef} ${bam_file[1]} | varscan mpileup2cns --variants --output-vcf 1 > ${SampleId}.${params.vc}.vcf\n        \"\"\"\n    }",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "GATK",
            "FreeBayes",
            "SAMtools",
            "VarScan"
        ],
        "tools_url": [
            "https://bio.tools/gatk",
            "https://bio.tools/freebayes",
            "https://bio.tools/samtools",
            "https://bio.tools/varscan"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            },
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "VarScan",
                "uri": "https://bio.tools/varscan",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "VarScan, an open source tool for variant detection that is compatible with several short read align-ers.",
                "homepage": "http://dkoboldt.github.io/varscan/"
            }
        ],
        "inputs": [
            "SampleId",
            "bam_file"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Variant calling using selected Variant Caller (GATK, freebayes, varscan)\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/vcf_raw\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "VCF_indexing": {
        "name_process": "VCF_indexing",
        "string_process": " process VCF_indexing {\n    tag \"Indexes vcf files generated by Variant_Calling\"\n    label 'big_mem'\n    label 'generic'\n\n    publishDir \"$params.outdir/raw_variant_calling_files\", mode: 'copy'\n\n    input:\n      set sampleId, file(vcf_file) from ch_vcf\n    output:\n      set sampleId, file(\"${vcf_file[0]}\"), file('*.vcf.idx')\n\n    script:\n    \"\"\"\n    gatk IndexFeatureFile --input ${vcf_file[0]}\n    \"\"\"\n  }",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    gatk IndexFeatureFile --input ${vcf_file[0]}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Indexes vcf files generated by Variant_Calling\"",
            "label 'big_mem'",
            "label 'generic'",
            "publishDir \"$params.outdir/raw_variant_calling_files\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "SelectVariants": {
        "name_process": "SelectVariants",
        "string_process": "\nprocess SelectVariants {\n  tag \"Selects SNV or indels\"\n  publishDir \"$params.outdir/raw_variant_calling_files/intermediate_vcfs\"\n  label \"vfiltering\"\n  label 'generic'\n\n  input:\n    set sampleId, file(vcf_file) from ch_vcf\n  output:\n    set sampleId, file(\"*.snp.vcf\"), file(\"*.snp.vcf.idx\") into ch_SNV\n    set sampleId, file(\"*.indel.vcf\"), file(\"*.indel.vcf.idx\") into ch_indels\n  script:\n  \"\"\"\n  gatk SelectVariants -V ${vcf_file[0]} -select-type SNP -O ${sampleId}.${params.vc}.snp.vcf\n  gatk SelectVariants -V ${vcf_file[0]} -select-type INDEL -O ${sampleId}.${params.vc}.indel.vcf\n  \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "  \"\"\"\n  gatk SelectVariants -V ${vcf_file[0]} -select-type SNP -O ${sampleId}.${params.vc}.snp.vcf\n  gatk SelectVariants -V ${vcf_file[0]} -select-type INDEL -O ${sampleId}.${params.vc}.indel.vcf\n  \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_SNV",
            "ch_indels"
        ],
        "nb_outputs": 2,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Selects SNV or indels\"",
            "publishDir \"$params.outdir/raw_variant_calling_files/intermediate_vcfs\"",
            "label \"vfiltering\"",
            "label 'generic'"
        ],
        "when": "",
        "stub": ""
    },
    "VariantFiltration": {
        "name_process": "VariantFiltration",
        "string_process": "\nprocess VariantFiltration {\n  tag \"Filter both SNP and indel variants\"\n  publishDir \"$params.outdir/raw_variant_calling_files/intermediate_vcfs\"\n  label\t\"vfiltering\"\n  label 'generic'\n\n  input:\n    set sampleId, file(snp_file) from ch_SNV\n    set sampleId, file(indel_file) from ch_indels\n  output:\n    set sampleId, file(\"*.snp.filtered.vcf\") into ch_SNV_filtered\n    set sampleId, file(\"*.indel.filtered.vcf\") into ch_indel_filtered\n  script:\n  \"\"\"\n  gatk VariantFiltration -V ${snp_file[0]} -filter 'QD < 2.0' --filter-name 'QD2' -filter 'QUAL < 30.0' --filter-name 'QUAL30' -filter 'SOR > 3.0' --filter-name 'SOR3' -filter 'FS > 60.0' --filter-name 'FS60' -filter 'MQ < 40.0' --filter-name 'MQ40' -filter 'MQRankSum < -12.5' --filter-name 'MQRankSum-12.5' -filter 'ReadPosRankSum < -8.0' --filter-name 'ReadPosRankSum-8' -O ${sampleId}.${params.vc}.snp.filtered.vcf\n  gatk VariantFiltration -V ${indel_file[0]} -filter 'QD < 2.0' --filter-name 'QD2' -filter 'QUAL < 30.0' --filter-name 'QUAL30' -filter 'FS > 200.0' --filter-name 'FS200' -filter 'ReadPosRankSum < -20.0' --filter-name 'ReadPosRankSum-20' -O ${sampleId}.${params.vc}.indel.filtered.vcf\n\n  \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "  \"\"\"\n  gatk VariantFiltration -V ${snp_file[0]} -filter 'QD < 2.0' --filter-name 'QD2' -filter 'QUAL < 30.0' --filter-name 'QUAL30' -filter 'SOR > 3.0' --filter-name 'SOR3' -filter 'FS > 60.0' --filter-name 'FS60' -filter 'MQ < 40.0' --filter-name 'MQ40' -filter 'MQRankSum < -12.5' --filter-name 'MQRankSum-12.5' -filter 'ReadPosRankSum < -8.0' --filter-name 'ReadPosRankSum-8' -O ${sampleId}.${params.vc}.snp.filtered.vcf\n  gatk VariantFiltration -V ${indel_file[0]} -filter 'QD < 2.0' --filter-name 'QD2' -filter 'QUAL < 30.0' --filter-name 'QUAL30' -filter 'FS > 200.0' --filter-name 'FS200' -filter 'ReadPosRankSum < -20.0' --filter-name 'ReadPosRankSum-20' -O ${sampleId}.${params.vc}.indel.filtered.vcf\n\n  \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_SNV",
            "ch_indels"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_SNV_filtered",
            "ch_indel_filtered"
        ],
        "nb_outputs": 2,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Filter both SNP and indel variants\"",
            "publishDir \"$params.outdir/raw_variant_calling_files/intermediate_vcfs\"",
            "label \"vfiltering\"",
            "label 'generic'"
        ],
        "when": "",
        "stub": ""
    },
    "Sorting_Variants": {
        "name_process": "Sorting_Variants",
        "string_process": "\nprocess Sorting_Variants {\n  tag \"Sort Variants in preparation for the MergeVcfs process\"\n  publishDir \"$params.outdir/raw_variant_calling_files/intermediate_vcfs\"\n  label\t\"vfiltering\"\n  label 'generic'\n\n  input:\n    set sampleId, file(snp_file) from ch_SNV_filtered\n    set sampleId, file(indel_file) from ch_indel_filtered\n  output:\n    set sampleId, file(\"*.snp.filtered.sorted.vcf\") into ch_SNV_sorted\n    set sampleId, file(\"*.indel.filtered.sorted.vcf\") into ch_indel_sorted\n\n  script:\n  \"\"\"\n  gatk SortVcf -I ${snp_file[0]} -R ${params.seqRef} -O ${sampleId}.${params.vc}.snp.filtered.sorted.vcf\n  gatk SortVcf -I ${indel_file[0]} -R ${params.seqRef} -O ${sampleId}.${params.vc}.indel.filtered.sorted.vcf\n  \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "  \"\"\"\n  gatk SortVcf -I ${snp_file[0]} -R ${params.seqRef} -O ${sampleId}.${params.vc}.snp.filtered.sorted.vcf\n  gatk SortVcf -I ${indel_file[0]} -R ${params.seqRef} -O ${sampleId}.${params.vc}.indel.filtered.sorted.vcf\n  \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_SNV_filtered",
            "ch_indel_filtered"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_SNV_sorted",
            "ch_indel_sorted"
        ],
        "nb_outputs": 2,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Sort Variants in preparation for the MergeVcfs process\"",
            "publishDir \"$params.outdir/raw_variant_calling_files/intermediate_vcfs\"",
            "label \"vfiltering\"",
            "label 'generic'"
        ],
        "when": "",
        "stub": ""
    },
    "MergeVcfs": {
        "name_process": "MergeVcfs",
        "string_process": "\nprocess MergeVcfs {\n  tag \"Merges both snp and indel vcfs, filtered and sorted\"\n  publishDir \"$params.outdir/curated_variant_calling_files\", mode: 'copy'\n  label\t\"vfiltering\"\n  label 'generic'\n\n  input:\n    set sampleId, file(snp_file) from ch_SNV_sorted\n    set sampleId, file(indel_file) from ch_indel_sorted\n  output:\n    set sampleId, file(\"*.curated.vcf\") into ch_curated\n\n  script:\n  \"\"\"\n  gatk MergeVcfs -I ${snp_file[0]} -I ${indel_file[0]} -R ${params.seqRef} -O ${sampleId}.${params.vc}.curated.vcf\n\n  \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "  \"\"\"\n  gatk MergeVcfs -I ${snp_file[0]} -I ${indel_file[0]} -R ${params.seqRef} -O ${sampleId}.${params.vc}.curated.vcf\n\n  \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_SNV_sorted",
            "ch_indel_sorted"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_curated"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Merges both snp and indel vcfs, filtered and sorted\"",
            "publishDir \"$params.outdir/curated_variant_calling_files\", mode: 'copy'",
            "label \"vfiltering\"",
            "label 'generic'"
        ],
        "when": "",
        "stub": ""
    },
    "IndexFeatureFile": {
        "name_process": "IndexFeatureFile",
        "string_process": "\nprocess IndexFeatureFile {\n  tag \"Indexes final curated vcf\"\n  publishDir \"$params.outdir/curated_variant_calling_files\", mode: 'copy'\n  label\t\"vfiltering\"\n  label 'generic'\n\n  input:\n    set sampleId, file(vcf_file) from ch_curated\n  output:\n    set sampleId, file(\"*.vcf.idx\")\n\n  script:\n  \"\"\"\n  gatk IndexFeatureFile --input ${vcf_file[0]}\n  \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "  \"\"\"\n  gatk IndexFeatureFile --input ${vcf_file[0]}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_curated"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sampleId"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Indexes final curated vcf\"",
            "publishDir \"$params.outdir/curated_variant_calling_files\", mode: 'copy'",
            "label \"vfiltering\"",
            "label 'generic'"
        ],
        "when": "",
        "stub": ""
    },
    "Variant_Calling_batch": {
        "name_process": "Variant_Calling_batch",
        "string_process": " process Variant_Calling_batch {\n      tag \"Variant calling using selected Variant Caller (GATK, freebayes, varscan)\"\n      label 'big_mem'\n      label 'generic'\n      echo true\n                                                                           \n\n                                                                                                                                                                      \n\n      input:\n        set expId, val(data) from ch_variant_calling                                \n\n      output:\n\n        set expId, file('*.clean.vcf') into ch_vcf_sample\n\n      script:\n\n        String bams = data.flatten().collate(1,2).flatten().join(\" \")\n\n        if(params.vc == 'gatk'){\n\n          println(\"gatk right now is incompatible with GVCFmode\")\n\n        }else if(params.vc == 'freebayes'){\n\n          def GVCF = \"--gvcf\"\n          def min_alt_fraction_var = params.min_alt_fraction == '' ? 0.2:\"${params.min_alt_fraction}\"\n        \"\"\"\n        freebayes ${ploidy} --min-alternate-fraction ${min_alt_fraction_var} ${GVCF} -f ${seqRef} ${bams} > ${expId}.${params.vc}.vcf\n        cat ${expId}.${params.vc}.vcf | grep -v '<\\\\*>' > ${expId}.${params.vc}.clean.vcf\n\n        \"\"\"\n        }else if(params.vc == 'varscan'){\n\n        println(\"varscan right now is incompatible with GVCFmode\")\n\n        }\n      }",
        "nb_lignes_process": 37,
        "string_script": "        String bams = data.flatten().collate(1,2).flatten().join(\" \")\n\n        if(params.vc == 'gatk'){\n\n          println(\"gatk right now is incompatible with GVCFmode\")\n\n        }else if(params.vc == 'freebayes'){\n\n          def GVCF = \"--gvcf\"\n          def min_alt_fraction_var = params.min_alt_fraction == '' ? 0.2:\"${params.min_alt_fraction}\"\n        \"\"\"\n        freebayes ${ploidy} --min-alternate-fraction ${min_alt_fraction_var} ${GVCF} -f ${seqRef} ${bams} > ${expId}.${params.vc}.vcf\n        cat ${expId}.${params.vc}.vcf | grep -v '<\\\\*>' > ${expId}.${params.vc}.clean.vcf\n\n        \"\"\"\n        }else if(params.vc == 'varscan'){\n\n        println(\"varscan right now is incompatible with GVCFmode\")\n\n        }",
        "nb_lignes_script": 19,
        "language_script": "bash",
        "tools": [
            "STRING",
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/string",
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "STRING",
                "uri": "https://bio.tools/string",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0128",
                            "term": "Protein interactions"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0121",
                            "term": "Proteomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0276",
                                    "term": "Protein interaction network analysis"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A database of known and predicted protein-protein interactions. The database contains information from numerous sources, including experimental repositories, computational prediction methods and public text collections. STRING is regularly updated and gives a comprehensive view on protein-protein interactions currently available.",
                "homepage": "http://string-db.org/"
            },
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "ch_variant_calling"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_vcf_sample"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"Variant calling using selected Variant Caller (GATK, freebayes, varscan)\"",
            "label 'big_mem'",
            "label 'generic'",
            "echo true"
        ],
        "when": "",
        "stub": ""
    },
    "Sample_isolation": {
        "name_process": "Sample_isolation",
        "string_process": " process Sample_isolation {\n      tag \"From a gVCF isolate different samples with their particular mutations\"\n      label 'generic'\n      label 'big_mem'\n      publishDir \"$params.outdir/raw_variant_calling_files/samples_isolates\", mode: 'copy'\n    \n      input:\n        set sampleId, file(vcf_file), file(idx_file) from ch_vcf_sample\n      output:\n        file(\"*.vcf\") into ch_vcf\n    \n      script:\n      \"\"\"\n      $baseDir/scripts/extract_all_samples ${vcf_file[0]}\n      \"\"\"\n    }",
        "nb_lignes_process": 14,
        "string_script": "      \"\"\"\n      $baseDir/scripts/extract_all_samples ${vcf_file[0]}\n      \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_vcf_sample"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_vcf"
        ],
        "nb_outputs": 1,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"From a gVCF isolate different samples with their particular mutations\"",
            "label 'generic'",
            "label 'big_mem'",
            "publishDir \"$params.outdir/raw_variant_calling_files/samples_isolates\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "Sample_indexing": {
        "name_process": "Sample_indexing",
        "string_process": " process Sample_indexing {\n  tag \"index vcf files of isolated samples\"\n  label 'generic'\n  label 'big_mem'\n  publishDir \"$params.outdir/raw_variant_calling_files\", mode: 'copy'\n\n  input:\n    set sampleId, file(vcf_file) from ch_vcf\n  output:\n    file(\"${vcf_file}\")\n    file('*.vcf.idx')\n\n  script:\n  \"\"\"\n  gatk IndexFeatureFile --input ${vcf_file}\n  \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "  \"\"\"\n  gatk IndexFeatureFile --input ${vcf_file}\n  \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "ch_vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "tag \"index vcf files of isolated samples\"",
            "label 'generic'",
            "label 'big_mem'",
            "publishDir \"$params.outdir/raw_variant_calling_files\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "VCF_Normalization": {
        "name_process": "VCF_Normalization",
        "string_process": "\nprocess VCF_Normalization {\n    publishDir = \"$params.outdir/vcf_cleanup\"\n    label 'bcftools'\n\n    input:\n        path vcf\n    output:\n        file('*')\n    script:\n        \"\"\"\n        bcftools norm -m-both -o ${vcf.baseName}.norm.vcf $vcf\n        \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "        \"\"\"\n        bcftools norm -m-both -o ${vcf.baseName}.norm.vcf $vcf\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/vcf_cleanup\"",
            "label 'bcftools'"
        ],
        "when": "",
        "stub": ""
    },
    "VCF_Decomposition": {
        "name_process": "VCF_Decomposition",
        "string_process": "\nprocess VCF_Decomposition {\n    publishDir = \"$params.outdir/vcf_cleanup\"\n    label 'bcftools'\n\n    input:\n        path vcf\n    output:\n        file('*.vcf')\n    script:\n        \"\"\"\n        bcftools norm -f $params.seqRef -o ${vcf.baseName}.decomp.vcf $vcf\n        \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "        \"\"\"\n        bcftools norm -f $params.seqRef -o ${vcf.baseName}.decomp.vcf $vcf\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/vcf_cleanup\"",
            "label 'bcftools'"
        ],
        "when": "",
        "stub": ""
    },
    "snpEff": {
        "name_process": "snpEff",
        "string_process": "\nprocess snpEff {\n                                              \n    label 'snpEffect'\n\n    input:\n        path vcf\n    output:\n        file('*.vcf')\n    script:\n        \"\"\"\n        snpEff -v -dataDir $params.snpEffdb $params.genome_annot $vcf > ${vcf.baseName}.snpeff.vcf\n        \"\"\"\n\n}",
        "nb_lignes_process": 13,
        "string_script": "        \"\"\"\n        snpEff -v -dataDir $params.snpEffdb $params.genome_annot $vcf > ${vcf.baseName}.snpeff.vcf\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "snpEff"
        ],
        "tools_url": [
            "https://bio.tools/snpeff"
        ],
        "tools_dico": [
            {
                "name": "snpEff",
                "uri": "https://bio.tools/snpeff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "Single nucleotide polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP discovery"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP calling"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            },
                            {
                                "uri": "http://edamontology.org/data_3002",
                                "term": "Annotation track"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Variant annotation and effect prediction tool. It annotates and predicts the effects of variants on genes and proteins (such as amino acid changes).",
                "homepage": "http://snpeff.sourceforge.net/"
            }
        ],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "label 'snpEffect'"
        ],
        "when": "",
        "stub": ""
    },
    "snpSift_annotate": {
        "name_process": "snpSift_annotate",
        "string_process": "\nprocess snpSift_annotate {\n    publishDir = \"$params.outdir/annotation\"\n    label 'snpEffect'\n\n    input:\n        path vcf\n    output:\n        file('*.vcf')\n    script:\n        \"\"\"\n        snpSift annotate -id $params.dbSNP_annot $vcf > ${vcf.baseName}.snpsift.vcf\n        \"\"\"\n\n}",
        "nb_lignes_process": 13,
        "string_script": "        \"\"\"\n        snpSift annotate -id $params.dbSNP_annot $vcf > ${vcf.baseName}.snpsift.vcf\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SnpSift"
        ],
        "tools_url": [
            "https://bio.tools/snpsift"
        ],
        "tools_dico": [
            {
                "name": "SnpSift",
                "uri": "https://bio.tools/snpsift",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3365",
                            "term": "Data architecture, analysis and design"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Toolbox that allows you to filter and manipulate annotated vcf files.",
                "homepage": "http://snpeff.sourceforge.net/SnpSift.html"
            }
        ],
        "inputs": [
            "vcf"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "SergFern__Variant_Calling",
        "directive": [
            "publishDir = \"$params.outdir/annotation\"",
            "label 'snpEffect'"
        ],
        "when": "",
        "stub": ""
    }
}