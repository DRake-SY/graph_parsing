{
    "align_fq": {
        "name_process": "align_fq",
        "string_process": "\nprocess align_fq {\n    label 'bowtie'\n    label 'high_mem'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n    publishDir path:sample_outdir, mode:'copy', pattern:\"*.fastq\"\n    \n    input:\n    tuple val(sampleID), path(fqR1), path(fqR2) from ch_sample_fastqs\n\n    path(ref_transcripts)\n                                                \n\n    output:\n    tuple sampleID, path(align_1), path(align_2) into ch_aligned_sam\n    path \"${sampleID}*.log\"\n\n    script:\n    align_1 = \"align_1.sam\"\n    align_2 = \"align_2.sam\"\n    \"\"\"\n    zcat ${fqR1} | bowtie \\\n      -p ${task.cpus} \\\n      -q -a --best --strata \\\n      --sam ${align_1} \\\n      -v 3 \\\n      ${ref_transcripts} \\\n      - \\\n      2>${sampleID}.bowtie_R1.log\n    zcat ${fqR2} | bowtie \\\n      -p ${task.cpus} \\\n      -q -a --best --strata \\\n      --sam ${align_2} \\\n      -v 3 \\\n      ${ref_transcripts} \\\n      - \\\n      2>${sampleID}.bowtie_R2.log\n    \"\"\"\n}",
        "nb_lignes_process": 37,
        "string_script": "    align_1 = \"align_1.sam\"\n    align_2 = \"align_2.sam\"\n    \"\"\"\n    zcat ${fqR1} | bowtie \\\n      -p ${task.cpus} \\\n      -q -a --best --strata \\\n      --sam ${align_1} \\\n      -v 3 \\\n      ${ref_transcripts} \\\n      - \\\n      2>${sampleID}.bowtie_R1.log\n    zcat ${fqR2} | bowtie \\\n      -p ${task.cpus} \\\n      -q -a --best --strata \\\n      --sam ${align_2} \\\n      -v 3 \\\n      ${ref_transcripts} \\\n      - \\\n      2>${sampleID}.bowtie_R2.log\n    \"\"\"",
        "nb_lignes_script": 19,
        "language_script": "bash",
        "tools": [
            "Bowtie"
        ],
        "tools_url": [
            "https://bio.tools/bowtie"
        ],
        "tools_dico": [
            {
                "name": "Bowtie",
                "uri": "https://bio.tools/bowtie",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            },
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "Bowtie is an ultrafast, memory-efficient short read aligner.",
                "homepage": "http://bowtie-bio.sourceforge.net/index.shtml"
            }
        ],
        "inputs": [
            "ch_sample_fastqs",
            "ref_transcripts"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aligned_sam"
        ],
        "nb_outputs": 1,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'bowtie'",
            "label 'high_mem'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"",
            "publishDir path:sample_outdir, mode:'copy', pattern:\"*.fastq\""
        ],
        "when": "",
        "stub": ""
    },
    "aligns_to_bams": {
        "name_process": "aligns_to_bams",
        "string_process": "\nprocess aligns_to_bams {\n    label 'samtools'\n\n    input:\n    tuple sampleID, path(sam_1), path(sam_2) from ch_aligned_sam\n\n    output:\n    tuple sampleID, path(bam_1), path(bam_2) into ch_bams\n\n    script:\n    \"\"\"\n    samtools view -bS ${sam_1} > ${bam_1}\n    samtools view -bS ${sam_2} > ${bam_2}\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    samtools view -bS ${sam_1} > ${bam_1}\n    samtools view -bS ${sam_2} > ${bam_2}\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_aligned_sam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_bams"
        ],
        "nb_outputs": 1,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'samtools'"
        ],
        "when": "",
        "stub": ""
    },
    "bams_to_emase_to_merge": {
        "name_process": "bams_to_emase_to_merge",
        "string_process": "\nprocess bams_to_emase_to_merge {\n    label 'gbrs'\n    label 'high_mem'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n    publishDir path:sample_outdir, mode:'copy', pattern:\"*.merged_compressed.h5\"\n                                        \n\n    input:\n    tuple sampleID, path(align1), path(align2) from ch_bams\n    path(ref) from params.gbrsSupport\n                                                                     \n\n    output:\n    path \"*.log\"\n    tuple sampleID, path(merged) into ch_aln_merged\n\n    script:\n    emase1 = ${sampleID}.emase1.h5\n    emase2 = ${sampleID}.emase2.h5\n    ecomp1 = ${sampleID}.compressed.emase1.h5\n    ecomp1 = ${sampleID}.compressed.emase2.h5\n    merged = ${sampleID}.merged_compressed.h5\n    \"\"\"\n    gbrs bam2emase -i ${align1} \\\n                   -m ${ref}/ref.transcripts_info \\\n                   -s A,B,C,D,E,F,G,H \\\n                   -o ${emase1}\n    gbrs compress -i ${emase1} -o ${ecomp1}\n\n    gbrs bam2emase -i $align2 \\\n                   -m ${ref}/ref.transcripts_info \\\n                   -s A,B,C,D,E,F,G,H \\\n                   -o ${emase2}\n    gbrs compress -i ${emase2} -o ${ecomp2}\n\n    gbrs compress -i ${ecomp1},${ecomp2} -o ${merged}\n\n    ls -l > gbrs_merge_dir.fof.log\n    \"\"\"\n}",
        "nb_lignes_process": 39,
        "string_script": "    emase1 = ${sampleID}.emase1.h5\n    emase2 = ${sampleID}.emase2.h5\n    ecomp1 = ${sampleID}.compressed.emase1.h5\n    ecomp1 = ${sampleID}.compressed.emase2.h5\n    merged = ${sampleID}.merged_compressed.h5\n    \"\"\"\n    gbrs bam2emase -i ${align1} \\\n                   -m ${ref}/ref.transcripts_info \\\n                   -s A,B,C,D,E,F,G,H \\\n                   -o ${emase1}\n    gbrs compress -i ${emase1} -o ${ecomp1}\n\n    gbrs bam2emase -i $align2 \\\n                   -m ${ref}/ref.transcripts_info \\\n                   -s A,B,C,D,E,F,G,H \\\n                   -o ${emase2}\n    gbrs compress -i ${emase2} -o ${ecomp2}\n\n    gbrs compress -i ${ecomp1},${ecomp2} -o ${merged}\n\n    ls -l > gbrs_merge_dir.fof.log\n    \"\"\"",
        "nb_lignes_script": 21,
        "language_script": "bash",
        "tools": [
            "GBRS"
        ],
        "tools_url": [
            "https://bio.tools/gbrs"
        ],
        "tools_dico": [
            {
                "name": "GBRS",
                "uri": "https://bio.tools/gbrs",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype reconstruction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype map generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype inference"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Genotype-free individual genome reconstruction of Multiparental Population Models by RNA sequencing data.\n\nGBRS is a suite of tools for reconstructing genomes using RNA-Seq data from multiparent population and quantifying allele specific expression.",
                "homepage": "https://github.com/churchill-lab/gbrs"
            }
        ],
        "inputs": [
            "ch_bams",
            "params"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aln_merged"
        ],
        "nb_outputs": 1,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'gbrs'",
            "label 'high_mem'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"",
            "publishDir path:sample_outdir, mode:'copy', pattern:\"*.merged_compressed.h5\""
        ],
        "when": "",
        "stub": ""
    },
    "quantify": {
        "name_process": "quantify",
        "string_process": "\nprocess quantify {\n    label 'gbrs'\n    label 'high_mem'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.pdf\"\n    publishDir path:sample_outdir, mode:'copy'                \n\n    input:\n    tuple sampleID, path(merged) from ch_aln_merged\n    path(ref) from params.gbrsSupport\n\n    output:\n    path \"*.log\"\n    path \"*.pdf\"\n    file \"${sampleID}.gbrs.interpolated.genoprobs.npz\" into ch_genoprobs\n    tuple sampleID, file(\"${sampleID}.multiway.isoforms.tpm\") into ch_genes_tpm\n\n    script:\n    model      = params.model\n    sex        = params.sex\n    generation = params.generation\n    \"\"\"\n    gbrs quantify \\\n        -i ${merged} \\\n        -g ${ref_Gene2Transcripts} \\\n        -L ${ref_GbrsHybridTargets} \\\n        -M ${model} \\\n        --report-alignment-counts \\\n        -o ${sampleID}\n\n    gbrs reconstruct \\\n        -e ${sampleID}.multiway.genes.tpm \\\n        -t ${ref_tranprob}/tranprob.DO.${generation}.${sex}.npz \\\n        -x ${ref_avecs} \\\n        -g ${ref_GenePosOrdered} \\\n        -o ${sampleID}\n\n    gbrs quantify \\\n        -i ${merged} \\\n        -G ${sampleID}.genotypes.tsv \\\n        -g ${ref_Gene2Transcripts} \\\n        -L ${ref_GbrsHybridTargets} \\\n        -M ${model} \\\n        --report-alignment-counts \\\n        -o ${sampleID}\n\n    gbrs interpolate \\\n        -i ${sampleID}.genoprobs.npz \\\n        -g ${ref_GenomeGrid} \\\n        -p ${ref_GenePosOrdered_ver} \\\n        -o ${sampleID}.gbrs.interpolated.genoprobs.npz\n\n    gbrs plot \\\n        -i ${sampleID}.gbrs.interpolated.genoprobs.npz \\\n        -o ${sampleID}.gbrs.plotted.genome.pdf \\\n        -n ${sampleID}\n\n    ls -l > quantify_dir.fof.log\n    \"\"\"\n\n}",
        "nb_lignes_process": 60,
        "string_script": "    model      = params.model\n    sex        = params.sex\n    generation = params.generation\n    \"\"\"\n    gbrs quantify \\\n        -i ${merged} \\\n        -g ${ref_Gene2Transcripts} \\\n        -L ${ref_GbrsHybridTargets} \\\n        -M ${model} \\\n        --report-alignment-counts \\\n        -o ${sampleID}\n\n    gbrs reconstruct \\\n        -e ${sampleID}.multiway.genes.tpm \\\n        -t ${ref_tranprob}/tranprob.DO.${generation}.${sex}.npz \\\n        -x ${ref_avecs} \\\n        -g ${ref_GenePosOrdered} \\\n        -o ${sampleID}\n\n    gbrs quantify \\\n        -i ${merged} \\\n        -G ${sampleID}.genotypes.tsv \\\n        -g ${ref_Gene2Transcripts} \\\n        -L ${ref_GbrsHybridTargets} \\\n        -M ${model} \\\n        --report-alignment-counts \\\n        -o ${sampleID}\n\n    gbrs interpolate \\\n        -i ${sampleID}.genoprobs.npz \\\n        -g ${ref_GenomeGrid} \\\n        -p ${ref_GenePosOrdered_ver} \\\n        -o ${sampleID}.gbrs.interpolated.genoprobs.npz\n\n    gbrs plot \\\n        -i ${sampleID}.gbrs.interpolated.genoprobs.npz \\\n        -o ${sampleID}.gbrs.plotted.genome.pdf \\\n        -n ${sampleID}\n\n    ls -l > quantify_dir.fof.log\n    \"\"\"",
        "nb_lignes_script": 40,
        "language_script": "bash",
        "tools": [
            "MoDEL",
            "seXY",
            "GBRS"
        ],
        "tools_url": [
            "https://bio.tools/model",
            "https://bio.tools/seXY",
            "https://bio.tools/gbrs"
        ],
        "tools_dico": [
            {
                "name": "MoDEL",
                "uri": "https://bio.tools/model",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0176",
                            "term": "Molecular dynamics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2426",
                                    "term": "Modelling and simulation"
                                }
                            ],
                            []
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0842",
                                "term": "Identifier"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2080",
                                "term": "Database search results"
                            }
                        ]
                    }
                ],
                "description": "Database of protein Molecular Dynamics simulations, with 1800 trajectories representing different structural clusters of the PDB.",
                "homepage": "http://mmb.irbbarcelona.org/MoDEL"
            },
            {
                "name": "seXY",
                "uri": "https://bio.tools/seXY",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3659",
                                    "term": "Regression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Tool for sex inference from genotype arrays.",
                "homepage": "https://github.com/Christopher-Amos-Lab/seXY"
            },
            {
                "name": "GBRS",
                "uri": "https://bio.tools/gbrs",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype reconstruction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype map generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype inference"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Genotype-free individual genome reconstruction of Multiparental Population Models by RNA sequencing data.\n\nGBRS is a suite of tools for reconstructing genomes using RNA-Seq data from multiparent population and quantifying allele specific expression.",
                "homepage": "https://github.com/churchill-lab/gbrs"
            }
        ],
        "inputs": [
            "ch_aln_merged",
            "params"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_genoprobs",
            "ch_genes_tpm"
        ],
        "nb_outputs": 2,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'gbrs'",
            "label 'high_mem'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.pdf\"",
            "publishDir path:sample_outdir, mode:'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "exportgeno": {
        "name_process": "exportgeno",
        "string_process": "\nprocess exportgeno {\n    label 'export'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n    publishDir path:sample_outdir, mode:'copy', pattern:\"*\"\n\n    input:\n    path(ref_GenomeGrid)\n    file(genoprob) from ch_genoprobs\n\n    output:\n    path \"*.log\"\n    file \"*\" into export_out\n\n    script:\n    \"\"\"\n    export-genoprob-file\n        -i ${genoprob} \\\n        -s A,B,C,D,E,F,G,H \\\n        -g ${ref_GenomeGrid}\n    ls -l > export_dir.fof.log\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    export-genoprob-file\n        -i ${genoprob} \\\n        -s A,B,C,D,E,F,G,H \\\n        -g ${ref_GenomeGrid}\n    ls -l > export_dir.fof.log\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ref_GenomeGrid",
            "ch_genoprobs"
        ],
        "nb_inputs": 2,
        "outputs": [
            "export_out"
        ],
        "nb_outputs": 1,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'export'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"",
            "publishDir path:sample_outdir, mode:'copy', pattern:\"*\""
        ],
        "when": "",
        "stub": ""
    },
    "star": {
        "name_process": "star",
        "string_process": "\nprocess star {\n    label 'star'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n                                                             \n\n    input:\n    path(genomeDir) from ref_StarGenomeDir\n    path(starIdx)   from ref_StarIdx\n                                             \n                                                                  \n    tuple sampleID, fqR1, fqR2 from ch_fastq_star\n\n    output:\n    path \"*.log\"\n    tuple sampleID, path(\"${sampleID}.Aligned.sortedByCoord.out.bam\") into ch_star_bam\n\n\n    script:\n    \"\"\"\n    STAR \\\n        --runThreadN ${task.cpus} \\\n        --genomeDir ${genomeDir} \\\n        --sjdbGTFfile ${starIdx} \\\n        --outFileNamePrefix ${sampleID}. \\\n        --readFilesIn ${fqR1} ${fqR2} \\\n        --readFilesCommand zcat \\\n        --outSAMtype BAM SortedByCoordinate \\\n        --twopassMode Basic \\\n        --quantMode GeneCounts \\\n        --outFilterMultimapNmax 5\n    ls -l > star_dir.fof.log\n    \"\"\"\n}",
        "nb_lignes_process": 32,
        "string_script": "    \"\"\"\n    STAR \\\n        --runThreadN ${task.cpus} \\\n        --genomeDir ${genomeDir} \\\n        --sjdbGTFfile ${starIdx} \\\n        --outFileNamePrefix ${sampleID}. \\\n        --readFilesIn ${fqR1} ${fqR2} \\\n        --readFilesCommand zcat \\\n        --outSAMtype BAM SortedByCoordinate \\\n        --twopassMode Basic \\\n        --quantMode GeneCounts \\\n        --outFilterMultimapNmax 5\n    ls -l > star_dir.fof.log\n    \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "STAR"
        ],
        "tools_url": [
            "https://bio.tools/star"
        ],
        "tools_dico": [
            {
                "name": "STAR",
                "uri": "https://bio.tools/star",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Ultrafast universal RNA-seq aligner",
                "homepage": "http://code.google.com/p/rna-star/"
            }
        ],
        "inputs": [
            "ref_StarGenomeDir",
            "ref_StarIdx",
            "ch_fastq_star"
        ],
        "nb_inputs": 3,
        "outputs": [
            "ch_star_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'star'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\""
        ],
        "when": "",
        "stub": ""
    },
    "picard": {
        "name_process": "picard",
        "string_process": "\nprocess picard {\n    label 'picard'\n    label 'high_mem'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n\n    input:\n    tuple sampleID, path(\"${sampleID}.Aligned.sortedByCoord.out.bam\") from ch_star_bam\n    path(ref_StarIdxGenome)\n    path(ref_PicardMetricsFlat)\n\n    output:\n    path \"*.log\"\n    tuple sampleID, path(\"${sampleID}.alignment.read.group.reorder.sorted.bam\") into ch_picard_bam\n    tuple sampleID, path(\"${sampleID}.picard_aln_metrics.txt\") into ch_picard_log\n\n    script:\n    \"\"\"\n    picard AddOrReplaceReadGroups \\\n        INPUT=${sampleID}.Aligned.sortedByCoord.out.bam \\\n        OUTPUT=${sampleID}.alignment.read.group.bam \\\n        SORT_ORDER=coordinate CREATE_INDEX=true \\\n        RGID=ID RGLB=LIB RGPL=ILLUMINA RGSM=SAMPLE RGPU=Lane\n\n    picard ReorderSam \\\n        INPUT=${sampleID}.alignment.read.group.bam \\\n        OUTPUT=${sampleID}.alignment.read.group.reorder.bam \\\n        REFERENCE=${ref_StarIdxGenome} \\\n        CREATE_INDEX=true\n\n    picard SortSam \\\n        SO=coordinate  \\\n        INPUT=${sampleID}.alignment.read.group.reorder.bam \\\n        OUTPUT=${sampleID}.alignment.read.group.reorder.sorted.bam \\\n        VALIDATION_STRINGENCY=SILENT \\\n        CREATE_INDEX=true\n\n    picard CollectRnaSeqMetrics \\\n        I=${sampleID}.alignment.read.group.reorder.sorted.bam \\\n        O=${sampleID}.picard_aln_metrics.txt \\\n        REF_FLAT=${ref_PicardMetricsFlat} \\\n        RIBOSOMAL_INTERVALS=${ref_PicardMetrics}\n        STRAND=${LIBRARY}\n    ls -l > picard_dir.fof.log\n    \"\"\"\n}",
        "nb_lignes_process": 44,
        "string_script": "    \"\"\"\n    picard AddOrReplaceReadGroups \\\n        INPUT=${sampleID}.Aligned.sortedByCoord.out.bam \\\n        OUTPUT=${sampleID}.alignment.read.group.bam \\\n        SORT_ORDER=coordinate CREATE_INDEX=true \\\n        RGID=ID RGLB=LIB RGPL=ILLUMINA RGSM=SAMPLE RGPU=Lane\n\n    picard ReorderSam \\\n        INPUT=${sampleID}.alignment.read.group.bam \\\n        OUTPUT=${sampleID}.alignment.read.group.reorder.bam \\\n        REFERENCE=${ref_StarIdxGenome} \\\n        CREATE_INDEX=true\n\n    picard SortSam \\\n        SO=coordinate  \\\n        INPUT=${sampleID}.alignment.read.group.reorder.bam \\\n        OUTPUT=${sampleID}.alignment.read.group.reorder.sorted.bam \\\n        VALIDATION_STRINGENCY=SILENT \\\n        CREATE_INDEX=true\n\n    picard CollectRnaSeqMetrics \\\n        I=${sampleID}.alignment.read.group.reorder.sorted.bam \\\n        O=${sampleID}.picard_aln_metrics.txt \\\n        REF_FLAT=${ref_PicardMetricsFlat} \\\n        RIBOSOMAL_INTERVALS=${ref_PicardMetrics}\n        STRAND=${LIBRARY}\n    ls -l > picard_dir.fof.log\n    \"\"\"",
        "nb_lignes_script": 27,
        "language_script": "bash",
        "tools": [
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "ch_star_bam",
            "ref_StarIdxGenome",
            "ref_PicardMetricsFlat"
        ],
        "nb_inputs": 3,
        "outputs": [
            "ch_picard_bam",
            "ch_picard_log"
        ],
        "nb_outputs": 2,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'picard'",
            "label 'high_mem'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\""
        ],
        "when": "",
        "stub": ""
    },
    "qc_metrics": {
        "name_process": "qc_metrics",
        "string_process": "\nprocess qc_metrics {\n    label 'perl'\n    publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"\n    publishDir path:sample_outdir, mode:'move', pattern:\"*_stats.txt\"\n    publishDir path:sample_outdir, mode:'move', pattern:\"*_metrics.txt\"\n                                                                       \n\n    input:\n    tuple sampleID, path(picard_aln_metrics) from ch_picard_log\n\n    output:\n    path \"*.log\"\n    path{\"${sampleID}.summary_stats.txt\"}\n\n    script:\n    log_final = \"${sampleID}.Log.final.out\"\n    \"\"\"\n    perl ${projectDir}/bin/summary_QC_metrics_starAligner.pl \\\n        ${log_final} \\\n        ${picard_aln_metrics} \\\n        > ${sampleID}.summary_stats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    log_final = \"${sampleID}.Log.final.out\"\n    \"\"\"\n    perl ${projectDir}/bin/summary_QC_metrics_starAligner.pl \\\n        ${log_final} \\\n        ${picard_aln_metrics} \\\n        > ${sampleID}.summary_stats.txt\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_picard_log"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "cometsong__gbrs_nxf",
        "directive": [
            "label 'perl'",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*.log\"",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*_stats.txt\"",
            "publishDir path:sample_outdir, mode:'move', pattern:\"*_metrics.txt\""
        ],
        "when": "",
        "stub": ""
    }
}