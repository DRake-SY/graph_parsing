{
    "fastqc": {
        "name_process": "fastqc",
        "string_process": "\nprocess fastqc {\n\tlabel \"small\"\n\ttag \"$prefix\"\n\tpublishDir \"${params.outdir}/01-fastQC\", mode: 'copy',\n\t\tsaveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}\n\n\tinput:\n\tset val(name), file(reads) from raw_reads_fastqc\n\n\toutput:\n\tfile '*_fastqc.{zip,html}' into fastqc_results\n\tfile '.command.out' into fastqc_stdout\n\n\tscript:\n\n\tprefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n\t\"\"\"\n\tmkdir tmp\n\tfastqc -t ${task.cpus} -dir tmp $reads\n\trm -rf tmp\n\t\"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\tprefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n\t\"\"\"\n\tmkdir tmp\n\tfastqc -t ${task.cpus} -dir tmp $reads\n\trm -rf tmp\n\t\"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "raw_reads_fastqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_results",
            "fastqc_stdout"
        ],
        "nb_outputs": 2,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "label \"small\"",
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/01-fastQC\", mode: 'copy' , saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}"
        ],
        "when": "",
        "stub": ""
    },
    "trimming": {
        "name_process": "trimming",
        "string_process": "\nprocess trimming {\n\tlabel \"small\"\n\ttag \"$prefix\"\n\tpublishDir \"${params.outdir}/02-preprocessing\", mode: 'copy',\n\t\tsaveAs: {filename ->\n\t\t\tif (filename.indexOf(\"_fastqc\") > 0) \"../03-preprocQC/$filename\"\n\t\t\telse if (filename.indexOf(\".log\") > 0) \"logs/$filename\"\n      else if (params.saveTrimmed && filename.indexOf(\".fastq.gz\")) \"trimmed/$filename\"\n\t\t\telse null\n\t}\n\n\tinput:\n\tset val(name), file(reads) from raw_reads_trimming\n\n\toutput:\n\tfile '*_paired_*.fastq.gz' into trimmed_paired_reads,trimmed_paired_reads_bwa,trimmed_paired_reads_bwa_virus\n\tfile '*_unpaired_*.fastq.gz' into trimmed_unpaired_reads\n\tfile '*_fastqc.{zip,html}' into trimmomatic_fastqc_reports\n\tfile '*.log' into trimmomatic_results\n\n\tscript:\n\tprefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n\t\"\"\"\n\ttrimmomatic PE -threads ${task.cpus} -phred33 $reads $prefix\"_paired_R1.fastq\" $prefix\"_unpaired_R1.fastq\" $prefix\"_paired_R2.fastq\" $prefix\"_unpaired_R2.fastq\" ILLUMINACLIP:${params.trimmomatic_adapters_file}:${params.trimmomatic_adapters_parameters} SLIDINGWINDOW:${params.trimmomatic_window_length}:${params.trimmomatic_window_value} MINLEN:${params.trimmomatic_mininum_length} 2> ${name}.log\n\n\tgzip *.fastq\n\tmkdir tmp\n\tfastqc -t ${task.cpus} -q *_paired_*.fastq.gz\n\trm -rf tmp\n\n\t\"\"\"\n}",
        "nb_lignes_process": 31,
        "string_script": "\tprefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n\t\"\"\"\n\ttrimmomatic PE -threads ${task.cpus} -phred33 $reads $prefix\"_paired_R1.fastq\" $prefix\"_unpaired_R1.fastq\" $prefix\"_paired_R2.fastq\" $prefix\"_unpaired_R2.fastq\" ILLUMINACLIP:${params.trimmomatic_adapters_file}:${params.trimmomatic_adapters_parameters} SLIDINGWINDOW:${params.trimmomatic_window_length}:${params.trimmomatic_window_value} MINLEN:${params.trimmomatic_mininum_length} 2> ${name}.log\n\n\tgzip *.fastq\n\tmkdir tmp\n\tfastqc -t ${task.cpus} -q *_paired_*.fastq.gz\n\trm -rf tmp\n\n\t\"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "Trimmomatic",
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/trimmomatic",
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "Trimmomatic",
                "uri": "https://bio.tools/trimmomatic",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "A flexible read trimming tool for Illumina NGS data",
                "homepage": "http://www.usadellab.org/cms/index.php?page=trimmomatic"
            },
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "raw_reads_trimming"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trimmed_paired_reads",
            "trimmed_paired_reads_bwa",
            "trimmed_paired_reads_bwa_virus",
            "trimmed_unpaired_reads",
            "trimmomatic_fastqc_reports",
            "trimmomatic_results"
        ],
        "nb_outputs": 6,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "label \"small\"",
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/02-preprocessing\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"_fastqc\") > 0) \"../03-preprocQC/$filename\" else if (filename.indexOf(\".log\") > 0) \"logs/$filename\" else if (params.saveTrimmed && filename.indexOf(\".fastq.gz\")) \"trimmed/$filename\" else null }"
        ],
        "when": "",
        "stub": ""
    },
    "mapping_host": {
        "name_process": "mapping_host",
        "string_process": "\nprocess mapping_host {\n\ttag \"$prefix\"\n\tpublishDir \"${params.outdir}/04-mapping_host\", mode: 'copy',\n\t\tsaveAs: {filename ->\n\t\t\tif (filename.indexOf(\".bam\") > 0) \"mapping/$filename\"\n\t\t\telse if (filename.indexOf(\".bai\") > 0) \"mapping/$filename\"\n      else if (filename.indexOf(\".txt\") > 0) \"stats/$filename\"\n      else if (filename.indexOf(\".stats\") > 0) \"stats/$filename\"\n\t}\n\n\tinput:\n\tset file(readsR1),file(readsR2) from trimmed_paired_reads_bwa\n  file refhost from host_fasta_file\n  file index from host_index_files.collect()\n\n\toutput:\n\tfile '*_sorted.bam' into mapping_host_sorted_bam\n  file '*.bam.bai' into mapping_host_bai\n\tfile '*_flagstat.txt' into mapping_host_flagstat\n\tfile '*.stats' into mapping_host_picardstats\n\n\tscript:\n\tprefix = readsR1.toString() - '_paired_R1.fastq.gz'\n\t\"\"\"\n  bowtie2 -p ${task.cpus} --local -x $refhost -1 $readsR1 -2 $readsR2 --very-sensitive-local -S $prefix\".sam\"\n  samtools sort -o $prefix\"_sorted.bam\" -O bam -T $prefix $prefix\".sam\"\n  samtools index $prefix\"_sorted.bam\"\n  samtools flagstat $prefix\"_sorted.bam\" > $prefix\"_flagstat.txt\"\n  picard CollectWgsMetrics COVERAGE_CAP=1000000 I=$prefix\"_sorted.bam\" O=$prefix\".stats\" R=$refhost\n\t\"\"\"\n}",
        "nb_lignes_process": 30,
        "string_script": "\tprefix = readsR1.toString() - '_paired_R1.fastq.gz'\n\t\"\"\"\n  bowtie2 -p ${task.cpus} --local -x $refhost -1 $readsR1 -2 $readsR2 --very-sensitive-local -S $prefix\".sam\"\n  samtools sort -o $prefix\"_sorted.bam\" -O bam -T $prefix $prefix\".sam\"\n  samtools index $prefix\"_sorted.bam\"\n  samtools flagstat $prefix\"_sorted.bam\" > $prefix\"_flagstat.txt\"\n  picard CollectWgsMetrics COVERAGE_CAP=1000000 I=$prefix\"_sorted.bam\" O=$prefix\".stats\" R=$refhost\n\t\"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "Rbowtie2",
            "SAMtools",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "trimmed_paired_reads_bwa",
            "host_fasta_file",
            "host_index_files"
        ],
        "nb_inputs": 3,
        "outputs": [
            "mapping_host_sorted_bam",
            "mapping_host_bai",
            "mapping_host_flagstat",
            "mapping_host_picardstats"
        ],
        "nb_outputs": 4,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/04-mapping_host\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\".bam\") > 0) \"mapping/$filename\" else if (filename.indexOf(\".bai\") > 0) \"mapping/$filename\" else if (filename.indexOf(\".txt\") > 0) \"stats/$filename\" else if (filename.indexOf(\".stats\") > 0) \"stats/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "mapping_virus": {
        "name_process": "mapping_virus",
        "string_process": "\nprocess mapping_virus {\n\ttag \"$prefix\"\n\tpublishDir \"${params.outdir}/05-mapping_virus\", mode: 'copy',\n\t\tsaveAs: {filename ->\n\t\t\tif (filename.indexOf(\".bam\") > 0) \"mapping/$filename\"\n\t\t\telse if (filename.indexOf(\".bai\") > 0) \"mapping/$filename\"\n      else if (filename.indexOf(\".txt\") > 0) \"stats/$filename\"\n      else if (filename.indexOf(\".stats\") > 0) \"stats/$filename\"\n\t}\n\n\tinput:\n\tset file(readsR1),file(readsR2) from trimmed_paired_reads_bwa_virus\n  file refvirus from viral_fasta_file\n  file index from viral_index_files.collect()\n\n\toutput:\n\tfile '*_sorted.bam' into mapping_virus_sorted_bam,mapping_virus_sorted_bam_variant_calling,mapping_virus_sorted_bam_consensus\n  file '*.bam.bai' into mapping_virus_bai,mapping_virus_bai_variant_calling,mapping_virus_bai_consensus\n\tfile '*_flagstat.txt' into mapping_virus_flagstat\n\tfile '*.stats' into mapping_virus_picardstats\n\n\tscript:\n  prefix = readsR1.toString() - '_paired_R1.fastq.gz'\n\t\"\"\"\n  bowtie2 -p ${task.cpus} --local -x $refvirus -1 $readsR1 -2 $readsR2 --very-sensitive-local -S $prefix\".sam\"\n  samtools sort -o $prefix\"_sorted.bam\" -O bam -T $prefix $prefix\".sam\"\n  samtools index $prefix\"_sorted.bam\"\n  samtools flagstat $prefix\"_sorted.bam\" > $prefix\"_flagstat.txt\"\n  picard CollectWgsMetrics COVERAGE_CAP=1000000 I=$prefix\"_sorted.bam\" O=$prefix\".stats\" R=$refvirus\n\t\"\"\"\n}",
        "nb_lignes_process": 30,
        "string_script": "  prefix = readsR1.toString() - '_paired_R1.fastq.gz'\n\t\"\"\"\n  bowtie2 -p ${task.cpus} --local -x $refvirus -1 $readsR1 -2 $readsR2 --very-sensitive-local -S $prefix\".sam\"\n  samtools sort -o $prefix\"_sorted.bam\" -O bam -T $prefix $prefix\".sam\"\n  samtools index $prefix\"_sorted.bam\"\n  samtools flagstat $prefix\"_sorted.bam\" > $prefix\"_flagstat.txt\"\n  picard CollectWgsMetrics COVERAGE_CAP=1000000 I=$prefix\"_sorted.bam\" O=$prefix\".stats\" R=$refvirus\n\t\"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "Rbowtie2",
            "SAMtools",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "trimmed_paired_reads_bwa_virus",
            "viral_fasta_file",
            "viral_index_files"
        ],
        "nb_inputs": 3,
        "outputs": [
            "mapping_virus_sorted_bam",
            "mapping_virus_sorted_bam_variant_calling",
            "mapping_virus_sorted_bam_consensus",
            "mapping_virus_bai",
            "mapping_virus_bai_variant_calling",
            "mapping_virus_bai_consensus",
            "mapping_virus_flagstat",
            "mapping_virus_picardstats"
        ],
        "nb_outputs": 8,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/05-mapping_virus\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\".bam\") > 0) \"mapping/$filename\" else if (filename.indexOf(\".bai\") > 0) \"mapping/$filename\" else if (filename.indexOf(\".txt\") > 0) \"stats/$filename\" else if (filename.indexOf(\".stats\") > 0) \"stats/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "ivar_trimming": {
        "name_process": "ivar_trimming",
        "string_process": " process ivar_trimming {\n\t tag \"$prefix\"\n\t  publishDir path: { \"${params.outdir}/05-mapping_virus/ivar\" }, mode: 'copy'\n\n\t  input:\n\t  file sorted_bam from mapping_virus_sorted_bam_variant_calling\n    file amplicons_bed from amplicons_bed_file\n    file refvirus from viral_fasta_file\n    file index from viral_index_files_ivar.collect()\n\n\t  output:\n\t  file '*_primertrimmed_sorted.bam' into ivar_sorted_bam,sorted_bam_variant_calling,sorted_bam_consensus\n    file '*_primertrimmed_sorted.bam.bai' into ivar_bai,bam_bai_variant_calling,bai_consensus\n    file '*_flagstat.txt' into ivar_flagstat\n  \tfile '*.stats' into ivar_picardstats\n\n\t  script:\n    prefix = sorted_bam.baseName - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_sorted)?(_paired)?(_00*)?(\\.bam)?(\\.fastq)?(\\.gz)?$/\n\t  \"\"\"\n    samtools view -b -F 4 $sorted_bam > $prefix\"_onlymapped.bam\"\n    samtools index $prefix\"_onlymapped.bam\"\n    ivar trim -e -i $prefix\"_onlymapped.bam\" -b $amplicons_bed -p $prefix\"_primertrimmed\" -q 15 -m 50 -s 4\n    samtools sort -o $prefix\"_primertrimmed_sorted.bam\" -O bam -T $prefix $prefix\"_primertrimmed.bam\"\n    samtools index $prefix\"_primertrimmed_sorted.bam\"\n    samtools flagstat $prefix\"_primertrimmed_sorted.bam\" > $prefix\"_primertrimmed_flagstat.txt\"\n    picard CollectWgsMetrics COVERAGE_CAP=1000000 I=$prefix\"_primertrimmed_sorted.bam\" O=$prefix\"_primertrimmed.stats\" R=$refvirus\n\t  \"\"\"\n  }",
        "nb_lignes_process": 26,
        "string_script": "    prefix = sorted_bam.baseName - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_sorted)?(_paired)?(_00*)?(\\.bam)?(\\.fastq)?(\\.gz)?$/\n\t  \"\"\"\n    samtools view -b -F 4 $sorted_bam > $prefix\"_onlymapped.bam\"\n    samtools index $prefix\"_onlymapped.bam\"\n    ivar trim -e -i $prefix\"_onlymapped.bam\" -b $amplicons_bed -p $prefix\"_primertrimmed\" -q 15 -m 50 -s 4\n    samtools sort -o $prefix\"_primertrimmed_sorted.bam\" -O bam -T $prefix $prefix\"_primertrimmed.bam\"\n    samtools index $prefix\"_primertrimmed_sorted.bam\"\n    samtools flagstat $prefix\"_primertrimmed_sorted.bam\" > $prefix\"_primertrimmed_flagstat.txt\"\n    picard CollectWgsMetrics COVERAGE_CAP=1000000 I=$prefix\"_primertrimmed_sorted.bam\" O=$prefix\"_primertrimmed.stats\" R=$refvirus\n\t  \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "AIVAR",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/AIVAR",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "AIVAR",
                "uri": "https://bio.tools/AIVAR",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3474",
                            "term": "Machine learning"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Targeted exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "WES"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Whole exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome capture"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3461",
                                    "term": "Virulence prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Deposition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3225",
                                    "term": "Variant classification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3461",
                                    "term": "Pathogenicity prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Submission"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Data submission"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Database deposition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Database submission"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Data deposition"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Assessing concordance among human, in silico predictions and functional assays on genetic variant classification.",
                "homepage": "https://github.com/TopGene/AIvar"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "mapping_virus_sorted_bam_variant_calling",
            "amplicons_bed_file",
            "viral_fasta_file",
            "viral_index_files_ivar"
        ],
        "nb_inputs": 4,
        "outputs": [
            "ivar_sorted_bam",
            "sorted_bam_variant_calling",
            "sorted_bam_consensus",
            "ivar_bai",
            "bam_bai_variant_calling",
            "bai_consensus",
            "ivar_flagstat",
            "ivar_picardstats"
        ],
        "nb_outputs": 8,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir path: { \"${params.outdir}/05-mapping_virus/ivar\" }, mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "variant_calling": {
        "name_process": "variant_calling",
        "string_process": "\nprocess variant_calling {\n\ttag \"$prefix\"\n\tpublishDir \"${params.outdir}/06-variant_calling\", mode: 'copy',\n\t\tsaveAs: {filename ->\n\t\t\tif (filename.indexOf(\".pileup\") > 0) \"pileup/$filename\"\n\t\t\telse if (filename.indexOf(\"_majority.vcf\") > 0) \"majority_allele/$filename\"\n      else if (filename.indexOf(\".vcf\") > 0) \"lowfreq_vars/$filename\"\n\t\t\telse params.saveTrimmed ? filename : null\n\t}\n\n\tinput:\n\tfile sorted_bam from sorted_bam_variant_calling\n  file bam_index from bam_bai_variant_calling\n  file refvirus from viral_fasta_file\n  file index from viral_index_files_variant_calling.collect()\n\n\toutput:\n\tfile '*.pileup' into variant_calling_pileup\n  file '*_majority.vcf' into majority_allele_vcf,majority_allele_vcf_annotation,majority_allele_vcf_consensus\n\tfile '*_lowfreq.vcf' into lowfreq_variants_vcf,lowfreq_variants_vcf_annotation\n\n\tscript:\n\tprefix = sorted_bam.baseName - ~/(_primertrimmed)?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_sorted)?(_paired)?(_00*)?(\\.bam)?(\\.fastq)?(\\.gz)?$/\n\t\"\"\"\n  samtools mpileup -A -d 20000 -Q 0 -f $refvirus $sorted_bam > $prefix\".pileup\"\n  varscan mpileup2cns $prefix\".pileup\" --min-var-freq 0.02 --p-value 0.99 --variants --output-vcf 1 > $prefix\"_lowfreq.vcf\"\n  varscan mpileup2cns $prefix\".pileup\" --min-var-freq 0.8 --p-value 0.05 --variants --output-vcf 1 > $prefix\"_majority.vcf\"\n\t\"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "\tprefix = sorted_bam.baseName - ~/(_primertrimmed)?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_sorted)?(_paired)?(_00*)?(\\.bam)?(\\.fastq)?(\\.gz)?$/\n\t\"\"\"\n  samtools mpileup -A -d 20000 -Q 0 -f $refvirus $sorted_bam > $prefix\".pileup\"\n  varscan mpileup2cns $prefix\".pileup\" --min-var-freq 0.02 --p-value 0.99 --variants --output-vcf 1 > $prefix\"_lowfreq.vcf\"\n  varscan mpileup2cns $prefix\".pileup\" --min-var-freq 0.8 --p-value 0.05 --variants --output-vcf 1 > $prefix\"_majority.vcf\"\n\t\"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "VarScan"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/varscan"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "VarScan",
                "uri": "https://bio.tools/varscan",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "VarScan, an open source tool for variant detection that is compatible with several short read align-ers.",
                "homepage": "http://dkoboldt.github.io/varscan/"
            }
        ],
        "inputs": [
            "sorted_bam_variant_calling",
            "bam_bai_variant_calling",
            "viral_fasta_file",
            "viral_index_files_variant_calling"
        ],
        "nb_inputs": 4,
        "outputs": [
            "variant_calling_pileup",
            "majority_allele_vcf",
            "majority_allele_vcf_annotation",
            "majority_allele_vcf_consensus",
            "lowfreq_variants_vcf",
            "lowfreq_variants_vcf_annotation"
        ],
        "nb_outputs": 6,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/06-variant_calling\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\".pileup\") > 0) \"pileup/$filename\" else if (filename.indexOf(\"_majority.vcf\") > 0) \"majority_allele/$filename\" else if (filename.indexOf(\".vcf\") > 0) \"lowfreq_vars/$filename\" else params.saveTrimmed ? filename : null }"
        ],
        "when": "",
        "stub": ""
    },
    "variant_calling_annotation": {
        "name_process": "variant_calling_annotation",
        "string_process": "\nprocess variant_calling_annotation {\n \ttag \"$prefix\"\n  publishDir \"${params.outdir}/07-annotation\", mode: 'copy',\n\t\tsaveAs: {filename ->\n\t\t\tif (filename.indexOf(\"majority.ann.vcf\") > 0) \"majority/$filename\"\n\t\t\telse if (filename.indexOf(\"majority_snpEff_genes.txt\") > 0) \"majority/$filename\"\n      else if (filename.indexOf(\"majority_snpEff_summary.html\") > 0) \"majority/$filename\"\n      else if (filename.indexOf(\"majority.ann.table.txt\") > 0) \"majority/$filename\"\n      else if (filename.indexOf(\"lowfreq.ann.vcf\") > 0) \"lowfreq/$filename\"\n      else if (filename.indexOf(\"lowfreq_snpEff_genes.txt\") > 0) \"lowfreq/$filename\"\n      else if (filename.indexOf(\"lowfreq_snpEff_summary.html\") > 0) \"lowfreq/$filename\"\n      else if (filename.indexOf(\"lowfreq.ann.table.txt\") > 0) \"lowfreq/$filename\"\n\t}\n\n \tinput:\n \tfile majority_variants from majority_allele_vcf_annotation\n  file low_variants from lowfreq_variants_vcf_annotation\n\n \toutput:\n \tfile '*_majority.ann.vcf' into majority_annotated_variants\n  file '*_majority_snpEff_genes.txt' into majority_snpeff_genes\n \tfile '*_majority_snpEff_summary.html' into majority_snpeff_summary\n  file '*_lowfreq.ann.vcf' into lowfreq_annotated_variants\n  file '*_lowfreq_snpEff_genes.txt' into lowfreq_snpeff_genes\n \tfile '*_lowfreq_snpEff_summary.html' into lowfreq_snpeff_summary\n  file '*_majority.ann.table.txt' into snpsift_majority_table\n  file '*_lowfreq.ann.table.txt' into snpsift_lowfreq_table\n\n \tscript:\n \tprefix = majority_variants.baseName - ~/(_S[0-9]{2})?(_majority)?(.R1)?(_1)?(_R1)?(_sorted)?(_paired)?(_00*)?(\\.bam)?(\\.vcf)?(\\.gz)?$/\n \t\"\"\"\n  snpEff sars-cov-2 $majority_variants > $prefix\"_majority.ann.vcf\"\n  mv snpEff_genes.txt $prefix\"_majority_snpEff_genes.txt\"\n  mv snpEff_summary.html $prefix\"_majority_snpEff_summary.html\"\n  snpEff sars-cov-2 $low_variants > $prefix\"_lowfreq.ann.vcf\"\n  mv snpEff_genes.txt $prefix\"_lowfreq_snpEff_genes.txt\"\n  mv snpEff_summary.html $prefix\"_lowfreq_snpEff_summary.html\"\n  SnpSift extractFields -s \",\" -e \".\" $prefix\"_majority.ann.vcf\" CHROM POS REF ALT \"ANN[*].GENE\" \"ANN[*].GENEID\" \"ANN[*].IMPACT\" \"ANN[*].EFFECT\" \"ANN[*].FEATURE\" \"ANN[*].FEATUREID\" \"ANN[*].BIOTYPE\" \"ANN[*].RANK\" \"ANN[*].HGVS_C\" \"ANN[*].HGVS_P\" \"ANN[*].CDNA_POS\" \"ANN[*].CDNA_LEN\" \"ANN[*].CDS_POS\" \"ANN[*].CDS_LEN\" \"ANN[*].AA_POS\" \"ANN[*].AA_LEN\" \"ANN[*].DISTANCE\" \"EFF[*].EFFECT\" \"EFF[*].FUNCLASS\" \"EFF[*].CODON\" \"EFF[*].AA\" \"EFF[*].AA_LEN\" > $prefix\"_majority.ann.table.txt\"\n  SnpSift extractFields -s \",\" -e \".\" $prefix\"_lowfreq.ann.vcf\" CHROM POS REF ALT \"ANN[*].GENE\" \"ANN[*].GENEID\" \"ANN[*].IMPACT\" \"ANN[*].EFFECT\" \"ANN[*].FEATURE\" \"ANN[*].FEATUREID\" \"ANN[*].BIOTYPE\" \"ANN[*].RANK\" \"ANN[*].HGVS_C\" \"ANN[*].HGVS_P\" \"ANN[*].CDNA_POS\" \"ANN[*].CDNA_LEN\" \"ANN[*].CDS_POS\" \"ANN[*].CDS_LEN\" \"ANN[*].AA_POS\" \"ANN[*].AA_LEN\" \"ANN[*].DISTANCE\" \"EFF[*].EFFECT\" \"EFF[*].FUNCLASS\" \"EFF[*].CODON\" \"EFF[*].AA\" \"EFF[*].AA_LEN\" > $prefix\"_lowfreq.ann.table.txt\"\n \t\"\"\"\n}",
        "nb_lignes_process": 40,
        "string_script": " \tprefix = majority_variants.baseName - ~/(_S[0-9]{2})?(_majority)?(.R1)?(_1)?(_R1)?(_sorted)?(_paired)?(_00*)?(\\.bam)?(\\.vcf)?(\\.gz)?$/\n \t\"\"\"\n  snpEff sars-cov-2 $majority_variants > $prefix\"_majority.ann.vcf\"\n  mv snpEff_genes.txt $prefix\"_majority_snpEff_genes.txt\"\n  mv snpEff_summary.html $prefix\"_majority_snpEff_summary.html\"\n  snpEff sars-cov-2 $low_variants > $prefix\"_lowfreq.ann.vcf\"\n  mv snpEff_genes.txt $prefix\"_lowfreq_snpEff_genes.txt\"\n  mv snpEff_summary.html $prefix\"_lowfreq_snpEff_summary.html\"\n  SnpSift extractFields -s \",\" -e \".\" $prefix\"_majority.ann.vcf\" CHROM POS REF ALT \"ANN[*].GENE\" \"ANN[*].GENEID\" \"ANN[*].IMPACT\" \"ANN[*].EFFECT\" \"ANN[*].FEATURE\" \"ANN[*].FEATUREID\" \"ANN[*].BIOTYPE\" \"ANN[*].RANK\" \"ANN[*].HGVS_C\" \"ANN[*].HGVS_P\" \"ANN[*].CDNA_POS\" \"ANN[*].CDNA_LEN\" \"ANN[*].CDS_POS\" \"ANN[*].CDS_LEN\" \"ANN[*].AA_POS\" \"ANN[*].AA_LEN\" \"ANN[*].DISTANCE\" \"EFF[*].EFFECT\" \"EFF[*].FUNCLASS\" \"EFF[*].CODON\" \"EFF[*].AA\" \"EFF[*].AA_LEN\" > $prefix\"_majority.ann.table.txt\"\n  SnpSift extractFields -s \",\" -e \".\" $prefix\"_lowfreq.ann.vcf\" CHROM POS REF ALT \"ANN[*].GENE\" \"ANN[*].GENEID\" \"ANN[*].IMPACT\" \"ANN[*].EFFECT\" \"ANN[*].FEATURE\" \"ANN[*].FEATUREID\" \"ANN[*].BIOTYPE\" \"ANN[*].RANK\" \"ANN[*].HGVS_C\" \"ANN[*].HGVS_P\" \"ANN[*].CDNA_POS\" \"ANN[*].CDNA_LEN\" \"ANN[*].CDS_POS\" \"ANN[*].CDS_LEN\" \"ANN[*].AA_POS\" \"ANN[*].AA_LEN\" \"ANN[*].DISTANCE\" \"EFF[*].EFFECT\" \"EFF[*].FUNCLASS\" \"EFF[*].CODON\" \"EFF[*].AA\" \"EFF[*].AA_LEN\" > $prefix\"_lowfreq.ann.table.txt\"\n \t\"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "snpEff",
            "SnpSift"
        ],
        "tools_url": [
            "https://bio.tools/snpeff",
            "https://bio.tools/snpsift"
        ],
        "tools_dico": [
            {
                "name": "snpEff",
                "uri": "https://bio.tools/snpeff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "Single nucleotide polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP discovery"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP calling"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            },
                            {
                                "uri": "http://edamontology.org/data_3002",
                                "term": "Annotation track"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Variant annotation and effect prediction tool. It annotates and predicts the effects of variants on genes and proteins (such as amino acid changes).",
                "homepage": "http://snpeff.sourceforge.net/"
            },
            {
                "name": "SnpSift",
                "uri": "https://bio.tools/snpsift",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3365",
                            "term": "Data architecture, analysis and design"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Toolbox that allows you to filter and manipulate annotated vcf files.",
                "homepage": "http://snpeff.sourceforge.net/SnpSift.html"
            }
        ],
        "inputs": [
            "majority_allele_vcf_annotation",
            "lowfreq_variants_vcf_annotation"
        ],
        "nb_inputs": 2,
        "outputs": [
            "majority_annotated_variants",
            "majority_snpeff_genes",
            "majority_snpeff_summary",
            "lowfreq_annotated_variants",
            "lowfreq_snpeff_genes",
            "lowfreq_snpeff_summary",
            "snpsift_majority_table",
            "snpsift_lowfreq_table"
        ],
        "nb_outputs": 8,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/07-annotation\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"majority.ann.vcf\") > 0) \"majority/$filename\" else if (filename.indexOf(\"majority_snpEff_genes.txt\") > 0) \"majority/$filename\" else if (filename.indexOf(\"majority_snpEff_summary.html\") > 0) \"majority/$filename\" else if (filename.indexOf(\"majority.ann.table.txt\") > 0) \"majority/$filename\" else if (filename.indexOf(\"lowfreq.ann.vcf\") > 0) \"lowfreq/$filename\" else if (filename.indexOf(\"lowfreq_snpEff_genes.txt\") > 0) \"lowfreq/$filename\" else if (filename.indexOf(\"lowfreq_snpEff_summary.html\") > 0) \"lowfreq/$filename\" else if (filename.indexOf(\"lowfreq.ann.table.txt\") > 0) \"lowfreq/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "genome_consensus": {
        "name_process": "genome_consensus",
        "string_process": "\nprocess genome_consensus {\n  tag \"$prefix\"\n  publishDir \"${params.outdir}/08-mapping_consensus\", mode: 'copy',\n\t\tsaveAs: {filename ->\n\t\t\tif (filename.indexOf(\"_consensus.fasta\") > 0) \"consensus/$filename\"\n\t\t\telse if (filename.indexOf(\"_consensus_masked.fasta\") > 0) \"masked/$filename\"\n\t}\n\n  input:\n  file variants from majority_allele_vcf_consensus\n  file refvirus from viral_fasta_file\n  file sorted_bam from sorted_bam_consensus\n  file sorted_bai from bai_consensus\n\n  output:\n  file '*_consensus.fasta' into consensus_fasta\n  file '*_consensus_masked.fasta' into masked_fasta\n\n  script:\n  prefix = variants.baseName - ~/(_majority)?(_paired)?(\\.vcf)?(\\.gz)?$/\n  refname = refvirus.baseName - ~/(\\.2)?(\\.fasta)?$/\n  \"\"\"\n  bgzip -c $variants > $prefix\"_\"$refname\".vcf.gz\"\n  bcftools index $prefix\"_\"$refname\".vcf.gz\"\n  cat $refvirus | bcftools consensus $prefix\"_\"$refname\".vcf.gz\" > $prefix\"_\"$refname\"_consensus.fasta\"\n  bedtools genomecov -bga -ibam $sorted_bam -g $refvirus | awk '\\$4 < 20' | bedtools merge > $prefix\"_\"$refname\"_bed4mask.bed\"\n  bedtools maskfasta -fi $prefix\"_\"$refname\"_consensus.fasta\" -bed $prefix\"_\"$refname\"_bed4mask.bed\" -fo $prefix\"_\"$refname\"_consensus_masked.fasta\"\n  sed -i 's/$refname/$prefix/g' $prefix\"_\"$refname\"_consensus_masked.fasta\"\n  \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "  prefix = variants.baseName - ~/(_majority)?(_paired)?(\\.vcf)?(\\.gz)?$/\n  refname = refvirus.baseName - ~/(\\.2)?(\\.fasta)?$/\n  \"\"\"\n  bgzip -c $variants > $prefix\"_\"$refname\".vcf.gz\"\n  bcftools index $prefix\"_\"$refname\".vcf.gz\"\n  cat $refvirus | bcftools consensus $prefix\"_\"$refname\".vcf.gz\" > $prefix\"_\"$refname\"_consensus.fasta\"\n  bedtools genomecov -bga -ibam $sorted_bam -g $refvirus | awk '\\$4 < 20' | bedtools merge > $prefix\"_\"$refname\"_bed4mask.bed\"\n  bedtools maskfasta -fi $prefix\"_\"$refname\"_consensus.fasta\" -bed $prefix\"_\"$refname\"_bed4mask.bed\" -fo $prefix\"_\"$refname\"_consensus_masked.fasta\"\n  sed -i 's/$refname/$prefix/g' $prefix\"_\"$refname\"_consensus_masked.fasta\"\n  \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "majority_allele_vcf_consensus",
            "viral_fasta_file",
            "sorted_bam_consensus",
            "bai_consensus"
        ],
        "nb_inputs": 4,
        "outputs": [
            "consensus_fasta",
            "masked_fasta"
        ],
        "nb_outputs": 2,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/08-mapping_consensus\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"_consensus.fasta\") > 0) \"consensus/$filename\" else if (filename.indexOf(\"_consensus_masked.fasta\") > 0) \"masked/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc": {
        "name_process": "multiqc",
        "string_process": "\nprocess multiqc {\n\ttag \"$prefix\"\n    publishDir path: { \"${params.outdir}/99-stats/MultiQC\" }, mode: 'copy'\n\n    input:\n    file multiqc_config from multiqc_config\n    file (fastqc:'fastqc/*') from fastqc_results.collect().ifEmpty([])\n    file ('trimommatic/*') from trimmomatic_results.collect()\n    file ('trimommatic/*') from trimmomatic_fastqc_reports.collect()\n    file ('mappinh_host/*') from mapping_host_flagstat.collect()\n    file ('mappinh_host/*') from mapping_host_picardstats.collect()\n    file ('mapping_virus/*') from mapping_virus_flagstat.collect()\n    file ('mapping_virus/*') from mapping_virus_picardstats.collect()\n    file ('ivar/*') from ivar_flagstat.collect()\n    file ('ivar/*') from ivar_picardstats.collect()\n    file ('snpeff/majority*') from majority_snpeff_summary.collect()\n    file ('snpeff/lowfreq*') from lowfreq_snpeff_summary.collect()\n\n    output:\n    file '*multiqc_report.html' into multiqc_report\n    file '*_data' into multiqc_data\n    val prefix into multiqc_prefix\n\n    script:\n    prefix = fastqc[0].toString() - '_fastqc.html' - 'fastqc/'\n\n    \"\"\"\n    multiqc -d . --config $multiqc_config\n    \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "    prefix = fastqc[0].toString() - '_fastqc.html' - 'fastqc/'\n\n    \"\"\"\n    multiqc -d . --config $multiqc_config\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "multiqc_config",
            "fastqc_results",
            "trimmomatic_results",
            "trimmomatic_fastqc_reports",
            "mapping_host_flagstat",
            "mapping_host_picardstats",
            "mapping_virus_flagstat",
            "mapping_virus_picardstats",
            "ivar_flagstat",
            "ivar_picardstats",
            "majority_snpeff_summary",
            "lowfreq_snpeff_summary"
        ],
        "nb_inputs": 12,
        "outputs": [
            "multiqc_report",
            "multiqc_data",
            "multiqc_prefix"
        ],
        "nb_outputs": 3,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir path: { \"${params.outdir}/99-stats/MultiQC\" }, mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "output_documentation": {
        "name_process": "output_documentation",
        "string_process": "\nprocess output_documentation {\n    publishDir \"$doc_output\", mode: 'copy'\n\n    input:\n    file output_docs from ch_output_docs\n\n    output:\n    file \"results_description.html\"\n    file \"*.pdf\"\n\n    script:\n    if (params.service_id) {\n      \"\"\"\n      markdown_to_html.r $output_docs results_description.html\n      wkhtmltopdf --keep-relative-links results_description.html INFRES_${params.service_id}.pdf\n      \"\"\"\n    } else{\n      \"\"\"\n      markdown_to_html.r $output_docs results_description.html\n      wkhtmltopdf --keep-relative-links results_description.html INFRES.pdf\n      \"\"\"\n    }\n}",
        "nb_lignes_process": 22,
        "string_script": "    if (params.service_id) {\n      \"\"\"\n      markdown_to_html.r $output_docs results_description.html\n      wkhtmltopdf --keep-relative-links results_description.html INFRES_${params.service_id}.pdf\n      \"\"\"\n    } else{\n      \"\"\"\n      markdown_to_html.r $output_docs results_description.html\n      wkhtmltopdf --keep-relative-links results_description.html INFRES.pdf\n      \"\"\"\n    }",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_output_docs"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "BU-ISCIII__SARS_Cov2_consensus-nf",
        "directive": [
            "publishDir \"$doc_output\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}