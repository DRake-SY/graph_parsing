{
    "makeBWAindex": {
        "name_process": "makeBWAindex",
        "string_process": " process makeBWAindex {\n        tag \"${fasta.baseName}\"\n        publishDir path: { params.saveReference ? \"${params.outdir}/REFERENCES\" : params.outdir },\n                saveAs: { params.saveReference ? it : null }, mode: 'copy'\n\n        input:\n        file fasta from fasta_file\n\n        output:\n        file \"${fasta}*\" into bwa_index, bwa_index_pileup\n\n        script:\n        \"\"\"\n        bwa index -a bwtsw $fasta \n        \"\"\"\n    }",
        "nb_lignes_process": 14,
        "string_script": "        \"\"\"\n        bwa index -a bwtsw $fasta \n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BWA"
        ],
        "tools_url": [
            "https://bio.tools/bwa"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            }
        ],
        "inputs": [
            "fasta_file"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bwa_index",
            "bwa_index_pileup"
        ],
        "nb_outputs": 2,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"${fasta.baseName}\"",
            "publishDir path: { params.saveReference ? \"${params.outdir}/REFERENCES\" : params.outdir } , saveAs: { params.saveReference ? it : null }, mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc": {
        "name_process": "fastqc",
        "string_process": "\nprocess fastqc {\n    tag \"$prefix\"\n    publishDir \"${params.outdir}/01-fastqc\", mode: 'copy',\n        saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}\n\n    input:\n    set val(name), file(reads) from raw_reads_fastqc\n\n    output:\n    file '*_fastqc.{zip,html}' into fastqc_results, fastqc_results_picard\n    file '.command.out' into fastqc_stdout\n\n    script:\n\n    prefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \"\"\"\n    fastqc --nogroup -t 1 -k 8 $reads\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    prefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \"\"\"\n    fastqc --nogroup -t 1 -k 8 $reads\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "raw_reads_fastqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_results",
            "fastqc_results_picard",
            "fastqc_stdout"
        ],
        "nb_outputs": 3,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/01-fastqc\", mode: 'copy' , saveAs: {filename -> filename.indexOf(\".zip\") > 0 ? \"zips/$filename\" : \"$filename\"}"
        ],
        "when": "",
        "stub": ""
    },
    "trimming": {
        "name_process": "trimming",
        "string_process": " process trimming {\n        tag \"$prefix\"\n        publishDir \"${params.outdir}/02-preprocessing\", mode: 'copy',\n            saveAs: {filename ->\n                if (filename.indexOf(\"_fastqc\") > 0) \"FastQC/$filename\"\n                else if (filename.indexOf(\".log\") > 0) \"logs/$filename\"\n                else if (params.saveTrimmed && filename.indexOf(\".fastq.gz\")) \"trimmed/$filename\"\n                else null\n        }\n\n        input:\n        set val(name), file(reads) from raw_reads_trimming\n\n        output:\n        file '*_filtered_*.fastq.gz' into trimmed_paired_reads,trimmed_paired_reads_bwa\n        file '*_unpaired_*.fastq.gz' into trimmed_unpaired_reads, trimmed_unpaired_reads_picard\n        file '*_fastqc.{zip,html}' into trimmomatic_fastqc_reports, trimmomatic_fastqc_reports_picard\n        file '*.log' into trimmomatic_results, trimmomatic_results_picard\n\n        script:\n        prefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n        \"\"\"\n        trimmomatic PE -phred33 $reads -threads 1 $prefix\"_filtered_R1.fastq\" $prefix\"_unpaired_R1.fastq\" $prefix\"_filtered_R2.fastq\" $prefix\"_unpaired_R2.fastq\" ILLUMINACLIP:${params.trimmomatic_adapters_file}:${params.trimmomatic_adapters_parameters} SLIDINGWINDOW:${params.trimmomatic_window_length}:${params.trimmomatic_window_value} MINLEN:${params.trimmomatic_mininum_length} 2> ${name}.log\n        gzip *.fastq\n        fastqc -q *_filtered_*.fastq.gz\n        \"\"\"\n    }",
        "nb_lignes_process": 25,
        "string_script": "        prefix = name - ~/(_S[0-9]{2})?(_L00[1-9])?(.R1)?(_1)?(_R1)?(_trimmed)?(_val_1)?(_00*)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n        \"\"\"\n        trimmomatic PE -phred33 $reads -threads 1 $prefix\"_filtered_R1.fastq\" $prefix\"_unpaired_R1.fastq\" $prefix\"_filtered_R2.fastq\" $prefix\"_unpaired_R2.fastq\" ILLUMINACLIP:${params.trimmomatic_adapters_file}:${params.trimmomatic_adapters_parameters} SLIDINGWINDOW:${params.trimmomatic_window_length}:${params.trimmomatic_window_value} MINLEN:${params.trimmomatic_mininum_length} 2> ${name}.log\n        gzip *.fastq\n        fastqc -q *_filtered_*.fastq.gz\n        \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "Trimmomatic",
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/trimmomatic",
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "Trimmomatic",
                "uri": "https://bio.tools/trimmomatic",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "A flexible read trimming tool for Illumina NGS data",
                "homepage": "http://www.usadellab.org/cms/index.php?page=trimmomatic"
            },
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "raw_reads_trimming"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trimmed_paired_reads",
            "trimmed_paired_reads_bwa",
            "trimmed_unpaired_reads",
            "trimmed_unpaired_reads_picard",
            "trimmomatic_fastqc_reports",
            "trimmomatic_fastqc_reports_picard",
            "trimmomatic_results",
            "trimmomatic_results_picard"
        ],
        "nb_outputs": 8,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/02-preprocessing\", mode: 'copy' , saveAs: {filename -> if (filename.indexOf(\"_fastqc\") > 0) \"FastQC/$filename\" else if (filename.indexOf(\".log\") > 0) \"logs/$filename\" else if (params.saveTrimmed && filename.indexOf(\".fastq.gz\")) \"trimmed/$filename\" else null }"
        ],
        "when": "",
        "stub": ""
    },
    "bwa": {
        "name_process": "bwa",
        "string_process": "\nprocess bwa {\n    tag \"$prefix\"\n    publishDir path: { params.saveAlignedIntermediates ? \"${params.outdir}/03-mapping\" : params.outdir }, mode: 'copy',\n            saveAs: {filename -> params.saveAlignedIntermediates ? filename : null }\n\n    input:\n    file reads from raw_reads_bwa\n    file fasta from fasta_file\t\n                                  \n    file bwa_index from bwa_index.collect()\n\n    output:\n    file '*.bam' into bwa_bam\n\n    script:\n    prefix = reads[0].toString() - ~/(.R1)?(_1)?(_R1)?(_trimmed)?(_filtered)?(_val_1)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \"\"\"\n    bwa mem -M $fasta $reads | samtools view -bT $fasta - > ${prefix}.bam\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    prefix = reads[0].toString() - ~/(.R1)?(_1)?(_R1)?(_trimmed)?(_filtered)?(_val_1)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \"\"\"\n    bwa mem -M $fasta $reads | samtools view -bT $fasta - > ${prefix}.bam\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "raw_reads_bwa",
            "fasta_file",
            "bwa_index"
        ],
        "nb_inputs": 3,
        "outputs": [
            "bwa_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir path: { params.saveAlignedIntermediates ? \"${params.outdir}/03-mapping\" : params.outdir }, mode: 'copy' , saveAs: {filename -> params.saveAlignedIntermediates ? filename : null }"
        ],
        "when": "",
        "stub": ""
    },
    "samtools": {
        "name_process": "samtools",
        "string_process": "\nprocess samtools {\n    tag \"$prefix\"\n    publishDir path: \"${params.outdir}/03-mapping\", mode: 'copy',\n            saveAs: { filename ->\n                    if (filename.indexOf(\"_stats.txt\") > 0) \"stats/$filename\"\n                    else params.saveAlignedIntermediates ? filename : null\n            }\n\n    input:\n    file bam from bwa_bam\n\n    output:\n    file '*_sorted.bam' into bam_picard, bam_samtools, bam_stats, picard_stats, bedtools_coverage\n    file '*_sorted.bam.bai' into bai_picard, bai_samtools, bai_bamstats, bai_picard_stats, bai_bedtools_coverage\n    file '*_stats.txt' into samtools_stats\n\n    script:\n    prefix = bam.baseName - ~/(.R1)?(_1)?(_R1)?(_trimmed)?(_filtered)?(_val_1)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \"\"\"\n    samtools sort $bam -T ${prefix}_sorted -o ${prefix}_sorted.bam\n    samtools index ${prefix}_sorted.bam\n    samtools stats ${prefix}_sorted.bam > ${prefix}_stats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    prefix = bam.baseName - ~/(.R1)?(_1)?(_R1)?(_trimmed)?(_filtered)?(_val_1)?(\\.fq)?(\\.fastq)?(\\.gz)?$/\n    \"\"\"\n    samtools sort $bam -T ${prefix}_sorted -o ${prefix}_sorted.bam\n    samtools index ${prefix}_sorted.bam\n    samtools stats ${prefix}_sorted.bam > ${prefix}_stats.txt\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bwa_bam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bam_picard",
            "bam_samtools",
            "bam_stats",
            "picard_stats",
            "bedtools_coverage",
            "bai_picard",
            "bai_samtools",
            "bai_bamstats",
            "bai_picard_stats",
            "bai_bedtools_coverage",
            "samtools_stats"
        ],
        "nb_outputs": 11,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir path: \"${params.outdir}/03-mapping\", mode: 'copy' , saveAs: { filename -> if (filename.indexOf(\"_stats.txt\") > 0) \"stats/$filename\" else params.saveAlignedIntermediates ? filename : null }"
        ],
        "when": "",
        "stub": ""
    },
    "picard": {
        "name_process": "picard",
        "string_process": " process picard {\n        tag \"$prefix\"\n        publishDir \"${params.outdir}/04-picard\", mode: 'copy'\n            \n        input:\n        file bam from bam_picard\n        file bai from bai_picard\n\n        output:\n        file '*_dedup_sorted.bam' into bam_dedup_mpileup, dedup_bam_stats, dedup_picard_stats, dedup_bedtools_coverage\n        file '*_dedup_sorted.bam.bai' into bai_dedup_stats, bai_dedup_picard_stats, bai_dedup_mpileup, bai_dedup_bedtools_coverage\n        file '*_picardDupMetrics.txt' into picard_reports\n\n        script:\n        prefix = bam[0].toString() - ~/(_sorted)?(\\.bam)?$/\n        \"\"\"\n        picard MarkDuplicates \\\\\n            INPUT=$bam \\\\\n            OUTPUT=${prefix}_dedup.bam \\\\\n            ASSUME_SORTED=true \\\\\n            REMOVE_DUPLICATES=true \\\\\n            METRICS_FILE=${prefix}_picardDupMetrics.txt \\\\\n            VALIDATION_STRINGENCY=LENIENT \\\\\n            PROGRAM_RECORD_ID='null'\n        samtools sort ${prefix}_dedup.bam -o ${prefix}_dedup_sorted.bam -T ${prefix}\n        samtools index ${prefix}_dedup_sorted.bam\n        \"\"\"\n    }",
        "nb_lignes_process": 26,
        "string_script": "        prefix = bam[0].toString() - ~/(_sorted)?(\\.bam)?$/\n        \"\"\"\n        picard MarkDuplicates \\\\\n            INPUT=$bam \\\\\n            OUTPUT=${prefix}_dedup.bam \\\\\n            ASSUME_SORTED=true \\\\\n            REMOVE_DUPLICATES=true \\\\\n            METRICS_FILE=${prefix}_picardDupMetrics.txt \\\\\n            VALIDATION_STRINGENCY=LENIENT \\\\\n            PROGRAM_RECORD_ID='null'\n        samtools sort ${prefix}_dedup.bam -o ${prefix}_dedup_sorted.bam -T ${prefix}\n        samtools index ${prefix}_dedup_sorted.bam\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "Picard",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_picard",
            "bai_picard"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bam_dedup_mpileup",
            "dedup_bam_stats",
            "dedup_picard_stats",
            "dedup_bedtools_coverage",
            "bai_dedup_stats",
            "bai_dedup_picard_stats",
            "bai_dedup_mpileup",
            "bai_dedup_bedtools_coverage",
            "picard_reports"
        ],
        "nb_outputs": 9,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/04-picard\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "mpileup": {
        "name_process": "mpileup",
        "string_process": "\nprocess mpileup {\n    tag \"$prefix\"\n    publishDir \"${params.outdir}/05-samtools\", mode: 'copy',\n            saveAs: {filename -> params.saveMpileup ? filename : null }\n\n    input:\n    file bam from bam_samtools\n    file bai_file from bai_samtools\n    file fasta from fasta_file\n                                       \n    file bwa_index from bwa_index_pileup.collect()\n\n    output:\n    file '*.pileup' into pileup_results\n\n    script:\n    prefix = bam.baseName  - ~/(_dedup)?(\\_sorted)?(\\.bam)?$/\n    \"\"\"\n    samtools mpileup -A -d ${params.maxDepth} -Q ${params.minBaseQ} -f $fasta $bam > ${prefix}.pileup\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    prefix = bam.baseName  - ~/(_dedup)?(\\_sorted)?(\\.bam)?$/\n    \"\"\"\n    samtools mpileup -A -d ${params.maxDepth} -Q ${params.minBaseQ} -f $fasta $bam > ${prefix}.pileup\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "bam_samtools",
            "bai_samtools",
            "fasta_file",
            "bwa_index_pileup"
        ],
        "nb_inputs": 4,
        "outputs": [
            "pileup_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/05-samtools\", mode: 'copy' , saveAs: {filename -> params.saveMpileup ? filename : null }"
        ],
        "when": "",
        "stub": ""
    },
    "varscan": {
        "name_process": "varscan",
        "string_process": "\nprocess varscan {\n    tag \"${pileup.baseName}\"\n    publishDir \"${params.outdir}/06-VarScan\", mode: 'copy'\n\n    input:\n    file pileup from pileup_results\n\n    output:\n    file '*.vcf' into vcf_file\n\n    script:\n    \"\"\"\n    varscan mpileup2cns $pileup --min-var-freq ${params.minVarFreq} --p-value ${params.pValue} --variants --output-vcf 1 > ${pileup.baseName}.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n    varscan mpileup2cns $pileup --min-var-freq ${params.minVarFreq} --p-value ${params.pValue} --variants --output-vcf 1 > ${pileup.baseName}.vcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "VarScan"
        ],
        "tools_url": [
            "https://bio.tools/varscan"
        ],
        "tools_dico": [
            {
                "name": "VarScan",
                "uri": "https://bio.tools/varscan",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "VarScan, an open source tool for variant detection that is compatible with several short read align-ers.",
                "homepage": "http://dkoboldt.github.io/varscan/"
            }
        ],
        "inputs": [
            "pileup_results"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_file"
        ],
        "nb_outputs": 1,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"${pileup.baseName}\"",
            "publishDir \"${params.outdir}/06-VarScan\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "kggseq": {
        "name_process": "kggseq",
        "string_process": "\nprocess kggseq {\n    tag \"${vcf.baseName}\"\n    publishDir \"${params.outdir}/07-annotation\", mode: 'copy',\n            saveAs: { filename ->\n                if (filename.indexOf(\"_header.table\") > 0) \"tables/$filename\"\n                else if (filename.indexOf(\".log\") > 0) \"logs/$filename\"\n                else if (filename.indexOf(\".txt\") > 0) \"annotation/$filename\"\n                else if (filename.indexOf(\".table\") > 0) \"annotation/$filename\"\n            }\n    input:\n    file vcf from vcf_file\n    file resource from resourceDatasets_file\n\n    output:\n    file '*.table' into bcftools_tables\n    file '*_annot.txt.flt.txt' into kggseq_flt_file\n    file '*_annot.txt.log' into kggseq_annot_log\n    file '*_header.table' into header_table\n\n    script:\n\tprefix = vcf.baseName - ~/(\\.vcf)?$/\n    \"\"\"\n    bcftools query -H $vcf -f '%CHROM\\t%POS\\t%REF\\t%ALT\\t%FILTER[\\t%GT\\t%DP\\t%RD\\t%AD\\t%FREQ\\t%PVAL\\t%RBQ\\t%ABQ\\t%RDF\\t%RDR\\t%ADF\\t%ADR]\\n' > ${vcf.baseName}.table\n    kggseq --no-lib-check --buildver hg38 --vcf-file $vcf --resource $resource --db-gene refgene --db-score dbnsfp --genome-annot --db-filter ESP5400,dbsnp141,1kg201305,exac --rare-allele-freq 1 --mendel-causing-predict best --omim-annot --out ${vcf.baseName}_annot.txt\n    gunzip *_annot.txt.flt.txt.gz\n    cp ${baseDir}/assets/header ${vcf.baseName}_header.table && tail -n +2 ${vcf.baseName}.table >> ${vcf.baseName}_header.table\n    \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "\tprefix = vcf.baseName - ~/(\\.vcf)?$/\n    \"\"\"\n    bcftools query -H $vcf -f '%CHROM\\t%POS\\t%REF\\t%ALT\\t%FILTER[\\t%GT\\t%DP\\t%RD\\t%AD\\t%FREQ\\t%PVAL\\t%RBQ\\t%ABQ\\t%RDF\\t%RDR\\t%ADF\\t%ADR]\\n' > ${vcf.baseName}.table\n    kggseq --no-lib-check --buildver hg38 --vcf-file $vcf --resource $resource --db-gene refgene --db-score dbnsfp --genome-annot --db-filter ESP5400,dbsnp141,1kg201305,exac --rare-allele-freq 1 --mendel-causing-predict best --omim-annot --out ${vcf.baseName}_annot.txt\n    gunzip *_annot.txt.flt.txt.gz\n    cp ${baseDir}/assets/header ${vcf.baseName}_header.table && tail -n +2 ${vcf.baseName}.table >> ${vcf.baseName}_header.table\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "KGGSeq"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/kggseq"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "KGGSeq",
                "uri": "https://bio.tools/kggseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "Pathology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "Disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0634",
                            "term": "https://en.wikipedia.org/wiki/Pathology"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Linkage mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Functional mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic cartography"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0282",
                                    "term": "Genetic map generation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Software platform constituted of Bioinformatics and statistical genetics functions making use of valuable biologic resources and knowledge for sequencing-based genetic mapping of variants/genes responsible for human diseases/traits.",
                "homepage": "http://statgenpro.psychiatry.hku.hk/limx/kggseq/"
            }
        ],
        "inputs": [
            "vcf_file",
            "resourceDatasets_file"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bcftools_tables",
            "kggseq_flt_file",
            "kggseq_annot_log",
            "header_table"
        ],
        "nb_outputs": 4,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"${vcf.baseName}\"",
            "publishDir \"${params.outdir}/07-annotation\", mode: 'copy' , saveAs: { filename -> if (filename.indexOf(\"_header.table\") > 0) \"tables/$filename\" else if (filename.indexOf(\".log\") > 0) \"logs/$filename\" else if (filename.indexOf(\".txt\") > 0) \"annotation/$filename\" else if (filename.indexOf(\".table\") > 0) \"annotation/$filename\" }"
        ],
        "when": "",
        "stub": ""
    },
    "rmerge": {
        "name_process": "rmerge",
        "string_process": "\nprocess rmerge {\n    tag \"$prefix\"\n    publishDir \"${params.outdir}/07-annotation/tables\", mode: 'copy'\n\n    input:\n    file header_table from header_table\n    file flt from kggseq_flt_file\n\n    output:\n    file '*_all_annotated.tab' into r_merged_tables\n\n    script:\n    prefix = header_table.baseName - ~/(_header)?(\\.table)?$/\n    \"\"\"\n    Rscript ${baseDir}/bin/merge_parse.R $prefix\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    prefix = header_table.baseName - ~/(_header)?(\\.table)?$/\n    \"\"\"\n    Rscript ${baseDir}/bin/merge_parse.R $prefix\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "header_table",
            "kggseq_flt_file"
        ],
        "nb_inputs": 2,
        "outputs": [
            "r_merged_tables"
        ],
        "nb_outputs": 1,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/07-annotation/tables\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "bamstats": {
        "name_process": "bamstats",
        "string_process": "\nprocess bamstats {\n    tag \"$prefix\"\n    publishDir \"${params.outdir}/99-stats/bamstats\", mode: 'copy'\n\n    input:\n    file region_list from bamstatsTargets_file\n    file sorted_bam from bam_stats\n    file bai_file from bai_bamstats\n\n\n    output:\n    file '*_bamstat.txt' into bamstats_result\n\n    script:\n    prefix = sorted_bam.baseName - ~/(_paired)?(_dedup)?(_sorted)?(\\.bam)?$/\n\n    \"\"\"\n    bam stats --regionList $region_list --in $sorted_bam --baseSum --basic 2> ${prefix}_bamstat.txt\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    prefix = sorted_bam.baseName - ~/(_paired)?(_dedup)?(_sorted)?(\\.bam)?$/\n\n    \"\"\"\n    bam stats --regionList $region_list --in $sorted_bam --baseSum --basic 2> ${prefix}_bamstat.txt\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "BaMM"
        ],
        "tools_url": [
            "https://bio.tools/bamm"
        ],
        "tools_dico": [
            {
                "name": "BaMM",
                "uri": "https://bio.tools/bamm",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "ChIP-seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "Chip-sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "Chip Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "ChIP-sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3169",
                            "term": "Chip sequencing"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Sequence motif recognition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3501",
                                    "term": "Enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0238",
                                    "term": "Sequence motif discovery"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Motif scanning"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Sequence signature recognition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0239",
                                    "term": "Sequence signature detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3501",
                                    "term": "Enrichment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3501",
                                    "term": "Over-representation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0238",
                                    "term": "Motif discovery"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "de-novo motif discovery and regulatory sequence analysis.\nDiscovery of regulatory motifs with higher-order Bayesian Markov Models (BaMMs)",
                "homepage": "https://bammmotif.mpibpc.mpg.de"
            }
        ],
        "inputs": [
            "bamstatsTargets_file",
            "bam_stats",
            "bai_bamstats"
        ],
        "nb_inputs": 3,
        "outputs": [
            "bamstats_result"
        ],
        "nb_outputs": 1,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/99-stats/bamstats\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "picard_all_out": {
        "name_process": "picard_all_out",
        "string_process": "\nprocess picard_all_out {\n    tag \"$prefix\"\n    publishDir \"${params.outdir}/99-stats/picardmetrics\", mode: 'copy'\n\n    input:\n    file picard_stats from picard_all_out.collect()\n\n    output:\n    file 'hsMetrics_all.out' into picardstats_all_result\n\n    script:\n    \"\"\"\n    echo \"SAMPLE\",\"MEAN TARGET COVERAGE\", \"PCT USABLE BASES ON TARGET\",\"FOLD ENRICHMENT\",\"PCT TARGET BASES 10X\",\"PCT TARGET BASES 20X\",\"PCT TARGET BASES 30X\",\"PCT TARGET BASES 40X\",\"PCT TARGET BASES 50X\" > hsMetrics_all.out\n\tfor file in $picard_stats; do\n\t\tprefix=${file%_hsMetrics.out}\n\t\tgrep '^RB' $file | awk 'BEGIN {FS=\"\\t\";OFS=\",\"}{print var,\\$22,\\$24,\\$25,\\$29,\\$30,\\$31,\\$32,\\$33}' var=\"${prefix}\" >> hsMetrics_all.out\n\tdone\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "    \"\"\"\n    echo \"SAMPLE\",\"MEAN TARGET COVERAGE\", \"PCT USABLE BASES ON TARGET\",\"FOLD ENRICHMENT\",\"PCT TARGET BASES 10X\",\"PCT TARGET BASES 20X\",\"PCT TARGET BASES 30X\",\"PCT TARGET BASES 40X\",\"PCT TARGET BASES 50X\" > hsMetrics_all.out\n\tfor file in $picard_stats; do\n\t\tprefix=${file%_hsMetrics.out}\n\t\tgrep '^RB' $file | awk 'BEGIN {FS=\"\\t\";OFS=\",\"}{print var,\\$22,\\$24,\\$25,\\$29,\\$30,\\$31,\\$32,\\$33}' var=\"${prefix}\" >> hsMetrics_all.out\n\tdone\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "picard_all_out"
        ],
        "nb_inputs": 1,
        "outputs": [
            "picardstats_all_result"
        ],
        "nb_outputs": 1,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/99-stats/picardmetrics\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc": {
        "name_process": "multiqc",
        "string_process": "\nprocess multiqc {\n    tag \"$prefix\"\n    publishDir \"${params.outdir}/99-stats/multiQC\", mode: 'copy'\n\n    input:\n    file multiqc_config\n    file (fastqc:'fastqc/*') from fastqc_results.collect()\n    file ('trimommatic/*') from trimmomatic_results.collect()\n    file ('trimommatic/*') from trimmomatic_fastqc_reports.collect()\n    file ('bamstats/*') from bamstats_result.collect()\n    file ('picardstats/*') from picardstats_result.collect()\n\n    output:\n    file '*multiqc_report.html' into multiqc_report\n    file '*_data' into multiqc_data\n    file '.command.err' into multiqc_stderr\n    val prefix into multiqc_prefix\n\n    script:\n    prefix = fastqc[0].toString() - '_fastqc.html' - 'fastqc/'\n\n    \"\"\"\n    multiqc -d . --config $multiqc_config\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    prefix = fastqc[0].toString() - '_fastqc.html' - 'fastqc/'\n\n    \"\"\"\n    multiqc -d . --config $multiqc_config\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "multiqc_config",
            "fastqc_results",
            "trimmomatic_results",
            "trimmomatic_fastqc_reports",
            "bamstats_result",
            "picardstats_result"
        ],
        "nb_inputs": 6,
        "outputs": [
            "multiqc_report",
            "multiqc_data",
            "multiqc_stderr",
            "multiqc_prefix"
        ],
        "nb_outputs": 4,
        "name_workflow": "BU-ISCIII__panelLowFreq-nf",
        "directive": [
            "tag \"$prefix\"",
            "publishDir \"${params.outdir}/99-stats/multiQC\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}