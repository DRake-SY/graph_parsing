{
    "index_tiles": {
        "name_process": "index_tiles",
        "string_process": "\nprocess index_tiles {\n\n    input:\n     file amplicons from ch_amplicons\n\n    output:\n     file(\"indices\") into ch_tile_indices\n\n    script:\n    \"\"\"\n\n    ${baseDir}/bin/tsv2index.sh ${amplicons}\n\n    \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "    \"\"\"\n\n    ${baseDir}/bin/tsv2index.sh ${amplicons}\n\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_amplicons"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_tile_indices"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "index_genome": {
        "name_process": "index_genome",
        "string_process": "\nprocess index_genome {\n\n    input:\n    file(\"indices/sequence.fasta\") from ch_genomefa\n\n    output:\n    file(\"indices\") into ch_genome_indices\n\n    script:\n    \"\"\"\n    samtools faidx indices/sequence.fasta\n    minimap2 -d indices/sequence.mmi indices/sequence.fasta\n    \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "    \"\"\"\n    samtools faidx indices/sequence.fasta\n    minimap2 -d indices/sequence.mmi indices/sequence.fasta\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "Minimap2"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/minimap2"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "Minimap2",
                "uri": "https://bio.tools/minimap2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0491",
                                    "term": "Pairwise sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0491",
                                    "term": "Pairwise alignment"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Pairwise aligner for genomic and spliced nucleotide sequences",
                "homepage": "https://github.com/lh3/minimap2"
            }
        ],
        "inputs": [
            "ch_genomefa"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_genome_indices"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "make_primerbed": {
        "name_process": "make_primerbed",
        "string_process": "\nprocess make_primerbed {\n\n    input:\n    file genomeseq from ch_genomefa\n    file amplicons from ch_amplicons\n\n    output:\n    file(\"primer.bed\") into ch_primerbed\n\n    script:\n    \"\"\"\n    #!/usr/bin/env Rscript\n    library(Biostrings)\n    library(dplyr)\n\n\n    genomeF <- \"${genomeseq}\"\n    primerF <- \"${amplicons}\"\n    genome <- readDNAStringSet(genomeF)\n    primer <- readr::read_tsv(primerF,col_names=F) %>% setNames(c(\"tilename\",\"primFWD\",\"primREV\",\"tileseq\"))\n    primerBed <- NULL\n    for(i in 1:nrow(primer)){\n       print(i)\n       tilename <- primer[i,]\\$tilename\n       primerFWD <- DNAString(primer[i,]\\$primFWD)\n       primerREV <- reverseComplement(DNAString(primer[i,]\\$primREV))\n\n       primerFWDmatch <- data.frame(unlist(vmatchPattern(primerFWD, genome))) %>%\n                         mutate(strand=\"+\",tile=tilename,score=60) %>%\n                         dplyr::select(names,start,end,tile,score,strand)\n       primerREVmatch <- data.frame(unlist(vmatchPattern(primerREV, genome)))%>%\n                         mutate(strand=\"-\",tile=tilename,score=60) %>%\n                         dplyr::select(names,start,end,tile,score,strand)\n       primermatch <- rbind(primerFWDmatch,primerREVmatch)\n\n       primerBed <- rbind(primerBed,primermatch)\n\n     }\n     primerBed <- primerBed %>% distinct() %>% mutate(start=start-1)\n\n     readr::write_tsv(primerBed,\"primer.bed\",col_names=F)\n    \"\"\"\n}",
        "nb_lignes_process": 42,
        "string_script": "    \"\"\"\n    #!/usr/bin/env Rscript\n    library(Biostrings)\n    library(dplyr)\n\n\n    genomeF <- \"${genomeseq}\"\n    primerF <- \"${amplicons}\"\n    genome <- readDNAStringSet(genomeF)\n    primer <- readr::read_tsv(primerF,col_names=F) %>% setNames(c(\"tilename\",\"primFWD\",\"primREV\",\"tileseq\"))\n    primerBed <- NULL\n    for(i in 1:nrow(primer)){\n       print(i)\n       tilename <- primer[i,]\\$tilename\n       primerFWD <- DNAString(primer[i,]\\$primFWD)\n       primerREV <- reverseComplement(DNAString(primer[i,]\\$primREV))\n\n       primerFWDmatch <- data.frame(unlist(vmatchPattern(primerFWD, genome))) %>%\n                         mutate(strand=\"+\",tile=tilename,score=60) %>%\n                         dplyr::select(names,start,end,tile,score,strand)\n       primerREVmatch <- data.frame(unlist(vmatchPattern(primerREV, genome)))%>%\n                         mutate(strand=\"-\",tile=tilename,score=60) %>%\n                         dplyr::select(names,start,end,tile,score,strand)\n       primermatch <- rbind(primerFWDmatch,primerREVmatch)\n\n       primerBed <- rbind(primerBed,primermatch)\n\n     }\n     primerBed <- primerBed %>% distinct() %>% mutate(start=start-1)\n\n     readr::write_tsv(primerBed,\"primer.bed\",col_names=F)\n    \"\"\"",
        "nb_lignes_script": 31,
        "language_script": "Rscript",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_genomefa",
            "ch_amplicons"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_primerbed"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "demux": {
        "name_process": "demux",
        "string_process": " process demux {\n      publishDir path: \"${params.outdirExt}/QC\", mode: 'copy',\n      saveAs: {filename->\n        if (filename.lastIndexOf(\".fastq\") > 0) null\n        else filename\n    }\n\n    input:\n    set file(r1),file(r2),file(i1),file(i2) from ch_input\n    file platebc from platebc_file\n    file wellbc from ch_wellbc\n\n\n    output:\n    file (\"*fastq\") into ch_dmx\n    file (\"*tsv\") into ch_dmx_rmd\n\n    script:\n    \"\"\"\n    cp ${baseDir}/bin/SARSeq_fixedOFF_demux.sh .\n    ./SARSeq_fixedOFF_demux.sh -1 ${r1} -2 ${r2} -3 ${i1} -4 ${i2} -M ${params.MM}  -t sarseq1  -i ${params.platemin} -a ${params.platemax} -I ${platebc} -W ${wellbc}\n    rm not_demuxed.R*\n    \"\"\"\n    }",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    cp ${baseDir}/bin/SARSeq_fixedOFF_demux.sh .\n    ./SARSeq_fixedOFF_demux.sh -1 ${r1} -2 ${r2} -3 ${i1} -4 ${i2} -M ${params.MM}  -t sarseq1  -i ${params.platemin} -a ${params.platemax} -I ${platebc} -W ${wellbc}\n    rm not_demuxed.R*\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_input",
            "platebc_file",
            "ch_wellbc"
        ],
        "nb_inputs": 3,
        "outputs": [
            "ch_dmx",
            "ch_dmx_rmd"
        ],
        "nb_outputs": 2,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "publishDir path: \"${params.outdirExt}/QC\", mode: 'copy' , saveAs: {filename-> if (filename.lastIndexOf(\".fastq\") > 0) null else filename }"
        ],
        "when": "",
        "stub": ""
    },
    "read2tile": {
        "name_process": "read2tile",
        "string_process": "\nprocess read2tile {\n\n    tag \"$bcset\"\n\n    input:\n    set val(bcset), file(reads) from ch_read2tile\n    file amplicons from ch_amplicons\n\n\n    output:\n    file (\"*tsv\") optional true into ch_r2t_report\n    file (\"*fastq\") optional true into ch_r2t_fastq\n\n    script:\n    \"\"\"\n    mkdir tmp\n\n    for infile in $reads; do\n       name=\\$(basename \\$infile | sed 's/.R12.fastq//')\n\n       # only work of files with reads\n       if [ \\$(wc -l \\$infile | cut -f 1 -d \" \") -ge \"${params.sample_minreads_fastq_paired}\" ]; then\n\n          ${baseDir}/bin/deinterleave_fastq.sh < \\$infile tmp/\\${name}.R1.fastq tmp/\\${name}.R2.fastq\n          awk 'NR%4==1' tmp/\\${name}.R1.fastq  | cut -f 1 -d \" \" > names1\n          awk 'NR%4==1' tmp/\\${name}.R2.fastq  | cut -f 1 -d \" \" > names2\n          diff --brief names1 names2 >/dev/null\n          comp_value=\\$?\n\n          if [ \\$comp_value -eq 1 ]\n          then\n              exit \"names of deinterleaved files could be different. is something going wrong?\"\n          fi\n\n          cp ${baseDir}/bin/SARSeq_read2tiles.sh .\n\n         ./SARSeq_read2tiles.sh -1 tmp/\\${name}.R1.fastq -2 tmp/\\${name}.R2.fastq  -t \\${name}  -A ${amplicons} -P ${params.primerk}\n      fi\n\n    done\n\n    \"\"\"\n\n\n\n}",
        "nb_lignes_process": 45,
        "string_script": "    \"\"\"\n    mkdir tmp\n\n    for infile in $reads; do\n       name=\\$(basename \\$infile | sed 's/.R12.fastq//')\n\n       # only work of files with reads\n       if [ \\$(wc -l \\$infile | cut -f 1 -d \" \") -ge \"${params.sample_minreads_fastq_paired}\" ]; then\n\n          ${baseDir}/bin/deinterleave_fastq.sh < \\$infile tmp/\\${name}.R1.fastq tmp/\\${name}.R2.fastq\n          awk 'NR%4==1' tmp/\\${name}.R1.fastq  | cut -f 1 -d \" \" > names1\n          awk 'NR%4==1' tmp/\\${name}.R2.fastq  | cut -f 1 -d \" \" > names2\n          diff --brief names1 names2 >/dev/null\n          comp_value=\\$?\n\n          if [ \\$comp_value -eq 1 ]\n          then\n              exit \"names of deinterleaved files could be different. is something going wrong?\"\n          fi\n\n          cp ${baseDir}/bin/SARSeq_read2tiles.sh .\n\n         ./SARSeq_read2tiles.sh -1 tmp/\\${name}.R1.fastq -2 tmp/\\${name}.R2.fastq  -t \\${name}  -A ${amplicons} -P ${params.primerk}\n      fi\n\n    done\n\n    \"\"\"",
        "nb_lignes_script": 27,
        "language_script": "bash",
        "tools": [
            "RDiff",
            "NullSeq"
        ],
        "tools_url": [
            "https://bio.tools/rdiff",
            "https://bio.tools/nullseq"
        ],
        "tools_dico": [
            {
                "name": "RDiff",
                "uri": "https://bio.tools/rdiff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3320",
                            "term": "RNA splicing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3320",
                            "term": "Alternative splicing"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "rDiff is an open source tool for accurate detection of differential RNA processing from RNA-Seq data. It implements two statistical tests to detect changes of the RNA processing between two samples. rDiff.parametric is a powerful test, which can be applied for well annotated organisms to detect changes in the relative abundance of isoforms. rDiff.nonparametric is an alternative when the annotation is incomplete or missing.",
                "homepage": "http://bioweb.me/rdiff"
            },
            {
                "name": "NullSeq",
                "uri": "https://bio.tools/nullseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0364",
                                    "term": "Random sequence generation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Creates Random Coding Sequences with specified GC content and Amino Acid usage.",
                "homepage": "https://github.com/amarallab/NullSeq"
            }
        ],
        "inputs": [
            "ch_read2tile",
            "ch_amplicons"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_r2t_report",
            "ch_r2t_fastq"
        ],
        "nb_outputs": 2,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "tag \"$bcset\""
        ],
        "when": "",
        "stub": ""
    },
    "aln2tile": {
        "name_process": "aln2tile",
        "string_process": "\nprocess aln2tile {\n\n    tag \"${setname}\"\n\n    input:\n    set val(setname), file(reads) from ch_r2t_fastq_set\n    file index from ch_tile_indices\n\n    output:\n    set file(\"*bam\"), file(\"*flagstat\") optional true into ch_aln2tile_bam_log\n    file(\"*flagstat\") optional true into ch_aln2tile_multiqc\n\n\n    script:\n    \"\"\"\n    for infile in $reads; do\n\n      if [ \\$(wc -l \\$infile | cut -f 1 -d \" \") -ge \"${params.sample_minreads_fastq_paired}\" ]; then\n        name=\\$(basename \\$infile | sed 's/.R12.fastq//')\n\n        tile=\\$(echo \\$infile | sed 's/__.*\\$//')\n\n        minimap2 -ax sr -t $task.cpus indices/\\$tile/sequence.mmi \\$infile | \\\\\n          samtools view -@ $task.cpus -b -h -F 0x0100 - | samtools sort -o \\$name.bam -\n\n        samtools index \\$name.bam\n\n        samtools flagstat -@ $task.cpus \\$name.bam > \\$name.flagstat\n      fi\n    done\n    \"\"\"\n\n}",
        "nb_lignes_process": 32,
        "string_script": "    \"\"\"\n    for infile in $reads; do\n\n      if [ \\$(wc -l \\$infile | cut -f 1 -d \" \") -ge \"${params.sample_minreads_fastq_paired}\" ]; then\n        name=\\$(basename \\$infile | sed 's/.R12.fastq//')\n\n        tile=\\$(echo \\$infile | sed 's/__.*\\$//')\n\n        minimap2 -ax sr -t $task.cpus indices/\\$tile/sequence.mmi \\$infile | \\\\\n          samtools view -@ $task.cpus -b -h -F 0x0100 - | samtools sort -o \\$name.bam -\n\n        samtools index \\$name.bam\n\n        samtools flagstat -@ $task.cpus \\$name.bam > \\$name.flagstat\n      fi\n    done\n    \"\"\"",
        "nb_lignes_script": 16,
        "language_script": "bash",
        "tools": [
            "Minimap2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/minimap2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Minimap2",
                "uri": "https://bio.tools/minimap2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0491",
                                    "term": "Pairwise sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0491",
                                    "term": "Pairwise alignment"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Pairwise aligner for genomic and spliced nucleotide sequences",
                "homepage": "https://github.com/lh3/minimap2"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_r2t_fastq_set",
            "ch_tile_indices"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aln2tile_bam_log",
            "ch_aln2tile_multiqc"
        ],
        "nb_outputs": 2,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "tag \"${setname}\""
        ],
        "when": "",
        "stub": ""
    },
    "aln2tile_multiqc": {
        "name_process": "aln2tile_multiqc",
        "string_process": "\nprocess aln2tile_multiqc {\n\n    publishDir path: \"${params.outdirExt}/QC/multiqc_aln2tile\", mode: 'copy'\n\n    input:\n    file(\"*\") from ch_aln2tile_multiqc.collect()\n    file multiqc_config from ch_multiqc_config\n\n    output:\n    file \"*multiqc*\" into ch_aln2tile_multiqc_report\n\n    script:\n    \"\"\"\n    multiqc . -m samtools -n multiqc_aln2tile --config $multiqc_config\n    \"\"\"\n\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    multiqc . -m samtools -n multiqc_aln2tile --config $multiqc_config\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "ch_aln2tile_multiqc",
            "ch_multiqc_config"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aln2tile_multiqc_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "publishDir path: \"${params.outdirExt}/QC/multiqc_aln2tile\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "aln2tile_mpile": {
        "name_process": "aln2tile_mpile",
        "string_process": "\nprocess aln2tile_mpile {\n\n    tag \"$setname\"\n\n    publishDir path: \"${params.outdirExt}/aln2tile\", mode: 'copy',\n    saveAs: {filename->\n      if (filename.lastIndexOf(\".mpileup\") > 0) \"mpileup/$filename\"\n      else if (filename.lastIndexOf(\".csv\") > 0) \"mpileup2csv/$filename\"\n      else null\n    }\n\n    input:\n    set val(setname), file (bams) from ch_aln2tile_bam_set\n    file index from ch_tile_indices\n\n    output:\n    file(\"*fractions.csv\") optional true into ch_aln2tile_fractions_consensus\n\n    script:\n    bqfilter = params.bqfilter > 0 ? \"--min-BQ ${params.bqfilter}\" : '--no-BAQ'\n\n    \"\"\"\n    for infile in $bams; do\n      name=\\$(basename \\$infile | sed 's/.bam//')\n      tile=\\$(echo \\$infile | sed 's/__.*\\$//')\n\n      # filter bam\n      samtools view -@ $task.cpus -b -f 2 -F4 -F 0x0100  \\$infile | samtools sort -o \\$name.filt.tmp.bam -\n      samtools mpileup -aa --max-depth 0 $bqfilter --min-MQ 1  -f indices/\\$tile/sequence.fasta   \\$name.filt.tmp.bam > \\$name.mpileup.txt\n      readstomper.pl \\$name.mpileup.txt > \\$name.mpileup.fractions.csv\n\n    done\n\n    \"\"\"\n}",
        "nb_lignes_process": 34,
        "string_script": "    bqfilter = params.bqfilter > 0 ? \"--min-BQ ${params.bqfilter}\" : '--no-BAQ'\n\n    \"\"\"\n    for infile in $bams; do\n      name=\\$(basename \\$infile | sed 's/.bam//')\n      tile=\\$(echo \\$infile | sed 's/__.*\\$//')\n\n      # filter bam\n      samtools view -@ $task.cpus -b -f 2 -F4 -F 0x0100  \\$infile | samtools sort -o \\$name.filt.tmp.bam -\n      samtools mpileup -aa --max-depth 0 $bqfilter --min-MQ 1  -f indices/\\$tile/sequence.fasta   \\$name.filt.tmp.bam > \\$name.mpileup.txt\n      readstomper.pl \\$name.mpileup.txt > \\$name.mpileup.fractions.csv\n\n    done\n\n    \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_aln2tile_bam_set",
            "ch_tile_indices"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aln2tile_fractions_consensus"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "tag \"$setname\"",
            "publishDir path: \"${params.outdirExt}/aln2tile\", mode: 'copy' , saveAs: {filename-> if (filename.lastIndexOf(\".mpileup\") > 0) \"mpileup/$filename\" else if (filename.lastIndexOf(\".csv\") > 0) \"mpileup2csv/$filename\" else null }"
        ],
        "when": "",
        "stub": ""
    },
    "aln2spike": {
        "name_process": "aln2spike",
        "string_process": " process aln2spike {\n\n      tag \"$bcset\"\n\n      input:\n      set val(bcset), file(reads) from ch_aln2spike_set\n      file index from ch_genome_indices\n\n      output:\n      set file(\"*bam\"), file(\"*flagstat\") optional true into ch_aln2spike_bam_log\n      file(\"*flagstat\") optional true into ch_aln2spike_multiqc\n\n      script:\n      \"\"\"\n      for infile in $reads; do\n        if [ \\$(wc -l \\$infile | cut -f 1 -d \" \") -ge \"${params.sample_minreads_fastq_paired}\" ]; then\n          name=\\$(basename \\$infile | sed 's/.R12.fastq//')\n          minimap2 -ax sr -t $task.cpus indices/sequence.mmi \\$infile | \\\\\n            samtools view -@ $task.cpus -b -h -F 0x0100 - | samtools sort -o \\$name.bam -\n          samtools index \\$name.bam\n          samtools flagstat -@ $task.cpus \\$name.bam > \\$name.flagstat\n        fi\n      done\n      \"\"\"\n  }",
        "nb_lignes_process": 23,
        "string_script": "      \"\"\"\n      for infile in $reads; do\n        if [ \\$(wc -l \\$infile | cut -f 1 -d \" \") -ge \"${params.sample_minreads_fastq_paired}\" ]; then\n          name=\\$(basename \\$infile | sed 's/.R12.fastq//')\n          minimap2 -ax sr -t $task.cpus indices/sequence.mmi \\$infile | \\\\\n            samtools view -@ $task.cpus -b -h -F 0x0100 - | samtools sort -o \\$name.bam -\n          samtools index \\$name.bam\n          samtools flagstat -@ $task.cpus \\$name.bam > \\$name.flagstat\n        fi\n      done\n      \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "Minimap2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/minimap2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Minimap2",
                "uri": "https://bio.tools/minimap2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0491",
                                    "term": "Pairwise sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0491",
                                    "term": "Pairwise alignment"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Pairwise aligner for genomic and spliced nucleotide sequences",
                "homepage": "https://github.com/lh3/minimap2"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_aln2spike_set",
            "ch_genome_indices"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aln2spike_bam_log",
            "ch_aln2spike_multiqc"
        ],
        "nb_outputs": 2,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "tag \"$bcset\""
        ],
        "when": "",
        "stub": ""
    },
    "aln2spike_multiqc": {
        "name_process": "aln2spike_multiqc",
        "string_process": " process aln2spike_multiqc {\n\n      publishDir path: \"${params.outdirExt}/QC/multiqc_aln2spike\", mode: 'copy'\n\n      input:\n      file \"*\" from ch_aln2spike_multiqc.collect()\n      file multiqc_config from ch_multiqc_config\n\n      output:\n      file \"*multiqc*\" into ch_aln2spike_multiqc_report\n\n      script:\n      \"\"\"\n      multiqc . -m samtools -n multiqc_aln2spike --config $multiqc_config\n      \"\"\"\n  }",
        "nb_lignes_process": 14,
        "string_script": "      \"\"\"\n      multiqc . -m samtools -n multiqc_aln2spike --config $multiqc_config\n      \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "ch_aln2spike_multiqc",
            "ch_multiqc_config"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_aln2spike_multiqc_report"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "publishDir path: \"${params.outdirExt}/QC/multiqc_aln2spike\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "aln2spike_ivar_mpile": {
        "name_process": "aln2spike_ivar_mpile",
        "string_process": " process aln2spike_ivar_mpile {\n\n      tag \"$bcset\"\n\n      publishDir path: \"${params.outdirExt}/aln2spike\", mode: 'copy',\n      saveAs: {filename->\n        if (filename.lastIndexOf(\".mpileup\") > 0) \"mpileup/$filename\"\n        else if (filename.lastIndexOf(\".csv\") > 0) \"mpileup2csv/$filename\"\n        else null\n      }\n\n      input:\n      set val(bcset), file (bams) from ch_aln2spike_bam_set\n      file index  from ch_genome_indices\n      file primerbed from ch_primerbed\n\n      output:\n      file(\"*fa\") optional true into ch_ivar_consensus\n      file(\"*fractions.csv\") optional true into ch_aln2spike_fractions_consensus\n\n      script:\n      \"\"\"\n      for infile in $bams; do\n        name=\\$(basename \\$infile | sed 's/.bam//')\n\n        # filter bam\n        samtools view -@ $task.cpus -b -f 2 -F4 -F 0x0100  \\$infile | samtools sort -o \\$name.filt.tmp.bam -\n\n        #  primer trim; excluding reads with no primers\n        ivar trim -b ${primerbed} -p \\$name.trim.tmp.bam -i \\$name.filt.tmp.bam\n        samtools sort -@ $task.cpus -o \\$name.trim.sort.tmp.bam -T \\$name  \\$name.trim.tmp.bam\n        samtools index \\$name.trim.sort.tmp.bam\n\n        # mpileup\n        samtools mpileup -aa --max-depth 0 --no-BAQ --min-MQ 1 -f indices/sequence.fasta \\$name.trim.sort.tmp.bam > \\$name.mpileup\n\n        # mpileup to table\n        readstomper.pl \\$name.mpileup > \\$name.mpileup.fractions.csv\n\n        # mpileup to consensus\n        cat \\$name.mpileup | ivar consensus  -t ${params.ivar_max_allele_freq} -m ${params.ivar_min_coverage}  -p \\$name.ivar.consensus.fa\n\n        header=\\$(head -n1 \\$name.ivar.consensus.fa | sed 's/>//g')\n        sed -i \"s/\\${header}/\\$name/g\" \\$name.ivar.consensus.fa\n\n        rm *tmp.bam\n      done\n      \"\"\"\n  }",
        "nb_lignes_process": 47,
        "string_script": "      \"\"\"\n      for infile in $bams; do\n        name=\\$(basename \\$infile | sed 's/.bam//')\n\n        # filter bam\n        samtools view -@ $task.cpus -b -f 2 -F4 -F 0x0100  \\$infile | samtools sort -o \\$name.filt.tmp.bam -\n\n        #  primer trim; excluding reads with no primers\n        ivar trim -b ${primerbed} -p \\$name.trim.tmp.bam -i \\$name.filt.tmp.bam\n        samtools sort -@ $task.cpus -o \\$name.trim.sort.tmp.bam -T \\$name  \\$name.trim.tmp.bam\n        samtools index \\$name.trim.sort.tmp.bam\n\n        # mpileup\n        samtools mpileup -aa --max-depth 0 --no-BAQ --min-MQ 1 -f indices/sequence.fasta \\$name.trim.sort.tmp.bam > \\$name.mpileup\n\n        # mpileup to table\n        readstomper.pl \\$name.mpileup > \\$name.mpileup.fractions.csv\n\n        # mpileup to consensus\n        cat \\$name.mpileup | ivar consensus  -t ${params.ivar_max_allele_freq} -m ${params.ivar_min_coverage}  -p \\$name.ivar.consensus.fa\n\n        header=\\$(head -n1 \\$name.ivar.consensus.fa | sed 's/>//g')\n        sed -i \"s/\\${header}/\\$name/g\" \\$name.ivar.consensus.fa\n\n        rm *tmp.bam\n      done\n      \"\"\"",
        "nb_lignes_script": 26,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "AIVAR"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/AIVAR"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "AIVAR",
                "uri": "https://bio.tools/AIVAR",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3474",
                            "term": "Machine learning"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Targeted exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "WES"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Whole exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome capture"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3461",
                                    "term": "Virulence prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Deposition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3225",
                                    "term": "Variant classification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3461",
                                    "term": "Pathogenicity prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Submission"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Data submission"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Database deposition"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Database submission"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3431",
                                    "term": "Data deposition"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Assessing concordance among human, in silico predictions and functional assays on genetic variant classification.",
                "homepage": "https://github.com/TopGene/AIvar"
            }
        ],
        "inputs": [
            "ch_aln2spike_bam_set",
            "ch_genome_indices",
            "ch_primerbed"
        ],
        "nb_inputs": 3,
        "outputs": [
            "ch_ivar_consensus",
            "ch_aln2spike_fractions_consensus"
        ],
        "nb_outputs": 2,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "tag \"$bcset\"",
            "publishDir path: \"${params.outdirExt}/aln2spike\", mode: 'copy' , saveAs: {filename-> if (filename.lastIndexOf(\".mpileup\") > 0) \"mpileup/$filename\" else if (filename.lastIndexOf(\".csv\") > 0) \"mpileup2csv/$filename\" else null }"
        ],
        "when": "",
        "stub": ""
    },
    "consensus_pangolin": {
        "name_process": "consensus_pangolin",
        "string_process": " process consensus_pangolin {\n      publishDir path: \"${params.outdirExt}/ivar.consensus.pangolin\", mode: 'copy'\n\n      input:\n      file \"*\" from ch_ivar_consensus.collect()\n\n      output:\n      file \"lineage_report.csv\" into ch_lineage\n      file \"ivar.consensus.fasta\"\n\n      script:\n      \"\"\"\n      # remove end Ns- for only N sequences will leave a single N\n      cat *fa | perl -pe 's/^N+/N/;s/N+\\$/N/' > ivar.consensus.fasta\n      pangolin -t $task.cpus --min-length 1000 ivar.consensus.fasta\n      \"\"\"\n  }",
        "nb_lignes_process": 15,
        "string_script": "      \"\"\"\n      # remove end Ns- for only N sequences will leave a single N\n      cat *fa | perl -pe 's/^N+/N/;s/N+\\$/N/' > ivar.consensus.fasta\n      pangolin -t $task.cpus --min-length 1000 ivar.consensus.fasta\n      \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_ivar_consensus"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_lineage"
        ],
        "nb_outputs": 1,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "publishDir path: \"${params.outdirExt}/ivar.consensus.pangolin\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "summarize": {
        "name_process": "summarize",
        "string_process": "\nprocess summarize {\n\n\n    publishDir path: \"${params.outdirExt}/\", mode: 'copy'\n\n\n    input:\n    file \"QC/multiqc_aln2spike/*\" from ch_aln2spike_multiqc_report\n    file \"QC/multiqc_aln2tile/*\" from ch_aln2tile_multiqc_report\n    file \"ReadInTile_mpileup/*\" from ch_aln2tile_fractions_consensus.collect()\n    file \"indices\" from ch_tile_indices\n    file spikeFa from ch_spikefa\n    file lineageF from ch_lineage\n    file sampleinfoF from ch_bc2sample\n\n\n    output:\n     file \"*xlsx\"\n     file \"*tsv\" optional true\n     file \"*fa\" optional true\n     file \"*rda\" optional true\n\n\n    script:\n    def outdir=\"results\"\n    \"\"\"\n    #!/usr/bin/env Rscript\n    spikeFa=\"${spikeFa}\"\n    lineageF=\"${lineageF}\"\n    sampleinfoF=\"${sampleinfoF}\"\n    minposcoverage=as.numeric(${params.min_poscoverage})\n\n\n\n    source(\"${baseDir}/bin/functions.R\")\n    source(\"${baseDir}/bin/summarize_aln2tile.R\")\n\n\n\n    \"\"\"\n}",
        "nb_lignes_process": 40,
        "string_script": "    def outdir=\"results\"\n    \"\"\"\n    #!/usr/bin/env Rscript\n    spikeFa=\"${spikeFa}\"\n    lineageF=\"${lineageF}\"\n    sampleinfoF=\"${sampleinfoF}\"\n    minposcoverage=as.numeric(${params.min_poscoverage})\n\n\n\n    source(\"${baseDir}/bin/functions.R\")\n    source(\"${baseDir}/bin/summarize_aln2tile.R\")\n\n\n\n    \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "Rscript",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_aln2spike_multiqc_report",
            "ch_aln2tile_multiqc_report",
            "ch_aln2tile_fractions_consensus",
            "ch_tile_indices",
            "ch_spikefa",
            "ch_lineage",
            "ch_bc2sample"
        ],
        "nb_inputs": 7,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "publishDir path: \"${params.outdirExt}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "checkContainer": {
        "name_process": "checkContainer",
        "string_process": "\nprocess checkContainer {\n\n    publishDir path: \"${params.outdirExt}/sw\", mode: 'copy'\n    cache false\n\n    output:\n    file \"*txt\"\n\n    script:\n    \"\"\"\n    set +u\n    if [ ! -z \\$SINGULARITY_CONTAINER ]; then\n      conda list --export > containerPackagelist.txt\n    fi\n    \"\"\"\n}",
        "nb_lignes_process": 15,
        "string_script": "    \"\"\"\n    set +u\n    if [ ! -z \\$SINGULARITY_CONTAINER ]; then\n      conda list --export > containerPackagelist.txt\n    fi\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "ANACONDA"
        ],
        "tools_url": [
            "https://bio.tools/anaconda"
        ],
        "tools_dico": [
            {
                "name": "ANACONDA",
                "uri": "https://bio.tools/anaconda",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Gene expression"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0203",
                            "term": "Expression"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3658",
                                    "term": "Statistical inference"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0436",
                                    "term": "Coding region prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2478",
                                    "term": "Nucleic acid sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0436",
                                    "term": "ORF prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0436",
                                    "term": "ORF finding"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2478",
                                    "term": "Sequence analysis (nucleic acid)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Software package specially developed for the study of genes\u2019 primary structure. It uses gene sequences downloaded from public databases, as FASTA and GenBank, and it applies a set of statistical and visualization methods in different ways, to reveal information about codon context, codon usage, nucleotide repeats within open reading frames (ORFeome) and others.",
                "homepage": "http://bioinformatics.ua.pt/software/anaconda/"
            }
        ],
        "inputs": [],
        "nb_inputs": 0,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "sarseq__sarseq2",
        "directive": [
            "publishDir path: \"${params.outdirExt}/sw\", mode: 'copy'",
            "cache false"
        ],
        "when": "",
        "stub": ""
    }
}