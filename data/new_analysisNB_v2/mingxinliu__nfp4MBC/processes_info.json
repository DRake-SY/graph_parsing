{
    "merge": {
        "name_process": "merge",
        "string_process": "\nprocess merge {\n\tpublishDir \"${workingdir}/output_${params.marker}_1.0_merged\", mode: \"copy\", overwrite: true\t\n\n\tinput:\n\tset sample_id, file (rawForward), file (rawReverse) from read_pairs\n\n\toutput:\n\tset sample_id, file (\"${sample_id}_merged.fastq\") into (merged_c1, merged_c2)\n\n\tscript:\n\t\"\"\"\n\tusearch -threads ${params.threads} -fastq_mergepairs $rawForward -fastqout ${sample_id}_merged.fastq\n\t\"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\t\"\"\"\n\tusearch -threads ${params.threads} -fastq_mergepairs $rawForward -fastqout ${sample_id}_merged.fastq\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "USEARCH"
        ],
        "tools_url": [
            "https://bio.tools/usearch"
        ],
        "tools_dico": [
            {
                "name": "USEARCH",
                "uri": "https://bio.tools/usearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Algorithm designed to enable high-throughput, sensitive search of very large sequence databases.",
                "homepage": "http://www.drive5.com/usearch/"
            }
        ],
        "inputs": [
            "read_pairs"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_1.0_merged\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_merged": {
        "name_process": "fastqc_merged",
        "string_process": "\nprocess fastqc_merged {\n\tpublishDir \"${workingdir}/output_${params.marker}_1.1_fastqc_merged\", mode: \"copy\", overwrite: true\n\t\n\tinput:\n\tset sample_id, file (in_merged_c1) from merged_c1\n\n\toutput:\n\tfile (\"${sample_id}_fastqc_merged\") into fastqc_merged\n\t\n\t\"\"\"\n\tmkdir ${sample_id}_fastqc_merged\n\tfastqc -t ${params.threads} -f fastq -q --casava $in_merged_c1 -o ${sample_id}_fastqc_merged\n\t\"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n\tmkdir ${sample_id}_fastqc_merged\n\tfastqc -t ${params.threads} -f fastq -q --casava $in_merged_c1 -o ${sample_id}_fastqc_merged\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "merged_c1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_merged"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_1.1_fastqc_merged\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc_merged": {
        "name_process": "multiqc_merged",
        "string_process": "\nprocess multiqc_merged {\n\tpublishDir \"${workingdir}/output_${params.marker}_1.2_multiqc_merged\", mode: \"copy\", overwrite: true\n\t\n\tinput:\n\tfile (\"*\") from fastqc_merged.collect().ifEmpty([])\n\n\toutput:\n\tfile (\"multiqc_report.html\")\n\tfile \"multiqc_data\"\t\n\n\t\"\"\"\n\tmultiqc .\n\t\"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n\tmultiqc .\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "fastqc_merged"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_1.2_multiqc_merged\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "cutadapters": {
        "name_process": "cutadapters",
        "string_process": "\nprocess cutadapters {\n\tpublishDir \"${workingdir}/output_${params.marker}_2.0_cutadatpers\", mode: \"copy\", overwrite: true\t\n\n\tinput:\n\tset sample_id, file (in_merged_c2) from merged_c2\n\n\toutput:\n\tset sample_id, file (\"${sample_id}_adapters_trimmed.fastq\") into (adapters_trimmed_c1, adapters_trimmed_c2)\n\tset sample_id, file (\"${sample_id}_adapters_untrimmed.fastq\")\n\t\n\t\"\"\"\n\tcutadapt -a file:$PWD/adapters_${params.marker}/${sample_id}_adapters.fasta -o ${sample_id}_adapters_trimmed.fastq --untrimmed-o ${sample_id}_adapters_untrimmed.fastq $in_merged_c2\n\t\"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n\tcutadapt -a file:$PWD/adapters_${params.marker}/${sample_id}_adapters.fasta -o ${sample_id}_adapters_trimmed.fastq --untrimmed-o ${sample_id}_adapters_untrimmed.fastq $in_merged_c2\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "Cutadapt"
        ],
        "tools_url": [
            "https://bio.tools/cutadapt"
        ],
        "tools_dico": [
            {
                "name": "Cutadapt",
                "uri": "https://bio.tools/cutadapt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0632",
                            "term": "Probes and primers"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ]
                    }
                ],
                "description": "Find and remove adapter sequences, primers, poly-A tails and other types of unwanted sequence from your high-throughput sequencing reads.",
                "homepage": "https://pypi.python.org/pypi/cutadapt"
            }
        ],
        "inputs": [
            "merged_c2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            "sample_id"
        ],
        "nb_outputs": 2,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_2.0_cutadatpers\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_cutadapters": {
        "name_process": "fastqc_cutadapters",
        "string_process": "\nprocess fastqc_cutadapters {\n        publishDir \"${workingdir}/output_${params.marker}_2.1_fastqc_cutadapters\", mode: \"copy\", overwrite: true\n\n        input:\n        set sample_id, file (in_adapters_trimmed_c1) from adapters_trimmed_c1\n\n        output:\n        file (\"${sample_id}_fastqc_cutadapters\") into fastqc_cutadapters\n\n        \"\"\"\n        mkdir ${sample_id}_fastqc_cutadapters\n        fastqc -t ${params.threads} -f fastq -q --casava $in_adapters_trimmed_c1 -o ${sample_id}_fastqc_cutadapters\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        mkdir ${sample_id}_fastqc_cutadapters\n        fastqc -t ${params.threads} -f fastq -q --casava $in_adapters_trimmed_c1 -o ${sample_id}_fastqc_cutadapters\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "adapters_trimmed_c1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_cutadapters"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_2.1_fastqc_cutadapters\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc_cutadapters": {
        "name_process": "multiqc_cutadapters",
        "string_process": "\nprocess multiqc_cutadapters {\n        publishDir \"${workingdir}/output_${params.marker}_2.2_multiqc_cutadapters\", mode: \"copy\", overwrite: true\n\n        input:\n        file (\"*\") from fastqc_cutadapters.collect().ifEmpty([])\n\n        output:\n        file (\"multiqc_report.html\")\n\t   file \"multiqc_data\"\n\n        \"\"\"\n        multiqc .\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        multiqc .\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "fastqc_cutadapters"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_2.2_multiqc_cutadapters\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "cutprimers": {
        "name_process": "cutprimers",
        "string_process": "\nprocess cutprimers {\n\tpublishDir \"${workingdir}/output_${params.marker}_3.0_cutprimers\", mode: \"copy\", overwirte: true\n\n\tinput:\n\tset sample_id, file (in_adapters_trimmed_c2) from adapters_trimmed_c2\n\n\toutput:\n\tset sample_id, file (\"${sample_id}_primers_trimmed.fastq\") into (primers_trimmed_c1, primers_trimmed_c2)\n\tset sample_id, file (\"${sample_id}_primers_untrimmed.fastq\")\n\n\tscript:\n\tif (params.marker == \"CO1\")\n\t\t\"\"\"\n\t\tcutadapt --no-indels -M ${params.M} -m ${params.m} -a \"AGATATTGGAACWTTATATTTTATTTTTGG;max_error_rate=0.04;min_overlap=29\"...\"GGAGGATTTGGWAATTGATTAGTW\\$;max_error_rate=0.1;min_overlap=22\" -o ${sample_id}_primers_trimmed.fastq --untrimmed-o ${sample_id}_primers_untrimmed.fastq $in_adapters_trimmed_c2\n\t\t\"\"\"\n\n\telse if ( params.marker == \"16S\")\n\t\t\"\"\"\n\t\tcutadapt --no-indels -M ${params.M} -m ${params.m} -a \"AGACGAGAAGACCCTATAGA;max_error_rate=0.05;min_overlap=19\"...\"TACCTTAGGGATAACAGCGTA\\$;max_error_rate=0.05;min_overlap=20;\" -o ${sample_id}_primers_trimmed.fastq --untrimmed-o ${sample_id}_primers_untrimmed.fastq $in_adapters_trimmed_c2\n\t\t\"\"\"\n\n\telse\n\t\terror \"Invalid marker!\"\n}",
        "nb_lignes_process": 23,
        "string_script": "\tif (params.marker == \"CO1\")\n\t\t\"\"\"\n\t\tcutadapt --no-indels -M ${params.M} -m ${params.m} -a \"AGATATTGGAACWTTATATTTTATTTTTGG;max_error_rate=0.04;min_overlap=29\"...\"GGAGGATTTGGWAATTGATTAGTW\\$;max_error_rate=0.1;min_overlap=22\" -o ${sample_id}_primers_trimmed.fastq --untrimmed-o ${sample_id}_primers_untrimmed.fastq $in_adapters_trimmed_c2\n\t\t\"\"\"\n\n\telse if ( params.marker == \"16S\")\n\t\t\"\"\"\n\t\tcutadapt --no-indels -M ${params.M} -m ${params.m} -a \"AGACGAGAAGACCCTATAGA;max_error_rate=0.05;min_overlap=19\"...\"TACCTTAGGGATAACAGCGTA\\$;max_error_rate=0.05;min_overlap=20;\" -o ${sample_id}_primers_trimmed.fastq --untrimmed-o ${sample_id}_primers_untrimmed.fastq $in_adapters_trimmed_c2\n\t\t\"\"\"\n\n\telse\n\t\terror \"Invalid marker!\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "Cutadapt"
        ],
        "tools_url": [
            "https://bio.tools/cutadapt"
        ],
        "tools_dico": [
            {
                "name": "Cutadapt",
                "uri": "https://bio.tools/cutadapt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0632",
                            "term": "Probes and primers"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3495",
                                "term": "RNA sequence"
                            }
                        ]
                    }
                ],
                "description": "Find and remove adapter sequences, primers, poly-A tails and other types of unwanted sequence from your high-throughput sequencing reads.",
                "homepage": "https://pypi.python.org/pypi/cutadapt"
            }
        ],
        "inputs": [
            "adapters_trimmed_c2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            "sample_id"
        ],
        "nb_outputs": 2,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_3.0_cutprimers\", mode: \"copy\", overwirte: true"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_cutprimers": {
        "name_process": "fastqc_cutprimers",
        "string_process": "\nprocess fastqc_cutprimers {\n        publishDir \"${workingdir}/output_${params.marker}_3.1_fastqc_cutprimers\", mode: \"copy\", overwrite: true\n\n        input:\n        set sample_id, file (in_primers_trimmed_c1) from primers_trimmed_c1\n\n        output:\n        file (\"${sample_id}_fastqc_cutprimers\") into fastqc_cutprimers\n\n        \"\"\"\n        mkdir ${sample_id}_fastqc_cutprimers\n        fastqc -t ${params.threads} -f fastq -q --casava $in_primers_trimmed_c1 -o ${sample_id}_fastqc_cutprimers\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        mkdir ${sample_id}_fastqc_cutprimers\n        fastqc -t ${params.threads} -f fastq -q --casava $in_primers_trimmed_c1 -o ${sample_id}_fastqc_cutprimers\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "primers_trimmed_c1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_cutprimers"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_3.1_fastqc_cutprimers\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc_cutprimers": {
        "name_process": "multiqc_cutprimers",
        "string_process": "\nprocess multiqc_cutprimers {\n        publishDir \"${workingdir}/output_${params.marker}_3.2_multiqc_cutprimers\", mode: \"copy\", overwrite: true\n\n        input:\n        file (\"*\") from fastqc_cutprimers.collect().ifEmpty([])\n\n        output:\n        file (\"multiqc_report.html\")\n\tfile \"multiqc_data\"\n\n        \"\"\"\n        multiqc .\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        multiqc .\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "fastqc_cutprimers"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_3.2_multiqc_cutprimers\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "filter": {
        "name_process": "filter",
        "string_process": "\nprocess filter {\n\tpublishDir \"${workingdir}/output_${params.marker}_4.0_filtered\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tset sample_id, file (in_primers_trimmed_c2) from primers_trimmed_c2\n\n\toutput:\n\tfile (\"${sample_id}_filtered.fasta\") into (filtered_fasta_c1, filtered_fasta_c2, filtered_fasta_c3)\n\tset sample_id, file (\"${sample_id}_filtered.fastq\") into filtered_fastq_c1\n\t\n\t\"\"\"\n\tusearch -threads ${params.threads} -fastq_filter $in_primers_trimmed_c2 -fastq_maxee 1.0 -fastaout ${sample_id}_filtered.fasta -fastqout ${sample_id}_filtered.fastq -relabel @\n\t\"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n\tusearch -threads ${params.threads} -fastq_filter $in_primers_trimmed_c2 -fastq_maxee 1.0 -fastaout ${sample_id}_filtered.fasta -fastqout ${sample_id}_filtered.fastq -relabel @\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "USEARCH"
        ],
        "tools_url": [
            "https://bio.tools/usearch"
        ],
        "tools_dico": [
            {
                "name": "USEARCH",
                "uri": "https://bio.tools/usearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Algorithm designed to enable high-throughput, sensitive search of very large sequence databases.",
                "homepage": "http://www.drive5.com/usearch/"
            }
        ],
        "inputs": [
            "primers_trimmed_c2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            "filtered_fastq_c1"
        ],
        "nb_outputs": 2,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_4.0_filtered\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_filtered": {
        "name_process": "fastqc_filtered",
        "string_process": "\nprocess fastqc_filtered {\n        publishDir \"${workingdir}/output_${params.marker}_4.1_fastqc_filtered\", mode: \"copy\", overwrite: true\n\n        input:\n        set sample_id, file (in_filtered_fastq_c1) from filtered_fastq_c1\n\n        output:\n        file (\"${sample_id}_fastqc_filtered\") into fastqc_filtered\n\n        \"\"\"\n        mkdir ${sample_id}_fastqc_filtered\n        fastqc -t ${params.threads} -f fastq -q --casava $in_filtered_fastq_c1 -o ${sample_id}_fastqc_filtered\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        mkdir ${sample_id}_fastqc_filtered\n        fastqc -t ${params.threads} -f fastq -q --casava $in_filtered_fastq_c1 -o ${sample_id}_fastqc_filtered\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "filtered_fastq_c1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_filtered"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_4.1_fastqc_filtered\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "multiqc_filtered": {
        "name_process": "multiqc_filtered",
        "string_process": "\nprocess multiqc_filtered {\n        publishDir \"${workingdir}/output_${params.marker}_4.2_multiqc_filtered\", mode: \"copy\", overwrite: true\n\n        input:\n        file (\"*\") from fastqc_filtered.collect().ifEmpty([])\n\n        output:\n        file (\"multiqc_report.html\")\n\tfile \"multiqc_data\"\n\n        \"\"\"\n        multiqc .\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n        multiqc .\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "fastqc_filtered"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_4.2_multiqc_filtered\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "uniques": {
        "name_process": "uniques",
        "string_process": "\nprocess uniques {\n\tpublishDir \"${workingdir}/output_${params.marker}_5.0_uniques\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"*.filtered.fasta\") from filtered_fasta_c1.toList()\n\n\toutput:\n\tfile (\"uniques_${params.marker}.fasta\") into (all_uniques)\n\t\n\t\"\"\"\n\tcat *.filtered.fasta > all_filtered.fasta\n\tusearch -fastx_uniques all_filtered.fasta -fastaout uniques_${params.marker}.fasta -relabel Uniq -sizeout -minuniquesize 2 -threads ${params.threads}\n\t\"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "\"\"\"\n\tcat *.filtered.fasta > all_filtered.fasta\n\tusearch -fastx_uniques all_filtered.fasta -fastaout uniques_${params.marker}.fasta -relabel Uniq -sizeout -minuniquesize 2 -threads ${params.threads}\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "USEARCH"
        ],
        "tools_url": [
            "https://bio.tools/usearch"
        ],
        "tools_dico": [
            {
                "name": "USEARCH",
                "uri": "https://bio.tools/usearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Algorithm designed to enable high-throughput, sensitive search of very large sequence databases.",
                "homepage": "http://www.drive5.com/usearch/"
            }
        ],
        "inputs": [
            "filtered_fasta_c1"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_5.0_uniques\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "cluster": {
        "name_process": "cluster",
        "string_process": "\nprocess cluster {\n\tpublishDir \"${workingdir}/output_${params.marker}_6.0_clustered\", mode: \"copy\", overwrite: true\n\t\n\tinput:\n\tfile (\"uniques_${params.marker}.fasta\") from all_uniques\n\n\toutput:\n\tfile (\"zotus_${params.marker}.fasta\") into (zotus_rep1, zotus_rep2, zotus_rep3, zotus_rep4, zotus_rep5)\n\n\tscript:\n\tif(params.cluster == 'usearch')\n\t\"\"\"\n\tusearch -unoise3 uniques_${params.marker}.fasta -zotus zotus_${params.marker}.fasta -tabbedout zotus_${params.marker}.txt\n\t\"\"\"\n\n\telse if(params.cluster == 'vsearch')\n\t\"\"\"\n\tvsearch --cluster_unoise uniques_${params.marker}.fasta --centroids zotus_${params.marker}.fasta  --threads ${params.threads}\n\t\"\"\"\n\n\telse\n\terror \"Invalid clustring mode: ${mode}\"\n}",
        "nb_lignes_process": 22,
        "string_script": "\tif(params.cluster == 'usearch')\n\t\"\"\"\n\tusearch -unoise3 uniques_${params.marker}.fasta -zotus zotus_${params.marker}.fasta -tabbedout zotus_${params.marker}.txt\n\t\"\"\"\n\n\telse if(params.cluster == 'vsearch')\n\t\"\"\"\n\tvsearch --cluster_unoise uniques_${params.marker}.fasta --centroids zotus_${params.marker}.fasta  --threads ${params.threads}\n\t\"\"\"\n\n\telse\n\terror \"Invalid clustring mode: ${mode}\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "USEARCH",
            "VSEARCH"
        ],
        "tools_url": [
            "https://bio.tools/usearch",
            "https://bio.tools/vsearch"
        ],
        "tools_dico": [
            {
                "name": "USEARCH",
                "uri": "https://bio.tools/usearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Algorithm designed to enable high-throughput, sensitive search of very large sequence databases.",
                "homepage": "http://www.drive5.com/usearch/"
            },
            {
                "name": "VSEARCH",
                "uri": "https://bio.tools/vsearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3174",
                            "term": "Metagenomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2520",
                                    "term": "DNA mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0450",
                                    "term": "Chimera detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0450",
                                    "term": "Chimeric sequence detection"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2977",
                                "term": "Nucleic acid sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_0865",
                                "term": "Sequence similarity score"
                            }
                        ]
                    }
                ],
                "description": "High-throughput search and clustering sequence analysis tool. It supports de novo and reference based chimera detection, clustering, full-length and prefix dereplication, reverse complementation, masking, all-vs-all pairwise global alignment, exact and global alignment searching, shuffling, subsampling and sorting. It also supports FASTQ file analysis, filtering and conversion.",
                "homepage": "https://github.com/torognes/vsearch"
            }
        ],
        "inputs": [
            "all_uniques"
        ],
        "nb_inputs": 1,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_6.0_clustered\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "zotutab_CO1": {
        "name_process": "zotutab_CO1",
        "string_process": "\nprocess zotutab_CO1 {\n\tpublishDir \"${workingdir}/output_${params.marker}_7.0_otutab\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"*.filtered.fasta\") from filtered_fasta_c2.toList()\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep1\n\n\toutput:\n\tfile (\"zotutab_${params.marker}.txt\") into zotutab_CO1\n\n\twhen:\n\t!params.skip\t\n\n\t\"\"\"\n\tcat *.filtered.fasta > all_filtered.fasta\n\tusearch -otutab all_filtered.fasta -sample_delim . -zotus zotus_${params.marker}.fasta -id 0.97 -otutabout zotutab_${params.marker}.txt -threads ${params.threads}\n\t\"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n\tcat *.filtered.fasta > all_filtered.fasta\n\tusearch -otutab all_filtered.fasta -sample_delim . -zotus zotus_${params.marker}.fasta -id 0.97 -otutabout zotutab_${params.marker}.txt -threads ${params.threads}\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "USEARCH"
        ],
        "tools_url": [
            "https://bio.tools/usearch"
        ],
        "tools_dico": [
            {
                "name": "USEARCH",
                "uri": "https://bio.tools/usearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Algorithm designed to enable high-throughput, sensitive search of very large sequence databases.",
                "homepage": "http://www.drive5.com/usearch/"
            }
        ],
        "inputs": [
            "filtered_fasta_c2",
            "zotus_rep1"
        ],
        "nb_inputs": 2,
        "outputs": [
            "zotutab_CO1"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_7.0_otutab\", mode: \"copy\", overwrite: true"
        ],
        "when": "!params.skip",
        "stub": ""
    },
    "zotutab_16S": {
        "name_process": "zotutab_16S",
        "string_process": "\nprocess zotutab_16S {\n\tpublishDir \"${workingdir}/output_${params.marker}_7.0_otutab\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"*.filtered.fasta\") from filtered_fasta_c3.toList()\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep1\n\n\toutput:\n\tfile (\"zotutab_${params.marker}.txt\") into zotutab_16S\n\n\twhen:\n\tparams.skip\t\n\n\t\"\"\"\n\tcat *.filtered.fasta > all_filtered.fasta\n\tusearch -otutab all_filtered.fasta -sample_delim . -zotus zotus_${params.marker}.fasta -id 0.97 -otutabout zotutab_${params.marker}.txt -threads ${params.threads}\n\t\"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n\tcat *.filtered.fasta > all_filtered.fasta\n\tusearch -otutab all_filtered.fasta -sample_delim . -zotus zotus_${params.marker}.fasta -id 0.97 -otutabout zotutab_${params.marker}.txt -threads ${params.threads}\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "USEARCH"
        ],
        "tools_url": [
            "https://bio.tools/usearch"
        ],
        "tools_dico": [
            {
                "name": "USEARCH",
                "uri": "https://bio.tools/usearch",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Algorithm designed to enable high-throughput, sensitive search of very large sequence databases.",
                "homepage": "http://www.drive5.com/usearch/"
            }
        ],
        "inputs": [
            "filtered_fasta_c3",
            "zotus_rep1"
        ],
        "nb_inputs": 2,
        "outputs": [
            "zotutab_16S"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_7.0_otutab\", mode: \"copy\", overwrite: true"
        ],
        "when": "params.skip",
        "stub": ""
    },
    "matchlist_CO1": {
        "name_process": "matchlist_CO1",
        "string_process": "\nprocess matchlist_CO1 {\n\tpublishDir \"${workingdir}/output_${params.marker}_8.0_matchlist\", mode: \"copy\"\n\n\tinput:\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep2\n\n\toutput:\n\tfile (\"matchlist_${params.marker}.txt\") into matchlist_CO1\n\n\twhen:\n\t!params.skip\n\n\t\"\"\"\n\tmakeblastdb -in zotus_${params.marker}.fasta -parse_seqids -dbtype nucl\t\n\tblastn -db zotus_${params.marker}.fasta -outfmt '6 qseqid sseqid pident' -out matchlist_${params.marker}.txt -qcov_hsp_perc 80 -perc_identity 84 -query zotus_${params.marker}.fasta\n\t\"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "\"\"\"\n\tmakeblastdb -in zotus_${params.marker}.fasta -parse_seqids -dbtype nucl\t\n\tblastn -db zotus_${params.marker}.fasta -outfmt '6 qseqid sseqid pident' -out matchlist_${params.marker}.txt -qcov_hsp_perc 80 -perc_identity 84 -query zotus_${params.marker}.fasta\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "G-BLASTN"
        ],
        "tools_url": [
            "https://bio.tools/g-blastn"
        ],
        "tools_dico": [
            {
                "name": "G-BLASTN",
                "uri": "https://bio.tools/g-blastn",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acids"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0346",
                                    "term": "Sequence similarity search"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2976",
                                "term": "Protein sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0857",
                                "term": "Sequence search results"
                            }
                        ]
                    }
                ],
                "description": "GPU-accelerated nucleotide alignment tool based on the widely used NCBI-BLAST.",
                "homepage": "http://www.comp.hkbu.edu.hk/~chxw/software/G-BLASTN.html"
            }
        ],
        "inputs": [
            "zotus_rep2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "matchlist_CO1"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_8.0_matchlist\", mode: \"copy\""
        ],
        "when": "!params.skip",
        "stub": ""
    },
    "matchlist_16S": {
        "name_process": "matchlist_16S",
        "string_process": "\nprocess matchlist_16S {\n\tpublishDir \"${workingdir}/output_${params.marker}_8.0_matchlist\", mode: \"copy\"\n\n\tinput:\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep2\n\n\toutput:\n\tfile (\"matchlist_${params.marker}.txt\") into matchlist_16S\n\n\twhen:\n\tparams.skip\n\n\t\"\"\"\n\tmakeblastdb -in zotus_${params.marker}.fasta -parse_seqids -dbtype nucl\t\n\tblastn -db zotus_${params.marker}.fasta -outfmt '6 qseqid sseqid pident' -out matchlist_${params.marker}.txt -qcov_hsp_perc 80 -perc_identity 84 -query zotus_${params.marker}.fasta\n\t\"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "\"\"\"\n\tmakeblastdb -in zotus_${params.marker}.fasta -parse_seqids -dbtype nucl\t\n\tblastn -db zotus_${params.marker}.fasta -outfmt '6 qseqid sseqid pident' -out matchlist_${params.marker}.txt -qcov_hsp_perc 80 -perc_identity 84 -query zotus_${params.marker}.fasta\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "G-BLASTN"
        ],
        "tools_url": [
            "https://bio.tools/g-blastn"
        ],
        "tools_dico": [
            {
                "name": "G-BLASTN",
                "uri": "https://bio.tools/g-blastn",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acids"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0346",
                                    "term": "Sequence similarity search"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2976",
                                "term": "Protein sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0857",
                                "term": "Sequence search results"
                            }
                        ]
                    }
                ],
                "description": "GPU-accelerated nucleotide alignment tool based on the widely used NCBI-BLAST.",
                "homepage": "http://www.comp.hkbu.edu.hk/~chxw/software/G-BLASTN.html"
            }
        ],
        "inputs": [
            "zotus_rep2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "matchlist_16S"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_8.0_matchlist\", mode: \"copy\""
        ],
        "when": "params.skip",
        "stub": ""
    },
    "lulu_CO1": {
        "name_process": "lulu_CO1",
        "string_process": "\nprocess lulu_CO1 {\n\tpublishDir \"${workingdir}/output_${params.marker}_9.0_lulu\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"zotutab_${params.marker}.txt\") from zotutab_CO1\n\tfile (\"matchlist_${params.marker}.txt\") from matchlist_CO1\n\n\toutput:\n\tfile (\"zotus_lulu_${params.marker}.txt\") into zotus_lulu_CO1\n\tfile (\"zotutab_lulu_${params.marker}.csv\") into zotutab_lulu_CO1\n\n\t\"\"\"\n\tRscript --vanilla $PWD/lulu_CO1.R zotutab_${params.marker}.txt matchlist_${params.marker}.txt zotus_lulu_${params.marker}.txt zotutab_lulu_${params.marker}.csv\n\t\"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "\"\"\"\n\tRscript --vanilla $PWD/lulu_CO1.R zotutab_${params.marker}.txt matchlist_${params.marker}.txt zotus_lulu_${params.marker}.txt zotutab_lulu_${params.marker}.csv\n\t\"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "zotutab_CO1",
            "matchlist_CO1"
        ],
        "nb_inputs": 2,
        "outputs": [
            "zotus_lulu_CO1",
            "zotutab_lulu_CO1"
        ],
        "nb_outputs": 2,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_9.0_lulu\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "lulu_16S": {
        "name_process": "lulu_16S",
        "string_process": "\nprocess lulu_16S {\n        publishDir \"${workingdir}/output_${params.marker}_9.0_lulu\", mode: \"copy\", overwrite: true\n\n        input:\n        file (\"zotutab_${params.marker}.txt\") from zotutab_16S\n        file (\"matchlist_${params.marker}.txt\") from matchlist_16S\n\n        output:\n        file (\"zotus_lulu_${params.marker}.txt\") into zotus_lulu_16S\n        file \"zotutab_lulu_${params.marker}.csv\"\n\n        \"\"\"\n        Rscript --vanilla $PWD/lulu_CO1.R zotutab_${params.marker}.txt matchlist_${params.marker}.txt zotus_lulu_${params.marker}.txt zotutab_lulu_${params.marker}.csv\n        \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "\"\"\"\n        Rscript --vanilla $PWD/lulu_CO1.R zotutab_${params.marker}.txt matchlist_${params.marker}.txt zotus_lulu_${params.marker}.txt zotutab_lulu_${params.marker}.csv\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "zotutab_16S",
            "matchlist_16S"
        ],
        "nb_inputs": 2,
        "outputs": [
            "zotus_lulu_16S"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_9.0_lulu\", mode: \"copy\", overwrite: true"
        ],
        "when": "",
        "stub": ""
    },
    "blastn_16S": {
        "name_process": "blastn_16S",
        "string_process": "\nprocess blastn_16S {\n\tpublishDir \"${workingdir}/output_${params.marker}_10.0_blastn\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"zotus_lulu_id.txt\") from zotus_lulu_16S\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep3\n\t\n\toutput:\n\tfile (\"zotus_lulu_blastn_${params.marker}.txt\")\t\n\t\n\twhen:\n\tparams.skip\n\n\t\"\"\"\n\tgrep \"Zotu\" zotus_lulu_id.txt | sed 's/^.*Z/Z/' | sed 's/\\\"//' > lulu_ids.txt\n\tseqtk subseq zotus_${params.marker}.fasta lulu_ids.txt > zotus_lulu.fasta\n\tblastn -db $PWD/database/Coleoptera_COI_db -query zotus_lulu.fasta -evalue 1e-4 -outfmt 5 -max_target_seqs 50 -out zotus_lulu_blastn_${params.marker}.txt -num_threads ${params.threads}\n\t\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n\tgrep \"Zotu\" zotus_lulu_id.txt | sed 's/^.*Z/Z/' | sed 's/\\\"//' > lulu_ids.txt\n\tseqtk subseq zotus_${params.marker}.fasta lulu_ids.txt > zotus_lulu.fasta\n\tblastn -db $PWD/database/Coleoptera_COI_db -query zotus_lulu.fasta -evalue 1e-4 -outfmt 5 -max_target_seqs 50 -out zotus_lulu_blastn_${params.marker}.txt -num_threads ${params.threads}\n\t\"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "seqtk",
            "G-BLASTN"
        ],
        "tools_url": [
            "https://bio.tools/seqtk",
            "https://bio.tools/g-blastn"
        ],
        "tools_dico": [
            {
                "name": "seqtk",
                "uri": "https://bio.tools/seqtk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool for processing sequences in the FASTA or FASTQ format. It parses both FASTA and FASTQ files which can also be optionally compressed by gzip.",
                "homepage": "https://github.com/lh3/seqtk"
            },
            {
                "name": "G-BLASTN",
                "uri": "https://bio.tools/g-blastn",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acids"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0346",
                                    "term": "Sequence similarity search"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2976",
                                "term": "Protein sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0857",
                                "term": "Sequence search results"
                            }
                        ]
                    }
                ],
                "description": "GPU-accelerated nucleotide alignment tool based on the widely used NCBI-BLAST.",
                "homepage": "http://www.comp.hkbu.edu.hk/~chxw/software/G-BLASTN.html"
            }
        ],
        "inputs": [
            "zotus_lulu_16S",
            "zotus_rep3"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_10.0_blastn\", mode: \"copy\", overwrite: true"
        ],
        "when": "params.skip",
        "stub": ""
    },
    "translate_CO1": {
        "name_process": "translate_CO1",
        "string_process": "\nprocess translate_CO1 {\n\tpublishDir \"${workingdir}/output_${params.marker}_10.1_translate\", mode: \"copy\", overwrite: true\n\tframe = ['1', '2', '3']\t\n\n\tinput:\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep3\n\teach codon from frame\t\n\t\n\toutput:\n\tfile (\"${codon}.txt\") into header\n\t\n\twhen:\n\t!params.skip\t\n\n\t\"\"\"\n\tseqkit translate -T 5 -f ${codon} zotus_${params.marker}.fasta > zotus_${params.marker}_AA${codon}.fasta\n\tgrep -B1 \\\\* zotus_${params.marker}_AA${codon}.fasta | grep -vFf - zotus_${params.marker}_AA${codon}.fasta | sed 's/_frame=${codon}//' | awk 'sub(/^>/, \"\")' > ${codon}.txt\n\t\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n\tseqkit translate -T 5 -f ${codon} zotus_${params.marker}.fasta > zotus_${params.marker}_AA${codon}.fasta\n\tgrep -B1 \\\\* zotus_${params.marker}_AA${codon}.fasta | grep -vFf - zotus_${params.marker}_AA${codon}.fasta | sed 's/_frame=${codon}//' | awk 'sub(/^>/, \"\")' > ${codon}.txt\n\t\"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "zotus_rep3",
            "frame"
        ],
        "nb_inputs": 2,
        "outputs": [
            "header"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_10.1_translate\", mode: \"copy\", overwrite: true frame = ['1', '2', '3']"
        ],
        "when": "!params.skip",
        "stub": ""
    },
    "nostopcodon_CO1": {
        "name_process": "nostopcodon_CO1",
        "string_process": "\nprocess nostopcodon_CO1 {\n\tpublishDir \"${workingdir}/output_${params.marker}_10.2_nostopcodon\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep4\n\tfile (\"*.txt\") from header.toList()\n\t\t\n\toutput:\n\tfile (\"zotus_${params.marker}_codon.fasta\") into zotus_codon\n\n\twhen:\n\t!params.skip\n\n\t\"\"\"\n\tcat *.txt > names.txt\n\tseqtk subseq zotus_${params.marker}.fasta names.txt > subseq.fasta\t\t\n\tseqkit rmdup -n subseq.fasta -o zotus_${params.marker}_codon.fasta \n\t\"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n\tcat *.txt > names.txt\n\tseqtk subseq zotus_${params.marker}.fasta names.txt > subseq.fasta\t\t\n\tseqkit rmdup -n subseq.fasta -o zotus_${params.marker}_codon.fasta \n\t\"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "seqtk"
        ],
        "tools_url": [
            "https://bio.tools/seqtk"
        ],
        "tools_dico": [
            {
                "name": "seqtk",
                "uri": "https://bio.tools/seqtk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool for processing sequences in the FASTA or FASTQ format. It parses both FASTA and FASTQ files which can also be optionally compressed by gzip.",
                "homepage": "https://github.com/lh3/seqtk"
            }
        ],
        "inputs": [
            "zotus_rep4",
            "header"
        ],
        "nb_inputs": 2,
        "outputs": [
            "zotus_codon"
        ],
        "nb_outputs": 1,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_10.2_nostopcodon\", mode: \"copy\", overwrite: true"
        ],
        "when": "!params.skip",
        "stub": ""
    },
    "commonzotus_CO1": {
        "name_process": "commonzotus_CO1",
        "string_process": "\nprocess commonzotus_CO1 {\n\tpublishDir \"${workingdir}/output_${params.marker}_11.0_commonzotus\", mode: \"copy\", overwrite: true\n\n\tinput:\n\tfile (\"zotus_${params.marker}.fasta\") from zotus_rep5\n\tfile (\"zotus_lulu_${params.marker}.txt\") from zotus_lulu_CO1\n\tfile (\"zotus_${params.marker}_codon.fasta\") from zotus_codon\n\n\toutput:\n\tfile (\"zotus_lulu_${params.marker}.fasta\") into zotus_lulu\n\tfile (\"zotus_common_${params.marker}.fasta\") into zotus_common\n\tfile (\"zotus_common_blastn_${params.marker}.txt\")\n\n\twhen:\n\t!params.skip\n\n\t\"\"\"\n\tgrep \"Zotu\" zotus_lulu_${params.marker}.txt | sed 's/^.*Z/Z/' | sed 's/\\\"//' > lulu_ids.txt\n\tseqtk subseq zotus_${params.marker}.fasta lulu_ids.txt > zotus_lulu_${params.marker}.fasta\n\tseqkit common zotus_lulu_${params.marker}.fasta zotus_${params.marker}_codon.fasta -o zotus_common_${params.marker}.fasta\n\tblastn -db $PWD/database/Coleoptera_COI_db -query zotus_common_${params.marker}.fasta -evalue 1e-4 -outfmt 5 -max_target_seqs 50 -out zotus_common_blastn_${params.marker}.txt -num_threads ${params.threads}\n\t\"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "\"\"\"\n\tgrep \"Zotu\" zotus_lulu_${params.marker}.txt | sed 's/^.*Z/Z/' | sed 's/\\\"//' > lulu_ids.txt\n\tseqtk subseq zotus_${params.marker}.fasta lulu_ids.txt > zotus_lulu_${params.marker}.fasta\n\tseqkit common zotus_lulu_${params.marker}.fasta zotus_${params.marker}_codon.fasta -o zotus_common_${params.marker}.fasta\n\tblastn -db $PWD/database/Coleoptera_COI_db -query zotus_common_${params.marker}.fasta -evalue 1e-4 -outfmt 5 -max_target_seqs 50 -out zotus_common_blastn_${params.marker}.txt -num_threads ${params.threads}\n\t\"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "seqtk",
            "G-BLASTN"
        ],
        "tools_url": [
            "https://bio.tools/seqtk",
            "https://bio.tools/g-blastn"
        ],
        "tools_dico": [
            {
                "name": "seqtk",
                "uri": "https://bio.tools/seqtk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool for processing sequences in the FASTA or FASTQ format. It parses both FASTA and FASTQ files which can also be optionally compressed by gzip.",
                "homepage": "https://github.com/lh3/seqtk"
            },
            {
                "name": "G-BLASTN",
                "uri": "https://bio.tools/g-blastn",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acids"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0654",
                            "term": "DNA analysis"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0346",
                                    "term": "Sequence similarity search"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2976",
                                "term": "Protein sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0857",
                                "term": "Sequence search results"
                            }
                        ]
                    }
                ],
                "description": "GPU-accelerated nucleotide alignment tool based on the widely used NCBI-BLAST.",
                "homepage": "http://www.comp.hkbu.edu.hk/~chxw/software/G-BLASTN.html"
            }
        ],
        "inputs": [
            "zotus_rep5",
            "zotus_lulu_CO1",
            "zotus_codon"
        ],
        "nb_inputs": 3,
        "outputs": [
            "zotus_lulu",
            "zotus_common"
        ],
        "nb_outputs": 2,
        "name_workflow": "mingxinliu__nfp4MBC",
        "directive": [
            "publishDir \"${workingdir}/output_${params.marker}_11.0_commonzotus\", mode: \"copy\", overwrite: true"
        ],
        "when": "!params.skip",
        "stub": ""
    }
}