{
    "trim_and_combine": {
        "name_process": "trim_and_combine",
        "string_process": "\nprocess trim_and_combine {\n    tag { \"Preprocessing of \" + reads.size()/2 + \"  read pairs for \" + sample_id }\n                                                                     \n\n    input:\n        set sample_id, file(reads) from fastq_ch\n    output:\n        set sample_id, file(\"${sample_id}_R1-trimmed.fastq.gz\"), file(\"${sample_id}_R2-trimmed.fastq.gz\") into trim_and_combine_ch\n    script:\n        \"\"\"\n        # loop over readunits in pairs per sample\n        pairno=0\n        echo ${reads.join(\" \")} | xargs -n2 | while read fq1 fq2; do\n            let pairno=pairno+1\n            # note: don't make reads smaller than assembler kmer length\n            skewer --quiet -t ${task.cpus} -m pe -q 3 -n -l 31 -z -o pair\\${pairno}-skewer-out \\$fq1 \\$fq2;\n            cat *-trimmed-pair1.fastq.gz >> ${sample_id}_R1-trimmed.fastq.gz;\n            cat *-trimmed-pair2.fastq.gz >> ${sample_id}_R2-trimmed.fastq.gz;\n            rm *-trimmed-pair[12].fastq.gz;\n        done\n        fastqc -t {task.cpus} ${sample_id}_R1-trimmed.fastq.gz ${sample_id}_R2-trimmed.fastq.gz;\n        \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "        \"\"\"\n        # loop over readunits in pairs per sample\n        pairno=0\n        echo ${reads.join(\" \")} | xargs -n2 | while read fq1 fq2; do\n            let pairno=pairno+1\n            # note: don't make reads smaller than assembler kmer length\n            skewer --quiet -t ${task.cpus} -m pe -q 3 -n -l 31 -z -o pair\\${pairno}-skewer-out \\$fq1 \\$fq2;\n            cat *-trimmed-pair1.fastq.gz >> ${sample_id}_R1-trimmed.fastq.gz;\n            cat *-trimmed-pair2.fastq.gz >> ${sample_id}_R2-trimmed.fastq.gz;\n            rm *-trimmed-pair[12].fastq.gz;\n        done\n        fastqc -t {task.cpus} ${sample_id}_R1-trimmed.fastq.gz ${sample_id}_R2-trimmed.fastq.gz;\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "carlet",
            "Skewer",
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/carlet",
            "https://bio.tools/skewer",
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "carlet",
                "uri": "https://bio.tools/carlet",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0084",
                            "term": "Phylogeny"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2229",
                            "term": "Cell biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Targeted exome capture"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "WES"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Whole exome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3676",
                            "term": "Exome capture"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0323",
                                    "term": "Phylogenetic inference"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3799",
                                    "term": "Quantification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0323",
                                    "term": "Phlyogenetic tree construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0323",
                                    "term": "Phylogenetic reconstruction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0323",
                                    "term": "Phylogenetic tree generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3799",
                                    "term": "Quantitation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Single-cell tumor phylogeny inference with copy-number constrained mutation losses.\n\nSCARLET (Single-cell Algorithm for Reconstructing Loss-supported Evolution of Tumors) is an algorithm that reconstructs tumor phylogenies from single-cell DNA sequencing data. SCARLET uses a loss-supported model that constrains mutation losses based on observed copy-number data.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'S carlet', 'loss-supported'",
                "homepage": "http://github.com/raphael-group/scarlet"
            },
            {
                "name": "Skewer",
                "uri": "https://bio.tools/skewer",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3219",
                                    "term": "Read pre-processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3237",
                                    "term": "Primer removal"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3219",
                                    "term": "Sequence read pre-processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Skewer implements a novel dynamic programming algorithm dedicated to the task of adapter trimming and it is specially designed for processing illumina paired-end sequences.",
                "homepage": "https://sourceforge.net/projects/skewer/"
            },
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "fastq_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trim_and_combine_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Preprocessing of \" + reads.size()/2 + \" read pairs for \" + sample_id }"
        ],
        "when": "",
        "stub": ""
    },
    "decont": {
        "name_process": "decont",
        "string_process": "\nprocess decont {\n    tag { \"Decontaminating \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/reads/\", mode: 'copy'\n\n    input:\n        set sample_id, file(fq1), file(fq2) from trim_and_combine_ch\n        set file(cont_fasta), file(cont_amb), file(cont_ann), file(cont_bwt), \\\n            file(cont_pac), file(cont_sa) from cont_fasta_ch\n    output:\n        set sample_id, file(\"${sample_id}_trimmed_decont_1.fastq.gz\"), file(\"${sample_id}_trimmed_decont_2.fastq.gz\") into \\\n            fastq_for_tadpole, fastq_for_polish_assembly_ch, fastq_for_mapping_ch, fastq_for_kraken_ch\n        set file(\"${sample_id}_trimmed_decont_1_fastqc.zip\"), file(\"${sample_id}_trimmed_decont_2_fastqc.zip\"), \\\n            file(\"${sample_id}_trimmed_decont_1_fastqc.html\"), file(\"${sample_id}_trimmed_decont_2_fastqc.html\") into fastqc_ch\n    script:\n                                                                             \n        \"\"\"\n        decont.py -i ${fq1} ${fq2} -t ${task.cpus} -c 0.5 -r ${cont_fasta} -o ${sample_id}_trimmed_decont;\n        # since this is the last fastqc processing step, let's run fastqc here\n        fastqc -t {task.cpus} ${sample_id}_trimmed_decont_1.fastq.gz ${sample_id}_trimmed_decont_2.fastq.gz;\n        \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "        \"\"\"\n        decont.py -i ${fq1} ${fq2} -t ${task.cpus} -c 0.5 -r ${cont_fasta} -o ${sample_id}_trimmed_decont;\n        # since this is the last fastqc processing step, let's run fastqc here\n        fastqc -t {task.cpus} ${sample_id}_trimmed_decont_1.fastq.gz ${sample_id}_trimmed_decont_2.fastq.gz;\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "trim_and_combine_ch",
            "cont_fasta",
            "cont_amb",
            "cont_ann",
            "cont_bwt",
            "cont_fasta_ch"
        ],
        "nb_inputs": 6,
        "outputs": [
            "fastq_for_tadpole",
            "fastq_for_polish_assembly_ch",
            "fastq_for_mapping_ch",
            "fastq_for_kraken_ch",
            "fastqc_ch"
        ],
        "nb_outputs": 5,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Decontaminating \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/reads/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "kraken": {
        "name_process": "kraken",
        "string_process": " process kraken {\n        tag { \"Running Kraken on \" + sample_id }\n        publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n        input:\n            set sample_id, file(fq1), file(fq2) from fastq_for_kraken_ch\n        output:\n            file(\"${sample_id}_kraken.report\")\n        script:\n            \"\"\"\n            kraken --threads ${task.cpus} --preload --db ${kraken_db} \\\n              -paired ${fq1} ${fq2} > kraken.out;\n            # do not gzip! otherwise kraken-report happily runs (with some warnings) and produces rubbish results\n            kraken-report --db ${kraken_db} kraken.out > ${sample_id}_kraken.report\n            \"\"\"\n    }",
        "nb_lignes_process": 14,
        "string_script": "            \"\"\"\n            kraken --threads ${task.cpus} --preload --db ${kraken_db} \\\n              -paired ${fq1} ${fq2} > kraken.out;\n            # do not gzip! otherwise kraken-report happily runs (with some warnings) and produces rubbish results\n            kraken-report --db ${kraken_db} kraken.out > ${sample_id}_kraken.report\n            \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "Kraken"
        ],
        "tools_url": [
            "https://bio.tools/kraken"
        ],
        "tools_dico": [
            {
                "name": "Kraken",
                "uri": "https://bio.tools/kraken",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3174",
                            "term": "Metagenomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0637",
                            "term": "Taxonomy"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3460",
                                    "term": "Taxonomic classification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3460",
                                    "term": "Taxonomy assignment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3494",
                                "term": "DNA sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3028",
                                "term": "Taxonomy"
                            }
                        ]
                    }
                ],
                "description": "System for assigning taxonomic labels to short DNA sequences, usually obtained through metagenomic studies. Previous attempts by other bioinformatics software to accomplish this task have often used sequence alignment or machine learning techniques that were quite slow, leading to the development of less sensitive but much faster abundance estimation programs. It aims to achieve high sensitivity and high speed by utilizing exact alignments of k-mers and a novel classification algorithm.",
                "homepage": "https://ccb.jhu.edu/software/kraken/"
            }
        ],
        "inputs": [
            "fastq_for_kraken_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Running Kraken on \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "tadpole": {
        "name_process": "tadpole",
        "string_process": "\nprocess tadpole {\n    tag { \"Tadpole assembly of \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n    input:\n        set sample_id, file(fq1), file(fq2) from fastq_for_tadpole\n    output:\n        set sample_id, file(\"${sample_id}_contigs.fa\") into contigs_ch\n    script:\n        \"\"\"\n        tadpole.sh -Xmx10g threads=${task.cpus} in=${fq1} in2=${fq2} out=${sample_id}_contigs.fa,\n        \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "        \"\"\"\n        tadpole.sh -Xmx10g threads=${task.cpus} in=${fq1} in2=${fq2} out=${sample_id}_contigs.fa,\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fastq_for_tadpole"
        ],
        "nb_inputs": 1,
        "outputs": [
            "contigs_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Tadpole assembly of \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "gap_fill_assembly": {
        "name_process": "gap_fill_assembly",
        "string_process": "\nprocess gap_fill_assembly {\n    tag { \"Orienting and gap filling contigs for \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n                                                                                       \n                                                                                     \n    errorStrategy = { task.exitStatus == 3 ? 'ignore' : 'terminate' }\n\n    input:\n        set sample_id, file(contigs_fa) from contigs_ch\n        file(input_ref_fasta)\n    output:\n        set sample_id, file(\"${sample_id}-gap-filled-assembly.fa\"), file(\"${sample_id}-gap-filled-assembly.gaps.bed\") \\\n            into gap_filled_assembly_ch\n    script:\n        \"\"\"\n        set +e;\n        log=${sample_id}-gap-filled-assembly.log;\n        simple_contig_joiner.py -c ${contigs_fa} -r ${input_ref_fasta} \\\n          -s \"${sample_id}-gap-filled-assembly\" -o ${sample_id}-gap-filled-assembly.fa \\\n          -b \"${sample_id}-gap-filled-assembly.gaps.bed\" >& \\$log;\n\n        rc=\\$?\n        if [ \\$rc -ne 0 ]; then\n            # nothing to join, means we cannot continue. so stop here.\n            grep 'Nothing to join' \\$log && exit 3;\n            exit \\$rc;\n        fi\n        \"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "        \"\"\"\n        set +e;\n        log=${sample_id}-gap-filled-assembly.log;\n        simple_contig_joiner.py -c ${contigs_fa} -r ${input_ref_fasta} \\\n          -s \"${sample_id}-gap-filled-assembly\" -o ${sample_id}-gap-filled-assembly.fa \\\n          -b \"${sample_id}-gap-filled-assembly.gaps.bed\" >& \\$log;\n\n        rc=\\$?\n        if [ \\$rc -ne 0 ]; then\n            # nothing to join, means we cannot continue. so stop here.\n            grep 'Nothing to join' \\$log && exit 3;\n            exit \\$rc;\n        fi\n        \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "contigs_ch",
            "input_ref_fasta"
        ],
        "nb_inputs": 2,
        "outputs": [
            "gap_filled_assembly_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Orienting and gap filling contigs for \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'",
            "errorStrategy = { task.exitStatus == 3 ? 'ignore' : 'terminate' }"
        ],
        "when": "",
        "stub": ""
    },
    "polish_assembly": {
        "name_process": "polish_assembly",
        "string_process": "\nprocess polish_assembly {\n    tag { \"Polishing assembly for \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n    input:\n        set sample_id, file(assembly_fa), file(assembly_gaps_bed), file(fq1), file(fq2) \\\n            from gap_filled_assembly_ch.join(fastq_for_polish_assembly_ch)\n    output:\n        set sample_id, file(\"${sample_id}_polished_assembly.fa\") into polished_assembly_ch\n    script:\n        \"\"\"\n        # downsample to 1M reads to increase runtime\n        seqtk sample -s 666 ${fq1} 1000000 | gzip > R1_ds.R1.fastq.gz;\n        seqtk sample -s 666 ${fq2} 1000000 | gzip > R2_ds.R2.fastq.gz;\n        polish_viral_ref.sh -t ${task.cpus} -1 R1_ds.R1.fastq.gz -2 R2_ds.R2.fastq.gz \\\n            -r ${assembly_fa} -o ${sample_id}_polished_assembly.fa\n        \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "        \"\"\"\n        # downsample to 1M reads to increase runtime\n        seqtk sample -s 666 ${fq1} 1000000 | gzip > R1_ds.R1.fastq.gz;\n        seqtk sample -s 666 ${fq2} 1000000 | gzip > R2_ds.R2.fastq.gz;\n        polish_viral_ref.sh -t ${task.cpus} -1 R1_ds.R1.fastq.gz -2 R2_ds.R2.fastq.gz \\\n            -r ${assembly_fa} -o ${sample_id}_polished_assembly.fa\n        \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "seqtk"
        ],
        "tools_url": [
            "https://bio.tools/seqtk"
        ],
        "tools_dico": [
            {
                "name": "seqtk",
                "uri": "https://bio.tools/seqtk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool for processing sequences in the FASTA or FASTQ format. It parses both FASTA and FASTQ files which can also be optionally compressed by gzip.",
                "homepage": "https://github.com/lh3/seqtk"
            }
        ],
        "inputs": [
            "gap_filled_assembly_ch",
            "fastq_for_polish_assembly_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "polished_assembly_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Polishing assembly for \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "final_mapping": {
        "name_process": "final_mapping",
        "string_process": "\nprocess final_mapping {\n    tag { \"Mapping to polished assembly for \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n    input:\n        set sample_id, file(ref_fa), file(fq1), file(fq2) \\\n            from polished_assembly_ch.join(fastq_for_mapping_ch)\n    output:\n        set sample_id, file(ref_fa), file(\"${sample_id}.bam\"), file(\"${sample_id}.bam.bai\") into \\\n            final_mapping_for_vcf_ch, final_mapping_for_cov_ch\n        set sample_id, \"${sample_id}.bam.stats\" into final_mapping_bamstats_ch\n    script:\n        \"\"\"\n        bwa index ${ref_fa};\n        samtools faidx ${ref_fa};\n        bwa mem -t ${task.cpus} ${ref_fa} ${fq1} ${fq2} | \\\n            lofreq viterbi -f ${ref_fa} - | \\\n            lofreq alnqual -u - ${ref_fa} | \\\n            lofreq indelqual --dindel -f ${ref_fa} - | \\\n            samtools sort -o ${sample_id}.bam -T ${sample_id}.final.tmp -;\n        samtools index ${sample_id}.bam;\n        samtools stats ${sample_id}.bam > ${sample_id}.bam.stats\n        \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "        \"\"\"\n        bwa index ${ref_fa};\n        samtools faidx ${ref_fa};\n        bwa mem -t ${task.cpus} ${ref_fa} ${fq1} ${fq2} | \\\n            lofreq viterbi -f ${ref_fa} - | \\\n            lofreq alnqual -u - ${ref_fa} | \\\n            lofreq indelqual --dindel -f ${ref_fa} - | \\\n            samtools sort -o ${sample_id}.bam -T ${sample_id}.final.tmp -;\n        samtools index ${sample_id}.bam;\n        samtools stats ${sample_id}.bam > ${sample_id}.bam.stats\n        \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "polished_assembly_ch",
            "fastq_for_mapping_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "final_mapping_for_vcf_ch",
            "final_mapping_for_cov_ch",
            "final_mapping_bamstats_ch"
        ],
        "nb_outputs": 3,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Mapping to polished assembly for \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "var_calling": {
        "name_process": "var_calling",
        "string_process": "\nprocess var_calling {\n    tag { \"Final variant calling for \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n    input:\n        set sample_id, file(ref_fa), file(bam), file(bai) from final_mapping_for_vcf_ch\n    output:\n        set sample_id, file(ref_fa), file(\"${sample_id}.vcf.gz\") into vcf_ch\n    script:\n        \"\"\"\n        samtools faidx ${ref_fa};\n        lofreq call-parallel --pp-threads ${task.cpus} -f ${ref_fa} \\\n           -d 1000000 --call-indels -o ${sample_id}.vcf.gz ${bam}\n        \"\"\"\n}",
        "nb_lignes_process": 14,
        "string_script": "        \"\"\"\n        samtools faidx ${ref_fa};\n        lofreq call-parallel --pp-threads ${task.cpus} -f ${ref_fa} \\\n           -d 1000000 --call-indels -o ${sample_id}.vcf.gz ${bam}\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "final_mapping_for_vcf_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "vcf_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Final variant calling for \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "genomecov": {
        "name_process": "genomecov",
        "string_process": "\nprocess genomecov {\n    tag { \"Genome coverage for \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n    input:\n        set sample_id, file(ref_fa), file(bam), file(bai) from final_mapping_for_cov_ch\n    output:\n        set sample_id, file(\"${sample_id}.cov.gz\") into cov_ch\n    script:\n        \"\"\"\n        # note: -d is one-based. -dz is zero-based but only non-zero values, so less explicit.\n        bedtools genomecov -d -ibam ${bam} | gzip > ${sample_id}.cov.gz;\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "        \"\"\"\n        # note: -d is one-based. -dz is zero-based but only non-zero values, so less explicit.\n        bedtools genomecov -d -ibam ${bam} | gzip > ${sample_id}.cov.gz;\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "final_mapping_for_cov_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "cov_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Genome coverage for \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    },
    "vipr_tools": {
        "name_process": "vipr_tools",
        "string_process": "\nprocess vipr_tools {\n    tag { \"Plotting AF vs. coverage and readying fasta for  \" + sample_id }\n    publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'\n\n    input:\n        set sample_id, file(cov), file(ref_fa), file(vcf) from cov_ch.join(vcf_ch)\n    output:\n        set sample_id, file(\"${sample_id}_af-vs-cov.html\"), file(\"${sample_id}_0cov2N.fa\")\n    script:\n        \"\"\"\n        vipr_af_vs_cov_html.py --vcf ${vcf} --cov ${cov} --plot ${sample_id}_af-vs-cov.html;\n        vipr_gaps_to_n.py -i ${ref_fa} -c ${cov} > ${sample_id}_0cov2N.fa;\n        \"\"\"\n}",
        "nb_lignes_process": 13,
        "string_script": "        \"\"\"\n        vipr_af_vs_cov_html.py --vcf ${vcf} --cov ${cov} --plot ${sample_id}_af-vs-cov.html;\n        vipr_gaps_to_n.py -i ${ref_fa} -c ${cov} > ${sample_id}_0cov2N.fa;\n        \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "cov_ch",
            "vcf_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "sample_id"
        ],
        "nb_outputs": 1,
        "name_workflow": "nf-core__vipr",
        "directive": [
            "tag { \"Plotting AF vs. coverage and readying fasta for \" + sample_id }",
            "publishDir \"${params.outdir}/${sample_id}/\", mode: 'copy'"
        ],
        "when": "",
        "stub": ""
    }
}