{
    "preprocess_fasta_index": {
        "name_process": "preprocess_fasta_index",
        "string_process": " process preprocess_fasta_index {\n        publishDir \"$baseDir/data/test_data/input/\", mode: \"copy\"\n\n        input:\n            file(fasta) from genome_fasta_file\n\n        output:\n            file(\"${fasta.name + '.fai'}\") into genome_fasta_index\n\n        script:\n        \"\"\"\n        samtools faidx $fasta > ${fasta.name + '.fai'}\n        \"\"\"\n    }",
        "nb_lignes_process": 12,
        "string_script": "        \"\"\"\n        samtools faidx $fasta > ${fasta.name + '.fai'}\n        \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "genome_fasta_file"
        ],
        "nb_inputs": 1,
        "outputs": [
            "genome_fasta_index"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"$baseDir/data/test_data/input/\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "preprocess_fasta_dict": {
        "name_process": "preprocess_fasta_dict",
        "string_process": " process preprocess_fasta_dict {\n        publishDir \"$baseDir/data/test_data/input/\", mode: \"copy\"\n\n        input:\n            file(fasta) from genome_fasta_file\n\n        output:\n            file(\"${fasta.name.replace(\".fasta\", \".dict\")}\") into genome_fasta_dict\n\n        script:\n        \"\"\"\n        picard CreateSequenceDictionary \\\n            R=$fasta \\\n            O=${fasta.name.replace(\".fasta\", \".dict\")}\n        \"\"\"\n    }",
        "nb_lignes_process": 14,
        "string_script": "        \"\"\"\n        picard CreateSequenceDictionary \\\n            R=$fasta \\\n            O=${fasta.name.replace(\".fasta\", \".dict\")}\n        \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "genome_fasta_file"
        ],
        "nb_inputs": 1,
        "outputs": [
            "genome_fasta_dict"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"$baseDir/data/test_data/input/\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "preprocess_bam_rg": {
        "name_process": "preprocess_bam_rg",
        "string_process": "\nprocess preprocess_bam_rg {\n       \n                                                                   \n                                                                  \n       \n    publishDir \"${params.outdir}/processed_bams\", mode: \"copy\"\n\n    input:\n        file(bam) from bam_file\n\n    output:\n        file(\"${bam.name.replace('.bam', '_rg.bam')}\") into bam_rg\n        file(\"${bam.name.replace('.bam', '_rg.bai')}\") into bam_rg_index\n\n    script:\n        \"\"\"\n        picard AddOrReplaceReadGroups \\\n            I=$bam \\\n            O=${bam.name.replace('.bam', '_rg.bam')} \\\n            RGID=RG1 \\\n            RGLB=LIBRARY1 \\\n            RGPL=ILLUMINA \\\n            RGPU=FLOWCELL1.LANE1 \\\n            RGSM=$params.sample_name \\\n            SORT_ORDER=coordinate \\\n            CREATE_INDEX=true\n        \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "        \"\"\"\n        picard AddOrReplaceReadGroups \\\n            I=$bam \\\n            O=${bam.name.replace('.bam', '_rg.bam')} \\\n            RGID=RG1 \\\n            RGLB=LIBRARY1 \\\n            RGPL=ILLUMINA \\\n            RGPU=FLOWCELL1.LANE1 \\\n            RGSM=$params.sample_name \\\n            SORT_ORDER=coordinate \\\n            CREATE_INDEX=true\n        \"\"\"",
        "nb_lignes_script": 11,
        "language_script": "bash",
        "tools": [
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "bam_file"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bam_rg",
            "bam_rg_index"
        ],
        "nb_outputs": 2,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"${params.outdir}/processed_bams\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "preprocess_bam_rmdup": {
        "name_process": "preprocess_bam_rmdup",
        "string_process": "\nprocess preprocess_bam_rmdup {\n       \n                                                                       \n                \n       \n    publishDir \"${params.outdir}/processed_bams\", mode: \"copy\"\n\n    input:\n        file(bam) from bam_rg\n\n    output:\n        file(\"${bam.name.replace('.bam', '_rmdup.bam')}\") into bam_rmdup\n        file(\"${bam.name.replace('.bam', '_rmdup.bai')}\") into bam_rmdup_index\n\n    script:\n        \"\"\"\n        picard MarkDuplicates \\\n            INPUT=$bam \\\n            OUTPUT=${bam.name.replace('.bam', '_rmdup.bam')} \\\n            METRICS_FILE=metrics.txt \\\n            CREATE_INDEX=true\n        \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "        \"\"\"\n        picard MarkDuplicates \\\n            INPUT=$bam \\\n            OUTPUT=${bam.name.replace('.bam', '_rmdup.bam')} \\\n            METRICS_FILE=metrics.txt \\\n            CREATE_INDEX=true\n        \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "bam_rg"
        ],
        "nb_inputs": 1,
        "outputs": [
            "bam_rmdup",
            "bam_rmdup_index"
        ],
        "nb_outputs": 2,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"${params.outdir}/processed_bams\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "var_call_freebayes": {
        "name_process": "var_call_freebayes",
        "string_process": "\nprocess var_call_freebayes {\n       \n                                   \n       \n    publishDir \"${params.outdir}/vcfs\", mode: \"copy\"\n\n    input:\n        file(ref_file) from genome_fasta_file\n        file(ref_index) from genome_fasta_index\n        file(bam) from bam_rmdup\n        file(bam_index) from bam_rmdup_index\n        file(bed_file) from roi_bed_file\n\n    output:\n        file(\"${params.sample_name}_freebayes.vcf\") into vcf_freebayes\n\n    script:\n        \"\"\"\n        freebayes \\\n            -f $ref_file \\\n            -t $bed_file \\\n            $bam \\\n            > ${params.sample_name}_freebayes.vcf\n        \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "        \"\"\"\n        freebayes \\\n            -f $ref_file \\\n            -t $bed_file \\\n            $bam \\\n            > ${params.sample_name}_freebayes.vcf\n        \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "genome_fasta_file",
            "genome_fasta_index",
            "bam_rmdup",
            "bam_rmdup_index",
            "roi_bed_file"
        ],
        "nb_inputs": 5,
        "outputs": [
            "vcf_freebayes"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"${params.outdir}/vcfs\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "process_freebayes": {
        "name_process": "process_freebayes",
        "string_process": "\nprocess process_freebayes {\n       \n                                       \n       \n    input:\n        file(vcf) from vcf_freebayes\n\n    output:\n        file(\"${params.sample_name}_freebayes.txt\") into processed_freebayes\n\n    script:\n        \"\"\"\n        # convert to table\n        gatk VariantsToTable \\\n            -V $vcf \\\n            -O variants.txt \\\n            -F CHROM -F POS -F REF -F ALT -F FILTER -F AF \\\n            -GF AD -GF DP\n        \n        # merge chr,pos,ref and alt, change headers and save to file\n        awk ' { print \\$1\":\"\\$2\\$3\">\"\\$4\"\\t\"\\$5\"\\t\"\\$6\"\\t\"\\$7\"\\t\"\\$8 } ' variants.txt | \\\n        sed \"1 s/^.*\\$/variant\\tfreebayes_filter\\tfreebayes_AF\\tfreebayes_AD\\tfreebayes_DP/\" \\\n            > ${params.sample_name}_freebayes.txt\n        \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "        \"\"\"\n        # convert to table\n        gatk VariantsToTable \\\n            -V $vcf \\\n            -O variants.txt \\\n            -F CHROM -F POS -F REF -F ALT -F FILTER -F AF \\\n            -GF AD -GF DP\n        \n        # merge chr,pos,ref and alt, change headers and save to file\n        awk ' { print \\$1\":\"\\$2\\$3\">\"\\$4\"\\t\"\\$5\"\\t\"\\$6\"\\t\"\\$7\"\\t\"\\$8 } ' variants.txt | \\\n        sed \"1 s/^.*\\$/variant\\tfreebayes_filter\\tfreebayes_AF\\tfreebayes_AD\\tfreebayes_DP/\" \\\n            > ${params.sample_name}_freebayes.txt\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "vcf_freebayes"
        ],
        "nb_inputs": 1,
        "outputs": [
            "processed_freebayes"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "var_call_mutect": {
        "name_process": "var_call_mutect",
        "string_process": "\nprocess var_call_mutect {\n       \n                                      \n       \n    publishDir \"${params.outdir}/vcfs\", mode: \"copy\"\n\n    input:\n                                                                       \n        file(ref_file) from genome_fasta_file\n        file(ref_index) from genome_fasta_index\n        file(ref_dict) from genome_fasta_dict\n        file(bam) from bam_rmdup\n        file(bam_index) from bam_rmdup_index\n        file(bed_file) from roi_bed_file\n\n    output:\n        file(\"${params.sample_name}_mutect.vcf\") into vcf_mutect\n\n    script:\n        \"\"\"\n        gatk Mutect2 \\\n            --input $bam \\\n            --output ${params.sample_name}_mutect.vcf \\\n            --reference $ref_file \\\n            --intervals $bed_file\n        \"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "        \"\"\"\n        gatk Mutect2 \\\n            --input $bam \\\n            --output ${params.sample_name}_mutect.vcf \\\n            --reference $ref_file \\\n            --intervals $bed_file\n        \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "genome_fasta_file",
            "genome_fasta_index",
            "genome_fasta_dict",
            "bam_rmdup",
            "bam_rmdup_index",
            "roi_bed_file"
        ],
        "nb_inputs": 6,
        "outputs": [
            "vcf_mutect"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"${params.outdir}/vcfs\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "process_mutect": {
        "name_process": "process_mutect",
        "string_process": "\nprocess process_mutect {\n       \n                                    \n       \n    input:\n        file(vcf) from vcf_mutect\n\n    output:\n        file(\"${params.sample_name}_mutect.txt\") into processed_mutect\n\n    script:\n        \"\"\"\n        # convert to table\n        gatk VariantsToTable \\\n            -V $vcf \\\n            -O variants.txt \\\n            -F CHROM -F POS -F REF -F ALT -F FILTER \\\n            -GF AF -GF AD -GF DP\n        \n        # merge chr,pos,ref and alt, change headers and save to file\n        awk ' { print \\$1\":\"\\$2\\$3\">\"\\$4\"\\t\"\\$5\"\\t\"\\$6\"\\t\"\\$7\"\\t\"\\$8 } ' variants.txt | \\\n        sed \"1 s/^.*\\$/variant\\tmutect_filter\\tmutect_AF\\tmutect_AD\\tmutect_DP/\" \\\n            > ${params.sample_name}_mutect.txt\n        \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "        \"\"\"\n        # convert to table\n        gatk VariantsToTable \\\n            -V $vcf \\\n            -O variants.txt \\\n            -F CHROM -F POS -F REF -F ALT -F FILTER \\\n            -GF AF -GF AD -GF DP\n        \n        # merge chr,pos,ref and alt, change headers and save to file\n        awk ' { print \\$1\":\"\\$2\\$3\">\"\\$4\"\\t\"\\$5\"\\t\"\\$6\"\\t\"\\$7\"\\t\"\\$8 } ' variants.txt | \\\n        sed \"1 s/^.*\\$/variant\\tmutect_filter\\tmutect_AF\\tmutect_AD\\tmutect_DP/\" \\\n            > ${params.sample_name}_mutect.txt\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "vcf_mutect"
        ],
        "nb_inputs": 1,
        "outputs": [
            "processed_mutect"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "var_call_varscan": {
        "name_process": "var_call_varscan",
        "string_process": "\nprocess var_call_varscan {\n       \n                                  \n       \n    publishDir \"${params.outdir}/vcfs\", mode: \"copy\"\n\n    input:\n        file(ref_file) from genome_fasta_file\n        file(bam) from bam_rmdup\n        file(bed_file) from roi_bed_file\n\n    output:\n        file(\"${params.sample_name}_varscan.vcf\") into vcf_varscan\n\n    script:\n        \"\"\"\n        # make text file with sample name, as required by varscan\n        echo $params.sample_name > sample_list.txt\n        \n        samtools mpileup \\\n            --fasta-ref $ref_file \\\n            --no-BAQ \\\n            --positions $bed_file \\\n            $bam | \\\n        varscan mpileup2snp \\\n            --output-vcf 1 \\\n            --vcf-sample-list sample_list.txt \\\n            > ${params.sample_name}_varscan.vcf\n        \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "        \"\"\"\n        # make text file with sample name, as required by varscan\n        echo $params.sample_name > sample_list.txt\n        \n        samtools mpileup \\\n            --fasta-ref $ref_file \\\n            --no-BAQ \\\n            --positions $bed_file \\\n            $bam | \\\n        varscan mpileup2snp \\\n            --output-vcf 1 \\\n            --vcf-sample-list sample_list.txt \\\n            > ${params.sample_name}_varscan.vcf\n        \"\"\"",
        "nb_lignes_script": 13,
        "language_script": "bash",
        "tools": [
            "SAMtools",
            "VarScan"
        ],
        "tools_url": [
            "https://bio.tools/samtools",
            "https://bio.tools/varscan"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "VarScan",
                "uri": "https://bio.tools/varscan",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "VarScan, an open source tool for variant detection that is compatible with several short read align-ers.",
                "homepage": "http://dkoboldt.github.io/varscan/"
            }
        ],
        "inputs": [
            "genome_fasta_file",
            "bam_rmdup",
            "roi_bed_file"
        ],
        "nb_inputs": 3,
        "outputs": [
            "vcf_varscan"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"${params.outdir}/vcfs\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    },
    "process_varscan": {
        "name_process": "process_varscan",
        "string_process": "\nprocess process_varscan {\n       \n                                     \n       \n    input:\n        file(vcf) from vcf_varscan\n\n    output:\n        file(\"${params.sample_name}_varscan.txt\") into processed_varscan\n\n    script:\n        \"\"\"\n        # convert to table\n        gatk VariantsToTable \\\n            -V $vcf \\\n            -O variants.txt \\\n            -F CHROM -F POS -F REF -F ALT -F FILTER \\\n            -GF FREQ -GF AD -GF DP\n        \n        # merge chr,pos,ref and alt, change headers and save to file\n        awk ' { print \\$1\":\"\\$2\\$3\">\"\\$4\"\\t\"\\$5\"\\t\"\\$6\"\\t\"\\$7\"\\t\"\\$8 } ' variants.txt | \\\n        sed \"1 s/^.*\\$/variant\\tvarscan_filter\\tvarscan_AF\\tvarscan_AD\\tvarscan_DP/\" \\\n            > ${params.sample_name}_varscan.txt\n        \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "        \"\"\"\n        # convert to table\n        gatk VariantsToTable \\\n            -V $vcf \\\n            -O variants.txt \\\n            -F CHROM -F POS -F REF -F ALT -F FILTER \\\n            -GF FREQ -GF AD -GF DP\n        \n        # merge chr,pos,ref and alt, change headers and save to file\n        awk ' { print \\$1\":\"\\$2\\$3\">\"\\$4\"\\t\"\\$5\"\\t\"\\$6\"\\t\"\\$7\"\\t\"\\$8 } ' variants.txt | \\\n        sed \"1 s/^.*\\$/variant\\tvarscan_filter\\tvarscan_AF\\tvarscan_AD\\tvarscan_DP/\" \\\n            > ${params.sample_name}_varscan.txt\n        \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "vcf_varscan"
        ],
        "nb_inputs": 1,
        "outputs": [
            "processed_varscan"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "combine_vcfs": {
        "name_process": "combine_vcfs",
        "string_process": "\nprocess combine_vcfs {\n       \n                                                                   \n                                                  \n       \n    publishDir \"${params.outdir}/combined\", mode: \"copy\"\n\n    input:\n        file(freebayes_variants) from processed_freebayes\n        file(mutect_variants) from processed_mutect\n        file(varscan_variants) from processed_varscan\n\n    output:\n        file(\"${params.sample_name}_combined_results.txt\") into combined_vcfs\n\n    script:\n        \"\"\"\n        #!/usr/bin/env python\n        import pandas as pd\n\n        # load all files into dataframes with variant ID as index\n        df1 = pd.read_table(\"$freebayes_variants\", index_col=0)\n        df2 = pd.read_table(\"$mutect_variants\", index_col=0)\n        df3 = pd.read_table(\"$varscan_variants\", index_col=0)\n\n        # combine dataframes based on index\n        main = pd.concat([df1, df2, df3], axis=1)\n\n        # write to file\n        with open(\"${params.sample_name}_combined_results.txt\", 'w') as f:\n            main.to_csv(f)\n        \"\"\"\n}",
        "nb_lignes_process": 32,
        "string_script": "        \"\"\"\n        #!/usr/bin/env python\n        import pandas as pd\n\n        # load all files into dataframes with variant ID as index\n        df1 = pd.read_table(\"$freebayes_variants\", index_col=0)\n        df2 = pd.read_table(\"$mutect_variants\", index_col=0)\n        df3 = pd.read_table(\"$varscan_variants\", index_col=0)\n\n        # combine dataframes based on index\n        main = pd.concat([df1, df2, df3], axis=1)\n\n        # write to file\n        with open(\"${params.sample_name}_combined_results.txt\", 'w') as f:\n            main.to_csv(f)\n        \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "python",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "processed_freebayes",
            "processed_mutect",
            "processed_varscan"
        ],
        "nb_inputs": 3,
        "outputs": [
            "combined_vcfs"
        ],
        "nb_outputs": 1,
        "name_workflow": "erikwaskiewicz__ctdna-project",
        "directive": [
            "publishDir \"${params.outdir}/combined\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    }
}