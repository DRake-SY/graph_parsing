{
    "MAKE_GENOME_FILTER": {
        "name_process": "MAKE_GENOME_FILTER",
        "string_process": "\nprocess MAKE_GENOME_FILTER {\n    tag \"$fasta\"\n    publishDir \"${params.outdir}/genome\", mode: params.publish_dir_mode\n\n    input:\n    path fasta from ch_fasta\n    path blacklist from ch_blacklist.ifEmpty([])\n\n    output:\n    path \"$fasta\"                                                   \n    path '*.fai'                                                                        \n    path '*.bed' into ch_genome_filter_regions                                              \n    path '*.sizes' into ch_genome_sizes_bigwig,                                             \n                        ch_genome_sizes_bedgraph\n\n    script:\n    blacklist_filter = params.blacklist ? \"sortBed -i $blacklist -g ${fasta}.sizes | complementBed -i stdin -g ${fasta}.sizes\" : \"awk '{print \\$1, '0' , \\$2}' OFS='\\t' ${fasta}.sizes\"\n    \"\"\"\n    samtools faidx $fasta\n    cut -f 1,2 ${fasta}.fai > ${fasta}.sizes\n    $blacklist_filter > ${fasta}.include_regions.bed\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    blacklist_filter = params.blacklist ? \"sortBed -i $blacklist -g ${fasta}.sizes | complementBed -i stdin -g ${fasta}.sizes\" : \"awk '{print \\$1, '0' , \\$2}' OFS='\\t' ${fasta}.sizes\"\n    \"\"\"\n    samtools faidx $fasta\n    cut -f 1,2 ${fasta}.fai > ${fasta}.sizes\n    $blacklist_filter > ${fasta}.include_regions.bed\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_fasta",
            "ch_blacklist"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_genome_filter_regions",
            "ch_genome_sizes_bigwig",
            "ch_genome_sizes_bedgraph"
        ],
        "nb_outputs": 3,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$fasta\"",
            "publishDir \"${params.outdir}/genome\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "FASTQC": {
        "name_process": "FASTQC",
        "string_process": "\nprocess FASTQC {\n    tag \"$name\"\n    publishDir \"${params.outdir}/fastqc\", mode: params.publish_dir_mode,\n        saveAs: { filename ->\n                      filename.endsWith('.zip') ? \"zips/$filename\" : filename\n                }\n\n    when:\n    !params.skip_fastqc\n\n    input:\n    tuple val(name), path(reads) from ch_raw_reads_fastqc\n\n    output:\n    path '*.{zip,html}' into ch_fastqc_reports_mqc\n\n    script:\n                                                                           \n    \"\"\"\n    [ ! -f  ${name}_1.fastq.gz ] && ln -s ${reads[0]} ${name}_1.fastq.gz\n    [ ! -f  ${name}_2.fastq.gz ] && ln -s ${reads[1]} ${name}_2.fastq.gz\n    fastqc -q -t $task.cpus ${name}_1.fastq.gz\n    fastqc -q -t $task.cpus ${name}_2.fastq.gz\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    [ ! -f  ${name}_1.fastq.gz ] && ln -s ${reads[0]} ${name}_1.fastq.gz\n    [ ! -f  ${name}_2.fastq.gz ] && ln -s ${reads[1]} ${name}_2.fastq.gz\n    fastqc -q -t $task.cpus ${name}_1.fastq.gz\n    fastqc -q -t $task.cpus ${name}_2.fastq.gz\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "ch_raw_reads_fastqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_fastqc_reports_mqc"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/fastqc\", mode: params.publish_dir_mode , saveAs: { filename -> filename.endsWith('.zip') ? \"zips/$filename\" : filename }"
        ],
        "when": "!params.skip_fastqc",
        "stub": ""
    },
    "TRIM_1STROUND": {
        "name_process": "TRIM_1STROUND",
        "string_process": "\nprocess TRIM_1STROUND {\n    tag \"$name\"\n    publishDir \"${params.outdir}/trim_1st\", mode: params.publish_dir_mode,\n        saveAs: { filename ->\n                    if (filename.endsWith('.html')) \"fastqc/$filename\"\n                    else if (filename.endsWith('.zip')) \"fastqc/zips/$filename\"\n                    else filename\n            }\n\n    input:\n    tuple val(name), path(reads) from ch_raw_reads_trim\n    path adapter from ch_adapter\n\n    output:\n    tuple val(name), path('*.paired.fastq.gz') into ch_trimmed_1st\n    path '*.{zip,html}' into ch_trim1st_fastqc_reports_mqc\n\n    \"\"\"\n    [ ! -f  ${name}_1.fastq.gz ] && ln -s ${reads[0]} ${name}_1.fastq.gz\n    [ ! -f  ${name}_2.fastq.gz ] && ln -s ${reads[1]} ${name}_2.fastq.gz\n    trimmomatic PE -threads 1 -phred33 \\\n      ${name}_1.fastq.gz ${name}_2.fastq.gz \\\n      ${name}_1.paired.fastq.gz ${name}_1.unpaired.fastq.gz \\\n      ${name}_2.paired.fastq.gz ${name}_2.unpaired.fastq.gz \\\n      ILLUMINACLIP:${adapter}:2:15:4:4:true \\\n      LEADING:20 \\\n      TRAILING:20 \\\n      SLIDINGWINDOW:4:15 \\\n      MINLEN:25\n    fastqc -q -t $task.cpus ${name}_1.paired.fastq.gz\n    fastqc -q -t $task.cpus ${name}_2.paired.fastq.gz\n    \"\"\"\n}",
        "nb_lignes_process": 32,
        "string_script": "\"\"\"\n    [ ! -f  ${name}_1.fastq.gz ] && ln -s ${reads[0]} ${name}_1.fastq.gz\n    [ ! -f  ${name}_2.fastq.gz ] && ln -s ${reads[1]} ${name}_2.fastq.gz\n    trimmomatic PE -threads 1 -phred33 \\\n      ${name}_1.fastq.gz ${name}_2.fastq.gz \\\n      ${name}_1.paired.fastq.gz ${name}_1.unpaired.fastq.gz \\\n      ${name}_2.paired.fastq.gz ${name}_2.unpaired.fastq.gz \\\n      ILLUMINACLIP:${adapter}:2:15:4:4:true \\\n      LEADING:20 \\\n      TRAILING:20 \\\n      SLIDINGWINDOW:4:15 \\\n      MINLEN:25\n    fastqc -q -t $task.cpus ${name}_1.paired.fastq.gz\n    fastqc -q -t $task.cpus ${name}_2.paired.fastq.gz\n    \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "Trimmomatic",
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/trimmomatic",
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "Trimmomatic",
                "uri": "https://bio.tools/trimmomatic",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Sequence trimming"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3192",
                                    "term": "Trimming"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            }
                        ]
                    }
                ],
                "description": "A flexible read trimming tool for Illumina NGS data",
                "homepage": "http://www.usadellab.org/cms/index.php?page=trimmomatic"
            },
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "ch_raw_reads_trim",
            "ch_adapter"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_trimmed_1st",
            "ch_trim1st_fastqc_reports_mqc"
        ],
        "nb_outputs": 2,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/trim_1st\", mode: params.publish_dir_mode , saveAs: { filename -> if (filename.endsWith('.html')) \"fastqc/$filename\" else if (filename.endsWith('.zip')) \"fastqc/zips/$filename\" else filename }"
        ],
        "when": "",
        "stub": ""
    },
    "TRIM_2NDROUND": {
        "name_process": "TRIM_2NDROUND",
        "string_process": "\nprocess TRIM_2NDROUND {\n    tag \"$name\"\n    publishDir \"${params.outdir}/trim_2nd\", mode: params.publish_dir_mode,\n        saveAs: { filename ->\n                    if (filename.endsWith('.html')) \"fastqc/$filename\"\n                    else if (filename.endsWith('.zip')) \"fastqc/zips/$filename\"\n                    else filename\n            }\n\n    input:\n    tuple val(name), path(reads) from ch_trimmed_1st\n\n    output:\n    tuple val(name), path('*.paired.trimmed.fastq.gz') into ch_trimmed_2nd\n    path '*.{zip,html}' into ch_trim2nd_fastqc_reports_mqc\n\n    \"\"\"\n    kseq_test ${reads[0]} ${params.seq_len} ${name}_1.paired.trimmed.fastq.gz\n    kseq_test ${reads[1]} ${params.seq_len} ${name}_2.paired.trimmed.fastq.gz\n    fastqc -q -t $task.cpus ${name}_1.paired.trimmed.fastq.gz\n    fastqc -q -t $task.cpus ${name}_2.paired.trimmed.fastq.gz\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "\"\"\"\n    kseq_test ${reads[0]} ${params.seq_len} ${name}_1.paired.trimmed.fastq.gz\n    kseq_test ${reads[1]} ${params.seq_len} ${name}_2.paired.trimmed.fastq.gz\n    fastqc -q -t $task.cpus ${name}_1.paired.trimmed.fastq.gz\n    fastqc -q -t $task.cpus ${name}_2.paired.trimmed.fastq.gz\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "ch_trimmed_1st"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_trimmed_2nd",
            "ch_trim2nd_fastqc_reports_mqc"
        ],
        "nb_outputs": 2,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/trim_2nd\", mode: params.publish_dir_mode , saveAs: { filename -> if (filename.endsWith('.html')) \"fastqc/$filename\" else if (filename.endsWith('.zip')) \"fastqc/zips/$filename\" else filename }"
        ],
        "when": "",
        "stub": ""
    },
    "BOWTIE2": {
        "name_process": "BOWTIE2",
        "string_process": "\nprocess BOWTIE2 {\n    tag \"$name\"\n    publishDir \"${params.outdir}/bowtie2_aln\", mode: params.publish_dir_mode\n\n    input:\n    tuple val(name), path(reads) from ch_trimmed_2nd\n    path index from ch_bt2_index.collect()\n\n    output:\n    tuple val(name), path('*.bam') into ch_bt2\n\n    \"\"\"\n    bowtie2 -p 2 --dovetail --phred33 -x ${index}/${bt2_base} \\\n      -1 ${reads[0]} \\\n      -2 ${reads[1]} \\\n    | samtools view -bS - -o ${name}.bam \\\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n    bowtie2 -p 2 --dovetail --phred33 -x ${index}/${bt2_base} \\\n      -1 ${reads[0]} \\\n      -2 ${reads[1]} \\\n    | samtools view -bS - -o ${name}.bam \\\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "Rbowtie2",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/rbowtie2",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "Rbowtie2",
                "uri": "https://bio.tools/rbowtie2",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence merging"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0232",
                                    "term": "Sequence splicing"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "This package provides an R wrapper of the popular bowtie2 sequencing reads aligner and AdapterRemoval, a convenient tool for rapid adapter trimming, identification, and read merging.",
                "homepage": "http://bioconductor.org/packages/release/bioc/html/Rbowtie2.html"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_trimmed_2nd",
            "ch_bt2_index"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_bt2"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/bowtie2_aln\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "SORT_BAM": {
        "name_process": "SORT_BAM",
        "string_process": "\nprocess SORT_BAM {\n    tag \"$name\"\n    if (params.save_align_intermeds) {\n        publishDir \"${params.outdir}/sorted_bam\", mode: params.publish_dir_mode\n    }\n\n    input:\n    tuple val(name), path(bam) from ch_bt2\n\n    output:\n    tuple val(name), path('*.sorted.bam') into ch_sorted_bam\n\n    \"\"\"\n    samtools view -bh -f 3 -F 4 -F 8 ${bam} > ${name}.filter_unmapped.bam\n    java -jar ${params.picard_jar} SortSam INPUT=${name}.filter_unmapped.bam \\\n      OUTPUT=${name}.sorted.bam \\\n      SORT_ORDER=coordinate \\\n      VALIDATION_STRINGENCY=SILENT\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n    samtools view -bh -f 3 -F 4 -F 8 ${bam} > ${name}.filter_unmapped.bam\n    java -jar ${params.picard_jar} SortSam INPUT=${name}.filter_unmapped.bam \\\n      OUTPUT=${name}.sorted.bam \\\n      SORT_ORDER=coordinate \\\n      VALIDATION_STRINGENCY=SILENT\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_bt2"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_sorted_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\" if (params.save_align_intermeds) { publishDir \"${params.outdir}/sorted_bam\", mode: params.publish_dir_mode }"
        ],
        "when": "",
        "stub": ""
    },
    "DEDUP": {
        "name_process": "DEDUP",
        "string_process": " process DEDUP {\n      tag \"$name\"\n      publishDir \"${params.outdir}/remove_duplicates\", mode: params.publish_dir_mode\n\n      input:\n      tuple val(name), path(bam) from ch_sorted_bam\n\n      output:\n      tuple val(name), path('*.sorted.dedup.bam') into ch_dedup_bam\n      path '*.txt' into ch_picard_metrics_mqc\n\n      \"\"\"\n      java -jar ${params.picard_jar} MarkDuplicates INPUT=${bam} \\\n        OUTPUT=${name}.sorted.marked.bam \\\n        VALIDATION_STRINGENCY=SILENT \\\n        METRICS_FILE=metrics.${name}.txt\n      samtools view -bh -F 1024 ${name}.sorted.marked.bam > ${name}.sorted.dedup.bam\n      \"\"\"\n    }",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n      java -jar ${params.picard_jar} MarkDuplicates INPUT=${bam} \\\n        OUTPUT=${name}.sorted.marked.bam \\\n        VALIDATION_STRINGENCY=SILENT \\\n        METRICS_FILE=metrics.${name}.txt\n      samtools view -bh -F 1024 ${name}.sorted.marked.bam > ${name}.sorted.dedup.bam\n      \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_sorted_bam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_dedup_bam",
            "ch_picard_metrics_mqc"
        ],
        "nb_outputs": 2,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/remove_duplicates\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "FILTER120": {
        "name_process": "FILTER120",
        "string_process": " process FILTER120 {\n        tag \"$name\"\n        publishDir \"${params.outdir}/filter120\", mode: params.publish_dir_mode\n\n        input:\n        tuple val(name), path(bam) from ch_dedup_bam\n\n        output:\n        tuple val(name), path('*.sorted.dedup.filtered.{bam,bam.bai}') into ch_filtered_bam\n\n        \"\"\"\n        samtools view -h ${bam} \\\n          |LC_ALL=C awk -f /cutruntools/filter_below.awk \\\n          |samtools view -Sb - -o ${name}.sorted.dedup.filtered.bam\n        samtools index ${name}.sorted.dedup.filtered.bam\n        \"\"\"\n    }",
        "nb_lignes_process": 15,
        "string_script": "\"\"\"\n        samtools view -h ${bam} \\\n          |LC_ALL=C awk -f /cutruntools/filter_below.awk \\\n          |samtools view -Sb - -o ${name}.sorted.dedup.filtered.bam\n        samtools index ${name}.sorted.dedup.filtered.bam\n        \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_dedup_bam"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_filtered_bam"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/filter120\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "FLAGSTAT": {
        "name_process": "FLAGSTAT",
        "string_process": "\nprocess FLAGSTAT {\n    tag \"$name\"\n    publishDir \"${params.outdir}/flagstat\", mode: params.publish_dir_mode\n\n    input:\n    tuple val(name), path(bam) from ch_filtered_bam_flagstat\n\n    output:\n    tuple val(name), path('*.flagstat') into ch_flagstat_bigwig,\n                                             ch_flagstat_macs\n    path '*.{flagstat,idxstats,stats}' into ch_flagstat_mqc\n\n    \"\"\"\n    samtools flagstat ${bam[0]} > ${name}.sorted.dedup.filtered.bam.flagstat\n    samtools idxstats ${bam[0]} > ${name}.sorted.dedup.filtered.bam.idxstats\n    samtools stats ${bam[0]} > ${name}.sorted.dedup.filtered.bam.stats\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n    samtools flagstat ${bam[0]} > ${name}.sorted.dedup.filtered.bam.flagstat\n    samtools idxstats ${bam[0]} > ${name}.sorted.dedup.filtered.bam.idxstats\n    samtools stats ${bam[0]} > ${name}.sorted.dedup.filtered.bam.stats\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "ch_filtered_bam_flagstat"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_flagstat_bigwig",
            "ch_flagstat_macs",
            "ch_flagstat_mqc"
        ],
        "nb_outputs": 3,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/flagstat\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "BIGWIG": {
        "name_process": "BIGWIG",
        "string_process": "\nprocess BIGWIG {\n    tag \"$name\"\n    publishDir \"${params.outdir}/bigwig\", mode: params.publish_dir_mode\n\n    input:\n    tuple val(name), path(bam), path(flagstat) from ch_filtered_bam_bigwig.join(ch_flagstat_bigwig, by: [0])\n    path sizes from ch_genome_sizes_bigwig.collect()\n\n    output:\n    tuple val(name), path('*.bigWig') into ch_bigwig_plotprofile\n    path '*scale_factor.txt'\n\n    \"\"\"\n    SCALE_FACTOR=\\$(grep 'mapped (' $flagstat | awk '{print 1000000/\\$1}')\n    echo \\$SCALE_FACTOR > ${name}.scale_factor.txt\n    genomeCoverageBed -ibam ${bam[0]} -bg -scale \\$SCALE_FACTOR -pc | sort -T '.' -k1,1 -k2,2n > ${name}.bedGraph\n    bedGraphToBigWig ${name}.bedGraph $sizes ${name}.bigWig\n    find * -type f -name \"*.bigWig\" -exec echo -e \"bigwig/\"{}\"\\\\t0,0,178\" \\\\; > ${name}.bigWig.igv.txt\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "\"\"\"\n    SCALE_FACTOR=\\$(grep 'mapped (' $flagstat | awk '{print 1000000/\\$1}')\n    echo \\$SCALE_FACTOR > ${name}.scale_factor.txt\n    genomeCoverageBed -ibam ${bam[0]} -bg -scale \\$SCALE_FACTOR -pc | sort -T '.' -k1,1 -k2,2n > ${name}.bedGraph\n    bedGraphToBigWig ${name}.bedGraph $sizes ${name}.bigWig\n    find * -type f -name \"*.bigWig\" -exec echo -e \"bigwig/\"{}\"\\\\t0,0,178\" \\\\; > ${name}.bigWig.igv.txt\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "bedGraphToBigWig"
        ],
        "tools_url": [
            "https://bio.tools/bedgraphtobigwig"
        ],
        "tools_dico": [
            {
                "name": "bedGraphToBigWig",
                "uri": "https://bio.tools/bedgraphtobigwig",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Convert bedGraph to bigWig file.",
                "homepage": "https://www.encodeproject.org/software/bedgraphtobigwig/"
            }
        ],
        "inputs": [
            "ch_filtered_bam_bigwig",
            "ch_genome_sizes_bigwig"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_bigwig_plotprofile"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/bigwig\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "BEDGRAPH": {
        "name_process": "BEDGRAPH",
        "string_process": "\nprocess BEDGRAPH {\n    tag \"$name\"\n    publishDir \"${params.outdir}/bedgraph\", mode: params.publish_dir_mode\n\n    input:\n    tuple val(name), path(bam) from ch_filtered_bam_bedgraph\n    path sizes from ch_genome_sizes_bedgraph.collect()\n\n    output:\n    tuple val(name), path('*.bedgraph') into ch_bedgraph_seacr\n    path '*.bedgraph'\n\n    \"\"\"\n    bedtools bamtobed -bedpe -i ${bam[0]} > ${name}.bed\n    awk '\\$1==\\$4 && \\$6-\\$2 < 1000 {print \\$0}' ${name}.bed > ${name}.clean.bed\n    cut -f 1,2,6 ${name}.clean.bed | sort -k1,1 -k2,2n -k3,3n > ${name}.fragments.bed\n    bedtools genomecov -bg -i ${name}.fragments.bed -g ${sizes} > ${name}.fragments.bedgraph\n    \"\"\"\n}",
        "nb_lignes_process": 18,
        "string_script": "\"\"\"\n    bedtools bamtobed -bedpe -i ${bam[0]} > ${name}.bed\n    awk '\\$1==\\$4 && \\$6-\\$2 < 1000 {print \\$0}' ${name}.bed > ${name}.clean.bed\n    cut -f 1,2,6 ${name}.clean.bed | sort -k1,1 -k2,2n -k3,3n > ${name}.fragments.bed\n    bedtools genomecov -bg -i ${name}.fragments.bed -g ${sizes} > ${name}.fragments.bedgraph\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "BEDTools"
        ],
        "tools_url": [
            "https://bio.tools/bedtools"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            }
        ],
        "inputs": [
            "ch_filtered_bam_bedgraph",
            "ch_genome_sizes_bedgraph"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_bedgraph_seacr"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/bedgraph\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "MACS2": {
        "name_process": "MACS2",
        "string_process": "\nprocess MACS2 {\n    tag \"$name\"\n    publishDir \"${params.outdir}/macs\", mode: params.publish_dir_mode,\n        saveAs: { filename ->\n                      if (filename.endsWith('.tsv')) \"qc/$filename\"\n                      else if (filename.endsWith('.igv.txt')) null\n                      else filename\n                }\n\n    when:\n    params.macs_gsize\n\n    input:\n    tuple val(name), path(bam) from ch_filtered_bam_macs\n\n    output:\n    tuple val(name), path('*.narrowPeak') into ch_macs_peaks\n    path '*.{bed,xls,bdg}'\n\n    \"\"\"\n    macs2 callpeak \\\n      -t ${bam[0]} \\\n      -g $params.macs_gsize \\\n      -f BAMPE \\\n      -n ${name} \\\n      -q ${params.macs_qvalue} \\\n      -B --SPMR \\\n      --keep-dup all \n    \"\"\"\n}",
        "nb_lignes_process": 29,
        "string_script": "\"\"\"\n    macs2 callpeak \\\n      -t ${bam[0]} \\\n      -g $params.macs_gsize \\\n      -f BAMPE \\\n      -n ${name} \\\n      -q ${params.macs_qvalue} \\\n      -B --SPMR \\\n      --keep-dup all \n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_filtered_bam_macs"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_macs_peaks"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/macs\", mode: params.publish_dir_mode , saveAs: { filename -> if (filename.endsWith('.tsv')) \"qc/$filename\" else if (filename.endsWith('.igv.txt')) null else filename }"
        ],
        "when": "params.macs_gsize",
        "stub": ""
    },
    "SEACR": {
        "name_process": "SEACR",
        "string_process": "\nprocess SEACR {\n    tag \"$name\"\n    publishDir \"${params.outdir}/seacr\", mode: params.publish_dir_mode\n\n    when:\n    !params.skip_seacr\n\n    input:\n    tuple val(name), path(bdg) from ch_bedgraph_seacr\n\n    output:\n    tuple val(name), path('*.narrowPeak') into ch_seacr_peaks\n    path '*.narrowPeak'\n\n    \"\"\"\n    bash /SEACR/SEACR_1.3.sh \\\n      ${bdg} \\\n      ${params.seacr_threshold} \\\n      non \\\n      ${params.seacr_mode} \\\n      ${name}\n    awk 'BEGIN {FS=\"\\t\"; OFS=\"\\t\";} {print \\$1,\\$2,\\$3,\\$6,\\$4,\".\",\\$5}' ${name}.${params.seacr_mode}.bed \\\n      > ${name}.${params.seacr_mode}.narrowPeak\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "\"\"\"\n    bash /SEACR/SEACR_1.3.sh \\\n      ${bdg} \\\n      ${params.seacr_threshold} \\\n      non \\\n      ${params.seacr_mode} \\\n      ${name}\n    awk 'BEGIN {FS=\"\\t\"; OFS=\"\\t\";} {print \\$1,\\$2,\\$3,\\$6,\\$4,\".\",\\$5}' ${name}.${params.seacr_mode}.bed \\\n      > ${name}.${params.seacr_mode}.narrowPeak\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "Ganon"
        ],
        "tools_url": [
            "https://bio.tools/ganon"
        ],
        "tools_dico": [
            {
                "name": "Ganon",
                "uri": "https://bio.tools/ganon",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Model organisms"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0637",
                            "term": "Taxonomy"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3174",
                            "term": "Metagenomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0621",
                            "term": "Organisms"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3472",
                                    "term": "k-mer counting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0310",
                                    "term": "Sequence assembly"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3460",
                                    "term": "Taxonomic classification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3460",
                                    "term": "Taxonomy assignment"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Precise metagenomics classification against large and up-to-date sets of reference sequences.\n\nbenchmarking pipeline used to evaluate ganon as presented in https://www.biorxiv.org/content/10.1101/406017v3.",
                "homepage": "https://gitlab.com/rki_bioinformatics/ganon"
            }
        ],
        "inputs": [
            "ch_bedgraph_seacr"
        ],
        "nb_inputs": 1,
        "outputs": [
            "ch_seacr_peaks"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/seacr\", mode: params.publish_dir_mode"
        ],
        "when": "!params.skip_seacr",
        "stub": ""
    },
    "FILTER_MACS_PEAKS": {
        "name_process": "FILTER_MACS_PEAKS",
        "string_process": " process FILTER_MACS_PEAKS {\n        tag \"$name\"\n        publishDir \"${params.outdir}/macs\", mode: params.publish_dir_mode\n\n        input:\n        tuple val(name), path(peaks), path(flagstat), path(bam) from ch_macs_peaks.join(ch_flagstat_macs, by: [0]).join(ch_filtered_bam_filter_macs, by:[0])\n        path(bed) from ch_genome_filter_regions_macs.collect()\n        path peak_count_header from ch_peak_count_header\n        path frip_score_header from ch_frip_score_header\n\n\n        output:\n        tuple val(name), path('*.filtered.narrowPeak') into ch_filtered_macs_peaks_qc,\n                                                            ch_filtered_macs_peaks_annot\n        path '*_mqc.tsv' into ch_macs_mqc\n\n        \"\"\"\n        cat ${peaks} | \\\n          grep -v -e \"chrM\" | \\\n          sort-bed - | \\\n          bedops -n 1 - ${bed} > ${name}.filtered.narrowPeak\n\n        cat ${name}.filtered.narrowPeak | \\\n            wc -l | \\\n            awk -v OFS='\\t' '{ print \"${name}\", \\$1 }' | \\\n            cat $peak_count_header - > ${name}_peaks.count_mqc.tsv\n        READS_IN_PEAKS=\\$(intersectBed -a ${bam[0]} -b ${name}.filtered.narrowPeak -bed -c -f 0.20 | awk -F '\\t' '{sum += \\$NF} END {print sum}')\n        grep 'mapped (' $flagstat | awk -v a=\"\\$READS_IN_PEAKS\" -v OFS='\\t' '{print \"${name}\", a/\\$1}' | \\\n            cat $frip_score_header - \\\n            > ${name}_peaks.FRiP_mqc.tsv\n        \"\"\"\n    }",
        "nb_lignes_process": 30,
        "string_script": "\"\"\"\n        cat ${peaks} | \\\n          grep -v -e \"chrM\" | \\\n          sort-bed - | \\\n          bedops -n 1 - ${bed} > ${name}.filtered.narrowPeak\n\n        cat ${name}.filtered.narrowPeak | \\\n            wc -l | \\\n            awk -v OFS='\\t' '{ print \"${name}\", \\$1 }' | \\\n            cat $peak_count_header - > ${name}_peaks.count_mqc.tsv\n        READS_IN_PEAKS=\\$(intersectBed -a ${bam[0]} -b ${name}.filtered.narrowPeak -bed -c -f 0.20 | awk -F '\\t' '{sum += \\$NF} END {print sum}')\n        grep 'mapped (' $flagstat | awk -v a=\"\\$READS_IN_PEAKS\" -v OFS='\\t' '{print \"${name}\", a/\\$1}' | \\\n            cat $frip_score_header - \\\n            > ${name}_peaks.FRiP_mqc.tsv\n        \"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "Bedops"
        ],
        "tools_url": [
            "https://bio.tools/bedops"
        ],
        "tools_dico": [
            {
                "name": "Bedops",
                "uri": "https://bio.tools/bedops",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acids"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid informatics"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0361",
                                    "term": "Sequence annotation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDOPS is an open-source command-line toolkit that performs efficient and scalable Boolean and other set operations, statistical calculations, archiving, conversion and other management of genomic data of arbitrary scale. Tasks can be easily split by chromosome for distributing whole-genome analyses across a computational cluster.",
                "homepage": "https://bedops.readthedocs.io/en/latest/"
            }
        ],
        "inputs": [
            "ch_macs_peaks",
            "ch_genome_filter_regions_macs",
            "ch_peak_count_header",
            "ch_frip_score_header"
        ],
        "nb_inputs": 4,
        "outputs": [
            "ch_filtered_macs_peaks_qc",
            "ch_filtered_macs_peaks_annot",
            "ch_macs_mqc"
        ],
        "nb_outputs": 3,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/macs\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "FILTER_SEACR_PEAKS": {
        "name_process": "FILTER_SEACR_PEAKS",
        "string_process": " process FILTER_SEACR_PEAKS {\n        tag \"$name\"\n        publishDir \"${params.outdir}/seacr\", mode: params.publish_dir_mode\n\n        input:\n        tuple val(name), path(peaks) from ch_seacr_peaks\n        path(bed) from ch_genome_filter_regions_seacr.collect()\n\n        output:\n        tuple val(name), path('*.filtered.narrowPeak') into ch_filtered_seacr_peaks,\n                                                     ch_filtered_seacr_peaks_annot\n\n        \"\"\"\n        cat ${peaks} | \\\n          grep -v -e \"chrM\" | \\\n          sort-bed - | \\\n          bedops -n 1 - ${bed} > ${name}.${params.seacr_mode}.filtered.narrowPeak\n        \"\"\"\n    }",
        "nb_lignes_process": 17,
        "string_script": "\"\"\"\n        cat ${peaks} | \\\n          grep -v -e \"chrM\" | \\\n          sort-bed - | \\\n          bedops -n 1 - ${bed} > ${name}.${params.seacr_mode}.filtered.narrowPeak\n        \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [
            "Bedops"
        ],
        "tools_url": [
            "https://bio.tools/bedops"
        ],
        "tools_dico": [
            {
                "name": "Bedops",
                "uri": "https://bio.tools/bedops",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acids"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid bioinformatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0077",
                            "term": "Nucleic acid informatics"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0361",
                                    "term": "Sequence annotation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2121",
                                    "term": "Sequence file editing"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDOPS is an open-source command-line toolkit that performs efficient and scalable Boolean and other set operations, statistical calculations, archiving, conversion and other management of genomic data of arbitrary scale. Tasks can be easily split by chromosome for distributing whole-genome analyses across a computational cluster.",
                "homepage": "https://bedops.readthedocs.io/en/latest/"
            }
        ],
        "inputs": [
            "ch_seacr_peaks",
            "ch_genome_filter_regions_seacr"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_filtered_seacr_peaks",
            "ch_filtered_seacr_peaks_annot"
        ],
        "nb_outputs": 2,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/seacr\", mode: params.publish_dir_mode"
        ],
        "when": "",
        "stub": ""
    },
    "PEAK_ANNOTATION_MACS": {
        "name_process": "PEAK_ANNOTATION_MACS",
        "string_process": "\nprocess PEAK_ANNOTATION_MACS {\n    tag \"$name\"\n    publishDir \"${params.outdir}/macs\", mode: params.publish_dir_mode\n\n    when:\n    params.macs_gsize\n\n    input:\n    tuple val(name), path(peaks) from ch_filtered_macs_peaks_annot\n    path fasta from ch_fasta\n    path gtf from ch_gtf\n\n    output:\n    path '*.annotatePeaks.txt'\n\n    \"\"\"\n    annotatePeaks.pl \\\n        ${peaks} \\\n        ${fasta} \\\n        -gid \\\n        -gtf ${gtf} \\\n        > ${name}.annotatePeaks.txt\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "\"\"\"\n    annotatePeaks.pl \\\n        ${peaks} \\\n        ${fasta} \\\n        -gid \\\n        -gtf ${gtf} \\\n        > ${name}.annotatePeaks.txt\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_filtered_macs_peaks_annot",
            "ch_fasta",
            "ch_gtf"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/macs\", mode: params.publish_dir_mode"
        ],
        "when": "params.macs_gsize",
        "stub": ""
    },
    "PEAK_ANNOTATION_SEACR": {
        "name_process": "PEAK_ANNOTATION_SEACR",
        "string_process": "\nprocess PEAK_ANNOTATION_SEACR {\n    tag \"$name\"\n    publishDir \"${params.outdir}/seacr\", mode: params.publish_dir_mode\n\n    when:\n    !params.skip_seacr\n\n    input:\n    tuple val(name), path(peaks) from ch_filtered_seacr_peaks_annot\n    path fasta from ch_fasta\n    path gtf from ch_gtf\n\n    output:\n    path '*.annotatePeaks.txt'\n\n    \"\"\"\n    annotatePeaks.pl \\\n        ${peaks} \\\n        ${fasta} \\\n        -gid \\\n        -gtf ${gtf} \\\n        > ${name}.annotatePeaks.txt\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "\"\"\"\n    annotatePeaks.pl \\\n        ${peaks} \\\n        ${fasta} \\\n        -gid \\\n        -gtf ${gtf} \\\n        > ${name}.annotatePeaks.txt\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_filtered_seacr_peaks_annot",
            "ch_fasta",
            "ch_gtf"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/seacr\", mode: params.publish_dir_mode"
        ],
        "when": "!params.skip_seacr",
        "stub": ""
    },
    "PLOTPROFILE": {
        "name_process": "PLOTPROFILE",
        "string_process": "\nprocess PLOTPROFILE {\n    tag \"$name\"\n    publishDir \"${params.outdir}/deepTools/plotProfile\", mode: params.publish_dir_mode\n\n    when:\n    !params.skip_plot_profile\n\n    input:\n    tuple val(name), path(bigwig) from ch_bigwig_plotprofile\n    path bed from ch_gene_bed\n\n    output:\n    path '*.plotProfile.tab' into ch_plotprofile_mqc\n    path '*.{gz,pdf,mat.tab}'\n\n    script:\n    \"\"\"\n    computeMatrix scale-regions \\\\\n        --regionsFileName $bed \\\\\n        --scoreFileName $bigwig \\\\\n        --outFileName ${name}.computeMatrix.mat.gz \\\\\n        --outFileNameMatrix ${name}.computeMatrix.vals.mat.tab \\\\\n        --regionBodyLength 1000 \\\\\n        --beforeRegionStartLength 3000 \\\\\n        --afterRegionStartLength 3000 \\\\\n        --skipZeros \\\\\n        --smartLabels \\\\\n        --numberOfProcessors $task.cpus\n    plotProfile --matrixFile ${name}.computeMatrix.mat.gz \\\\\n        --outFileName ${name}.plotProfile.pdf \\\\\n        --outFileNameData ${name}.plotProfile.tab\n    plotHeatmap --matrixFile ${name}.computeMatrix.mat.gz \\\\\n        --outFileName ${name}.plotHeatmap.pdf \\\\\n        --outFileNameMatrix ${name}.plotHeatmap.mat.tab\n    \"\"\"\n}",
        "nb_lignes_process": 35,
        "string_script": "    \"\"\"\n    computeMatrix scale-regions \\\\\n        --regionsFileName $bed \\\\\n        --scoreFileName $bigwig \\\\\n        --outFileName ${name}.computeMatrix.mat.gz \\\\\n        --outFileNameMatrix ${name}.computeMatrix.vals.mat.tab \\\\\n        --regionBodyLength 1000 \\\\\n        --beforeRegionStartLength 3000 \\\\\n        --afterRegionStartLength 3000 \\\\\n        --skipZeros \\\\\n        --smartLabels \\\\\n        --numberOfProcessors $task.cpus\n    plotProfile --matrixFile ${name}.computeMatrix.mat.gz \\\\\n        --outFileName ${name}.plotProfile.pdf \\\\\n        --outFileNameData ${name}.plotProfile.tab\n    plotHeatmap --matrixFile ${name}.computeMatrix.mat.gz \\\\\n        --outFileName ${name}.plotHeatmap.pdf \\\\\n        --outFileNameMatrix ${name}.plotHeatmap.mat.tab\n    \"\"\"",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "ch_bigwig_plotprofile",
            "ch_gene_bed"
        ],
        "nb_inputs": 2,
        "outputs": [
            "ch_plotprofile_mqc"
        ],
        "nb_outputs": 1,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/deepTools/plotProfile\", mode: params.publish_dir_mode"
        ],
        "when": "!params.skip_plot_profile",
        "stub": ""
    },
    "MULTIQC": {
        "name_process": "MULTIQC",
        "string_process": "\nprocess MULTIQC {\n    tag \"$name\"\n    publishDir \"${params.outdir}/multiqc/\", mode: params.publish_dir_mode\n\n    when:\n    !params.skip_multiqc && params.macs_gsize && params.blacklist\n\n    input:\n    path (multiqc_config) from ch_multiqc_config\n    path workflow_summary from ch_workflow_summary.collectFile(name: 'workflow_summary_mqc.yaml')\n    path ('fastqc/*') from ch_fastqc_reports_mqc.collect().ifEmpty([])\n    path ('trim_1st/fastqc/*') from ch_trim1st_fastqc_reports_mqc.collect().ifEmpty([])\n    path ('trim_2nd/fastqc/*') from ch_trim2nd_fastqc_reports_mqc.collect().ifEmpty([])\n    path ('alignment/*') from ch_flagstat_mqc.collect()\n    path ('alignment/picard_metrics/*') from ch_picard_metrics_mqc.collect()\n    path ('macs/*') from ch_macs_mqc.collect().ifEmpty([])\n    path ('deeptools/*') from ch_plotprofile_mqc.collect().ifEmpty([])\n\n    output:\n    path '*multiqc_report.html'\n    path '*_data'\n\n    script:\n    rtitle = \"--title \\\"$params.name\\\"\"\n    rfilename = \"--filename \" + params.name + \"_multiqc_report\"\n    \"\"\"\n    multiqc . -f $rtitle $rfilename\n    \"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "    rtitle = \"--title \\\"$params.name\\\"\"\n    rfilename = \"--filename \" + params.name + \"_multiqc_report\"\n    \"\"\"\n    multiqc . -f $rtitle $rfilename\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "ch_multiqc_config",
            "ch_workflow_summary",
            "ch_fastqc_reports_mqc",
            "ch_trim1st_fastqc_reports_mqc",
            "ch_trim2nd_fastqc_reports_mqc",
            "ch_flagstat_mqc",
            "ch_picard_metrics_mqc",
            "ch_macs_mqc",
            "ch_plotprofile_mqc"
        ],
        "nb_inputs": 9,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "khigashi1987__CUTRUN_Nextflow",
        "directive": [
            "tag \"$name\"",
            "publishDir \"${params.outdir}/multiqc/\", mode: params.publish_dir_mode"
        ],
        "when": "!params.skip_multiqc && params.macs_gsize && params.blacklist",
        "stub": ""
    }
}