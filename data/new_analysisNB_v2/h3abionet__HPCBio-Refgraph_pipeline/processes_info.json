{
    "prepare_genome": {
        "name_process": "prepare_genome",
        "string_process": "\nprocess prepare_genome{\n    tag                    { \"PREP:${genome}\" }\n    executor               myExecutor\n    clusterOptions         params.clusterAcct \n    cpus                   defaultCPU\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"SAMtools/1.12-IGB-gcc-8.2.0\"\n    storeDir               genomeStore\n    \n    input:\n    file genome from genome_file\n\n    output:\n    file \"*.fai\" into genome_index_ch\n    \n    script:\n    \"\"\"\n    samtools faidx ${genome}\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    samtools faidx ${genome}\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "genome_file"
        ],
        "nb_inputs": 1,
        "outputs": [
            "genome_index_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { \"PREP:${genome}\" }",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus defaultCPU",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"SAMtools/1.12-IGB-gcc-8.2.0\"",
            "storeDir genomeStore"
        ],
        "when": "",
        "stub": ""
    },
    "qc_input": {
        "name_process": "qc_input",
        "string_process": "\nprocess qc_input {\n    tag                    { id }\n    executor               myExecutor\n    clusterOptions         params.clusterAcct \n    cpus                   defaultCPU\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"SAMtools/1.12-IGB-gcc-8.2.0\"\n    errorStrategy          { task.exitStatus=1 ? 'ignore' : 'terminate' }\n    \n    input:\n    set val(id), file(CRAM) from CRAM_Ch1\n\n    output:\n    set val(id), file('*_ok.cram') optional true into extract_unmapped_ch,extract_clipped_ch\n    \n    script:\n    \"\"\"\n    samtools quickcheck ${CRAM}\n    if [ \\$? -eq 0 ]\n    then\n        cp ${CRAM} ${id}_ok.cram\n    fi\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    samtools quickcheck ${CRAM}\n    if [ \\$? -eq 0 ]\n    then\n        cp ${CRAM} ${id}_ok.cram\n    fi\n    \"\"\"",
        "nb_lignes_script": 6,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "CRAM_Ch1"
        ],
        "nb_inputs": 1,
        "outputs": [
            "extract_unmapped_ch",
            "extract_clipped_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { id }",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus defaultCPU",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"SAMtools/1.12-IGB-gcc-8.2.0\"",
            "errorStrategy { task.exitStatus=1 ? 'ignore' : 'terminate' }"
        ],
        "when": "",
        "stub": ""
    },
    "extract_improper": {
        "name_process": "extract_improper",
        "string_process": "\nprocess extract_improper {\n    tag                    { id }\n    executor               myExecutor\n    cpus                   12\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"SAMtools/1.12-IGB-gcc-8.2.0\"\n    publishDir             \"${resultsPath}/Read-Prep/Improper\"\n    \n    input:\n    set val(id), file(cram) from extract_unmapped_ch\n    file genome from genome_file\n    file index from genome_index_ch\n\n    output:\n                            \n    set val(id), file(\"${id}.improper.bam\") into improper_unmapped_ch, improper_clipped_ch\n    \n                                                                                                  \n                                                                                              \n                                   \n    \n    script:\n    if(params.singleEnd) {\n    \n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n\n    # Uncomment below when we test SE\n    ## TODO: UNTESTED!!!!\n    ## we only need to extract reads that are unmapped, no worries about pairing\n    # samtools view -@ ${task.cpus} -hbt ${index} -f 4 -o ${id}.unmapped.bam ${cram} \n    \"\"\"\n    \n    } else {\n    \n    \"\"\"\n    # grab any non-properly paired reads (includes any unmapped and discordant reads) \n    samtools view -@ ${task.cpus} -hbt ${index} -G 2 -o ${id}.improper.bam ${cram}\n    \"\"\"\n    }\n}",
        "nb_lignes_process": 42,
        "string_script": "    if(params.singleEnd) {\n    \n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n\n    # Uncomment below when we test SE\n    ## TODO: UNTESTED!!!!\n    ## we only need to extract reads that are unmapped, no worries about pairing\n    # samtools view -@ ${task.cpus} -hbt ${index} -f 4 -o ${id}.unmapped.bam ${cram} \n    \"\"\"\n    \n    } else {\n    \n    \"\"\"\n    # grab any non-properly paired reads (includes any unmapped and discordant reads) \n    samtools view -@ ${task.cpus} -hbt ${index} -G 2 -o ${id}.improper.bam ${cram}\n    \"\"\"\n    }",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "extract_unmapped_ch",
            "genome_file",
            "genome_index_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "improper_unmapped_ch",
            "improper_clipped_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { id }",
            "executor myExecutor",
            "cpus 12",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"SAMtools/1.12-IGB-gcc-8.2.0\"",
            "publishDir \"${resultsPath}/Read-Prep/Improper\""
        ],
        "when": "",
        "stub": ""
    },
    "extract_unmapped": {
        "name_process": "extract_unmapped",
        "string_process": "\nprocess extract_unmapped {\n    tag                    { id }\n    executor               myExecutor\n    cpus                   12\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"SAMtools/1.12-IGB-gcc-8.2.0\"\n    publishDir             \"${resultsPath}/Read-Prep/Unmapped\"\n    \n    input:\n    set val(id), file(bam) from improper_unmapped_ch\n\n    output:\n    set val(id), file(\"${id}.all-unmapped.R{1,2}.fastq.gz\") optional true into fq_pe_unmapped_ch\n    set val(id), file(\"${id}.unmapped.bam\") optional true into unmapped_bam_ch                          \n\n                                                                                                  \n                                                           \n    \n    script:\n    if(params.singleEnd) {\n    \n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n\n    # Uncomment below when we test SE\n    ## TODO: UNTESTED!!!!\n    ## convert to FASTQ\n    # samtools fastq -@ ${task.cpus} ${bam} > ${id}.orphans.unmapped.fastq\n    \"\"\"\n    \n    } else {\n    \n    \"\"\"    \n    # both unmapped\n    samtools view -@ ${task.cpus} -hb \\\\\n        -f 12 -F 2304 -o ${id}.both-unmapped.bam ${bam}\n\n    samtools fastq -@ ${task.cpus} ${id}.both-unmapped.bam \\\\\n        -1 ${id}.both-unmapped.R1.fastq.gz -2 ${id}.both-unmapped.R2.fastq.gz\n\n    # R1 only unmapped\n    samtools view -@ ${task.cpus} -hb \\\\\n        -f 4 -F 2312 -o ${id}.R1-unmapped.bam ${bam}\n    samtools fastq -@ ${task.cpus} ${id}.R1-unmapped.bam \\\\\n        -1 ${id}.R1-unmapped.R1.fastq.gz -2 ${id}.R1-unmapped.R2.fastq.gz\n    \n    # R2 only unmapped\n    samtools view -@ ${task.cpus} -hb \\\\\n        -f 8 -F 2308 -o ${id}.R2-unmapped.bam ${bam}    \n    samtools fastq -@ ${task.cpus} ${id}.R2-unmapped.bam \\\\\n        -1 ${id}.R2-unmapped.R1.fastq.gz -2 ${id}.R2-unmapped.R2.fastq.gz\n    \n    # combine unmapped BAM files for later analysis\n    samtools merge -@ ${task.cpus} \\\n        ${id}.unmapped.bam \\\n        ${id}.both-unmapped.bam \\\n        ${id}.R1-unmapped.bam \\\n        ${id}.R2-unmapped.bam\n    \n    ## NOTE: in the below code we are keeping *all* paired reads if either or both are unmapped. \n    # combine R1 reads\n    cat ${id}.both-unmapped.R1.fastq.gz ${id}.R1-unmapped.R1.fastq.gz ${id}.R2-unmapped.R1.fastq.gz > ${id}.all-unmapped.R1.fastq.gz\n\n    # combine R2 reads\n    cat ${id}.both-unmapped.R2.fastq.gz ${id}.R1-unmapped.R2.fastq.gz ${id}.R2-unmapped.R2.fastq.gz > ${id}.all-unmapped.R2.fastq.gz\n\n    # combined SE unmapped FASTQ into one file for assembly\n    ## cat ${id}.R1-unmapped.R1.fastq ${id}.R2-unmapped.R2.fastq >> ${id}.orphans.unmapped.fastq\n    \n    # we could combine the mapped reads here, but we'll use the original BAM instead\n    ## cat ${id}.R1-unmapped.R2.fastq ${id}.R2-unmapped.R1.fastq >> ${id}.orphans.mapped.fastq\n    \"\"\"\n    }\n}",
        "nb_lignes_process": 75,
        "string_script": "    if(params.singleEnd) {\n    \n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n\n    # Uncomment below when we test SE\n    ## TODO: UNTESTED!!!!\n    ## convert to FASTQ\n    # samtools fastq -@ ${task.cpus} ${bam} > ${id}.orphans.unmapped.fastq\n    \"\"\"\n    \n    } else {\n    \n    \"\"\"    \n    # both unmapped\n    samtools view -@ ${task.cpus} -hb \\\\\n        -f 12 -F 2304 -o ${id}.both-unmapped.bam ${bam}\n\n    samtools fastq -@ ${task.cpus} ${id}.both-unmapped.bam \\\\\n        -1 ${id}.both-unmapped.R1.fastq.gz -2 ${id}.both-unmapped.R2.fastq.gz\n\n    # R1 only unmapped\n    samtools view -@ ${task.cpus} -hb \\\\\n        -f 4 -F 2312 -o ${id}.R1-unmapped.bam ${bam}\n    samtools fastq -@ ${task.cpus} ${id}.R1-unmapped.bam \\\\\n        -1 ${id}.R1-unmapped.R1.fastq.gz -2 ${id}.R1-unmapped.R2.fastq.gz\n    \n    # R2 only unmapped\n    samtools view -@ ${task.cpus} -hb \\\\\n        -f 8 -F 2308 -o ${id}.R2-unmapped.bam ${bam}    \n    samtools fastq -@ ${task.cpus} ${id}.R2-unmapped.bam \\\\\n        -1 ${id}.R2-unmapped.R1.fastq.gz -2 ${id}.R2-unmapped.R2.fastq.gz\n    \n    # combine unmapped BAM files for later analysis\n    samtools merge -@ ${task.cpus} \\\n        ${id}.unmapped.bam \\\n        ${id}.both-unmapped.bam \\\n        ${id}.R1-unmapped.bam \\\n        ${id}.R2-unmapped.bam\n    \n    ## NOTE: in the below code we are keeping *all* paired reads if either or both are unmapped. \n    # combine R1 reads\n    cat ${id}.both-unmapped.R1.fastq.gz ${id}.R1-unmapped.R1.fastq.gz ${id}.R2-unmapped.R1.fastq.gz > ${id}.all-unmapped.R1.fastq.gz\n\n    # combine R2 reads\n    cat ${id}.both-unmapped.R2.fastq.gz ${id}.R1-unmapped.R2.fastq.gz ${id}.R2-unmapped.R2.fastq.gz > ${id}.all-unmapped.R2.fastq.gz\n\n    # combined SE unmapped FASTQ into one file for assembly\n    ## cat ${id}.R1-unmapped.R1.fastq ${id}.R2-unmapped.R2.fastq >> ${id}.orphans.unmapped.fastq\n    \n    # we could combine the mapped reads here, but we'll use the original BAM instead\n    ## cat ${id}.R1-unmapped.R2.fastq ${id}.R2-unmapped.R1.fastq >> ${id}.orphans.mapped.fastq\n    \"\"\"\n    }",
        "nb_lignes_script": 54,
        "language_script": "bash",
        "tools": [
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "improper_unmapped_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fq_pe_unmapped_ch",
            "unmapped_bam_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { id }",
            "executor myExecutor",
            "cpus 12",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"SAMtools/1.12-IGB-gcc-8.2.0\"",
            "publishDir \"${resultsPath}/Read-Prep/Unmapped\""
        ],
        "when": "",
        "stub": ""
    },
    "extract_clipped": {
        "name_process": "extract_clipped",
        "string_process": "\nprocess extract_clipped {\n    tag                    { id }\n    executor               myExecutor\n    cpus                   12\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"SAMtools/1.12-IGB-gcc-8.2.0\",\"Python/3.7.2-IGB-gcc-8.2.0\"\n    publishDir             \"${resultsPath}/Read-Prep/Clipped\"    \n    \n    input:\n    set val(id), file(bam) from improper_clipped_ch\n\n    output:\n    set val(id), file(\"${id}.clipped.bam\") into extract_sort_ch                                           \n    set val(id), file(\"${id}.all-clipped.R{1,2}.fastq.gz\") into fq_pe_clipped_ch\n\n    script:\n    if(params.singleEnd) {\n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n    \"\"\"\n    } else {\n    \"\"\"\n    # capture only discordant clipped reads; note the -G 2\n    # the below is to prevent collisions if the pipeline is interrupted and restarted\n    tmpdir=\\$( mktemp -d /scratch/collate.XXXXXXXXX )\n    samtools collate --output-fmt bam -@ ${task.cpus - 4} -O ${bam} \\$tmpdir/${id} | \\\n        clipped-filter.py > ${id}.clipped.tmp.bam\n\n    samtools fastq -@ ${task.cpus} ${id}.clipped.tmp.bam \\\n        -1 ${id}.all-clipped.R1.fastq.gz -2 ${id}.all-clipped.R2.fastq.gz\n    \n    samtools sort -@ ${task.cpus} -o ${id}.clipped.bam ${id}.clipped.tmp.bam\n    \"\"\"\n    }\n}",
        "nb_lignes_process": 36,
        "string_script": "    if(params.singleEnd) {\n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n    \"\"\"\n    } else {\n    \"\"\"\n    # capture only discordant clipped reads; note the -G 2\n    # the below is to prevent collisions if the pipeline is interrupted and restarted\n    tmpdir=\\$( mktemp -d /scratch/collate.XXXXXXXXX )\n    samtools collate --output-fmt bam -@ ${task.cpus - 4} -O ${bam} \\$tmpdir/${id} | \\\n        clipped-filter.py > ${id}.clipped.tmp.bam\n\n    samtools fastq -@ ${task.cpus} ${id}.clipped.tmp.bam \\\n        -1 ${id}.all-clipped.R1.fastq.gz -2 ${id}.all-clipped.R2.fastq.gz\n    \n    samtools sort -@ ${task.cpus} -o ${id}.clipped.bam ${id}.clipped.tmp.bam\n    \"\"\"\n    }",
        "nb_lignes_script": 18,
        "language_script": "bash",
        "tools": [
            "SNPnotes",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/SNPnotes",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "SNPnotes",
                "uri": "https://bio.tools/SNPnotes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "Whole genome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3173",
                            "term": "Epigenomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "Genome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "WGS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3226",
                                    "term": "Variant prioritisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3778",
                                    "term": "Text annotation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "high-throughput tissue-specific functional annotation of single nucleotide variants.\n\nTissue-specific variant annotation pipeline.\n\nThis pipeline annotates variants based on multiple sources of prior knowledge, including the GWAS literature, tissue-specific open chromatin, tissue-specific modulation of gene expression, and clinical pathogenicity.\n\nTo download and prepare annotation files",
                "homepage": "https://github.com/shraddhapai/SNPNotes"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "improper_clipped_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "extract_sort_ch",
            "fq_pe_clipped_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { id }",
            "executor myExecutor",
            "cpus 12",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"SAMtools/1.12-IGB-gcc-8.2.0\",\"Python/3.7.2-IGB-gcc-8.2.0\"",
            "publishDir \"${resultsPath}/Read-Prep/Clipped\""
        ],
        "when": "",
        "stub": ""
    },
    "merge_pairs": {
        "name_process": "merge_pairs",
        "string_process": "\nprocess merge_pairs {\n    tag                    { id }\n    executor               myExecutor\n    cpus                   2\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"seqkit/0.12.1\"\n    publishDir             \"${resultsPath}/Read-Prep/Merged\"\n \n    input:\n    set val(id), file(unmapped), file(clipped) from fq_pe_unmapped_ch.join(fq_pe_clipped_ch)\n\n    output:\n    set val(id), file(\"${id}.all-reads.R{1,2}.fastq.gz\") into merge_trim_ch, merge_fastqc_ch\n    file(\"*.rmdup.txt\")\n\n    \"\"\"\n    cat ${unmapped[0]} ${clipped[0]} > ${id}.all-reads.R1.tmp.fastq.gz\n    cat ${unmapped[1]} ${clipped[1]} > ${id}.all-reads.R2.tmp.fastq.gz\n\n    seqkit rmdup -n -j ${task.cpus} -o ${id}.all-reads.R1.fastq.gz ${id}.all-reads.R1.tmp.fastq.gz 2> ${id}.R1.rmdup.txt\n    seqkit rmdup -n -j ${task.cpus} -o ${id}.all-reads.R2.fastq.gz ${id}.all-reads.R2.tmp.fastq.gz 2> ${id}.R2.rmdup.txt\n\n    rm ${id}.all-reads.R1.tmp.fastq.gz ${id}.all-reads.R2.tmp.fastq.gz\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "\"\"\"\n    cat ${unmapped[0]} ${clipped[0]} > ${id}.all-reads.R1.tmp.fastq.gz\n    cat ${unmapped[1]} ${clipped[1]} > ${id}.all-reads.R2.tmp.fastq.gz\n\n    seqkit rmdup -n -j ${task.cpus} -o ${id}.all-reads.R1.fastq.gz ${id}.all-reads.R1.tmp.fastq.gz 2> ${id}.R1.rmdup.txt\n    seqkit rmdup -n -j ${task.cpus} -o ${id}.all-reads.R2.fastq.gz ${id}.all-reads.R2.tmp.fastq.gz 2> ${id}.R2.rmdup.txt\n\n    rm ${id}.all-reads.R1.tmp.fastq.gz ${id}.all-reads.R2.tmp.fastq.gz\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "fq_pe_unmapped_ch",
            "fq_pe_clipped_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "merge_trim_ch",
            "merge_fastqc_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { id }",
            "executor myExecutor",
            "cpus 2",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"seqkit/0.12.1\"",
            "publishDir \"${resultsPath}/Read-Prep/Merged\""
        ],
        "when": "",
        "stub": ""
    },
    "fastqc": {
        "name_process": "fastqc",
        "string_process": "\nprocess fastqc {\n    tag \"FASTQC-Pretrim ${id}\"\n    executor               myExecutor\n    cpus                   2\n    queue                  params.myQueue\n    memory                 \"12 GB\"\n    module                 \"FastQC/0.11.8-Java-1.8.0_152\"\n    publishDir             \"${resultsPath}/FASTQC-Pretrim\"\n\n    input:\n    set val(id), file(reads) from merge_fastqc_ch\n\n    output:\n    file \"*_fastqc.{zip,html}\" into fastqc_results\n\n    script:\n    \"\"\"\n    fastqc --quiet --threads $task.cpus $reads\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    fastqc --quiet --threads $task.cpus $reads\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "merge_fastqc_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag \"FASTQC-Pretrim ${id}\"",
            "executor myExecutor",
            "cpus 2",
            "queue params.myQueue",
            "memory \"12 GB\"",
            "module \"FastQC/0.11.8-Java-1.8.0_152\"",
            "publishDir \"${resultsPath}/FASTQC-Pretrim\""
        ],
        "when": "",
        "stub": ""
    },
    "trimming": {
        "name_process": "trimming",
        "string_process": "\nprocess trimming {\n    tag                    { name }\n    executor               myExecutor\n    clusterOptions         params.clusterAcct \n    cpus                   2\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    publishDir             \"${resultsPath}/Read-Prep/Trimmed\"\n    module                 \"fastp/0.20.0-IGB-gcc-4.9.4\"\n\n    input:\n    set val(name), file(reads) from merge_trim_ch\n    \n    output:\n    set val(name), file('*.PE.R{1,2}.trimmed.fastq.gz'), file('*.unpR{1,2}.trimmed.fastq.gz') optional true into trim_megahit_ch, trim_masurca_ch, trim_fastqc, trim_aln_ch\n    set val(name), file('*.json') optional true into trim_multiqc_ch\n    file '*.html'\n        \n    script:\n    trimOptions      = params.skipTrim ? ' ' :  ' -l 20 --cut_right --cut_right_window_size 3 --cut_right_mean_quality 10'\n    adapterOptionsSE = params.guess_adapter ? ' ' : \" --adapter_sequence=${params.forward_adapter} \"\n    adapterOptionsPE = params.guess_adapter ? ' --detect_adapter_for_pe ' : \" --adapter_sequence=${params.forward_adapter}  --adapter_sequence_r2=${params.reverse_adapter} \"\n\n                                                                                                  \n                                                           \n\n    if(params.singleEnd){\n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n    # fastp --in1 ${reads[0]} \\\n    #   --out1 \"${name}.SE.R1.trimmed.fastq.gz\" \\\n    #   ${adapterOptionsSE} ${trimOptions} \\\n    #   --thread ${task.cpus} \\\n    #   -w ${task.cpus} \\\n    # --html \"${name}\"_SE_fastp.html \\\n    # --json \"${name}\"_SE_fastp.json\n    \"\"\"\n    \n    } else {\n    \n    \"\"\"\n    fastp --in1 ${reads[0]} \\\n        --in2 ${reads[1]} \\\n        --out1 \"${name}.PE.R1.trimmed.fastq.gz\"  \\\n        --out2 \"${name}.PE.R2.trimmed.fastq.gz\" \\\n        --unpaired1 \"${name}.unpR1.trimmed.fastq.gz\"\\\n        --unpaired2 \"${name}.unpR2.trimmed.fastq.gz\" \\\n        ${adapterOptionsPE}  ${trimOptions} \\\n        --thread ${task.cpus} -w ${task.cpus} \\\n        --html \"${name}\"_PE_fastp.html \\\n        --json \"${name}\"_PE_fastp.json\n    \"\"\"\n    \n    }\n}",
        "nb_lignes_process": 55,
        "string_script": "    trimOptions      = params.skipTrim ? ' ' :  ' -l 20 --cut_right --cut_right_window_size 3 --cut_right_mean_quality 10'\n    adapterOptionsSE = params.guess_adapter ? ' ' : \" --adapter_sequence=${params.forward_adapter} \"\n    adapterOptionsPE = params.guess_adapter ? ' --detect_adapter_for_pe ' : \" --adapter_sequence=${params.forward_adapter}  --adapter_sequence_r2=${params.reverse_adapter} \"\n\n                                                                                                  \n                                                           \n\n    if(params.singleEnd){\n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n    # fastp --in1 ${reads[0]} \\\n    #   --out1 \"${name}.SE.R1.trimmed.fastq.gz\" \\\n    #   ${adapterOptionsSE} ${trimOptions} \\\n    #   --thread ${task.cpus} \\\n    #   -w ${task.cpus} \\\n    # --html \"${name}\"_SE_fastp.html \\\n    # --json \"${name}\"_SE_fastp.json\n    \"\"\"\n    \n    } else {\n    \n    \"\"\"\n    fastp --in1 ${reads[0]} \\\n        --in2 ${reads[1]} \\\n        --out1 \"${name}.PE.R1.trimmed.fastq.gz\"  \\\n        --out2 \"${name}.PE.R2.trimmed.fastq.gz\" \\\n        --unpaired1 \"${name}.unpR1.trimmed.fastq.gz\"\\\n        --unpaired2 \"${name}.unpR2.trimmed.fastq.gz\" \\\n        ${adapterOptionsPE}  ${trimOptions} \\\n        --thread ${task.cpus} -w ${task.cpus} \\\n        --html \"${name}\"_PE_fastp.html \\\n        --json \"${name}\"_PE_fastp.json\n    \"\"\"\n    \n    }",
        "nb_lignes_script": 35,
        "language_script": "bash",
        "tools": [
            "fastPHASE"
        ],
        "tools_url": [
            "https://bio.tools/fastphase"
        ],
        "tools_dico": [
            {
                "name": "fastPHASE",
                "uri": "https://bio.tools/fastphase",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3454",
                                    "term": "Phasing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "fastPHASE is a program to estimate missing genotypes and unobserved haplotypes. It is an implementation of the model described in Scheet & Stephens (2006). This is a cluster-based model for haplotype variation, and gains its utility from implicitly modeling the genealogy of chromosomes in a random sample from a population as a tree but summarizing all haplotype variation in the \"tips\" of the trees.",
                "homepage": "http://scheet.org/software.html"
            }
        ],
        "inputs": [
            "merge_trim_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trim_megahit_ch",
            "trim_masurca_ch",
            "trim_fastqc",
            "trim_aln_ch",
            "trim_multiqc_ch"
        ],
        "nb_outputs": 5,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { name }",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 2",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "publishDir \"${resultsPath}/Read-Prep/Trimmed\"",
            "module \"fastp/0.20.0-IGB-gcc-4.9.4\""
        ],
        "when": "",
        "stub": ""
    },
    "fastqc_post": {
        "name_process": "fastqc_post",
        "string_process": "\nprocess fastqc_post {\n    tag \"FASTQC-Posttrim ${id}\"\n    executor               myExecutor\n    clusterOptions         params.clusterAcct     \n    cpus                   4\n    queue                  params.myQueue\n    memory                 \"12 GB\"\n    module                 \"FastQC/0.11.8-Java-1.8.0_152\"\n    publishDir             \"${resultsPath}/FASTQC-Posttrim\"\n\n    input:\n    set val(id), file(pereads), file(sereads) from trim_fastqc\n\n    output:\n    file \"*_fastqc.{zip,html}\" into fastqc_trimmed_results\n\n    script:\n    \"\"\"\n    fastqc --quiet --threads $task.cpus $pereads $sereads\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    \"\"\"\n    fastqc --quiet --threads $task.cpus $pereads $sereads\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "FastQC"
        ],
        "tools_url": [
            "https://bio.tools/fastqc"
        ],
        "tools_dico": [
            {
                "name": "FastQC",
                "uri": "https://bio.tools/fastqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3572",
                            "term": "Data quality management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality control"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0236",
                                    "term": "Sequence composition calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing QC"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3218",
                                    "term": "Sequencing quality assessment"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0848",
                                "term": "Raw sequence"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2955",
                                "term": "Sequence report"
                            }
                        ]
                    }
                ],
                "description": "This tool aims to provide a QC report which can spot problems or biases which originate either in the sequencer or in the starting library material. It can be run in one of two modes. It can either run as a stand alone interactive application for the immediate analysis of small numbers of FastQ files, or it can be run in a non-interactive mode where it would be suitable for integrating into a larger analysis pipeline for the systematic processing of large numbers of files.",
                "homepage": "http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
            }
        ],
        "inputs": [
            "trim_fastqc"
        ],
        "nb_inputs": 1,
        "outputs": [
            "fastqc_trimmed_results"
        ],
        "nb_outputs": 1,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag \"FASTQC-Posttrim ${id}\"",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 4",
            "queue params.myQueue",
            "memory \"12 GB\"",
            "module \"FastQC/0.11.8-Java-1.8.0_152\"",
            "publishDir \"${resultsPath}/FASTQC-Posttrim\""
        ],
        "when": "",
        "stub": ""
    },
    "megahit_assemble": {
        "name_process": "megahit_assemble",
        "string_process": "\nprocess megahit_assemble {\n    tag                    { name }\n    executor               myExecutor\n    clusterOptions         params.clusterAcct \n    cpus                   24\n    queue                  params.myQueue\n    memory                 \"$assemblerMemory GB\"\n    module                 \"MEGAHIT/1.2.9-IGB-gcc-8.2.0\" \n    publishDir             \"${resultsPath}/Raw-Assembly/megahit\"\n    \n    input:\n    set val(name), file(pefastqs), file(sefastqs) from trim_megahit_ch\n\n    output:\n    set val(name), val(\"megahit\"), file(\"${name}/final.contigs.fa\") into megahit_rename_ch\n    file(\"${name}/*\")\n\n    script:\n    if(params.singleEnd){\n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n    # megahit -1 ${fastqs[0]} -o ${name}.megahit_results\n    # \n    # perl \\$params.assemblathon ${name}.megahit_results/final.contigs.fa > ${name}.megahit_results/final.contigs.fa.stats\n    \"\"\"\n    } else {\n    \"\"\"\n    megahit -1 ${pefastqs[0]} -2 ${pefastqs[1]} \\\n        -r ${sefastqs[0]},${sefastqs[1]} \\\n        -o ${name}\n    # megahit -1 ${pefastqs[0]} -2 ${pefastqs[1]}  -o ${name}.megahit_results\n    \"\"\"\n    }\n}",
        "nb_lignes_process": 34,
        "string_script": "    if(params.singleEnd){\n    \"\"\"\n    echo \"SE support NYI\"\n    exit 1\n    # megahit -1 ${fastqs[0]} -o ${name}.megahit_results\n    # \n    # perl \\$params.assemblathon ${name}.megahit_results/final.contigs.fa > ${name}.megahit_results/final.contigs.fa.stats\n    \"\"\"\n    } else {\n    \"\"\"\n    megahit -1 ${pefastqs[0]} -2 ${pefastqs[1]} \\\n        -r ${sefastqs[0]},${sefastqs[1]} \\\n        -o ${name}\n    # megahit -1 ${pefastqs[0]} -2 ${pefastqs[1]}  -o ${name}.megahit_results\n    \"\"\"\n    }",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "MEGAHIT"
        ],
        "tools_url": [
            "https://bio.tools/megahit"
        ],
        "tools_dico": [
            {
                "name": "MEGAHIT",
                "uri": "https://bio.tools/megahit",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0610",
                            "term": "Ecology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3174",
                            "term": "Metagenomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Genome assembly"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Sequence assembly (genome assembly)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Genomic assembly"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Single node assembler for large and complex metagenomics NGS reads, such as soil. It makes use of succinct de Bruijn graph to achieve low memory usage, whereas its goal is not to make memory usage as low as possible.",
                "homepage": "https://github.com/voutcn/megahit"
            }
        ],
        "inputs": [
            "trim_megahit_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "megahit_rename_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { name }",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 24",
            "queue params.myQueue",
            "memory \"$assemblerMemory GB\"",
            "module \"MEGAHIT/1.2.9-IGB-gcc-8.2.0\"",
            "publishDir \"${resultsPath}/Raw-Assembly/megahit\""
        ],
        "when": "",
        "stub": ""
    },
    "masurca_assemble": {
        "name_process": "masurca_assemble",
        "string_process": "\nprocess masurca_assemble {\n    tag                    { name }\n    executor               myExecutor\n    clusterOptions         params.clusterAcct\n    cpus                   16\n    queue                  params.myQueue\n    memory                 \"$assemblerMemory GB\"\n    module                 \"MaSuRCA/3.4.2-IGB-gcc-8.2.0\"\n    publishDir             \"${resultsPath}/Raw-Assembly/masurca\"\n\n    input:\n    set val(name), file(pefastqs), file(sefastqs) from trim_masurca_ch\n\n    output:\n    set val(name), val(\"masurca\"), file(\"${name}/CA/final.genome.scf.fasta\") into masurca_rename_ch\n    file(\"${name}/*\")\n\n    script:\n    \"\"\"\n    mkdir ${name}\n    cd ${name}\n\n    cat << EOF > ${name}.masurca_config_file.txt\n    DATA\n    PE = pe 150 50 ../${pefastqs[0]} ../${pefastqs[1]}\n    PE = s1 150 50 ../${sefastqs[0]}\n    PE = s2 150 50 ../${sefastqs[1]}\n    END\n\n    PARAMETERS\n    GRAPH_KMER_SIZE = auto\n    USE_LINKING_MATES = 1\n    LIMIT_JUMP_COVERAGE = 300\n    CA_PARAMETERS = cgwErrorRate=0.15\n    KMER_COUNT_THRESHOLD = 1\n    NUM_THREADS = ${task.cpus}\n    JF_SIZE = 200000000\n    CLOSE_GAPS=0\n    SOAP_ASSEMBLY=0\n    DO_HOMOPOLYMER_TRIM=0\n    END\n\n    EOF\n\n    masurca ${name}.masurca_config_file.txt\n\n    ./assemble.sh\n    \"\"\"\n}",
        "nb_lignes_process": 48,
        "string_script": "    \"\"\"\n    mkdir ${name}\n    cd ${name}\n\n    cat << EOF > ${name}.masurca_config_file.txt\n    DATA\n    PE = pe 150 50 ../${pefastqs[0]} ../${pefastqs[1]}\n    PE = s1 150 50 ../${sefastqs[0]}\n    PE = s2 150 50 ../${sefastqs[1]}\n    END\n\n    PARAMETERS\n    GRAPH_KMER_SIZE = auto\n    USE_LINKING_MATES = 1\n    LIMIT_JUMP_COVERAGE = 300\n    CA_PARAMETERS = cgwErrorRate=0.15\n    KMER_COUNT_THRESHOLD = 1\n    NUM_THREADS = ${task.cpus}\n    JF_SIZE = 200000000\n    CLOSE_GAPS=0\n    SOAP_ASSEMBLY=0\n    DO_HOMOPOLYMER_TRIM=0\n    END\n\n    EOF\n\n    masurca ${name}.masurca_config_file.txt\n\n    ./assemble.sh\n    \"\"\"",
        "nb_lignes_script": 29,
        "language_script": "bash",
        "tools": [
            "Data",
            "PEC",
            "ENdb",
            "NeoFuse",
            "MaSuRCA"
        ],
        "tools_url": [
            "https://bio.tools/Data",
            "https://bio.tools/PEC",
            "https://bio.tools/ENdb",
            "https://bio.tools/NeoFuse",
            "https://bio.tools/masurca"
        ],
        "tools_dico": [
            {
                "name": "Data",
                "uri": "https://bio.tools/Data",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0623",
                            "term": "Gene and protein families"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0623",
                            "term": "Genes, gene family or system"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "> LOW CONFIDENCE! | Data set on the influence of members of a couple on family vacation decision-making | This article describes a database on the perceptions of members of a couple regarding the influence exerted in three stages (initiation, search, and final decision) and seven sub-decisions (destination, accommodation, transport, budget, date, activities, restaurants) in the family vacation decision-making process. We obtained responses from 375 couples, whose members each completed the questionnaire individually, which also enables researchers to obtain information about the consensus between the perceptions of both regarding said influence. To complement this information, we also included sociodemographic and travel behavior variables for the couples analyzed. The data are publicly available at https: github.com mmrojasgracia Data-in-Brief_Influence",
                "homepage": "https://github.com/mmrojasgracia/Data-in-Brief_Influence"
            },
            {
                "name": "PEC",
                "uri": "https://bio.tools/PEC",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0749",
                            "term": "Transcription factors and regulatory sites"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3384",
                            "term": "Medical imaging"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Medicine"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Experimental medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Clinical medicine"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3303",
                            "term": "Biomedical research"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A novel approach to the program evaluation committee.\n\nBACKGROUND:The Accreditation Council for Graduate Medical Education requires each residency program to have a Program Evaluation Committee (PEC) but does not specify how the PEC should be designed. We sought to develop a PEC that promotes resident leadership and provides actionable feedback. METHODS:Participants were residents and faculty in the Traditional Internal Medicine residency program at Yale School of Medicine (YSM). One resident and one faculty member facilitated a 1-h structured group discussion to obtain resident feedback on each rotation. PEC co-facilitators summarized the feedback in written form, then met with faculty Firm Chiefs overseeing each rotation and with residency program leadership to discuss feedback and generate action plans. This PEC process was implemented in all inpatient and outpatient rotations over a 4-year period.\n\n||| HOMEPAGE MISSING!",
                "homepage": "https://www.ncbi.nlm.nih.gov/pubmed/?term=31842868"
            },
            {
                "name": "ENdb",
                "uri": "https://bio.tools/ENdb",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0219",
                            "term": "Data submission, annotation and curation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0749",
                            "term": "Transcription factors and regulatory sites"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0440",
                                    "term": "Promoter prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0224",
                                    "term": "Query and retrieval"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2495",
                                    "term": "Expression data analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0224",
                                    "term": "Database retrieval"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A manually curated database of experimentally supported enhancers for human and mouse. Enhancers are a class of cis-regulatory elements that can increase gene transcription by forming loops in intergenic regions, introns and exons",
                "homepage": "http://www.licpathway.net/ENdb"
            },
            {
                "name": "NeoFuse",
                "uri": "https://bio.tools/NeoFuse",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2830",
                            "term": "Immunoproteins and antigens"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0154",
                            "term": "Small molecules"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Oncology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Transcriptome profiling"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA-Seq analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small RNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Small-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "Whole transcriptome shotgun sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "RNA sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3170",
                            "term": "WTSS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "Cancer biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2640",
                            "term": "https://en.wikipedia.org/wiki/Oncology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0310",
                                    "term": "Sequence assembly"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0252",
                                    "term": "Peptide immunogenicity prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3799",
                                    "term": "Quantification"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0252",
                                    "term": "Immunogenicity prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0252",
                                    "term": "Antigenicity prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3799",
                                    "term": "Quantitation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Predicting fusion neoantigens from RNA sequencing data.\n\nThe Section for Bioinformatrics at the Biocenter of Innsbruck Medical University is commited to the generation, management, integration, and leveraging data from genomics studies.\n\nQuantification of the tumor immune contexture.\n\nZlatko Trajanoski awarded with ERC Advanced Grant.",
                "homepage": "https://icbi.i-med.ac.at/NeoFuse/"
            },
            {
                "name": "MaSuRCA",
                "uri": "https://bio.tools/masurca",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0196",
                            "term": "Sequence assembly"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "Whole genome sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "Genome sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3673",
                            "term": "WGS"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Genome assembly"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Sequence assembly (genome assembly)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0525",
                                    "term": "Genomic assembly"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Whole genome assembly software. It combines the efficiency of the de\u00a0Bruijn graph and Overlap-Layout-Consensus (OLC) approaches. MaSuRCA can assemble data sets containing only short reads from Illumina sequencing or a mixture of short reads and long reads (Sanger, 454).",
                "homepage": "http://www.genome.umd.edu/masurca.html"
            }
        ],
        "inputs": [
            "trim_masurca_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "masurca_rename_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { name }",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 16",
            "queue params.myQueue",
            "memory \"$assemblerMemory GB\"",
            "module \"MaSuRCA/3.4.2-IGB-gcc-8.2.0\"",
            "publishDir \"${resultsPath}/Raw-Assembly/masurca\""
        ],
        "when": "",
        "stub": ""
    },
    "assembly_rename": {
        "name_process": "assembly_rename",
        "string_process": "\nprocess assembly_rename {\n    tag                    { name }\n    executor               myExecutor\n    clusterOptions         params.clusterAcct \n    cpus                   1\n    queue                  params.myQueue\n    memory                 \"$assemblerMemory GB\"\n                                                                           \n                                                       \n                                                         \n    publishDir             \"${resultsPath}/Final-Assembly/${assembler}\"\n\n    input:\n    set val(name), val(assembler), file(assembly) from all_assemblies_rename_ch\n\n    output:\n    set val(name), val(assembler), file(\"${name}.${assembler}.final.fasta\") into all_assemblies_metrics_ch,all_assemblies_aln_ch\n\n    script:\n                                             \n    shortname = name.replaceAll(~/\\.\\S+$/, \"\")\n    \"\"\"\n    perl -p -e 's/^>(\\\\N+)/>${name}:\\$1/' ${assembly} > ${name}.${assembler}.final.fasta\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    shortname = name.replaceAll(~/\\.\\S+$/, \"\")\n    \"\"\"\n    perl -p -e 's/^>(\\\\N+)/>${name}:\\$1/' ${assembly} > ${name}.${assembler}.final.fasta\n    \"\"\"",
        "nb_lignes_script": 3,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "all_assemblies_rename_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "all_assemblies_metrics_ch",
            "all_assemblies_aln_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag { name }",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 1",
            "queue params.myQueue",
            "memory \"$assemblerMemory GB\"",
            "publishDir \"${resultsPath}/Final-Assembly/${assembler}\""
        ],
        "when": "",
        "stub": ""
    },
    "assembly_metrics": {
        "name_process": "assembly_metrics",
        "string_process": "\nprocess assembly_metrics {\n    tag {id}\n    executor               myExecutor\n    clusterOptions         params.clusterAcct     \n    cpus                   4\n    queue                  params.myQueue\n    memory                 \"12 GB\"\n    module                 \"quast/5.0.0-IGB-gcc-4.9.4-Python-3.6.1\"\n    publishDir             \"${resultsPath}/QUAST/\"\n\n    input:\n    set val(id), val(assembler), file(asm) from all_assemblies_metrics_ch\n\n    output:\n    file \"${id}.${assembler}/*\" \n    file \"${id}.${assembler}\" into metrics_multiqc_ch\n\n    script:\n    \"\"\"\n    quast.py \\\\\n        --output-dir ${id}.${assembler} \\\\\n        --threads ${task.cpus} \\\\\n        ${asm}\n    \"\"\"\n}",
        "nb_lignes_process": 24,
        "string_script": "    \"\"\"\n    quast.py \\\\\n        --output-dir ${id}.${assembler} \\\\\n        --threads ${task.cpus} \\\\\n        ${asm}\n    \"\"\"",
        "nb_lignes_script": 5,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "all_assemblies_metrics_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "metrics_multiqc_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag {id}",
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 4",
            "queue params.myQueue",
            "memory \"12 GB\"",
            "module \"quast/5.0.0-IGB-gcc-4.9.4-Python-3.6.1\"",
            "publishDir \"${resultsPath}/QUAST/\""
        ],
        "when": "",
        "stub": ""
    },
    "aln_reads": {
        "name_process": "aln_reads",
        "string_process": "\nprocess aln_reads {\n    tag {id}\n    executor               myExecutor\n    cpus                   8\n    queue                  params.myQueue\n    clusterOptions         params.clusterAcct     \n    memory                 \"12 GB\"\n    module                 \"BWA/0.7.17-IGB-gcc-8.2.0\",\"SAMtools/1.12-IGB-gcc-8.2.0\"\n    publishDir             \"${resultsPath}/BWA-MEM/${assembler}\"\n\n    input:\n    set val(id), val(assembler), file(assembly), file(pereads), file(sereads) from all_assemblies_aln_ch.combine(trim_aln_ch, by:0)\n\n    output:\n    file \"${id}.${assembler}.sorted.pe.bam*\"\n    file \"${id}.${assembler}.sorted.se.bam*\"\n    file \"${id}.${assembler}.sorted.merged.bam*\"\n\n    script:\n    \"\"\"\n    bwa index ${assembly}\n\n    # PE\n    bwa mem -t ${task.cpus - 4} ${assembly} ${pereads[0]} ${pereads[1]} | samtools sort -@ 4 -o ${id}.${assembler}.sorted.pe.bam\n    samtools index ${id}.${assembler}.sorted.pe.bam\n\n    # SE\n    cat ${sereads[0]} ${sereads[1]} > ${id}.se.fastq.gz\n    bwa mem -t ${task.cpus - 4} ${assembly} ${id}.se.fastq.gz | samtools sort -@ 4 -o ${id}.${assembler}.sorted.se.bam\n    samtools index ${id}.${assembler}.sorted.se.bam\n\n    # merge both files\n    samtools merge -@ ${task.cpus} ${id}.${assembler}.sorted.merged.bam ${id}.${assembler}.sorted.pe.bam ${id}.${assembler}.sorted.se.bam\n    samtools index ${id}.${assembler}.sorted.merged.bam    \n    \"\"\"\n}",
        "nb_lignes_process": 35,
        "string_script": "    \"\"\"\n    bwa index ${assembly}\n\n    # PE\n    bwa mem -t ${task.cpus - 4} ${assembly} ${pereads[0]} ${pereads[1]} | samtools sort -@ 4 -o ${id}.${assembler}.sorted.pe.bam\n    samtools index ${id}.${assembler}.sorted.pe.bam\n\n    # SE\n    cat ${sereads[0]} ${sereads[1]} > ${id}.se.fastq.gz\n    bwa mem -t ${task.cpus - 4} ${assembly} ${id}.se.fastq.gz | samtools sort -@ 4 -o ${id}.${assembler}.sorted.se.bam\n    samtools index ${id}.${assembler}.sorted.se.bam\n\n    # merge both files\n    samtools merge -@ ${task.cpus} ${id}.${assembler}.sorted.merged.bam ${id}.${assembler}.sorted.pe.bam ${id}.${assembler}.sorted.se.bam\n    samtools index ${id}.${assembler}.sorted.merged.bam    \n    \"\"\"",
        "nb_lignes_script": 15,
        "language_script": "bash",
        "tools": [
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "all_assemblies_aln_ch"
        ],
        "nb_inputs": 1,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "tag {id}",
            "executor myExecutor",
            "cpus 8",
            "queue params.myQueue",
            "clusterOptions params.clusterAcct",
            "memory \"12 GB\"",
            "module \"BWA/0.7.17-IGB-gcc-8.2.0\",\"SAMtools/1.12-IGB-gcc-8.2.0\"",
            "publishDir \"${resultsPath}/BWA-MEM/${assembler}\""
        ],
        "when": "",
        "stub": ""
    },
    "MultiQC": {
        "name_process": "MultiQC",
        "string_process": "\nprocess MultiQC {\n    executor               myExecutor\n    clusterOptions         params.clusterAcct \n    cpus                   2\n    queue                  params.myQueue\n    memory                 \"$defaultMemory GB\"\n    module                 \"MultiQC/1.11-IGB-gcc-8.2.0-Python-3.7.2\"\n    publishDir             \"${resultsPath}/MultiQC\"\n \n    input:\n    file('./QUAST/*') from metrics_multiqc_ch.collect().ifEmpty([])\n    file('./FASTQC-Pretrim/*') from fastqc_results.collect().ifEmpty([])\n    file('./FASTQC-Posttrim/*') from fastqc_trimmed_results.collect().ifEmpty([])\n    file('./FASTP/*') from trim_multiqc_ch.collect().ifEmpty([])\n\n    output:\n    file \"multiqc*\"\n\n    \"\"\"\n    multiqc  .\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n    multiqc  .\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "MultiQC"
        ],
        "tools_url": [
            "https://bio.tools/multiqc"
        ],
        "tools_dico": [
            {
                "name": "MultiQC",
                "uri": "https://bio.tools/multiqc",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0091",
                            "term": "Bioinformatics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2428",
                                    "term": "Validation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "MultiQC aggregates results from multiple bioinformatics analyses across many samples into a single report. It searches a given directory for analysis logs and compiles a HTML report. It's a general use tool, perfect for summarising the output from numerous bioinformatics tools.",
                "homepage": "http://multiqc.info/"
            }
        ],
        "inputs": [
            "metrics_multiqc_ch",
            "fastqc_results",
            "fastqc_trimmed_results",
            "trim_multiqc_ch"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "h3abionet__HPCBio-Refgraph_pipeline",
        "directive": [
            "executor myExecutor",
            "clusterOptions params.clusterAcct",
            "cpus 2",
            "queue params.myQueue",
            "memory \"$defaultMemory GB\"",
            "module \"MultiQC/1.11-IGB-gcc-8.2.0-Python-3.7.2\"",
            "publishDir \"${resultsPath}/MultiQC\""
        ],
        "when": "",
        "stub": ""
    }
}