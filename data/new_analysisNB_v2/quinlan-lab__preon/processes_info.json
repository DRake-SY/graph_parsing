{
    "map_reads": {
        "name_process": "map_reads",
        "string_process": "\nprocess map_reads {\n    tag { \"${sample_id}_${run_id}\" }\n\n    input:\n    set sample_id, status, run_id, idx, file(r1), file(r2) from fastq_ch\n    file(fasta)\n    file(bwaidx) from bwaidx_ch\n\n    output:\n    set sample_id, file(\"${sample_id}_${run_id}_${idx}.bam\") into bwa_ch\n\n    script:\n    rg = \"@RG\\\\tID:${run_id}\\\\tPU:${run_id}\\\\tSM:${sample_id}\\\\tLB:${sample_id}\\\\tPL:illumina\"\n    \"\"\"\n    bwa mem -K 100000000 -R \\\"${rg}\\\" -t ${task.cpus} -M $fasta $r1 $r2 \\\n        | samtools sort -n --threads ${task.cpus} -m 2G --output-fmt BAM -o ${sample_id}_${run_id}_${idx}.bam\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    rg = \"@RG\\\\tID:${run_id}\\\\tPU:${run_id}\\\\tSM:${sample_id}\\\\tLB:${sample_id}\\\\tPL:illumina\"\n    \"\"\"\n    bwa mem -K 100000000 -R \\\"${rg}\\\" -t ${task.cpus} -M $fasta $r1 $r2 \\\n        | samtools sort -n --threads ${task.cpus} -m 2G --output-fmt BAM -o ${sample_id}_${run_id}_${idx}.bam\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [
            "org",
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/org",
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "org",
                "uri": "https://bio.tools/org",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_2229",
                            "term": "Cell biology"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0602",
                            "term": "Molecular interactions, pathways and networks"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype and phenotype resources"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0625",
                            "term": "Genotype-phenotype"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3659",
                                    "term": "Regression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Expression correlation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3463",
                                    "term": "Co-expression analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Genome-wide mutation profiling and related risk signature for prognosis of papillary renal cell carcinoma.\n\nBackground:The papillary renal cell carcinoma (pRCC) is a rare subtype of renal cell carcinoma with limited investigation. Our study aimed to explore a robust signature to predict the prognosis of pRCC from the perspective of mutation profiles. Methods:In this study, we downloaded the simple nucleotide variation data of 288 pRCC samples from The Cancer Genome Atlas (TCGA) database. \"GenVisR\" package was utilized to visualize gene mutation profiles in pRCC. The PPI network was conducted based on the STRING database and the modification was performed via Cytoscape software (Version 3.7.1). Top 50 mutant genes were selected and Cox regression method was conducted to identify the hub prognostic mutant signature in pRCC using \"survival\" package.\n\n||| HOMEPAGE BROKEN!.\n\n||| CORRECT NAME OF TOOL COULD ALSO BE 'pRCC', 'GenVisR' (bio.tools/genvisr)",
                "homepage": "http://org.Hs.eg.db"
            },
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "fastq_ch",
            "fasta",
            "bwaidx_ch"
        ],
        "nb_inputs": 3,
        "outputs": [
            "bwa_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "tag { \"${sample_id}_${run_id}\" }"
        ],
        "when": "",
        "stub": ""
    },
    "mark_duplicates": {
        "name_process": "mark_duplicates",
        "string_process": "\nprocess mark_duplicates {\n    tag \"${sample_id}\"\n    publishDir path: \"$outdir/alignments\"\n\n    input:\n    set sample_id, file(bam) from bwa_ch.groupTuple()\n\n    output:\n    file(\"${sample_id}.md.bam\") into (alignments_ch, alignments_upload_ch, create_call_bams_ch)\n    file(\"${sample_id}.md.bam.bai\") into (alignment_indexes_ch, alignment_indexes_upload_ch, indexcov_input_ch)\n\n    script:\n    \"\"\"\n    gatk --java-options -Xmx${task.memory.toGiga()}g MarkDuplicatesSpark \\\n        ${bam.collect { \"--input $it\" }.join(\" \")} \\\n        --output ${sample_id}.md.bam \\\n        --tmp-dir . \\\n        --spark-master \\'local[*]\\'\n    gatk --java-options -Xmx${task.memory.toGiga()}g BuildBamIndex \\\n        --INPUT ${sample_id}.md.bam \\\n        --OUTPUT ${sample_id}.md.bam.bai \\\n        --TMP_DIR .\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    \"\"\"\n    gatk --java-options -Xmx${task.memory.toGiga()}g MarkDuplicatesSpark \\\n        ${bam.collect { \"--input $it\" }.join(\" \")} \\\n        --output ${sample_id}.md.bam \\\n        --tmp-dir . \\\n        --spark-master \\'local[*]\\'\n    gatk --java-options -Xmx${task.memory.toGiga()}g BuildBamIndex \\\n        --INPUT ${sample_id}.md.bam \\\n        --OUTPUT ${sample_id}.md.bam.bai \\\n        --TMP_DIR .\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "GATK"
        ],
        "tools_url": [
            "https://bio.tools/gatk"
        ],
        "tools_dico": [
            {
                "name": "GATK",
                "uri": "https://bio.tools/gatk",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Workflows"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0769",
                            "term": "Pipelines"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3202",
                                    "term": "Polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2403",
                                    "term": "Sequence analysis (general)"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "The Genome Analysis Toolkit (GATK) is a set of bioinformatic tools for analyzing high-throughput sequencing (HTS) and variant call format (VCF) data. The toolkit is well established for germline short variant discovery from whole genome and exome sequencing data. GATK4 expands functionality into copy number and somatic analyses and offers pipeline scripts for workflows.  \n\nVersion 4 (GATK4) is open-source at https://github.com/broadinstitute/gatk.",
                "homepage": "https://software.broadinstitute.org/gatk/"
            }
        ],
        "inputs": [
            "bwa_ch"
        ],
        "nb_inputs": 1,
        "outputs": [
            "",
            ""
        ],
        "nb_outputs": 2,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "tag \"${sample_id}\"",
            "publishDir path: \"$outdir/alignments\""
        ],
        "when": "",
        "stub": ""
    },
    "upload_alignments": {
        "name_process": "upload_alignments",
        "string_process": "\nprocess upload_alignments {\n    label 'upload'\n\n    input:\n    val token from params.authtoken\n    val sbgproject from params.sbgproject\n    file(bam) from alignments_upload_ch\n    file(bai) from alignment_indexes_upload_ch\n\n    when:\n    token != \"\"\n\n    script:\n    \"\"\"\n    sbg-uploader.sh -t $token -p $sbgproject -f WGS/bam/ $bam $bai\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    sbg-uploader.sh -t $token -p $sbgproject -f WGS/bam/ $bam $bai\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "params",
            "params",
            "alignments_upload_ch",
            "alignment_indexes_upload_ch"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'upload'"
        ],
        "when": "token != \"\"",
        "stub": ""
    },
    "run_freebayes": {
        "name_process": "run_freebayes",
        "string_process": "\nprocess run_freebayes {\n    tag \"$interval\"\n\n    input:\n    file(aln) from alignments_ch.collect()\n    file(idx) from alignment_indexes_ch.collect()\n    each interval from intervals_ch\n    file(fasta)\n    file(faidx)\n\n    output:\n                                               \n    file(\"${params.project}_${interval.replaceAll(~/\\:|\\-|\\*/, \"_\")}.vcf.gz\") into (unannotated_ch, vcf_ch)\n\n    script:\n    \"\"\"\n    freebayes \\\n        --fasta-reference ${fasta} \\\n        ${params.freebayesoptions} \\\n        --region ${interval} \\\n        ${aln.collect { \"--bam $it\" }.join(\" \")} \\\n        | bgzip -c > ${params.project}_${interval.replaceAll(~/\\:|\\-|\\*/, \"_\")}.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 23,
        "string_script": "    \"\"\"\n    freebayes \\\n        --fasta-reference ${fasta} \\\n        ${params.freebayesoptions} \\\n        --region ${interval} \\\n        ${aln.collect { \"--bam $it\" }.join(\" \")} \\\n        | bgzip -c > ${params.project}_${interval.replaceAll(~/\\:|\\-|\\*/, \"_\")}.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "FreeBayes"
        ],
        "tools_url": [
            "https://bio.tools/freebayes"
        ],
        "tools_dico": [
            {
                "name": "FreeBayes",
                "uri": "https://bio.tools/freebayes",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs, indels, multi-nucleotide polymorphisms, and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.",
                "homepage": "https://github.com/ekg/freebayes"
            }
        ],
        "inputs": [
            "alignments_ch",
            "alignment_indexes_ch",
            "intervals_ch",
            "fasta",
            "faidx"
        ],
        "nb_inputs": 5,
        "outputs": [
            ""
        ],
        "nb_outputs": 1,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "tag \"$interval\""
        ],
        "when": "",
        "stub": ""
    },
    "merge_vcfs": {
        "name_process": "merge_vcfs",
        "string_process": "\nprocess merge_vcfs {\n    publishDir path: \"$outdir/freebayes\"\n\n    input:\n    file(vcf) from unannotated_ch.collect()\n    file(fasta)\n    file(faidx)\n\n    output:\n    file(\"${params.project}.vcf.gz\") into freebayesvcf_ch\n    file(\"${params.project}.vcf.gz.tbi\") into freebayesvcfidx_ch\n\n    script:\n    \"\"\"\n    gunzip -cd $vcf | vcffirstheader | bgzip -c > ${params.project}_dirty.vcf.gz\n    gsort ${params.project}_dirty.vcf.gz $faidx | vcfuniq \\\n        | bgzip -c > ${params.project}_dirty_sorted.vcf.gz\n    bcftools norm -c all -f $fasta --multiallelics - --threads ${task.cpus} \\\n        --output ${params.project}.vcf.gz --output-type z \\\n        ${params.project}_dirty_sorted.vcf.gz\n    tabix -p vcf ${params.project}.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    gunzip -cd $vcf | vcffirstheader | bgzip -c > ${params.project}_dirty.vcf.gz\n    gsort ${params.project}_dirty.vcf.gz $faidx | vcfuniq \\\n        | bgzip -c > ${params.project}_dirty_sorted.vcf.gz\n    bcftools norm -c all -f $fasta --multiallelics - --threads ${task.cpus} \\\n        --output ${params.project}.vcf.gz --output-type z \\\n        ${params.project}_dirty_sorted.vcf.gz\n    tabix -p vcf ${params.project}.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "unannotated_ch",
            "fasta",
            "faidx"
        ],
        "nb_inputs": 3,
        "outputs": [
            "freebayesvcf_ch",
            "freebayesvcfidx_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "publishDir path: \"$outdir/freebayes\""
        ],
        "when": "",
        "stub": ""
    },
    "upload_vcfs": {
        "name_process": "upload_vcfs",
        "string_process": "\nprocess upload_vcfs {\n    label 'upload'\n\n    input:\n    val token from params.authtoken\n    val sbgproject from params.sbgproject\n    file(vcf) from freebayesvcf_ch\n    file(tbi) from freebayesvcfidx_ch\n\n    when:\n    token != \"\"\n\n    script:\n    \"\"\"\n    sbg-uploader.sh -t $token -p $sbgproject -f WGS/freebayes/ $vcf $tbi\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    sbg-uploader.sh -t $token -p $sbgproject -f WGS/freebayes/ $vcf $tbi\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "params",
            "params",
            "freebayesvcf_ch",
            "freebayesvcfidx_ch"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'upload'"
        ],
        "when": "token != \"\"",
        "stub": ""
    },
    "annotate_vcf": {
        "name_process": "annotate_vcf",
        "string_process": "\nprocess annotate_vcf {\n    input:\n    file(vcf) from vcf_ch\n    file(cadd_indel)\n    file(cadd_indel_idx)\n    file(cadd_snv)\n    file(cadd_snv_idx)\n\n    output:\n    file(\"${vcf.baseName}.vep.vcf.gz\") into annotated_ch\n\n    script:\n    cadd = (params.caddsnv && params.caddindel) ? \"--plugin CADD,${cadd_snv},${cadd_indel}\" : \"\"\n    \"\"\"\n    vep --input_file $vcf --output_file ${vcf.baseName}.vep.vcf --format vcf --assembly GRCh38 \\\n        --cache --cache_version 95 --dir_cache /.vep --fork 2 $cadd --offline \\\n        --everything --filter_common --per_gene --total_length --vcf --force_overwrite \\\n        --buffer_size 15000\n    gzip ${vcf.baseName}.vep.vcf\n    \"\"\"\n}",
        "nb_lignes_process": 20,
        "string_script": "    cadd = (params.caddsnv && params.caddindel) ? \"--plugin CADD,${cadd_snv},${cadd_indel}\" : \"\"\n    \"\"\"\n    vep --input_file $vcf --output_file ${vcf.baseName}.vep.vcf --format vcf --assembly GRCh38 \\\n        --cache --cache_version 95 --dir_cache /.vep --fork 2 $cadd --offline \\\n        --everything --filter_common --per_gene --total_length --vcf --force_overwrite \\\n        --buffer_size 15000\n    gzip ${vcf.baseName}.vep.vcf\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "CADD",
            "fivepseq"
        ],
        "tools_url": [
            "https://bio.tools/cadd_phred",
            "https://bio.tools/fivepseq"
        ],
        "tools_dico": [
            {
                "name": "CADD",
                "uri": "https://bio.tools/cadd_phred",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2269",
                            "term": "Statistics and probability"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3574",
                            "term": "Human genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3063",
                            "term": "Medical informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3063",
                            "term": "Biomedical informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3063",
                            "term": "Healthcare informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3063",
                            "term": "Health informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3063",
                            "term": "Health and disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3063",
                            "term": "Clinical informatics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical calculation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3226",
                                    "term": "Variant prioritisation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Significance testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical testing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical test"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2238",
                                    "term": "Statistical analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "GSEA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Functional enrichment analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2436",
                                    "term": "Gene-set over-represenation analysis"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Combined Annotation Dependent Depletion (CADD) - tool for scoring the deleteriousness of single nucleotide variants as well as insertion/deletions variants in the human genome.",
                "homepage": "http://cadd.gs.washington.edu/"
            },
            {
                "name": "fivepseq",
                "uri": "https://bio.tools/fivepseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3563",
                                    "term": "RNA-seq read count analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fivepseq is a software package for analysis of 5prime endpoints distribution in RNA sequencing datasets. This is particularly useful for techniques that capture 5prime  monophosphorylated RNAs, such as 5PSeq, PARE-seq or GMUC. It may also be useful for ribosome profiling datasets and alike.",
                "homepage": "http://pelechanolab.com/software/fivepseq"
            }
        ],
        "inputs": [
            "vcf_ch",
            "cadd_indel",
            "cadd_indel_idx",
            "cadd_snv",
            "cadd_snv_idx"
        ],
        "nb_inputs": 5,
        "outputs": [
            "annotated_ch"
        ],
        "nb_outputs": 1,
        "name_workflow": "quinlan-lab__preon",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "merge_annotated_vcfs": {
        "name_process": "merge_annotated_vcfs",
        "string_process": "\nprocess merge_annotated_vcfs {\n    publishDir path: \"$outdir/vep\"\n\n    input:\n    file(vcf) from annotated_ch.collect()\n    file(fasta)\n    file(faidx)\n\n    output:\n    file(\"${params.project}.vcf.gz\") into (vepvcf_ch, somaticvcf_ch)\n    file(\"${params.project}.vcf.gz.tbi\") into vepvcfidx_ch\n\n    script:\n    \"\"\"\n    gunzip -cd $vcf | vcffirstheader | bgzip -c > ${params.project}_dirty.vcf.gz\n    gsort ${params.project}_dirty.vcf.gz $faidx | vcfuniq \\\n        | bgzip -c > ${params.project}_dirty_sorted.vcf.gz\n    bcftools norm -c all -f $fasta --multiallelics - --threads ${task.cpus} \\\n        --output ${params.project}.vcf.gz --output-type z \\\n        ${params.project}_dirty_sorted.vcf.gz\n    tabix -p vcf ${params.project}.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 22,
        "string_script": "    \"\"\"\n    gunzip -cd $vcf | vcffirstheader | bgzip -c > ${params.project}_dirty.vcf.gz\n    gsort ${params.project}_dirty.vcf.gz $faidx | vcfuniq \\\n        | bgzip -c > ${params.project}_dirty_sorted.vcf.gz\n    bcftools norm -c all -f $fasta --multiallelics - --threads ${task.cpus} \\\n        --output ${params.project}.vcf.gz --output-type z \\\n        ${params.project}_dirty_sorted.vcf.gz\n    tabix -p vcf ${params.project}.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "annotated_ch",
            "fasta",
            "faidx"
        ],
        "nb_inputs": 3,
        "outputs": [
            "",
            "vepvcfidx_ch"
        ],
        "nb_outputs": 2,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "publishDir path: \"$outdir/vep\""
        ],
        "when": "",
        "stub": ""
    },
    "upload_annotated_vcfs": {
        "name_process": "upload_annotated_vcfs",
        "string_process": "\nprocess upload_annotated_vcfs {\n    label 'upload'\n\n    input:\n    val token from params.authtoken\n    val sbgproject from params.sbgproject\n    file(vcf) from vepvcf_ch\n    file(tbi) from vepvcfidx_ch\n\n    when:\n    token != \"\"\n\n    script:\n    \"\"\"\n    sbg-uploader.sh -t $token -p $sbgproject -f WGS/vep/ $vcf $tbi\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    sbg-uploader.sh -t $token -p $sbgproject -f WGS/vep/ $vcf $tbi\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "params",
            "params",
            "vepvcf_ch",
            "vepvcfidx_ch"
        ],
        "nb_inputs": 4,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'upload'"
        ],
        "when": "token != \"\"",
        "stub": ""
    },
    "smoove_call": {
        "name_process": "smoove_call",
        "string_process": "\nprocess smoove_call {\n    label 'smoove'\n    publishDir path: \"$outdir/sv/smoove/called\", pattern: \"*.vcf.gz*\"\n    publishDir path: \"$outdir/sv/logs\", pattern: \"*-stats.txt\"\n    publishDir path: \"$outdir/sv/logs\", pattern: \"*-smoove-call.log\"\n\n    input:\n    env SMOOVE_KEEP_ALL from params.sensitive\n    set sample, file(bam), file(bai) from call_bams\n    file fasta\n    file faidx\n    file bed\n\n    output:\n    file(\"${sample}-smoove.genotyped.vcf.gz\") into call_vcfs\n    file(\"${sample}-smoove.genotyped.vcf.gz.csi\") into call_idxs\n    file(\"${sample}-stats.txt\") into variant_counts\n    file(\"${sample}-smoove-call.log\") into sequence_counts\n\n    script:\n    excludechroms = params.exclude ? \"--excludechroms \\\"${params.exclude}\\\"\" : \"\"\n    filters = params.sensitive ? \"--noextrafilters\" : \"\"\n    \"\"\"\n    smoove call --genotype --name $sample --processes ${task.cpus} \\\n        --fasta $fasta --exclude $bed $excludechroms $filters \\\n        $bam 2> >(tee -a ${sample}-smoove-call.log >&2)\n    bcftools stats ${sample}-smoove.genotyped.vcf.gz > ${sample}-stats.txt\n    \"\"\"\n}",
        "nb_lignes_process": 28,
        "string_script": "    excludechroms = params.exclude ? \"--excludechroms \\\"${params.exclude}\\\"\" : \"\"\n    filters = params.sensitive ? \"--noextrafilters\" : \"\"\n    \"\"\"\n    smoove call --genotype --name $sample --processes ${task.cpus} \\\n        --fasta $fasta --exclude $bed $excludechroms $filters \\\n        $bam 2> >(tee -a ${sample}-smoove-call.log >&2)\n    bcftools stats ${sample}-smoove.genotyped.vcf.gz > ${sample}-stats.txt\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "params",
            "call_bams",
            "fasta",
            "faidx",
            "bed"
        ],
        "nb_inputs": 5,
        "outputs": [
            "call_vcfs",
            "call_idxs",
            "variant_counts",
            "sequence_counts"
        ],
        "nb_outputs": 4,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'smoove'",
            "publishDir path: \"$outdir/sv/smoove/called\", pattern: \"*.vcf.gz*\"",
            "publishDir path: \"$outdir/sv/logs\", pattern: \"*-stats.txt\"",
            "publishDir path: \"$outdir/sv/logs\", pattern: \"*-smoove-call.log\""
        ],
        "when": "",
        "stub": ""
    },
    "smoove_merge": {
        "name_process": "smoove_merge",
        "string_process": "\nprocess smoove_merge {\n    label 'smoove'\n\n    input:\n    file vcf from call_vcfs.collect()\n    file idx from call_idxs.collect()\n    file fasta\n    file faidx\n\n    output:\n    file(\"${params.project}.sites.vcf.gz\") into sites\n\n    script:\n    \"\"\"\n    smoove merge --name ${params.project} --fasta $fasta $vcf\n    \"\"\"\n}",
        "nb_lignes_process": 16,
        "string_script": "    \"\"\"\n    smoove merge --name ${params.project} --fasta $fasta $vcf\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "call_vcfs",
            "call_idxs",
            "fasta",
            "faidx"
        ],
        "nb_inputs": 4,
        "outputs": [
            "sites"
        ],
        "nb_outputs": 1,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'smoove'"
        ],
        "when": "",
        "stub": ""
    },
    "smoove_genotype": {
        "name_process": "smoove_genotype",
        "string_process": "\nprocess smoove_genotype {\n    label 'smoove'\n    publishDir path: \"$outdir/sv/smoove/genotyped\"\n\n    input:\n    env SMOOVE_KEEP_ALL from params.sensitive\n    set sample, file(bam), file(bai) from genotype_bams\n    file sites\n    file fasta\n    file faidx\n\n    output:\n    file(\"${sample}-smoove.genotyped.vcf.gz.csi\") into genotyped_idxs\n    file(\"${sample}-smoove.genotyped.vcf.gz\") into genotyped_vcfs\n\n    script:\n    \"\"\"\n    wget -q https://raw.githubusercontent.com/samtools/samtools/develop/misc/seq_cache_populate.pl\n    perl seq_cache_populate.pl -root \\$(pwd)/cache $fasta 1> /dev/null 2> err || (cat err; exit 2)\n    export REF_PATH=\\$(pwd)/cache/%2s/%2s/%s:http://www.ebi.ac.uk/ena/cram/md5/%s\n    export REF_CACHE=xx\n\n    samtools quickcheck -v $bam\n    smoove genotype --duphold --processes ${task.cpus} --removepr --outdir ./ --name ${sample} --fasta $fasta --vcf $sites $bam\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "    \"\"\"\n    wget -q https://raw.githubusercontent.com/samtools/samtools/develop/misc/seq_cache_populate.pl\n    perl seq_cache_populate.pl -root \\$(pwd)/cache $fasta 1> /dev/null 2> err || (cat err; exit 2)\n    export REF_PATH=\\$(pwd)/cache/%2s/%2s/%s:http://www.ebi.ac.uk/ena/cram/md5/%s\n    export REF_CACHE=xx\n\n    samtools quickcheck -v $bam\n    smoove genotype --duphold --processes ${task.cpus} --removepr --outdir ./ --name ${sample} --fasta $fasta --vcf $sites $bam\n    \"\"\"",
        "nb_lignes_script": 8,
        "language_script": "bash",
        "tools": [
            "NullSeq",
            "Terra",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/nullseq",
            "https://bio.tools/Terra",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "NullSeq",
                "uri": "https://bio.tools/nullseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0364",
                                    "term": "Random sequence generation"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Creates Random Coding Sequences with specified GC content and Amino Acid usage.",
                "homepage": "https://github.com/amarallab/NullSeq"
            },
            {
                "name": "Terra",
                "uri": "https://bio.tools/Terra",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3316",
                            "term": "Computer science"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3810",
                            "term": "Agricultural science"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0610",
                            "term": "Ecology"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Terra Populus' Architecture for Integrated Big Geospatial Services | Boundaries are missing for the selected sample geography. Please select a different sample geography",
                "homepage": "https://data.terrapop.org/"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "params",
            "genotype_bams",
            "sites",
            "fasta",
            "faidx"
        ],
        "nb_inputs": 5,
        "outputs": [
            "genotyped_idxs",
            "genotyped_vcfs"
        ],
        "nb_outputs": 2,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'smoove'",
            "publishDir path: \"$outdir/sv/smoove/genotyped\""
        ],
        "when": "",
        "stub": ""
    },
    "smoove_square": {
        "name_process": "smoove_square",
        "string_process": "\nprocess smoove_square {\n    label 'smoove'\n    publishDir path: \"$outdir/sv/smoove/annotated\", pattern: \"*.vcf.gz*\"\n    publishDir path: \"$outdir/reports/bpbio\", pattern: \"*.html\"\n\n    input:\n    file vcf from genotyped_vcfs.collect()\n    file idx from genotyped_idxs.collect()\n    file gff\n\n    output:\n    file(\"${params.project}.smoove.square.anno.vcf.gz\") into square_vcf\n    file(\"${params.project}.smoove.square.anno.vcf.gz.csi\") into square_idx\n    file(\"svvcf.html\") into svvcf\n\n    script:\n    smoovepaste = \"smoove paste --outdir ./ --name ${params.project} $vcf\"\n    if( vcf.collect().size() < 2 ) {\n        paste = \"cp $vcf ${params.project}.smoove.square.vcf.gz && cp $idx ${params.project}.smoove.square.vcf.gz.csi\"\n    }\n    \"\"\"\n    $smoovepaste\n\n    smoove annotate --gff $gff ${params.project}.smoove.square.vcf.gz | bgzip --threads ${task.cpus} -c > ${params.project}.smoove.square.anno.vcf.gz\n    bcftools index ${params.project}.smoove.square.anno.vcf.gz\n    bpbio plot-sv-vcf ${params.project}.smoove.square.anno.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 27,
        "string_script": "    smoovepaste = \"smoove paste --outdir ./ --name ${params.project} $vcf\"\n    if( vcf.collect().size() < 2 ) {\n        paste = \"cp $vcf ${params.project}.smoove.square.vcf.gz && cp $idx ${params.project}.smoove.square.vcf.gz.csi\"\n    }\n    \"\"\"\n    $smoovepaste\n\n    smoove annotate --gff $gff ${params.project}.smoove.square.vcf.gz | bgzip --threads ${task.cpus} -c > ${params.project}.smoove.square.anno.vcf.gz\n    bcftools index ${params.project}.smoove.square.anno.vcf.gz\n    bpbio plot-sv-vcf ${params.project}.smoove.square.anno.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 10,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "genotyped_vcfs",
            "genotyped_idxs",
            "gff"
        ],
        "nb_inputs": 3,
        "outputs": [
            "square_vcf",
            "square_idx",
            "svvcf"
        ],
        "nb_outputs": 3,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'smoove'",
            "publishDir path: \"$outdir/sv/smoove/annotated\", pattern: \"*.vcf.gz*\"",
            "publishDir path: \"$outdir/reports/bpbio\", pattern: \"*.html\""
        ],
        "when": "",
        "stub": ""
    },
    "run_indexcov": {
        "name_process": "run_indexcov",
        "string_process": "\nprocess run_indexcov {\n    label 'covviz'\n    publishDir path: \"$outdir/reports/indexcov\"\n\n    input:\n    file idx from indexcov_input_ch.collect()\n    file faidx\n\n    output:\n    file(\"${params.project}*.png\")\n    file(\"*.html\")\n    file(\"${params.project}*.bed.gz\") into bed_ch\n    file(\"${params.project}*.ped\") into indexcov_ped_ch\n    file(\"${params.project}*.roc\") into roc_ch\n\n    script:\n    excludepatt = params.exclude ? \"--excludepatt \\\"${params.exclude}\\\"\" : \"\"\n    \"\"\"\n    goleft indexcov --sex $sexchroms $excludepatt --directory ${params.project} --fai $faidx $idx\n    mv ${params.project}/* .\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    excludepatt = params.exclude ? \"--excludepatt \\\"${params.exclude}\\\"\" : \"\"\n    \"\"\"\n    goleft indexcov --sex $sexchroms $excludepatt --directory ${params.project} --fai $faidx $idx\n    mv ${params.project}/* .\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "indexcov_input_ch",
            "faidx"
        ],
        "nb_inputs": 2,
        "outputs": [
            "bed_ch",
            "indexcov_ped_ch",
            "roc_ch"
        ],
        "nb_outputs": 3,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "label 'covviz'",
            "publishDir path: \"$outdir/reports/indexcov\""
        ],
        "when": "",
        "stub": ""
    },
    "build_covviz_report": {
        "name_process": "build_covviz_report",
        "string_process": "\nprocess build_covviz_report {\n    publishDir path: \"$outdir/reports\", mode: \"copy\", pattern: \"*.html\"\n    label 'covviz'\n    cache 'lenient'\n\n    input:\n    file ped from indexcov_ped_ch\n    file bed from bed_ch\n    file gff\n\n    output:\n    file(\"covviz_report.html\")\n\n    script:\n    \"\"\"\n    covviz --min-samples ${params.minsamples} --sex-chroms $sexchroms --exclude '${params.exclude}' \\\n        --skip-norm --z-threshold ${params.zthreshold} --distance-threshold ${params.distancethreshold} \\\n        --slop ${params.slop} --ped $ped --gff $gff $bed\n    \"\"\"\n}",
        "nb_lignes_process": 19,
        "string_script": "    \"\"\"\n    covviz --min-samples ${params.minsamples} --sex-chroms $sexchroms --exclude '${params.exclude}' \\\n        --skip-norm --z-threshold ${params.zthreshold} --distance-threshold ${params.distancethreshold} \\\n        --slop ${params.slop} --ped $ped --gff $gff $bed\n    \"\"\"",
        "nb_lignes_script": 4,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "indexcov_ped_ch",
            "bed_ch",
            "gff"
        ],
        "nb_inputs": 3,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "publishDir path: \"$outdir/reports\", mode: \"copy\", pattern: \"*.html\"",
            "label 'covviz'",
            "cache 'lenient'"
        ],
        "when": "",
        "stub": ""
    },
    "make_somatic": {
        "name_process": "make_somatic",
        "string_process": "\nprocess make_somatic {\n    publishDir path:  \"$outdir/vep\", mode: \"copy\"\n\n    input:\n    file vcf from somaticvcf_ch\n    file mask from params.somaticmask\n\n    output:\n    file(\"somatic.vcf\")\n\n    script:\n                                                         \n                                                    \n    \"\"\"\n    bedtools intersect -a $vcf -b $mask -wa -u -header > masked.vcf\n    SnpSift filter \"(QUAL >= ${params.minquality}) & (GEN[ALL].DP >= ${params.mindepth})\" masked.vcf > filtered.vcf\n    bcftools view --min-alleles 2 --max-alleles 2 --output-file biallelic.vcf filtered.vcf\n    snpEff -Xmx16g -i vcf -o vcf -noStats GRCh38.86 biallelic.vcf > snpeff.vcf\n    SnpSift filter \"(GEN[0].AO<=${params.maxao})\" snpeff.vcf | bgzip > somatic.vcf.gz\n    tabix -p vcf somatic.vcf.gz\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "    \"\"\"\n    bedtools intersect -a $vcf -b $mask -wa -u -header > masked.vcf\n    SnpSift filter \"(QUAL >= ${params.minquality}) & (GEN[ALL].DP >= ${params.mindepth})\" masked.vcf > filtered.vcf\n    bcftools view --min-alleles 2 --max-alleles 2 --output-file biallelic.vcf filtered.vcf\n    snpEff -Xmx16g -i vcf -o vcf -noStats GRCh38.86 biallelic.vcf > snpeff.vcf\n    SnpSift filter \"(GEN[0].AO<=${params.maxao})\" snpeff.vcf | bgzip > somatic.vcf.gz\n    tabix -p vcf somatic.vcf.gz\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "BEDTools",
            "SnpSift",
            "BCFtools",
            "snpEff"
        ],
        "tools_url": [
            "https://bio.tools/bedtools",
            "https://bio.tools/snpsift",
            "https://bio.tools/bcftools",
            "https://bio.tools/snpeff"
        ],
        "tools_dico": [
            {
                "name": "BEDTools",
                "uri": "https://bio.tools/bedtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0622",
                            "term": "Genomics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Mapping"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2429",
                                    "term": "Cartography"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "BEDTools is an extensive suite of utilities for comparing genomic features in BED format.",
                "homepage": "https://github.com/arq5x/bedtools2"
            },
            {
                "name": "SnpSift",
                "uri": "https://bio.tools/snpsift",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3365",
                            "term": "Data architecture, analysis and design"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3675",
                                    "term": "Variant filtering"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Toolbox that allows you to filter and manipulate annotated vcf files.",
                "homepage": "http://snpeff.sourceforge.net/SnpSift.html"
            },
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "snpEff",
                "uri": "https://bio.tools/snpeff",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3511",
                            "term": "Nucleic acid sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP detection"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "Single nucleotide polymorphism detection"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP discovery"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0484",
                                    "term": "SNP calling"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            },
                            {
                                "uri": "http://edamontology.org/data_3002",
                                "term": "Annotation track"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0006",
                                "term": "Data"
                            },
                            {
                                "uri": "http://edamontology.org/data_2048",
                                "term": "Report"
                            }
                        ]
                    }
                ],
                "description": "Variant annotation and effect prediction tool. It annotates and predicts the effects of variants on genes and proteins (such as amino acid changes).",
                "homepage": "http://snpeff.sourceforge.net/"
            }
        ],
        "inputs": [
            "somaticvcf_ch",
            "params"
        ],
        "nb_inputs": 2,
        "outputs": [],
        "nb_outputs": 0,
        "name_workflow": "quinlan-lab__preon",
        "directive": [
            "publishDir path: \"$outdir/vep\", mode: \"copy\""
        ],
        "when": "",
        "stub": ""
    }
}