{
    "trim_reads_with_fastp": {
        "name_process": "trim_reads_with_fastp",
        "string_process": "\nprocess trim_reads_with_fastp{\n\n    input:\n    set val(id), file(read1), file(read2) from reads \n\n    output:\n    set val(id), file(\"${id}_R1_trimmed.fastq.gz\") into trimmed_reads_channel_r1\n    set val(id), file(\"${id}_R2_trimmed.fastq.gz\") into trimmed_reads_channel_r2\n    file \"${id}_trimmed.html\" into fastp_html\n    file \"${id}_trimmed.json\" into fastp_json\n\n\t\"\"\"\n\tfastp \\\n    -i $read1 \\\n    -I $read2 \\\n    -o ${id}_R1_trimmed.fastq.gz \\\n    -O ${id}_R2_trimmed.fastq.gz \\\n    -h ${id}_trimmed.html \\\n    -j ${id}_trimmed.json \\\n    -w $params.fastp_threads\n\t\"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n\tfastp \\\n    -i $read1 \\\n    -I $read2 \\\n    -o ${id}_R1_trimmed.fastq.gz \\\n    -O ${id}_R2_trimmed.fastq.gz \\\n    -h ${id}_trimmed.html \\\n    -j ${id}_trimmed.json \\\n    -w $params.fastp_threads\n\t\"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "fastPHASE"
        ],
        "tools_url": [
            "https://bio.tools/fastphase"
        ],
        "tools_dico": [
            {
                "name": "fastPHASE",
                "uri": "https://bio.tools/fastphase",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3056",
                            "term": "Population genetics"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3454",
                                    "term": "Phasing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Imputation"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3557",
                                    "term": "Data imputation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "fastPHASE is a program to estimate missing genotypes and unobserved haplotypes. It is an implementation of the model described in Scheet & Stephens (2006). This is a cluster-based model for haplotype variation, and gains its utility from implicitly modeling the genealogy of chromosomes in a random sample from a population as a tree but summarizing all haplotype variation in the \"tips\" of the trees.",
                "homepage": "http://scheet.org/software.html"
            }
        ],
        "inputs": [
            "reads"
        ],
        "nb_inputs": 1,
        "outputs": [
            "trimmed_reads_channel_r1",
            "trimmed_reads_channel_r2",
            "fastp_html",
            "fastp_json"
        ],
        "nb_outputs": 4,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "align_reads_with_bwa": {
        "name_process": "align_reads_with_bwa",
        "string_process": "\nprocess align_reads_with_bwa{\n\n    input:\n    set val(id1), file(read1) from trimmed_reads_channel_r1\n    set val(id2), file(read2) from trimmed_reads_channel_r2\n\n    output:\n    file \"${id1}.bam\" into inital_bam_channel\n    file \"${id1}.bam.bai\" into inital_bam_indexes_channel\n\n    script:\n    lane = read1.name.toString().tokenize('_').get(2)\n    sample_id = read1.name.toString().tokenize('_').get(0)\n\n    \"\"\"\n\tbwa mem \\\n    -t $params.bwa_threads \\\n    -M \\\n    -R '@RG\\\\tID:${params.sequencing_run}.${lane}\\\\tCN:${params.sequencing_centre}\\\\tSM:${sample_id}\\\\tLB:${params.sequencing_run}\\\\tPL:ILLUMINA' \\\n    $reference_genome \\\n    $read1 \\\n    $read2 | samtools view -Sb - | \\\n    samtools sort -T $params.bwa_temp_dir -O bam > ${id1}.bam\n\n    samtools index ${id1}.bam\n\t\"\"\"\n}",
        "nb_lignes_process": 26,
        "string_script": "    lane = read1.name.toString().tokenize('_').get(2)\n    sample_id = read1.name.toString().tokenize('_').get(0)\n\n    \"\"\"\n\tbwa mem \\\n    -t $params.bwa_threads \\\n    -M \\\n    -R '@RG\\\\tID:${params.sequencing_run}.${lane}\\\\tCN:${params.sequencing_centre}\\\\tSM:${sample_id}\\\\tLB:${params.sequencing_run}\\\\tPL:ILLUMINA' \\\n    $reference_genome \\\n    $read1 \\\n    $read2 | samtools view -Sb - | \\\n    samtools sort -T $params.bwa_temp_dir -O bam > ${id1}.bam\n\n    samtools index ${id1}.bam\n\t\"\"\"",
        "nb_lignes_script": 14,
        "language_script": "bash",
        "tools": [
            "PlaNET",
            "BWA",
            "SAMtools"
        ],
        "tools_url": [
            "https://bio.tools/PlaNET",
            "https://bio.tools/bwa",
            "https://bio.tools/samtools"
        ],
        "tools_dico": [
            {
                "name": "PlaNET",
                "uri": "https://bio.tools/PlaNET",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarray experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3295",
                            "term": "Epigenetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3518",
                            "term": "Microarrays"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3196",
                                    "term": "Genotyping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3891",
                                    "term": "Essential dynamics"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "PTM site prediction"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3891",
                                    "term": "PCA"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3891",
                                    "term": "Principal modes"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3891",
                                    "term": "ED"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "Post-translational modification analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "Protein post-translation modification site prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "PTM analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "Post-translational modification site prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "PTM prediction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "PTM site analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0417",
                                    "term": "Post-translation modification site prediction"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "R package for inferring ethnicity from placental DNA methylation microarray data.",
                "homepage": "https://github.com/wvictor14/planet"
            },
            {
                "name": "BWA",
                "uri": "https://bio.tools/bwa",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    []
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3211",
                                    "term": "Genome indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3429",
                                    "term": "Construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Oligonucleotide alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short sequence read mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3198",
                                    "term": "Short read alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_2044",
                                "term": "Sequence"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0863",
                                "term": "Sequence alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_2012",
                                "term": "Sequence coordinates"
                            },
                            {
                                "uri": "http://edamontology.org/data_1916",
                                "term": "Alignment"
                            },
                            {
                                "uri": "http://edamontology.org/data_3210",
                                "term": "Genome index"
                            }
                        ]
                    }
                ],
                "description": "Fast, accurate, memory-efficient aligner for short and long sequencing reads",
                "homepage": "http://bio-bwa.sourceforge.net"
            },
            {
                "name": "SAMtools",
                "uri": "https://bio.tools/samtools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "Rare diseases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0102",
                            "term": "Mapping"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3325",
                            "term": "https://en.wikipedia.org/wiki/Rare_disease"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3096",
                                    "term": "Editing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Parsing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Indexing"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Data visualisation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0337",
                                    "term": "Rendering"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Data loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_1812",
                                    "term": "Loading"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File format conversion"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "File formatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0335",
                                    "term": "Reformatting"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Data indexing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0227",
                                    "term": "Database indexing"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_0924",
                                "term": "Sequence trace"
                            }
                        ]
                    }
                ],
                "description": "A software package with various utilities for processing alignments in the SAM format, including variant calling and alignment viewing.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "trimmed_reads_channel_r1",
            "trimmed_reads_channel_r2"
        ],
        "nb_inputs": 2,
        "outputs": [
            "inital_bam_channel",
            "inital_bam_indexes_channel"
        ],
        "nb_outputs": 2,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "merge_bams_and_remove_duplicates": {
        "name_process": "merge_bams_and_remove_duplicates",
        "string_process": "\nprocess merge_bams_and_remove_duplicates{\n\n        publishDir \"results/final_bams/\"\n\n    input:\n    set val(key), file(bams) from inital_bam_channel.map { file ->\n    def key = file.name.toString().tokenize('_').get(0)\n    return tuple(key, file)\n    }\n    .groupTuple()\n\n    set val(key2), file(bam_indexes) from inital_bam_indexes_channel.map { file ->\n    def key = file.name.toString().tokenize('_').get(0)\n    return tuple(key, file)\n    }\n    .groupTuple()\n\n    output:\n    file(\"${key}_markduplicates.bam\") into mark_duplicates_bam_channel\n    file(\"${key}_markduplicates.bai\") into mark_duplicates_bam_index_channel\n    file(\"${key}_markduplicate_metrics.txt\")\n\n    \"\"\"\n    picard MarkDuplicates \\\n    ${bams.collect { \"I=$it \" }.join()} \\\n    O=${key}_markduplicates.bam \\\n    METRICS_FILE=${key}_markduplicate_metrics.txt \\\n    CREATE_INDEX=true \\\n    VALIDATION_STRINGENCY=SILENT \\\n    MAX_RECORDS_IN_RAM=${params.picard_max_ram_records} \\\n    TMP_DIR=${params.picard_temp_dir}\n    \"\"\"\n}",
        "nb_lignes_process": 32,
        "string_script": "\"\"\"\n    picard MarkDuplicates \\\n    ${bams.collect { \"I=$it \" }.join()} \\\n    O=${key}_markduplicates.bam \\\n    METRICS_FILE=${key}_markduplicate_metrics.txt \\\n    CREATE_INDEX=true \\\n    VALIDATION_STRINGENCY=SILENT \\\n    MAX_RECORDS_IN_RAM=${params.picard_max_ram_records} \\\n    TMP_DIR=${params.picard_temp_dir}\n    \"\"\"",
        "nb_lignes_script": 9,
        "language_script": "bash",
        "tools": [
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "inital_bam_channel",
            "inital_bam_indexes_channel"
        ],
        "nb_inputs": 2,
        "outputs": [
            "mark_duplicates_bam_channel",
            "mark_duplicates_bam_index_channel"
        ],
        "nb_outputs": 2,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [
            "publishDir \"results/final_bams/\""
        ],
        "when": "",
        "stub": ""
    },
    "sort_capture_bed": {
        "name_process": "sort_capture_bed",
        "string_process": "\nprocess sort_capture_bed{\n\n    input:\n    file(capture_bed)\n\n    output:\n    file(\"${capture_bed.baseName}_sorted.bed\") into sorted_capture_bed\n\n    \"\"\"\n    sort-bed $capture_bed > ${capture_bed.baseName}_sorted.bed\n    \"\"\"\n}",
        "nb_lignes_process": 11,
        "string_script": "\"\"\"\n    sort-bed $capture_bed > ${capture_bed.baseName}_sorted.bed\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "capture_bed"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sorted_capture_bed"
        ],
        "nb_outputs": 1,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "split_bed_by_chromosome": {
        "name_process": "split_bed_by_chromosome",
        "string_process": "\nprocess split_bed_by_chromosome{\n\n    input:\n    val(chr) from chromosomes_ch\n    file(sorted_capture_bed) from sorted_capture_bed\n\n    output:\n    file(\"${chr}.bed\") into per_chromosome_bed_channel\n\n    \"\"\"\n    bedextract ${chr} $sorted_capture_bed > ${chr}.bed\n    \"\"\"\n}",
        "nb_lignes_process": 12,
        "string_script": "\"\"\"\n    bedextract ${chr} $sorted_capture_bed > ${chr}.bed\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "chromosomes_ch",
            "sorted_capture_bed"
        ],
        "nb_inputs": 2,
        "outputs": [
            "per_chromosome_bed_channel"
        ],
        "nb_outputs": 1,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "call_variants_with_platypus": {
        "name_process": "call_variants_with_platypus",
        "string_process": "\nprocess call_variants_with_platypus{\n    conda 'env/platypus.yaml'\n\n    input:\n    file (bams) from mark_duplicates_bam_channel.collect()\n    file (bam_indexes) from mark_duplicates_bam_index_channel.collect()\n    each file(chr) from per_chromosome_bed_channel\n\n    output:\n    file (\"${params.sequencing_run}_${chr.baseName}.vcf\") into per_chromsome_vcf_channel\n    file (\"${params.sequencing_run}_${chr.baseName}.log\") into per_chromsome_vcf_log_channel\n\n    \"\"\"\n    platypus \\\n    callVariants \\\n    --bamFiles=${bams.collect { \"$it\" }.join(\",\")} \\\n    --refFile=$reference_genome \\\n    --output=${params.sequencing_run}_${chr.baseName}.vcf \\\n    --regions=${chr} \\\n    --nCPU=${params.platypus_threads} \\\n    --minReads=${params.platypus_min_reads} \\\n    --hapScoreThreshold=${params.platypus_hap_score_threshold} \\\n    --minVarFreq=${params.platypus_min_var_freq} \\\n    --logFileName=${params.sequencing_run}_${chr.baseName}.log\n    \"\"\"\n}",
        "nb_lignes_process": 25,
        "string_script": "\"\"\"\n    platypus \\\n    callVariants \\\n    --bamFiles=${bams.collect { \"$it\" }.join(\",\")} \\\n    --refFile=$reference_genome \\\n    --output=${params.sequencing_run}_${chr.baseName}.vcf \\\n    --regions=${chr} \\\n    --nCPU=${params.platypus_threads} \\\n    --minReads=${params.platypus_min_reads} \\\n    --hapScoreThreshold=${params.platypus_hap_score_threshold} \\\n    --minVarFreq=${params.platypus_min_var_freq} \\\n    --logFileName=${params.sequencing_run}_${chr.baseName}.log\n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "platypus"
        ],
        "tools_url": [
            "https://bio.tools/platypus"
        ],
        "tools_dico": [
            {
                "name": "platypus",
                "uri": "https://bio.tools/platypus",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype mapping"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype reconstruction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype map generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0487",
                                    "term": "Haplotype inference"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment generation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_0292",
                                    "term": "Sequence alignment construction"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A tool designed for efficient and accurate variant-detection in high-throughput sequencing data using local realignment of reads and local assembly. Platypus can detect SNPs, MNPs, short indels, replacements and (using the assembly option) deletions up to several kb.",
                "homepage": "http://www.well.ox.ac.uk/platypus"
            }
        ],
        "inputs": [
            "mark_duplicates_bam_channel",
            "mark_duplicates_bam_index_channel",
            "per_chromosome_bed_channel"
        ],
        "nb_inputs": 3,
        "outputs": [
            "per_chromsome_vcf_channel",
            "per_chromsome_vcf_log_channel"
        ],
        "nb_outputs": 2,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [
            "conda 'env/platypus.yaml'"
        ],
        "when": "",
        "stub": ""
    },
    "fix_platypus_headers": {
        "name_process": "fix_platypus_headers",
        "string_process": "\nprocess fix_platypus_headers{\n\n    input:\n    file(per_chr_vcfs) from per_chromsome_vcf_channel\n\n    output:\n    file (\"${params.sequencing_run}_${chr}_sd.vcf\") into per_chromsome_vcf_sd_channel\n\n    script:\n    chr = per_chr_vcfs.baseName.toString().tokenize('_').get(1)\n\n    \"\"\"\n    picard UpdateVcfSequenceDictionary \\\n    I=${per_chr_vcfs} \\\n    O=${params.sequencing_run}_${chr}_sd.vcf \\\n    SD=${sequence_dict}\n    \"\"\"\n}",
        "nb_lignes_process": 17,
        "string_script": "    chr = per_chr_vcfs.baseName.toString().tokenize('_').get(1)\n\n    \"\"\"\n    picard UpdateVcfSequenceDictionary \\\n    I=${per_chr_vcfs} \\\n    O=${params.sequencing_run}_${chr}_sd.vcf \\\n    SD=${sequence_dict}\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [
            "SynChr",
            "Picard"
        ],
        "tools_url": [
            "https://bio.tools/synchr",
            "https://bio.tools/picard_tools"
        ],
        "tools_dico": [
            {
                "name": "SynChr",
                "uri": "https://bio.tools/synchr",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0092",
                            "term": "Data visualisation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0092",
                            "term": "Data rendering"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_0283",
                                    "term": "Linkage analysis"
                                }
                            ],
                            []
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A Fast and Easy Tool to Reconstruct and Visualize Synteny Blocks along Eukaryotic Chromosomes.",
                "homepage": "http://www.lcqb.upmc.fr/CHROnicle/SynChro.html"
            },
            {
                "name": "Picard",
                "uri": "https://bio.tools/picard_tools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Biological databases"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Data management"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3071",
                            "term": "Databases and information systems"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Sequence variation analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Variant analysis"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3197",
                                    "term": "Genetic variation annotation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "A set of command line tools for manipulating high-throughput sequencing (HTS) data in formats such as SAM/BAM/CRAM and VCF. Available as a standalone program or within the GATK4 program.",
                "homepage": "https://github.com/broadinstitute/picard"
            }
        ],
        "inputs": [
            "per_chromsome_vcf_channel"
        ],
        "nb_inputs": 1,
        "outputs": [
            "per_chromsome_vcf_sd_channel"
        ],
        "nb_outputs": 1,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "collect_per_chromosome_vcfs_split_and_normalise": {
        "name_process": "collect_per_chromosome_vcfs_split_and_normalise",
        "string_process": "\nprocess collect_per_chromosome_vcfs_split_and_normalise{\n\n    input:\n    file (per_chr_vcfs) from per_chromsome_vcf_sd_channel.collect()\n\n    output:\n    file(\"${params.sequencing_run}_merged_normalised_roi.vcf\") into merged_and_normalised_vcf_channel\n\n    \"\"\"\n    bcftools concat ${per_chr_vcfs.collect { \"$it \" }.join()} | bcftools sort | \\\n    sed 's/##FORMAT=<ID=GQ,Number=1/##FORMAT=<ID=GQ,Number=./' | \\\n    sed 's/##FORMAT=<ID=NR,Number=./##FORMAT=<ID=NR,Number=A/' | \\\n    sed 's/##FORMAT=<ID=NV,Number=./##FORMAT=<ID=NV,Number=A/' | \\\n    vt decompose -s - | vt normalize -r $reference_genome - > ${params.sequencing_run}_merged_normalised.vcf\n\n    bgzip ${params.sequencing_run}_merged_normalised.vcf\n    tabix ${params.sequencing_run}_merged_normalised.vcf.gz\n\n    bcftools view -R $capture_bed ${params.sequencing_run}_merged_normalised.vcf.gz > \"${params.sequencing_run}_merged_normalised_roi.vcf\"\n\n    \"\"\"\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n    bcftools concat ${per_chr_vcfs.collect { \"$it \" }.join()} | bcftools sort | \\\n    sed 's/##FORMAT=<ID=GQ,Number=1/##FORMAT=<ID=GQ,Number=./' | \\\n    sed 's/##FORMAT=<ID=NR,Number=./##FORMAT=<ID=NR,Number=A/' | \\\n    sed 's/##FORMAT=<ID=NV,Number=./##FORMAT=<ID=NV,Number=A/' | \\\n    vt decompose -s - | vt normalize -r $reference_genome - > ${params.sequencing_run}_merged_normalised.vcf\n\n    bgzip ${params.sequencing_run}_merged_normalised.vcf\n    tabix ${params.sequencing_run}_merged_normalised.vcf.gz\n\n    bcftools view -R $capture_bed ${params.sequencing_run}_merged_normalised.vcf.gz > \"${params.sequencing_run}_merged_normalised_roi.vcf\"\n\n    \"\"\"",
        "nb_lignes_script": 12,
        "language_script": "bash",
        "tools": [
            "BCFtools",
            "vt"
        ],
        "tools_url": [
            "https://bio.tools/bcftools",
            "https://bio.tools/vt"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            },
            {
                "name": "vt",
                "uri": "https://bio.tools/vt",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_0160",
                            "term": "Sequence sites, features and motifs"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequence analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "Sequencing"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3053",
                            "term": "Genetics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0080",
                            "term": "Sequences"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3168",
                            "term": "DNA-Seq"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Variant tool set that discovers short variants from Next Generation Sequencing data.",
                "homepage": "http://genome.sph.umich.edu/wiki/Vt"
            }
        ],
        "inputs": [
            "per_chromsome_vcf_sd_channel"
        ],
        "nb_inputs": 1,
        "outputs": [
            "merged_and_normalised_vcf_channel"
        ],
        "nb_outputs": 1,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "annotate_with_vep": {
        "name_process": "annotate_with_vep",
        "string_process": "\nprocess annotate_with_vep{\n\n    publishDir \"results/annotated_vcf/\"\n\n    input:\n    file(normalised_vcf) from merged_and_normalised_vcf_channel\n\n    output:\n    file(\"${params.sequencing_run}_merged_normalised_roi_annotated.vcf\") into annotated_vcf\n\n    \"\"\"\n    vep \\\n    --verbose \\\n    --format vcf \\\n    --everything \\\n    --fork $params.vep_threads \\\n    --species homo_sapiens \\\n    --assembly GRCh37 \\\n    --input_file $normalised_vcf \\\n    --output_file ${params.sequencing_run}_merged_normalised_roi_annotated.vcf \\\n    --force_overwrite \\\n    --cache \\\n    --dir  $vep_cache \\\n    --fasta $reference_genome \\\n    --offline \\\n    --cache_version 94 \\\n    --no_escape \\\n    --shift_hgvs 1 \\\n    --vcf \\\n    --refseq \\\n    --flag_pick \\\n    --pick_order biotype,canonical,appris,tsl,ccds,rank,length \\\n    --exclude_predicted \\\n    --custom ${gnomad_genomes},gnomADg,vcf,exact,0,AF_POPMAX \\\n    --custom ${gnomad_exomes},gnomADe,vcf,exact,0,AF_POPMAX \n    \"\"\"\n}",
        "nb_lignes_process": 36,
        "string_script": "\"\"\"\n    vep \\\n    --verbose \\\n    --format vcf \\\n    --everything \\\n    --fork $params.vep_threads \\\n    --species homo_sapiens \\\n    --assembly GRCh37 \\\n    --input_file $normalised_vcf \\\n    --output_file ${params.sequencing_run}_merged_normalised_roi_annotated.vcf \\\n    --force_overwrite \\\n    --cache \\\n    --dir  $vep_cache \\\n    --fasta $reference_genome \\\n    --offline \\\n    --cache_version 94 \\\n    --no_escape \\\n    --shift_hgvs 1 \\\n    --vcf \\\n    --refseq \\\n    --flag_pick \\\n    --pick_order biotype,canonical,appris,tsl,ccds,rank,length \\\n    --exclude_predicted \\\n    --custom ${gnomad_genomes},gnomADg,vcf,exact,0,AF_POPMAX \\\n    --custom ${gnomad_exomes},gnomADe,vcf,exact,0,AF_POPMAX \n    \"\"\"",
        "nb_lignes_script": 25,
        "language_script": "bash",
        "tools": [
            "fivepseq"
        ],
        "tools_url": [
            "https://bio.tools/fivepseq"
        ],
        "tools_dico": [
            {
                "name": "fivepseq",
                "uri": "https://bio.tools/fivepseq",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "Gene transcripts"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3308",
                            "term": "Transcriptomics"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_3512",
                            "term": "mRNA features"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantification"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3563",
                                    "term": "RNA-seq read count analysis"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_3800",
                                    "term": "RNA-Seq quantitation"
                                }
                            ]
                        ],
                        "input": [],
                        "output": []
                    }
                ],
                "description": "Fivepseq is a software package for analysis of 5prime endpoints distribution in RNA sequencing datasets. This is particularly useful for techniques that capture 5prime  monophosphorylated RNAs, such as 5PSeq, PARE-seq or GMUC. It may also be useful for ribosome profiling datasets and alike.",
                "homepage": "http://pelechanolab.com/software/fivepseq"
            }
        ],
        "inputs": [
            "merged_and_normalised_vcf_channel"
        ],
        "nb_inputs": 1,
        "outputs": [
            "annotated_vcf"
        ],
        "nb_outputs": 1,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [
            "publishDir \"results/annotated_vcf/\""
        ],
        "when": "",
        "stub": ""
    },
    "get_sample_names_from_vcf": {
        "name_process": "get_sample_names_from_vcf",
        "string_process": "\nprocess get_sample_names_from_vcf{\n\n    input:\n    file(annotated_vcf) from annotated_vcf_sample_names\n\n    output:\n    file(\"${params.sequencing_run}_sample_names.txt\") into sample_names_from_vcf\n\n    \"\"\"\n    bcftools query -l $annotated_vcf > ${params.sequencing_run}_sample_names.txt\n    \"\"\"\n\n}",
        "nb_lignes_process": 12,
        "string_script": "\"\"\"\n    bcftools query -l $annotated_vcf > ${params.sequencing_run}_sample_names.txt\n    \"\"\"",
        "nb_lignes_script": 2,
        "language_script": "bash",
        "tools": [
            "BCFtools"
        ],
        "tools_url": [
            "https://bio.tools/bcftools"
        ],
        "tools_dico": [
            {
                "name": "BCFtools",
                "uri": "https://bio.tools/bcftools",
                "topic": [
                    [
                        {
                            "uri": "http://edamontology.org/topic_3516",
                            "term": "Genotyping experiment"
                        },
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "Genetic variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS study"
                        },
                        {
                            "uri": "http://edamontology.org/topic_2885",
                            "term": "DNA polymorphism"
                        }
                    ],
                    [
                        {
                            "uri": "http://edamontology.org/topic_0199",
                            "term": "DNA variation"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS analysis"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "GWAS"
                        },
                        {
                            "uri": "http://edamontology.org/topic_3517",
                            "term": "Genome-wide association study"
                        }
                    ]
                ],
                "function": [
                    {
                        "operation": [
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Data handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant calling"
                                }
                            ],
                            [
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Utility operation"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "File processing"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_2409",
                                    "term": "Report handling"
                                },
                                {
                                    "uri": "http://edamontology.org/operation_3227",
                                    "term": "Variant mapping"
                                }
                            ]
                        ],
                        "input": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ],
                        "output": [
                            {
                                "uri": "http://edamontology.org/data_3498",
                                "term": "Sequence variations"
                            }
                        ]
                    }
                ],
                "description": "Set of utilities that manipulate variant calls in the Variant Call Format (VCF) and its binary counterpart BCF. All commands work transparently with both VCFs and BCFs, both uncompressed and BGZF-compressed.",
                "homepage": "http://www.htslib.org/"
            }
        ],
        "inputs": [
            "annotated_vcf_sample_names"
        ],
        "nb_inputs": 1,
        "outputs": [
            "sample_names_from_vcf"
        ],
        "nb_outputs": 1,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [],
        "when": "",
        "stub": ""
    },
    "create_snp_indel_variant_report": {
        "name_process": "create_snp_indel_variant_report",
        "string_process": "\nprocess create_snp_indel_variant_report{\n\n    publishDir \"results/variant_reports/\"\n\n    input:\n    file(annotated_vcf) from annotated_vcf_report\n    val sample_names from samples_ch\n\n    output:\n    file(\"${params.sequencing_run}_${sample_names[0]}_filtered.csv\") into variant_report_filtered\n    file(\"${params.sequencing_run}_${sample_names[0]}_unfiltered.csv\") into variant_report_unfiltered\n\n    \"\"\"\n    create_variant_report.py \\\n    --vcf $annotated_vcf \\\n    --sample_id ${sample_names[0]} \\\n    --worklist_id $params.sequencing_run \\\n    --output ${params.sequencing_run}_${sample_names[0]} \\\n    --gnomad_max_af $params.gnomad_max_pop\n    \"\"\"\n\n}",
        "nb_lignes_process": 21,
        "string_script": "\"\"\"\n    create_variant_report.py \\\n    --vcf $annotated_vcf \\\n    --sample_id ${sample_names[0]} \\\n    --worklist_id $params.sequencing_run \\\n    --output ${params.sequencing_run}_${sample_names[0]} \\\n    --gnomad_max_af $params.gnomad_max_pop\n    \"\"\"",
        "nb_lignes_script": 7,
        "language_script": "bash",
        "tools": [],
        "tools_url": [],
        "tools_dico": [],
        "inputs": [
            "annotated_vcf_report",
            "samples_ch"
        ],
        "nb_inputs": 2,
        "outputs": [
            "variant_report_filtered",
            "variant_report_unfiltered"
        ],
        "nb_outputs": 2,
        "name_workflow": "josephhalstead__nextflow_small_germline_panel",
        "directive": [
            "publishDir \"results/variant_reports/\""
        ],
        "when": "",
        "stub": ""
    }
}